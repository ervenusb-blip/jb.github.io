(function( factory ) {"use strict";if ( typeof define === "function" && define.amd ) {define(["jquery","jquery-ui/sortable"], factory );} else {factory( window.jQuery );}}(function($) {"use strict";function isOverAxis( x, reference, size ) {return ( x > reference ) && ( x < ( reference + size ) );}
$.widget("mjs.nestedSortable", $.extend({}, $.ui.sortable.prototype, {options: {disableParentChange: false,doNotClear: false,expandOnHover: 700,isAllowed: function() { return true; },isTree: false,listType: "ol",maxLevels: 0,protectRoot: false,rootID: null,rtl: false,startCollapsed: false,tabSize: 20,branchClass: "mjs-nestedSortable-branch",collapsedClass: "mjs-nestedSortable-collapsed",disableNestingClass: "mjs-nestedSortable-no-nesting",errorClass: "mjs-nestedSortable-error",expandedClass: "mjs-nestedSortable-expanded",hoveringClass: "mjs-nestedSortable-hovering",leafClass: "mjs-nestedSortable-leaf",disabledClass: "mjs-nestedSortable-disabled"},_create: function() {var self = this,err;this.element.data("ui-sortable", this.element.data("mjs-nestedSortable"));if (!this.element.is(this.options.listType)) {err = "nestedSortable: " +"Please check that the listType option is set to your actual list type";throw new Error(err);}
if (this.options.isTree && this.options.expandOnHover) {this.options.tolerance = "intersect";}
$.ui.sortable.prototype._create.apply(this, arguments);if (this.options.isTree) {$(this.items).each(function() {var $li = this.item,hasCollapsedClass = $li.hasClass(self.options.collapsedClass),hasExpandedClass = $li.hasClass(self.options.expandedClass);if ($li.children(self.options.listType).length) {$li.addClass(self.options.branchClass);if ( !hasCollapsedClass && !hasExpandedClass ) {if (self.options.startCollapsed) {$li.addClass(self.options.collapsedClass);} else {$li.addClass(self.options.expandedClass);}}} else {$li.addClass(self.options.leafClass);}});}},_destroy: function() {this.element
.removeData("mjs-nestedSortable")
.removeData("ui-sortable");return $.ui.sortable.prototype._destroy.apply(this, arguments);},_mouseDrag: function(event) {var i,item,itemElement,intersection,self = this,o = this.options,scrolled = false,$document = $(document),previousTopOffset,parentItem,level,childLevels,itemAfter,itemBefore,newList,method,a,previousItem,nextItem,helperIsNotSibling;this.position = this._generatePosition(event);this.positionAbs = this._convertPositionTo("absolute");if (!this.lastPositionAbs) {this.lastPositionAbs = this.positionAbs;}
if (this.options.scroll) {if (this.scrollParent[0] !== document && this.scrollParent[0].tagName !== "HTML") {if ((this.overflowOffset.top +this.scrollParent[0].offsetHeight) -
event.pageY <
o.scrollSensitivity) {scrolled = this.scrollParent.scrollTop() + o.scrollSpeed;this.scrollParent.scrollTop(scrolled);} else if (event.pageY -
this.overflowOffset.top <
o.scrollSensitivity) {scrolled = this.scrollParent.scrollTop() - o.scrollSpeed;this.scrollParent.scrollTop(scrolled);}
if ((this.overflowOffset.left +this.scrollParent[0].offsetWidth) -
event.pageX <
o.scrollSensitivity) {scrolled = this.scrollParent.scrollLeft() + o.scrollSpeed;this.scrollParent.scrollLeft(scrolled);} else if (event.pageX -
this.overflowOffset.left <
o.scrollSensitivity) {scrolled = this.scrollParent.scrollLeft() - o.scrollSpeed;this.scrollParent.scrollLeft(scrolled);}} else {if (event.pageY -
$document.scrollTop() <
o.scrollSensitivity) {scrolled = $document.scrollTop() - o.scrollSpeed;$document.scrollTop(scrolled);} else if ($(window).height() -
(event.pageY -
$document.scrollTop()) <
o.scrollSensitivity) {scrolled = $document.scrollTop() + o.scrollSpeed;$document.scrollTop(scrolled);}
if (event.pageX -
$document.scrollLeft() <
o.scrollSensitivity) {scrolled = $document.scrollLeft() - o.scrollSpeed;$document.scrollLeft(scrolled);} else if ($(window).width() -
(event.pageX -
$document.scrollLeft()) <
o.scrollSensitivity) {scrolled = $document.scrollLeft() + o.scrollSpeed;$document.scrollLeft(scrolled);}}
if (scrolled !== false && $.ui.ddmanager && !o.dropBehaviour) {$.ui.ddmanager.prepareOffsets(this, event);}}
this.positionAbs = this._convertPositionTo("absolute");previousTopOffset = this.placeholder.offset().top;if (!this.options.axis || this.options.axis !== "y") {this.helper[0].style.left = this.position.left + "px";}
if (!this.options.axis || this.options.axis !== "x") {this.helper[0].style.top = (this.position.top) + "px";}
this.hovering = this.hovering ? this.hovering : null;this.mouseentered = this.mouseentered ? this.mouseentered : false;(function() {var _parentItem = this.placeholder.parent().parent();if (_parentItem && _parentItem.closest(".ui-sortable").length) {parentItem = _parentItem;}}.call(this));level = this._getLevel(this.placeholder);childLevels = this._getChildLevels(this.helper);newList = document.createElement(o.listType);for (i = this.items.length - 1; i >= 0; i--) {item = this.items[i];itemElement = item.item[0];intersection = this._intersectsWithPointer(item);if (!intersection) {continue;}
if (item.instance !== this.currentContainer) {continue;}
if (itemElement.className.indexOf(o.disabledClass) !== -1) {if (intersection === 2) {itemAfter = this.items[i + 1];if (itemAfter && itemAfter.item.hasClass(o.disabledClass)) {continue;}} else if (intersection === 1) {itemBefore = this.items[i - 1];if (itemBefore && itemBefore.item.hasClass(o.disabledClass)) {continue;}}}
method = intersection === 1 ? "next" : "prev";if (itemElement !== this.currentItem[0] &&this.placeholder[method]()[0] !== itemElement &&!$.contains(this.placeholder[0], itemElement) &&(this.options.type === "semi-dynamic" ?!$.contains(this.element[0], itemElement) :true)) {if (!this.mouseentered) {$(itemElement).mouseenter();this.mouseentered = true;}
if (o.isTree && $(itemElement).hasClass(o.collapsedClass) && o.expandOnHover) {if (!this.hovering) {$(itemElement).addClass(o.hoveringClass);this.hovering = window.setTimeout(function() {$(itemElement)
.removeClass(o.collapsedClass)
.addClass(o.expandedClass);self.refreshPositions();self._trigger("expand", event, self._uiHash());}, o.expandOnHover);}}
this.direction = intersection === 1 ? "down" : "up";if (this.options.tolerance === "pointer" || this._intersectsWithSides(item)) {$(itemElement).mouseleave();this.mouseentered = false;$(itemElement).removeClass(o.hoveringClass);if (this.hovering) {window.clearTimeout(this.hovering);}
this.hovering = null;if (o.protectRoot &&!(this.currentItem[0].parentNode === this.element[0] &&itemElement.parentNode !== this.element[0])) {if (this.currentItem[0].parentNode !== this.element[0] &&itemElement.parentNode === this.element[0]) {if ( !$(itemElement).children(o.listType).length) {itemElement.appendChild(newList);if (o.isTree) {$(itemElement)
.removeClass(o.leafClass)
.addClass(o.branchClass + " " + o.expandedClass);}}
if (this.direction === "down") {a = $(itemElement).prev().children(o.listType);} else {a = $(itemElement).children(o.listType);}
if (a[0] !== undefined) {this._rearrange(event, null, a);}} else {this._rearrange(event, item);}} else if (!o.protectRoot) {this._rearrange(event, item);}} else {break;}
this._clearEmpty(itemElement);this._trigger("change", event, this._uiHash());break;}}
(function() {var _previousItem = this.placeholder.prev();if (_previousItem.length) {previousItem = _previousItem;} else {previousItem = null;}}.call(this));if (previousItem != null) {while (previousItem[0].nodeName.toLowerCase() !== "li" ||previousItem[0].className.indexOf(o.disabledClass) !== -1 ||previousItem[0] === this.currentItem[0] ||previousItem[0] === this.helper[0]) {if (previousItem[0].previousSibling) {previousItem = $(previousItem[0].previousSibling);} else {previousItem = null;break;}}}
(function() {var _nextItem = this.placeholder.next();if (_nextItem.length) {nextItem = _nextItem;} else {nextItem = null;}}.call(this));if (nextItem != null) {while (nextItem[0].nodeName.toLowerCase() !== "li" ||nextItem[0].className.indexOf(o.disabledClass) !== -1 ||nextItem[0] === this.currentItem[0] ||nextItem[0] === this.helper[0]) {if (nextItem[0].nextSibling) {nextItem = $(nextItem[0].nextSibling);} else {nextItem = null;break;}}}
this.beyondMaxLevels = 0;if (parentItem != null &&nextItem == null &&!(o.protectRoot && parentItem[0].parentNode == this.element[0]) &&(o.rtl &&(this.positionAbs.left +this.helper.outerWidth() > parentItem.offset().left +parentItem.outerWidth()) ||!o.rtl && (this.positionAbs.left < parentItem.offset().left))) {parentItem.after(this.placeholder[0]);helperIsNotSibling = !parentItem
.children(o.listItem)
.children("li:visible:not(.ui-sortable-helper)")
.length;if (o.isTree && helperIsNotSibling) {parentItem
.removeClass(this.options.branchClass + " " + this.options.expandedClass)
.addClass(this.options.leafClass);}
if(typeof parentItem !== 'undefined')
this._clearEmpty(parentItem[0]);this._trigger("change", event, this._uiHash());} else if (previousItem != null &&!previousItem.hasClass(o.disableNestingClass) &&(previousItem.children(o.listType).length &&previousItem.children(o.listType).is(":visible") ||!previousItem.children(o.listType).length) &&!(o.protectRoot && this.currentItem[0].parentNode === this.element[0]) &&(o.rtl &&(this.positionAbs.left +this.helper.outerWidth() <
previousItem.offset().left +previousItem.outerWidth() -
o.tabSize) ||!o.rtl &&(this.positionAbs.left > previousItem.offset().left + o.tabSize))) {this._isAllowed(previousItem, level, level + childLevels + 1);if (!previousItem.children(o.listType).length) {previousItem[0].appendChild(newList);if (o.isTree) {previousItem
.removeClass(o.leafClass)
.addClass(o.branchClass + " " + o.expandedClass);}}
if (previousTopOffset && (previousTopOffset <= previousItem.offset().top)) {previousItem.children(o.listType).prepend(this.placeholder);} else {previousItem.children(o.listType)[0].appendChild(this.placeholder[0]);}
if(typeof parentItem !== 'undefined')
this._clearEmpty(parentItem[0]);this._trigger("change", event, this._uiHash());} else {this._isAllowed(parentItem, level, level + childLevels);}
this._contactContainers(event);if ($.ui.ddmanager) {$.ui.ddmanager.drag(this, event);}
this._trigger("sort", event, this._uiHash());this.lastPositionAbs = this.positionAbs;return false;},_mouseStop: function(event) {if (this.beyondMaxLevels) {this.placeholder.removeClass(this.options.errorClass);if (this.domPosition.prev) {$(this.domPosition.prev).after(this.placeholder);} else {$(this.domPosition.parent).prepend(this.placeholder);}
this._trigger("revert", event, this._uiHash());}
$("." + this.options.hoveringClass)
.mouseleave()
.removeClass(this.options.hoveringClass);this.mouseentered = false;if (this.hovering) {window.clearTimeout(this.hovering);}
this.hovering = null;this._relocate_event = event;this._pid_current = $(this.domPosition.parent).parent().attr("id");this._sort_current = this.domPosition.prev ? $(this.domPosition.prev).next().index() : 0;$.ui.sortable.prototype._mouseStop.apply(this, arguments); //asybnchronous execution, @see _clear for the relocate event.
},_intersectsWithSides: function(item) {var half = this.options.isTree ? .8 : .5,isOverBottomHalf = isOverAxis(this.positionAbs.top + this.offset.click.top,item.top + (item.height * half),item.height),isOverTopHalf = isOverAxis(this.positionAbs.top + this.offset.click.top,item.top - (item.height * half),item.height),isOverRightHalf = isOverAxis(this.positionAbs.left + this.offset.click.left,item.left + (item.width / 2),item.width),verticalDirection = this._getDragVerticalDirection(),horizontalDirection = this._getDragHorizontalDirection();if (this.floating && horizontalDirection) {return ((horizontalDirection === "right" && isOverRightHalf) ||(horizontalDirection === "left" && !isOverRightHalf));} else {return verticalDirection && ((verticalDirection === "down" && isOverBottomHalf) ||(verticalDirection === "up" && isOverTopHalf));}},_contactContainers: function() {if (this.options.protectRoot && this.currentItem[0].parentNode === this.element[0] ) {return;}
$.ui.sortable.prototype._contactContainers.apply(this, arguments);},_clear: function() {var i,item;$.ui.sortable.prototype._clear.apply(this, arguments);if (!(this._pid_current === this._uiHash().item.parent().parent().attr("id") &&this._sort_current === this._uiHash().item.index())) {this._trigger("relocate", this._relocate_event, this._uiHash());}
for (i = this.items.length - 1; i >= 0; i--) {item = this.items[i].item[0];this._clearEmpty(item);}},serialize: function(options) {var o = $.extend({}, this.options, options),items = this._getItemsAsjQuery(o && o.connected),str = [];$(items).each(function() {var res = ($(o.item || this).attr(o.attribute || "id") || "")
.match(o.expression || (/(.+)[-=_](.+)/)),pid = ($(o.item || this).parent(o.listType)
.parent(o.items)
.attr(o.attribute || "id") || "")
.match(o.expression || (/(.+)[-=_](.+)/));if (res) {str.push(((o.key || res[1]) +"[" +(o.key && o.expression ? res[1] : res[2]) + "]") +"=" +(pid ? (o.key && o.expression ? pid[1] : pid[2]) : o.rootID));}});if (!str.length && o.key) {str.push(o.key + "=");}
return str.join("&");},toHierarchy: function(options) {var o = $.extend({}, this.options, options),ret = [];$(this.element).children(o.items).each(function() {var level = _recursiveItems(this);ret.push(level);});return ret;function _recursiveItems(item) {var id = ($(item).attr(o.attribute || "id") || "").match(o.expression || (/(.+)[-=_](.+)/)),currentItem;var data = $(item).data();if (data.nestedSortableItem) {delete data.nestedSortableItem; // Remove the nestedSortableItem object from the data
}
if (id) {currentItem = {"id": id[2]};currentItem = $.extend({}, currentItem, data); // Combine the two objects
if ($(item).children(o.listType).children(o.items).length > 0) {currentItem.children = [];$(item).children(o.listType).children(o.items).each(function() {var level = _recursiveItems(this);currentItem.children.push(level);});}
return currentItem;}}},toArray: function(options) {var o = $.extend({}, this.options, options),sDepth = o.startDepthCount || 0,ret = [],left = 1;if (!o.excludeRoot) {ret.push({"item_id": o.rootID,"parent_id": null,"depth": sDepth,"left": left,"right": ($(o.items, this.element).length + 1) * 2});left++;}
$(this.element).children(o.items).each(function() {left = _recursiveArray(this, sDepth, left);});ret = ret.sort(function(a, b) { return (a.left - b.left); });return ret;function _recursiveArray(item, depth, _left) {var right = _left + 1,id,pid,parentItem;if ($(item).children(o.listType).children(o.items).length > 0) {depth++;$(item).children(o.listType).children(o.items).each(function() {right = _recursiveArray($(this), depth, right);});depth--;}
id = ($(item).attr(o.attribute || "id") || "").match(o.expression || (/(.+)[-=_](.+)/));if (depth === sDepth) {pid = o.rootID;} else {parentItem = ($(item).parent(o.listType)
.parent(o.items)
.attr(o.attribute || "id"))
.match(o.expression || (/(.+)[-=_](.+)/));pid = parentItem[2];}
if (id) {var data = $(item).children('div').data();var itemObj = $.extend( data, {"id":id[2],"parent_id":pid,"depth":depth,"left":_left,"right":right} );ret.push( itemObj );}
_left = right + 1;return _left;}},_clearEmpty: function (item) {function replaceClass(elem, search, replace, swap) {if (swap) {search = [replace, replace = search][0];}
$(elem).removeClass(search).addClass(replace);}
var o = this.options,childrenList = $(item).children(o.listType),hasChildren = childrenList.has('li').length;var doNotClear =
o.doNotClear ||hasChildren ||o.protectRoot && $(item)[0] === this.element[0];if (o.isTree) {replaceClass(item, o.branchClass, o.leafClass, doNotClear);}
if (!doNotClear) {childrenList.parent().removeClass(o.expandedClass);childrenList.remove();}},_getLevel: function(item) {var level = 1,list;if (this.options.listType) {list = item.closest(this.options.listType);while (list && list.length > 0 && !list.is(".ui-sortable")) {level++;list = list.parent().closest(this.options.listType);}}
return level;},_getChildLevels: function(parent, depth) {var self = this,o = this.options,result = 0;depth = depth || 0;$(parent).children(o.listType).children(o.items).each(function(index, child) {result = Math.max(self._getChildLevels(child, depth + 1), result);});return depth ? result + 1 : result;},_isAllowed: function(parentItem, level, levels) {var o = this.options,maxLevels = this
.placeholder
.closest(".ui-sortable")
.nestedSortable("option", "maxLevels"),oldParent = this.currentItem.parent().parent(),disabledByParentchange = o.disableParentChange && (typeof parentItem !== 'undefined' && !oldParent.is(parentItem) ||typeof parentItem === 'undefined' && oldParent.is("li")	//From somewhere to the root
);if (disabledByParentchange ||!o.isAllowed(this.placeholder, parentItem, this.currentItem)) {this.placeholder.addClass(o.errorClass);if (maxLevels < levels && maxLevels !== 0) {this.beyondMaxLevels = levels - maxLevels;} else {this.beyondMaxLevels = 1;}} else {if (maxLevels < levels && maxLevels !== 0) {this.placeholder.addClass(o.errorClass);this.beyondMaxLevels = levels - maxLevels;} else {this.placeholder.removeClass(o.errorClass);this.beyondMaxLevels = 0;}}}}));$.mjs.nestedSortable.prototype.options = $.extend({},$.ui.sortable.prototype.options,$.mjs.nestedSortable.prototype.options);}));
/*! Sortable 1.15.0 - MIT | git://github.com/SortableJS/Sortable.git */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Sortable=e()}(this,function(){"use strict";function e(e,t){var n,o=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)),o}function M(o){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?e(Object(i),!0).forEach(function(t){var e,n;e=o,t=i[n=t],n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(i,t))})}return o}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function i(t,e){if(null==t)return{};var n,o=function(t,e){if(null==t)return{};for(var n,o={},i=Object.keys(t),r=0;r<i.length;r++)n=i[r],0<=e.indexOf(n)||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(t),r=0;r<i.length;r++)n=i[r],0<=e.indexOf(n)||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n]);return o}function r(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function t(t){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(t)}var y=t(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),w=t(/Edge/i),s=t(/firefox/i),u=t(/safari/i)&&!t(/chrome/i)&&!t(/android/i),n=t(/iP(ad|od|hone)/i),c=t(/chrome/i)&&t(/android/i),d={capture:!1,passive:!1};function h(t,e,n){t.addEventListener(e,n,!y&&d)}function f(t,e,n){t.removeEventListener(e,n,!y&&d)}function p(t,e){if(e&&(">"===e[0]&&(e=e.substring(1)),t))try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(t){return}}function N(t,e,n,o){if(t){n=n||document;do{if(null!=e&&(">"!==e[0]||t.parentNode===n)&&p(t,e)||o&&t===n)return t}while(t!==n&&(t=(i=t).host&&i!==document&&i.host.nodeType?i.host:i.parentNode))}var i;return null}var g,m=/\s+/g;function I(t,e,n){var o;t&&e&&(t.classList?t.classList[n?"add":"remove"](e):(o=(" "+t.className+" ").replace(m," ").replace(" "+e+" "," "),t.className=(o+(n?" "+e:"")).replace(m," ")))}function P(t,e,n){var o=t&&t.style;if(o){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];o[e=!(e in o||-1!==e.indexOf("webkit"))?"-webkit-"+e:e]=n+("string"==typeof n?"":"px")}}function v(t,e){var n="";if("string"==typeof t)n=t;else do{var o=P(t,"transform")}while(o&&"none"!==o&&(n=o+" "+n),!e&&(t=t.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function b(t,e,n){if(t){var o=t.getElementsByTagName(e),i=0,r=o.length;if(n)for(;i<r;i++)n(o[i],i);return o}return[]}function O(){var t=document.scrollingElement;return t||document.documentElement}function k(t,e,n,o,i){if(t.getBoundingClientRect||t===window){var r,a,l,s,c,u,d=t!==window&&t.parentNode&&t!==O()?(a=(r=t.getBoundingClientRect()).top,l=r.left,s=r.bottom,c=r.right,u=r.height,r.width):(l=a=0,s=window.innerHeight,c=window.innerWidth,u=window.innerHeight,window.innerWidth);if((e||n)&&t!==window&&(i=i||t.parentNode,!y))do{if(i&&i.getBoundingClientRect&&("none"!==P(i,"transform")||n&&"static"!==P(i,"position"))){var h=i.getBoundingClientRect();a-=h.top+parseInt(P(i,"border-top-width")),l-=h.left+parseInt(P(i,"border-left-width")),s=a+r.height,c=l+r.width;break}}while(i=i.parentNode);return o&&t!==window&&(o=(e=v(i||t))&&e.a,t=e&&e.d,e&&(s=(a/=t)+(u/=t),c=(l/=o)+(d/=o))),{top:a,left:l,bottom:s,right:c,width:d,height:u}}}function R(t,e,n){for(var o=A(t,!0),i=k(t)[e];o;){var r=k(o)[n];if(!("top"===n||"left"===n?r<=i:i<=r))return o;if(o===O())break;o=A(o,!1)}return!1}function X(t,e,n,o){for(var i=0,r=0,a=t.children;r<a.length;){if("none"!==a[r].style.display&&a[r]!==Bt.ghost&&(o||a[r]!==Bt.dragged)&&N(a[r],n.draggable,t,!1)){if(i===e)return a[r];i++}r++}return null}function Y(t,e){for(var n=t.lastElementChild;n&&(n===Bt.ghost||"none"===P(n,"display")||e&&!p(n,e));)n=n.previousElementSibling;return n||null}function B(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)"TEMPLATE"===t.nodeName.toUpperCase()||t===Bt.clone||e&&!p(t,e)||n++;return n}function E(t){var e=0,n=0,o=O();if(t)do{var i=v(t),r=i.a,i=i.d}while(e+=t.scrollLeft*r,n+=t.scrollTop*i,t!==o&&(t=t.parentNode));return[e,n]}function A(t,e){if(!t||!t.getBoundingClientRect)return O();var n=t,o=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=P(n);if(n.clientWidth<n.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!n.getBoundingClientRect||n===document.body)return O();if(o||e)return n;o=!0}}}while(n=n.parentNode);return O()}function D(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function S(e,n){return function(){var t;g||(1===(t=arguments).length?e.call(this,t[0]):e.apply(this,t),g=setTimeout(function(){g=void 0},n))}}function F(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function _(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function C(t,e){P(t,"position","absolute"),P(t,"top",e.top),P(t,"left",e.left),P(t,"width",e.width),P(t,"height",e.height)}function T(t){P(t,"position",""),P(t,"top",""),P(t,"left",""),P(t,"width",""),P(t,"height","")}var j="Sortable"+(new Date).getTime();function x(){var e,o=[];return{captureAnimationState:function(){o=[],this.options.animation&&[].slice.call(this.el.children).forEach(function(t){var e,n;"none"!==P(t,"display")&&t!==Bt.ghost&&(o.push({target:t,rect:k(t)}),e=M({},o[o.length-1].rect),!t.thisAnimationDuration||(n=v(t,!0))&&(e.top-=n.f,e.left-=n.e),t.fromRect=e)})},addAnimationState:function(t){o.push(t)},removeAnimationState:function(t){o.splice(function(t,e){for(var n in t)if(t.hasOwnProperty(n))for(var o in e)if(e.hasOwnProperty(o)&&e[o]===t[n][o])return Number(n);return-1}(o,{target:t}),1)},animateAll:function(t){var c=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof t&&t());var u=!1,d=0;o.forEach(function(t){var e=0,n=t.target,o=n.fromRect,i=k(n),r=n.prevFromRect,a=n.prevToRect,l=t.rect,s=v(n,!0);s&&(i.top-=s.f,i.left-=s.e),n.toRect=i,n.thisAnimationDuration&&D(r,i)&&!D(o,i)&&(l.top-i.top)/(l.left-i.left)==(o.top-i.top)/(o.left-i.left)&&(t=l,s=r,r=a,a=c.options,e=Math.sqrt(Math.pow(s.top-t.top,2)+Math.pow(s.left-t.left,2))/Math.sqrt(Math.pow(s.top-r.top,2)+Math.pow(s.left-r.left,2))*a.animation),D(i,o)||(n.prevFromRect=o,n.prevToRect=i,e=e||c.options.animation,c.animate(n,l,i,e)),e&&(u=!0,d=Math.max(d,e),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout(function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null},e),n.thisAnimationDuration=e)}),clearTimeout(e),u?e=setTimeout(function(){"function"==typeof t&&t()},d):"function"==typeof t&&t(),o=[]},animate:function(t,e,n,o){var i,r;o&&(P(t,"transition",""),P(t,"transform",""),i=(r=v(this.el))&&r.a,r=r&&r.d,i=(e.left-n.left)/(i||1),r=(e.top-n.top)/(r||1),t.animatingX=!!i,t.animatingY=!!r,P(t,"transform","translate3d("+i+"px,"+r+"px,0)"),this.forRepaintDummy=t.offsetWidth,P(t,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),P(t,"transform","translate3d(0,0,0)"),"number"==typeof t.animated&&clearTimeout(t.animated),t.animated=setTimeout(function(){P(t,"transition",""),P(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1},o))}}}var H=[],L={initializeByDefault:!0},K={mount:function(e){for(var t in L)!L.hasOwnProperty(t)||t in e||(e[t]=L[t]);H.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),H.push(e)},pluginEvent:function(e,n,o){var t=this;this.eventCanceled=!1,o.cancel=function(){t.eventCanceled=!0};var i=e+"Global";H.forEach(function(t){n[t.pluginName]&&(n[t.pluginName][i]&&n[t.pluginName][i](M({sortable:n},o)),n.options[t.pluginName]&&n[t.pluginName][e]&&n[t.pluginName][e](M({sortable:n},o)))})},initializePlugins:function(n,o,i,t){for(var e in H.forEach(function(t){var e=t.pluginName;(n.options[e]||t.initializeByDefault)&&((t=new t(n,o,n.options)).sortable=n,t.options=n.options,n[e]=t,a(i,t.defaults))}),n.options){var r;n.options.hasOwnProperty(e)&&(void 0!==(r=this.modifyOption(n,e,n.options[e]))&&(n.options[e]=r))}},getEventProperties:function(e,n){var o={};return H.forEach(function(t){"function"==typeof t.eventProperties&&a(o,t.eventProperties.call(n[t.pluginName],e))}),o},modifyOption:function(e,n,o){var i;return H.forEach(function(t){e[t.pluginName]&&t.optionListeners&&"function"==typeof t.optionListeners[n]&&(i=t.optionListeners[n].call(e[t.pluginName],o))}),i}};function W(t){var e=t.sortable,n=t.rootEl,o=t.name,i=t.targetEl,r=t.cloneEl,a=t.toEl,l=t.fromEl,s=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,d=t.newDraggableIndex,h=t.originalEvent,f=t.putSortable,p=t.extraEventProperties;if(e=e||n&&n[j]){var g,m=e.options,t="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||y||w?(g=document.createEvent("Event")).initEvent(o,!0,!0):g=new CustomEvent(o,{bubbles:!0,cancelable:!0}),g.to=a||n,g.from=l||n,g.item=i||n,g.clone=r,g.oldIndex=s,g.newIndex=c,g.oldDraggableIndex=u,g.newDraggableIndex=d,g.originalEvent=h,g.pullMode=f?f.lastPutMode:void 0;var v,b=M(M({},p),K.getEventProperties(o,e));for(v in b)g[v]=b[v];n&&n.dispatchEvent(g),m[t]&&m[t].call(e,g)}}function z(t,e){var n=(o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).evt,o=i(o,G);K.pluginEvent.bind(Bt)(t,e,M({dragEl:q,parentEl:V,ghostEl:Z,rootEl:$,nextEl:Q,lastDownEl:J,cloneEl:tt,cloneHidden:et,dragStarted:pt,putSortable:lt,activeSortable:Bt.active,originalEvent:n,oldIndex:nt,oldDraggableIndex:it,newIndex:ot,newDraggableIndex:rt,hideGhostForTarget:kt,unhideGhostForTarget:Rt,cloneNowHidden:function(){et=!0},cloneNowShown:function(){et=!1},dispatchSortableEvent:function(t){U({sortable:e,name:t,originalEvent:n})}},o))}var G=["evt"];function U(t){W(M({putSortable:lt,cloneEl:tt,targetEl:q,rootEl:$,oldIndex:nt,oldDraggableIndex:it,newIndex:ot,newDraggableIndex:rt},t))}var q,V,Z,$,Q,J,tt,et,nt,ot,it,rt,at,lt,st,ct,ut,dt,ht,ft,pt,gt,mt,vt,bt,yt=!1,wt=!1,Et=[],Dt=!1,St=!1,_t=[],Ct=!1,Tt=[],xt="undefined"!=typeof document,Ot=n,At=w||y?"cssFloat":"float",Mt=xt&&!c&&!n&&"draggable"in document.createElement("div"),Nt=function(){if(xt){if(y)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}}(),It=function(t,e){var n=P(t),o=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=X(t,0,e),r=X(t,1,e),a=i&&P(i),l=r&&P(r),s=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+k(i).width,t=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+k(r).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&a.float&&"none"!==a.float){e="left"===a.float?"left":"right";return!r||"both"!==l.clear&&l.clear!==e?"horizontal":"vertical"}return i&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||o<=s&&"none"===n[At]||r&&"none"===n[At]&&o<s+t)?"vertical":"horizontal"},Pt=function(t){function l(r,a){return function(t,e,n,o){var i=t.options.group.name&&e.options.group.name&&t.options.group.name===e.options.group.name;if(null==r&&(a||i))return!0;if(null==r||!1===r)return!1;if(a&&"clone"===r)return r;if("function"==typeof r)return l(r(t,e,n,o),a)(t,e,n,o);e=(a?t:e).options.group.name;return!0===r||"string"==typeof r&&r===e||r.join&&-1<r.indexOf(e)}}var e={},n=t.group;n&&"object"==o(n)||(n={name:n}),e.name=n.name,e.checkPull=l(n.pull,!0),e.checkPut=l(n.put),e.revertClone=n.revertClone,t.group=e},kt=function(){!Nt&&Z&&P(Z,"display","none")},Rt=function(){!Nt&&Z&&P(Z,"display","")};xt&&!c&&document.addEventListener("click",function(t){if(wt)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),wt=!1},!0);function Xt(t){if(q){t=t.touches?t.touches[0]:t;var e=(i=t.clientX,r=t.clientY,Et.some(function(t){var e=t[j].options.emptyInsertThreshold;if(e&&!Y(t)){var n=k(t),o=i>=n.left-e&&i<=n.right+e,e=r>=n.top-e&&r<=n.bottom+e;return o&&e?a=t:void 0}}),a);if(e){var n,o={};for(n in t)t.hasOwnProperty(n)&&(o[n]=t[n]);o.target=o.rootEl=e,o.preventDefault=void 0,o.stopPropagation=void 0,e[j]._onDragOver(o)}}var i,r,a}function Yt(t){q&&q.parentNode[j]._isOutsideThisEl(t.target)}function Bt(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=a({},e),t[j]=this;var n,o,i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return It(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Bt.supportPointer&&"PointerEvent"in window&&!u,emptyInsertThreshold:5};for(n in K.initializePlugins(this,t,i),i)n in e||(e[n]=i[n]);for(o in Pt(e),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!e.forceFallback&&Mt,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?h(t,"pointerdown",this._onTapStart):(h(t,"mousedown",this._onTapStart),h(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(h(t,"dragover",this),h(t,"dragenter",this)),Et.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),a(this,x())}function Ft(t,e,n,o,i,r,a,l){var s,c,u=t[j],d=u.options.onMove;return!window.CustomEvent||y||w?(s=document.createEvent("Event")).initEvent("move",!0,!0):s=new CustomEvent("move",{bubbles:!0,cancelable:!0}),s.to=e,s.from=t,s.dragged=n,s.draggedRect=o,s.related=i||e,s.relatedRect=r||k(e),s.willInsertAfter=l,s.originalEvent=a,t.dispatchEvent(s),c=d?d.call(u,s,a):c}function jt(t){t.draggable=!1}function Ht(){Ct=!1}function Lt(t){return setTimeout(t,0)}function Kt(t){return clearTimeout(t)}Bt.prototype={constructor:Bt,_isOutsideThisEl:function(t){this.el.contains(t)||t===this.el||(gt=null)},_getDirection:function(t,e){return"function"==typeof this.options.direction?this.options.direction.call(this,t,e,q):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,o=this.el,t=this.options,i=t.preventOnFilter,r=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,l=(a||e).target,s=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,c=t.filter;if(!function(t){Tt.length=0;var e=t.getElementsByTagName("input"),n=e.length;for(;n--;){var o=e[n];o.checked&&Tt.push(o)}}(o),!q&&!(/mousedown|pointerdown/.test(r)&&0!==e.button||t.disabled)&&!s.isContentEditable&&(this.nativeDraggable||!u||!l||"SELECT"!==l.tagName.toUpperCase())&&!((l=N(l,t.draggable,o,!1))&&l.animated||J===l)){if(nt=B(l),it=B(l,t.draggable),"function"==typeof c){if(c.call(this,e,l,this))return U({sortable:n,rootEl:s,name:"filter",targetEl:l,toEl:o,fromEl:o}),z("filter",n,{evt:e}),void(i&&e.cancelable&&e.preventDefault())}else if(c=c&&c.split(",").some(function(t){if(t=N(s,t.trim(),o,!1))return U({sortable:n,rootEl:t,name:"filter",targetEl:l,fromEl:o,toEl:o}),z("filter",n,{evt:e}),!0}))return void(i&&e.cancelable&&e.preventDefault());t.handle&&!N(s,t.handle,o,!1)||this._prepareDragStart(e,a,l)}}},_prepareDragStart:function(t,e,n){var o,i=this,r=i.el,a=i.options,l=r.ownerDocument;n&&!q&&n.parentNode===r&&(o=k(n),$=r,V=(q=n).parentNode,Q=q.nextSibling,J=n,at=a.group,st={target:Bt.dragged=q,clientX:(e||t).clientX,clientY:(e||t).clientY},ht=st.clientX-o.left,ft=st.clientY-o.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,q.style["will-change"]="all",o=function(){z("delayEnded",i,{evt:t}),Bt.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!s&&i.nativeDraggable&&(q.draggable=!0),i._triggerDragStart(t,e),U({sortable:i,name:"choose",originalEvent:t}),I(q,a.chosenClass,!0))},a.ignore.split(",").forEach(function(t){b(q,t.trim(),jt)}),h(l,"dragover",Xt),h(l,"mousemove",Xt),h(l,"touchmove",Xt),h(l,"mouseup",i._onDrop),h(l,"touchend",i._onDrop),h(l,"touchcancel",i._onDrop),s&&this.nativeDraggable&&(this.options.touchStartThreshold=4,q.draggable=!0),z("delayStart",this,{evt:t}),!a.delay||a.delayOnTouchOnly&&!e||this.nativeDraggable&&(w||y)?o():Bt.eventCanceled?this._onDrop():(h(l,"mouseup",i._disableDelayedDrag),h(l,"touchend",i._disableDelayedDrag),h(l,"touchcancel",i._disableDelayedDrag),h(l,"mousemove",i._delayedDragTouchMoveHandler),h(l,"touchmove",i._delayedDragTouchMoveHandler),a.supportPointer&&h(l,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(o,a.delay)))},_delayedDragTouchMoveHandler:function(t){t=t.touches?t.touches[0]:t;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){q&&jt(q),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;f(t,"mouseup",this._disableDelayedDrag),f(t,"touchend",this._disableDelayedDrag),f(t,"touchcancel",this._disableDelayedDrag),f(t,"mousemove",this._delayedDragTouchMoveHandler),f(t,"touchmove",this._delayedDragTouchMoveHandler),f(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||"touch"==t.pointerType&&t,!this.nativeDraggable||e?this.options.supportPointer?h(document,"pointermove",this._onTouchMove):h(document,e?"touchmove":"mousemove",this._onTouchMove):(h(q,"dragend",this),h($,"dragstart",this._onDragStart));try{document.selection?Lt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(t,e){var n;yt=!1,$&&q?(z("dragStarted",this,{evt:e}),this.nativeDraggable&&h(document,"dragover",Yt),n=this.options,t||I(q,n.dragClass,!1),I(q,n.ghostClass,!0),Bt.active=this,t&&this._appendGhost(),U({sortable:this,name:"start",originalEvent:e})):this._nulling()},_emulateDragOver:function(){if(ct){this._lastX=ct.clientX,this._lastY=ct.clientY,kt();for(var t=document.elementFromPoint(ct.clientX,ct.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ct.clientX,ct.clientY))!==e;)e=t;if(q.parentNode[j]._isOutsideThisEl(t),e)do{if(e[j])if(e[j]._onDragOver({clientX:ct.clientX,clientY:ct.clientY,target:t,rootEl:e})&&!this.options.dragoverBubble)break}while(e=(t=e).parentNode);Rt()}},_onTouchMove:function(t){if(st){var e=this.options,n=e.fallbackTolerance,o=e.fallbackOffset,i=t.touches?t.touches[0]:t,r=Z&&v(Z,!0),a=Z&&r&&r.a,l=Z&&r&&r.d,e=Ot&&bt&&E(bt),a=(i.clientX-st.clientX+o.x)/(a||1)+(e?e[0]-_t[0]:0)/(a||1),l=(i.clientY-st.clientY+o.y)/(l||1)+(e?e[1]-_t[1]:0)/(l||1);if(!Bt.active&&!yt){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}Z&&(r?(r.e+=a-(ut||0),r.f+=l-(dt||0)):r={a:1,b:0,c:0,d:1,e:a,f:l},r="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")"),P(Z,"webkitTransform",r),P(Z,"mozTransform",r),P(Z,"msTransform",r),P(Z,"transform",r),ut=a,dt=l,ct=i),t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!Z){var t=this.options.fallbackOnBody?document.body:$,e=k(q,!0,Ot,!0,t),n=this.options;if(Ot){for(bt=t;"static"===P(bt,"position")&&"none"===P(bt,"transform")&&bt!==document;)bt=bt.parentNode;bt!==document.body&&bt!==document.documentElement?(bt===document&&(bt=O()),e.top+=bt.scrollTop,e.left+=bt.scrollLeft):bt=O(),_t=E(bt)}I(Z=q.cloneNode(!0),n.ghostClass,!1),I(Z,n.fallbackClass,!0),I(Z,n.dragClass,!0),P(Z,"transition",""),P(Z,"transform",""),P(Z,"box-sizing","border-box"),P(Z,"margin",0),P(Z,"top",e.top),P(Z,"left",e.left),P(Z,"width",e.width),P(Z,"height",e.height),P(Z,"opacity","0.8"),P(Z,"position",Ot?"absolute":"fixed"),P(Z,"zIndex","100000"),P(Z,"pointerEvents","none"),Bt.ghost=Z,t.appendChild(Z),P(Z,"transform-origin",ht/parseInt(Z.style.width)*100+"% "+ft/parseInt(Z.style.height)*100+"%")}},_onDragStart:function(t,e){var n=this,o=t.dataTransfer,i=n.options;z("dragStart",this,{evt:t}),Bt.eventCanceled?this._onDrop():(z("setupClone",this),Bt.eventCanceled||((tt=_(q)).removeAttribute("id"),tt.draggable=!1,tt.style["will-change"]="",this._hideClone(),I(tt,this.options.chosenClass,!1),Bt.clone=tt),n.cloneId=Lt(function(){z("clone",n),Bt.eventCanceled||(n.options.removeCloneOnHide||$.insertBefore(tt,q),n._hideClone(),U({sortable:n,name:"clone"}))}),e||I(q,i.dragClass,!0),e?(wt=!0,n._loopId=setInterval(n._emulateDragOver,50)):(f(document,"mouseup",n._onDrop),f(document,"touchend",n._onDrop),f(document,"touchcancel",n._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(n,o,q)),h(document,"drop",n),P(q,"transform","translateZ(0)")),yt=!0,n._dragStartId=Lt(n._dragStarted.bind(n,e,t)),h(document,"selectstart",n),pt=!0,u&&P(document.body,"user-select","none"))},_onDragOver:function(n){var o,i,r,t,a=this.el,l=n.target,e=this.options,s=e.group,c=Bt.active,u=at===s,d=e.sort,h=lt||c,f=this,p=!1;if(!Ct){if(void 0!==n.preventDefault&&n.cancelable&&n.preventDefault(),l=N(l,e.draggable,a,!0),T("dragOver"),Bt.eventCanceled)return p;if(q.contains(n.target)||l.animated&&l.animatingX&&l.animatingY||f._ignoreWhileAnimating===l)return O(!1);if(wt=!1,c&&!e.disabled&&(u?d||(i=V!==$):lt===this||(this.lastPutMode=at.checkPull(this,c,q,n))&&s.checkPut(this,c,q,n))){if(r="vertical"===this._getDirection(n,l),o=k(q),T("dragOverValid"),Bt.eventCanceled)return p;if(i)return V=$,x(),this._hideClone(),T("revert"),Bt.eventCanceled||(Q?$.insertBefore(q,Q):$.appendChild(q)),O(!0);var g=Y(a,e.draggable);if(!g||function(t,e,n){n=k(Y(n.el,n.options.draggable));return e?t.clientX>n.right+10||t.clientX<=n.right&&t.clientY>n.bottom&&t.clientX>=n.left:t.clientX>n.right&&t.clientY>n.top||t.clientX<=n.right&&t.clientY>n.bottom+10}(n,r,this)&&!g.animated){if(g===q)return O(!1);if((l=g&&a===n.target?g:l)&&(w=k(l)),!1!==Ft($,a,q,o,l,w,n,!!l))return x(),g&&g.nextSibling?a.insertBefore(q,g.nextSibling):a.appendChild(q),V=a,A(),O(!0)}else if(g&&function(t,e,n){n=k(X(n.el,0,n.options,!0));return e?t.clientX<n.left-10||t.clientY<n.top&&t.clientX<n.right:t.clientY<n.top-10||t.clientY<n.bottom&&t.clientX<n.left}(n,r,this)){var m=X(a,0,e,!0);if(m===q)return O(!1);if(w=k(l=m),!1!==Ft($,a,q,o,l,w,n,!1))return x(),a.insertBefore(q,m),V=a,A(),O(!0)}else if(l.parentNode===a){var v,b,y,w=k(l),E=q.parentNode!==a,D=(D=q.animated&&q.toRect||o,C=l.animated&&l.toRect||w,S=(t=r)?D.left:D.top,s=t?D.right:D.bottom,g=t?D.width:D.height,m=t?C.left:C.top,D=t?C.right:C.bottom,C=t?C.width:C.height,!(S===m||s===D||S+g/2===m+C/2)),S=r?"top":"left",g=R(l,"top","top")||R(q,"top","top"),m=g?g.scrollTop:void 0;if(gt!==l&&(b=w[S],Dt=!1,St=!D&&e.invertSwap||E),0!==(v=function(t,e,n,o,i,r,a,l){var s=o?t.clientY:t.clientX,c=o?n.height:n.width,t=o?n.top:n.left,o=o?n.bottom:n.right,n=!1;if(!a)if(l&&vt<c*i){if(Dt=!Dt&&(1===mt?t+c*r/2<s:s<o-c*r/2)?!0:Dt)n=!0;else if(1===mt?s<t+vt:o-vt<s)return-mt}else if(t+c*(1-i)/2<s&&s<o-c*(1-i)/2)return function(t){return B(q)<B(t)?1:-1}(e);if((n=n||a)&&(s<t+c*r/2||o-c*r/2<s))return t+c/2<s?1:-1;return 0}(n,l,w,r,D?1:e.swapThreshold,null==e.invertedSwapThreshold?e.swapThreshold:e.invertedSwapThreshold,St,gt===l)))for(var _=B(q);(y=V.children[_-=v])&&("none"===P(y,"display")||y===Z););if(0===v||y===l)return O(!1);mt=v;var C=(gt=l).nextElementSibling,E=!1,D=Ft($,a,q,o,l,w,n,E=1===v);if(!1!==D)return 1!==D&&-1!==D||(E=1===D),Ct=!0,setTimeout(Ht,30),x(),E&&!C?a.appendChild(q):l.parentNode.insertBefore(q,E?C:l),g&&F(g,0,m-g.scrollTop),V=q.parentNode,void 0===b||St||(vt=Math.abs(b-k(l)[S])),A(),O(!0)}if(a.contains(q))return O(!1)}return!1}function T(t,e){z(t,f,M({evt:n,isOwner:u,axis:r?"vertical":"horizontal",revert:i,dragRect:o,targetRect:w,canSort:d,fromSortable:h,target:l,completed:O,onMove:function(t,e){return Ft($,a,q,o,t,k(t),n,e)},changed:A},e))}function x(){T("dragOverAnimationCapture"),f.captureAnimationState(),f!==h&&h.captureAnimationState()}function O(t){return T("dragOverCompleted",{insertion:t}),t&&(u?c._hideClone():c._showClone(f),f!==h&&(I(q,(lt||c).options.ghostClass,!1),I(q,e.ghostClass,!0)),lt!==f&&f!==Bt.active?lt=f:f===Bt.active&&lt&&(lt=null),h===f&&(f._ignoreWhileAnimating=l),f.animateAll(function(){T("dragOverAnimationComplete"),f._ignoreWhileAnimating=null}),f!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(l===q&&!q.animated||l===a&&!l.animated)&&(gt=null),e.dragoverBubble||n.rootEl||l===document||(q.parentNode[j]._isOutsideThisEl(n.target),t||Xt(n)),!e.dragoverBubble&&n.stopPropagation&&n.stopPropagation(),p=!0}function A(){ot=B(q),rt=B(q,e.draggable),U({sortable:f,name:"change",toEl:a,newIndex:ot,newDraggableIndex:rt,originalEvent:n})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){f(document,"mousemove",this._onTouchMove),f(document,"touchmove",this._onTouchMove),f(document,"pointermove",this._onTouchMove),f(document,"dragover",Xt),f(document,"mousemove",Xt),f(document,"touchmove",Xt)},_offUpEvents:function(){var t=this.el.ownerDocument;f(t,"mouseup",this._onDrop),f(t,"touchend",this._onDrop),f(t,"pointerup",this._onDrop),f(t,"touchcancel",this._onDrop),f(document,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;ot=B(q),rt=B(q,n.draggable),z("drop",this,{evt:t}),V=q&&q.parentNode,ot=B(q),rt=B(q,n.draggable),Bt.eventCanceled||(Dt=St=yt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Kt(this.cloneId),Kt(this._dragStartId),this.nativeDraggable&&(f(document,"drop",this),f(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),u&&P(document.body,"user-select",""),P(q,"transform",""),t&&(pt&&(t.cancelable&&t.preventDefault(),n.dropBubble||t.stopPropagation()),Z&&Z.parentNode&&Z.parentNode.removeChild(Z),($===V||lt&&"clone"!==lt.lastPutMode)&&tt&&tt.parentNode&&tt.parentNode.removeChild(tt),q&&(this.nativeDraggable&&f(q,"dragend",this),jt(q),q.style["will-change"]="",pt&&!yt&&I(q,(lt||this).options.ghostClass,!1),I(q,this.options.chosenClass,!1),U({sortable:this,name:"unchoose",toEl:V,newIndex:null,newDraggableIndex:null,originalEvent:t}),$!==V?(0<=ot&&(U({rootEl:V,name:"add",toEl:V,fromEl:$,originalEvent:t}),U({sortable:this,name:"remove",toEl:V,originalEvent:t}),U({rootEl:V,name:"sort",toEl:V,fromEl:$,originalEvent:t}),U({sortable:this,name:"sort",toEl:V,originalEvent:t})),lt&&lt.save()):ot!==nt&&0<=ot&&(U({sortable:this,name:"update",toEl:V,originalEvent:t}),U({sortable:this,name:"sort",toEl:V,originalEvent:t})),Bt.active&&(null!=ot&&-1!==ot||(ot=nt,rt=it),U({sortable:this,name:"end",toEl:V,originalEvent:t}),this.save())))),this._nulling()},_nulling:function(){z("nulling",this),$=q=V=Z=Q=tt=J=et=st=ct=pt=ot=rt=nt=it=gt=mt=lt=at=Bt.dragged=Bt.ghost=Bt.clone=Bt.active=null,Tt.forEach(function(t){t.checked=!0}),Tt.length=ut=dt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":q&&(this._onDragOver(t),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move");t.cancelable&&t.preventDefault()}(t));break;case"selectstart":t.preventDefault()}},toArray:function(){for(var t,e=[],n=this.el.children,o=0,i=n.length,r=this.options;o<i;o++)N(t=n[o],r.draggable,this.el,!1)&&e.push(t.getAttribute(r.dataIdAttr)||function(t){var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,o=0;for(;n--;)o+=e.charCodeAt(n);return o.toString(36)}(t));return e},sort:function(t,e){var n={},o=this.el;this.toArray().forEach(function(t,e){e=o.children[e];N(e,this.options.draggable,o,!1)&&(n[t]=e)},this),e&&this.captureAnimationState(),t.forEach(function(t){n[t]&&(o.removeChild(n[t]),o.appendChild(n[t]))}),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return N(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];var o=K.modifyOption(this,t,e);n[t]=void 0!==o?o:e,"group"===t&&Pt(n)},destroy:function(){z("destroy",this);var t=this.el;t[j]=null,f(t,"mousedown",this._onTapStart),f(t,"touchstart",this._onTapStart),f(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(f(t,"dragover",this),f(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Et.splice(Et.indexOf(this.el),1),this.el=t=null},_hideClone:function(){et||(z("hideClone",this),Bt.eventCanceled||(P(tt,"display","none"),this.options.removeCloneOnHide&&tt.parentNode&&tt.parentNode.removeChild(tt),et=!0))},_showClone:function(t){"clone"===t.lastPutMode?et&&(z("showClone",this),Bt.eventCanceled||(q.parentNode!=$||this.options.group.revertClone?Q?$.insertBefore(tt,Q):$.appendChild(tt):$.insertBefore(tt,q),this.options.group.revertClone&&this.animate(q,tt),P(tt,"display",""),et=!1)):this._hideClone()}},xt&&h(document,"touchmove",function(t){(Bt.active||yt)&&t.cancelable&&t.preventDefault()}),Bt.utils={on:h,off:f,css:P,find:b,is:function(t,e){return!!N(t,e,t,!1)},extend:function(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},throttle:S,closest:N,toggleClass:I,clone:_,index:B,nextTick:Lt,cancelNextTick:Kt,detectDirection:It,getChild:X},Bt.get=function(t){return t[j]},Bt.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];(e=e[0].constructor===Array?e[0]:e).forEach(function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&(Bt.utils=M(M({},Bt.utils),t.utils)),K.mount(t)})},Bt.create=function(t,e){return new Bt(t,e)};var Wt,zt,Gt,Ut,qt,Vt,Zt=[],$t=!(Bt.version="1.15.0");function Qt(){Zt.forEach(function(t){clearInterval(t.pid)}),Zt=[]}function Jt(){clearInterval(Vt)}var te,ee=S(function(n,t,e,o){if(t.scroll){var i,r=(n.touches?n.touches[0]:n).clientX,a=(n.touches?n.touches[0]:n).clientY,l=t.scrollSensitivity,s=t.scrollSpeed,c=O(),u=!1;zt!==e&&(zt=e,Qt(),Wt=t.scroll,i=t.scrollFn,!0===Wt&&(Wt=A(e,!0)));var d=0,h=Wt;do{var f=h,p=k(f),g=p.top,m=p.bottom,v=p.left,b=p.right,y=p.width,w=p.height,E=void 0,D=void 0,S=f.scrollWidth,_=f.scrollHeight,C=P(f),T=f.scrollLeft,p=f.scrollTop,D=f===c?(E=y<S&&("auto"===C.overflowX||"scroll"===C.overflowX||"visible"===C.overflowX),w<_&&("auto"===C.overflowY||"scroll"===C.overflowY||"visible"===C.overflowY)):(E=y<S&&("auto"===C.overflowX||"scroll"===C.overflowX),w<_&&("auto"===C.overflowY||"scroll"===C.overflowY)),T=E&&(Math.abs(b-r)<=l&&T+y<S)-(Math.abs(v-r)<=l&&!!T),p=D&&(Math.abs(m-a)<=l&&p+w<_)-(Math.abs(g-a)<=l&&!!p);if(!Zt[d])for(var x=0;x<=d;x++)Zt[x]||(Zt[x]={});Zt[d].vx==T&&Zt[d].vy==p&&Zt[d].el===f||(Zt[d].el=f,Zt[d].vx=T,Zt[d].vy=p,clearInterval(Zt[d].pid),0==T&&0==p||(u=!0,Zt[d].pid=setInterval(function(){o&&0===this.layer&&Bt.active._onTouchMove(qt);var t=Zt[this.layer].vy?Zt[this.layer].vy*s:0,e=Zt[this.layer].vx?Zt[this.layer].vx*s:0;"function"==typeof i&&"continue"!==i.call(Bt.dragged.parentNode[j],e,t,n,qt,Zt[this.layer].el)||F(Zt[this.layer].el,e,t)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&h!==c&&(h=A(h,!1)));$t=u}},30),c=function(t){var e=t.originalEvent,n=t.putSortable,o=t.dragEl,i=t.activeSortable,r=t.dispatchSortableEvent,a=t.hideGhostForTarget,t=t.unhideGhostForTarget;e&&(i=n||i,a(),e=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,e=document.elementFromPoint(e.clientX,e.clientY),t(),i&&!i.el.contains(e)&&(r("spill"),this.onSpill({dragEl:o,putSortable:n})))};function ne(){}function oe(){}ne.prototype={startIndex:null,dragStart:function(t){t=t.oldDraggableIndex;this.startIndex=t},onSpill:function(t){var e=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();t=X(this.sortable.el,this.startIndex,this.options);t?this.sortable.el.insertBefore(e,t):this.sortable.el.appendChild(e),this.sortable.animateAll(),n&&n.animateAll()},drop:c},a(ne,{pluginName:"revertOnSpill"}),oe.prototype={onSpill:function(t){var e=t.dragEl,t=t.putSortable||this.sortable;t.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),t.animateAll()},drop:c},a(oe,{pluginName:"removeOnSpill"});var ie,re,ae,le,se,ce=[],ue=[],de=!1,he=!1,fe=!1;function pe(n,o){ue.forEach(function(t,e){e=o.children[t.sortableIndex+(n?Number(e):0)];e?o.insertBefore(t,e):o.appendChild(t)})}function ge(){ce.forEach(function(t){t!==ae&&t.parentNode&&t.parentNode.removeChild(t)})}return Bt.mount(new function(){function t(){for(var t in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this))}return t.prototype={dragStarted:function(t){t=t.originalEvent;this.sortable.nativeDraggable?h(document,"dragover",this._handleAutoScroll):this.options.supportPointer?h(document,"pointermove",this._handleFallbackAutoScroll):t.touches?h(document,"touchmove",this._handleFallbackAutoScroll):h(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){t=t.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?f(document,"dragover",this._handleAutoScroll):(f(document,"pointermove",this._handleFallbackAutoScroll),f(document,"touchmove",this._handleFallbackAutoScroll),f(document,"mousemove",this._handleFallbackAutoScroll)),Jt(),Qt(),clearTimeout(g),g=void 0},nulling:function(){qt=zt=Wt=$t=Vt=Gt=Ut=null,Zt.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(e,n){var o,i=this,r=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,t=document.elementFromPoint(r,a);qt=e,n||this.options.forceAutoScrollFallback||w||y||u?(ee(e,this.options,t,n),o=A(t,!0),!$t||Vt&&r===Gt&&a===Ut||(Vt&&Jt(),Vt=setInterval(function(){var t=A(document.elementFromPoint(r,a),!0);t!==o&&(o=t,Qt()),ee(e,i.options,t,n)},10),Gt=r,Ut=a)):this.options.bubbleScroll&&A(t,!0)!==O()?ee(e,this.options,A(t,!1),!1):Qt()}},a(t,{pluginName:"scroll",initializeByDefault:!0})}),Bt.mount(oe,ne),Bt.mount(new function(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(t){t=t.dragEl;te=t},dragOverValid:function(t){var e=t.completed,n=t.target,o=t.onMove,i=t.activeSortable,r=t.changed,a=t.cancel;i.options.swap&&(t=this.sortable.el,i=this.options,n&&n!==t&&(t=te,te=!1!==o(n)?(I(n,i.swapClass,!0),n):null,t&&t!==te&&I(t,i.swapClass,!1)),r(),e(!0),a())},drop:function(t){var e,n,o=t.activeSortable,i=t.putSortable,r=t.dragEl,a=i||this.sortable,l=this.options;te&&I(te,l.swapClass,!1),te&&(l.swap||i&&i.options.swap)&&r!==te&&(a.captureAnimationState(),a!==o&&o.captureAnimationState(),n=te,t=(e=r).parentNode,l=n.parentNode,t&&l&&!t.isEqualNode(n)&&!l.isEqualNode(e)&&(i=B(e),r=B(n),t.isEqualNode(l)&&i<r&&r++,t.insertBefore(n,t.children[i]),l.insertBefore(e,l.children[r])),a.animateAll(),a!==o&&o.animateAll())},nulling:function(){te=null}},a(t,{pluginName:"swap",eventProperties:function(){return{swapItem:te}}})}),Bt.mount(new function(){function t(o){for(var t in this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this));o.options.avoidImplicitDeselect||(o.options.supportPointer?h(document,"pointerup",this._deselectMultiDrag):(h(document,"mouseup",this._deselectMultiDrag),h(document,"touchend",this._deselectMultiDrag))),h(document,"keydown",this._checkKeyDown),h(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(t,e){var n="";ce.length&&re===o?ce.forEach(function(t,e){n+=(e?", ":"")+t.textContent}):n=e.textContent,t.setData("Text",n)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(t){t=t.dragEl;ae=t},delayEnded:function(){this.isMultiDrag=~ce.indexOf(ae)},setupClone:function(t){var e=t.sortable,t=t.cancel;if(this.isMultiDrag){for(var n=0;n<ce.length;n++)ue.push(_(ce[n])),ue[n].sortableIndex=ce[n].sortableIndex,ue[n].draggable=!1,ue[n].style["will-change"]="",I(ue[n],this.options.selectedClass,!1),ce[n]===ae&&I(ue[n],this.options.chosenClass,!1);e._hideClone(),t()}},clone:function(t){var e=t.sortable,n=t.rootEl,o=t.dispatchSortableEvent,t=t.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||ce.length&&re===e&&(pe(!0,n),o("clone"),t()))},showClone:function(t){var e=t.cloneNowShown,n=t.rootEl,t=t.cancel;this.isMultiDrag&&(pe(!1,n),ue.forEach(function(t){P(t,"display","")}),e(),se=!1,t())},hideClone:function(t){var e=this,n=(t.sortable,t.cloneNowHidden),t=t.cancel;this.isMultiDrag&&(ue.forEach(function(t){P(t,"display","none"),e.options.removeCloneOnHide&&t.parentNode&&t.parentNode.removeChild(t)}),n(),se=!0,t())},dragStartGlobal:function(t){t.sortable;!this.isMultiDrag&&re&&re.multiDrag._deselectMultiDrag(),ce.forEach(function(t){t.sortableIndex=B(t)}),ce=ce.sort(function(t,e){return t.sortableIndex-e.sortableIndex}),fe=!0},dragStarted:function(t){var e,n=this,t=t.sortable;this.isMultiDrag&&(this.options.sort&&(t.captureAnimationState(),this.options.animation&&(ce.forEach(function(t){t!==ae&&P(t,"position","absolute")}),e=k(ae,!1,!0,!0),ce.forEach(function(t){t!==ae&&C(t,e)}),de=he=!0)),t.animateAll(function(){de=he=!1,n.options.animation&&ce.forEach(function(t){T(t)}),n.options.sort&&ge()}))},dragOver:function(t){var e=t.target,n=t.completed,t=t.cancel;he&&~ce.indexOf(e)&&(n(!1),t())},revert:function(t){var n,o,e=t.fromSortable,i=t.rootEl,r=t.sortable,a=t.dragRect;1<ce.length&&(ce.forEach(function(t){r.addAnimationState({target:t,rect:he?k(t):a}),T(t),t.fromRect=a,e.removeAnimationState(t)}),he=!1,n=!this.options.removeCloneOnHide,o=i,ce.forEach(function(t,e){e=o.children[t.sortableIndex+(n?Number(e):0)];e?o.insertBefore(t,e):o.appendChild(t)}))},dragOverCompleted:function(t){var e,n=t.sortable,o=t.isOwner,i=t.insertion,r=t.activeSortable,a=t.parentEl,l=t.putSortable,t=this.options;i&&(o&&r._hideClone(),de=!1,t.animation&&1<ce.length&&(he||!o&&!r.options.sort&&!l)&&(e=k(ae,!1,!0,!0),ce.forEach(function(t){t!==ae&&(C(t,e),a.appendChild(t))}),he=!0),o||(he||ge(),1<ce.length?(o=se,r._showClone(n),r.options.animation&&!se&&o&&ue.forEach(function(t){r.addAnimationState({target:t,rect:le}),t.fromRect=le,t.thisAnimationDuration=null})):r._showClone(n)))},dragOverAnimationCapture:function(t){var e=t.dragRect,n=t.isOwner,t=t.activeSortable;ce.forEach(function(t){t.thisAnimationDuration=null}),t.options.animation&&!n&&t.multiDrag.isMultiDrag&&(le=a({},e),e=v(ae,!0),le.top-=e.f,le.left-=e.e)},dragOverAnimationComplete:function(){he&&(he=!1,ge())},drop:function(t){var e=t.originalEvent,n=t.rootEl,o=t.parentEl,i=t.sortable,r=t.dispatchSortableEvent,a=t.oldIndex,l=t.putSortable,s=l||this.sortable;if(e){var c,u,d,h=this.options,f=o.children;if(!fe)if(h.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),I(ae,h.selectedClass,!~ce.indexOf(ae)),~ce.indexOf(ae))ce.splice(ce.indexOf(ae),1),ie=null,W({sortable:i,rootEl:n,name:"deselect",targetEl:ae,originalEvent:e});else{if(ce.push(ae),W({sortable:i,rootEl:n,name:"select",targetEl:ae,originalEvent:e}),e.shiftKey&&ie&&i.el.contains(ie)){var p=B(ie),t=B(ae);if(~p&&~t&&p!==t)for(var g,m=p<t?(g=p,t):(g=t,p+1);g<m;g++)~ce.indexOf(f[g])||(I(f[g],h.selectedClass,!0),ce.push(f[g]),W({sortable:i,rootEl:n,name:"select",targetEl:f[g],originalEvent:e}))}else ie=ae;re=s}fe&&this.isMultiDrag&&(he=!1,(o[j].options.sort||o!==n)&&1<ce.length&&(c=k(ae),u=B(ae,":not(."+this.options.selectedClass+")"),!de&&h.animation&&(ae.thisAnimationDuration=null),s.captureAnimationState(),de||(h.animation&&(ae.fromRect=c,ce.forEach(function(t){var e;t.thisAnimationDuration=null,t!==ae&&(e=he?k(t):c,t.fromRect=e,s.addAnimationState({target:t,rect:e}))})),ge(),ce.forEach(function(t){f[u]?o.insertBefore(t,f[u]):o.appendChild(t),u++}),a===B(ae)&&(d=!1,ce.forEach(function(t){t.sortableIndex!==B(t)&&(d=!0)}),d&&r("update"))),ce.forEach(function(t){T(t)}),s.animateAll()),re=s),(n===o||l&&"clone"!==l.lastPutMode)&&ue.forEach(function(t){t.parentNode&&t.parentNode.removeChild(t)})}},nullingGlobal:function(){this.isMultiDrag=fe=!1,ue.length=0},destroyGlobal:function(){this._deselectMultiDrag(),f(document,"pointerup",this._deselectMultiDrag),f(document,"mouseup",this._deselectMultiDrag),f(document,"touchend",this._deselectMultiDrag),f(document,"keydown",this._checkKeyDown),f(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(t){if(!(void 0!==fe&&fe||re!==this.sortable||t&&N(t.target,this.options.draggable,this.sortable.el,!1)||t&&0!==t.button))for(;ce.length;){var e=ce[0];I(e,this.options.selectedClass,!1),ce.shift(),W({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:e,originalEvent:t})}},_checkKeyDown:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},a(t,{pluginName:"multiDrag",utils:{select:function(t){var e=t.parentNode[j];e&&e.options.multiDrag&&!~ce.indexOf(t)&&(re&&re!==e&&(re.multiDrag._deselectMultiDrag(),re=e),I(t,e.options.selectedClass,!0),ce.push(t))},deselect:function(t){var e=t.parentNode[j],n=ce.indexOf(t);e&&e.options.multiDrag&&~n&&(I(t,e.options.selectedClass,!1),ce.splice(n,1))}},eventProperties:function(){var n=this,o=[],i=[];return ce.forEach(function(t){var e;o.push({multiDragElement:t,index:t.sortableIndex}),e=he&&t!==ae?-1:he?B(t,":not(."+n.options.selectedClass+")"):B(t),i.push({multiDragElement:t,index:e})}),{items:r(ce),clones:[].concat(ue),oldIndicies:o,newIndicies:i}},optionListeners:{multiDragKey:function(t){return"ctrl"===(t=t.toLowerCase())?t="Control":1<t.length&&(t=t.charAt(0).toUpperCase()+t.substr(1)),t}}})}),Bt});
function S123SingleFontTheme( settings ) {var _ = {$container: settings.$container,fontName: settings.fontName,websiteID: settings.websiteID,items: {},infinityScroll: null,website_language: settings.website_language,fontChangeCallback: settings.fontChangeCallback,tool: settings.hasOwnProperty('tool') ? settings.tool : '',isCustomFont: settings.hasOwnProperty('isCustomFont') ? settings.isCustomFont : false,lineHeight: settings.hasOwnProperty('lineHeight') ? settings.lineHeight : '1.25',fontChangeLineHeightCallback: settings.hasOwnProperty('fontChangeLineHeightCallback') ? settings.fontChangeLineHeightCallback : null,};_.init = function() {_.$themsContainer = $(generateThemeContainerHtml());_.$itemsContainer = _.$themsContainer.find('.theme-items-container');_.$themeDefultItemContainer = $(_.$themsContainer.get(0));_.$searchInput = _.$themsContainer.find('.search');addThemeTooltip(_.$themsContainer);if ( _.tool === 'headers' ) {_.$themsContainer.find('.headers-font-settings').off('click').on('click', function( event ) {var $this = $(this);var html = '<div class="form-group" style="position: relative;">';html += '<label for="header_line_height">';html += translations.headerLineHeight + '&nbsp;';html += '<a href="#" onclick="return false;" data-trigger="hover" data-rel="tooltip" title="' + translations.headerLineHeightTooltip + '">';html += '<i class="fa fa-question-circle"></i>';html += '</a>';html += '</label>';html += '<select class="form-control" name="header_line_height">';html += '<option value="">' + translations.websiteDefault + '</option>';html += '<option value="1.15"' + (_.lineHeight == '1.15' ? ' selected ' : '') +'>' + translations.small + '</option>';html += '<option value="1.25"' + (_.lineHeight == '1.25' ? ' selected ' : '') +'>' + translations.medium + '</option>';html += '<option value="1.35"' + (_.lineHeight == '1.35' ? ' selected ' : '') +'>' + translations.large + '</option>';html += '</select>';html += '</div>';var $html = $(html);$html.find('select[name="header_line_height"]').off('change').on('change', function() {if ( _.fontChangeLineHeightCallback ) _.fontChangeLineHeightCallback.call(this,$(this).val());});$this.popover({container: $this.closest('body'),content: $html,html: true,trigger: 'manual',template: `<div class="popover header-font-settings" role="tooltip"><div class="arrow"></div><div class="popover-header"><a href="#" class="btn btn-link close-header-font-settings-btn">×</a></div><div class="popover-content"></div></div>`,placement: $('html[dir=rtl]').length == 0 ? intrface_align : intrface_align_reverse,});function destroyPopover() {$this.popover('destroy');$(document).off('mousedown.headersFontSettings');$(window).off('blur.headersFontSettingsPopover');$(window).off('scroll.headersFontSettingsPopover');$(document).off('mousedown.preview.headersFontSettings');}
$this.on('shown.bs.popover', function () {$(document).on('mousedown.headersFontSettings', function ( event ) {if ( $(event.target).closest('.popover.header-font-settings').length === 0 ) {destroyPopover();}});$(window).one('blur.headersFontSettingsPopover', function( event ) {destroyPopover();});$this.closest('body').find('.header-font-settings .close-header-font-settings-btn').one('click',function(event) {event.preventDefault();event.stopPropagation();destroyPopover();});$this.closest('body').find('.popover.header-font-settings [data-rel=tooltip]').tooltip({container: $this.closest('body'),placement: 'auto'});$(document).on('mousedown.preview.headersFontSettings', function ( event ) {var $target = $(event.target);if ( $target.closest('.popover.header-font-settings').length === 0 ) {destroyPopover();}});});$this.popover('show');});}
_.$container.append(_.$themsContainer);_.$searchInput.on('input', function( event ) {clearTimeout(_.$searchInput.get(0).finishedTyping);_.$searchInput.get(0).finishedTyping = setTimeout( function() {if ( _.$searchInput.val().length === 0 ) {addThemesToPage('');} else {addThemesToPage(_.$searchInput.val());}},500);});if ( _.tool === 'headers' ) {_.$themeDefultItemContainer.find('#setDefultFonts').on('click', function( event ) {_.applyTheme({name: topWindow.$('#font_modules_header').val()});if ( _.fontChangeCallback ) _.fontChangeCallback.call(this,{name:'',italic:1});$(this).addClass('hidden');});if ( !_.isCustomFont ) {_.$themeDefultItemContainer.find('#setDefultFonts').addClass('hidden');} else {_.$themeDefultItemContainer.find('#setDefultFonts').removeClass('hidden');}}};_.refresh = function() {resetActiveClass();setSelectedTheme();};_.destroy = function() {_.items = {};_.$themsContainer.remove();if ( _.infinityScroll ) _.infinityScroll.destroy();};_.loadThemes = function() {var $noResult = _.$themsContainer.find('.no-result');$noResult.hide();addThemesToPage('');};_.applyTheme = function( newTheme ) {_.fontName = newTheme.name;resetActiveClass();setSelectedTheme();};function addThemesToPage( search ) {if ( _.infinityScroll ) _.infinityScroll.destroy();var template = generateThemeHtml(new getTheme({id: 'skeleton'}));_.$itemsContainer.empty();if ( search.length == 0 ) {setSelectedTheme();}
_.infinityScroll = new s123InfiniteScroll({isMobile: false, // we don't want to add "load more button" but we have other tools that do need that feature
$container: _.$themsContainer.filter('.themes-container'),firstRequestSettings: {pagesAmount: 1,limit: 30},loader: {$container: _.$itemsContainer,template: template},ajax: {type: 'POST',url: '/versions/2/wizard/modules/wizardInfiniteScroll_v4.php',data: {w: settings.websiteID,website_language: _.website_language,type: 'singleFontThemes',limit: 30,search: search},buildItemCallback: function( index, theme, $container ) {if ( theme.oldCustomersSupport && _.fontName !== theme.name ) return;var newTheme = new getTheme(theme);_.items[newTheme.id] = newTheme;var $theme = $(generateThemeHtml(newTheme));$theme.on('click', function( event ) {event.preventDefault();_.applyTheme(newTheme);if ( _.fontChangeCallback ) _.fontChangeCallback.call(this,newTheme);});addThemeTooltip($theme);_.$itemsContainer.append($theme);},success: function( data, infiniteScroll ) {if ( data.items.length == 0 ) {_.$themsContainer.find('.no-result').show();} else {_.$themsContainer.find('.no-result').hide();resetActiveClass();}}}});}
function resetActiveClass() {var $items = _.$themsContainer.find('.design-themes:not([data-id="theme-current"])');$items.removeClass('active');$items.filter('[data-font-name="'+_.fontName+'"]').addClass('active');}
function addThemeTooltip( $theme ) {$theme.find('[data-rel=tooltip]').tooltip({container: 'body',placement: 'auto',delay: {show: 1000,hide: 0}});}
function setSelectedTheme() {var theme = new getTheme({id: 'theme-current',name: _.fontName,order: 0,isUserTheme: true});_.$userTheme = $(generateThemeHtml(theme));if ( _.tool === 'headers' ) {_.$themeDefultItemContainer.find('[data-id="theme-current"]').remove();_.$themeDefultItemContainer.prepend(_.$userTheme);} else {_.$themsContainer.find('.theme-items-container [data-id="theme-current"]').remove();_.$themsContainer.find('.theme-items-container').prepend(_.$userTheme);}
addThemeTooltip(_.$userTheme);}
function getTheme( data ) {function Def() {return {id: 'static',name: '',isUserTheme: false,type: 'singleFontThemes'};}
var def = new Def();data = objectAssign(def,data);return data;}
function generateThemeContainerHtml() {var html = '';if ( _.tool === 'headers' ) {html += '<div class="theme-defult-item-container">';html += '<span class="headers-font-settings"><i class="fa-regular fa-gear"></i></span>';html += '<a id="setDefultFonts" href="#" class="btn btn btn-transparent btn-sm">'+translations.fontResetToWebsiteDefault+'</a>';html += '</div>';}
html += '<div class="searchInput_design_container">';html += '<input type="text" maxlength="50" class="search form-control search-query input-transparent" placeholder="'+translations.fontsSearchPlaceHolder+'">';html += '<span class="fa fa-search form-control-feedback searchInput_designIcon"></span>';html += '</div>';html += '<div class="themes-container fancy-scrollbar" data-type="singleFontThemes">';html += '<div class="theme-items-container"></div>';html += '<div class="no-result">'+translations.fontsSearchNoResult+'</div>';html += '</div>';return html;}
function generateThemeHtml( theme ) {var html = '<div data-id="{{id}}" style="order:{{order}};" class="wizard-card wizard-theme ActiveScale design-themes" data-type="singleFontThemes" data-font-name="{{fontName}}">';html += '<div class="mainDesign">';html += '<div class="mainFonts">';html += '<h2 class="themes-fonts-preview-image-all" style="{{fontModulesHeaderImage}} {{border}}">{{name}}</h2>';html += '</div>';html += '</div>';html += '</div>';html = html.replace('{{id}}',theme.id);html = html.replace('{{order}}',theme.order);if ( topWindow.customFontsHandler.isCustomFont(theme.name) ) {html = html.replace('{{name}}',escapeHtml(theme.name));html = html.replace('{{fontName}}',escapeHtml(theme.name));html = html.replace('{{border}}','');html = html.replace('{{fontModulesHeaderImage}}','text-align: left;');} else if ( theme.id == 'skeleton' ) {html = html.replace('{{name}}','&nbsp;');html = html.replace('{{fontName}}','');html = html.replace('{{border}}','border: 1px solid #4e4e4e;');html = html.replace('{{fontModulesHeaderImage}}','');} else {var fontModulesHeaderImage = $GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/fontsImages/v5/normal_'+encodeURIComponent(theme.name.replace(/ /ig,"_"))+'_f_white.png?v=3';html = html.replace('{{name}}','&nbsp;');html = html.replace('{{fontName}}',escapeHtml(theme.name));html = html.replace('{{border}}','');html = html.replace('{{fontModulesHeaderImage}}','background-image:url('+fontModulesHeaderImage+');');}
return html;}
_.init();return _;};
var isWizardChange = false;var isPreviewReload = false;var typingTimer;                // timer identifier
var doneTypingInterval = 3000;  // time in ms, 5 second for example
var doneTypingInterval_Short = 500; // time in ms, 500 milliseconds for example
var wizardReadyToGo = false; // Tell us if we can start working with the wizard (this var make sure everything is load properly)
var viewButtonReload = false; // Tell us if the user click on the 'EYE' (preview) button inside the module window. If so we don't reload the website preview with bootstrap event for HIDE
var disableLeavePopup = false;var tools_manage_is_change = false;var recommendedImagesLoading_start = false;var RecommendedImagesPage = 1;var imageAttributesResult_global = '';var imageHomepageLiveEleID = '';var holdWizardSave = false;var existingTitle1;var existingTitle2;var existingTitle3;var existingHomeButton1;var existingHomeButton2;var WizardAddImagesToHistory = new function() {var that = this;that.init = function( settings ) {that.websiteID = settings.websiteID;that.dataBase = that.websiteID+'_ImagesHistory';that.supported = false;that.disabled = false;that.tableNameSpace = 'history';that.$container = settings.$container;createDataBase();};that.add = function(previewURL,imageURL) {if ( !that.supported ) return;if ( that.disabled ) return;var exist = false;var imageExistHandler = that.objectStore.each(function(item) {if ( imageURL == item.value[1] ) {exist = true;return;}}).done(function(result, event){if ( !exist ) {var dataObj = [previewURL,imageURL];that.objectStore.add(dataObj,that.index).done(function( result, event ){that.index++;that.ShowUserImageShortCutInStyleImage($('#BackgroundTabHomepage'));});}});};that.show = function() {if ( !that.supported ) return;if ( that.disabled ) return;if ( that.$container.find('.recommendedImagesItem').length === 0 ) return;that.$container.show();};that.hide = function() {that.$container.hide();};function GetAllImages($ele) {if (!that.supported) return;var allImages = new Array();var range = '';var direction = true;var $lastImagesContent = $ele.find('.lastImages .boxContent');var iterationPromise = that.objectStore.each(function(item) {allImages.push(item);});iterationPromise.done(function(result, event){allImages = allImages.reverse();var length = allImages.length;if ( length > 4 ) length = 4;$lastImagesContent.empty();for (var i = 0; i < length; i++) {var item        = allImages[i];var previewURL  = item.value[0];var imageURL    = item.value[1];var $html      = $('<div class="col-xs-3"><div class="recommendedImagesItem"><img src="'+previewURL+'" data-full-image="'+imageURL+'"></div></div>');$lastImagesContent.append($html);$html.find('img').on('click',function() {var $this = $(this);homepage_PickNewObjectToHomepageBackground(false,$this.parent('.recommendedImagesItem'),$this.attr('src'),$this.data('full-image'),null,'images');});}
that.show();});}
function GetLastKeyFromDB() {if (!that.supported) return; // indexedDB not supported
var getLastKey = -1;var iterationPromise = that.objectStore.each(function(item) {getLastKey = item.key;});iterationPromise.done(function(result, event){that.index = getLastKey+1;});}
that.ShowUserImageShortCutInStyleImage = function($ele) {if (!that.supported) return; //indexedDB not supported
var allImages = GetAllImages($ele);}
function createDataBase() {that.indexedDB = $.indexedDB(that.dataBase, {"schema": {"1": function( versionTransaction ) {versionTransaction.createObjectStore(that.tableNameSpace);}}});that.indexedDB.done(function( db, event ) {that.supported = true;that.objectStore = that.indexedDB.objectStore(that.tableNameSpace,'readwrite');GetLastKeyFromDB();that.ShowUserImageShortCutInStyleImage($('#BackgroundTabHomepage'));convertOldIndexedDBToNew();});that.indexedDB.fail(function( db, event ) {that.supported = false;});}
function convertOldIndexedDBToNew() {var oldIndexedDB = $.indexedDB('ImagesHistory');oldIndexedDB.done(function( db, event ) {var index = 0;if ( db.objectStoreNames[0] === that.websiteID+'_history' ) {oldIndexedDB.objectStore(db.objectStoreNames[0],'readwrite').each(function( item ) {that.objectStore.add([item.value[0],item.value[1]],index);index ++;GetLastKeyFromDB();}).done(function() {that.ShowUserImageShortCutInStyleImage($('#BackgroundTabHomepage'));oldIndexedDB.deleteDatabase();});} else {oldIndexedDB.deleteDatabase();}});}}
var WizardUndoRedoHandler = function() {var that = {index: 0,skipSave: false,tableNameSpace: 'undo',isDisable: false,isSupported: true,isDifferentType: true,addRecordRequests: [],lastModuleID: null};that.init = function( settings ) {if ( !settings.$buttonsContainer || !settings.dataBase ) return;that.dataBase = settings.dataBase;that.$buttonsContainer = settings.$buttonsContainer;if ( $('html').data('device') === 'mobile' ) return;var deletePromise = $.indexedDB(that.dataBase).deleteDatabase();deletePromise.done(function( event ) {createDataBase();$(document).on('wizard_tabs_opened.WizardUndoRedoHandler',function( event, tabID ) {if ( ['settingsTab','designTab','pagesTab'].includes(tabID) ) {that.$buttonsContainer.removeClass('hidden');that.enable();} else {that.$buttonsContainer.addClass('hidden');that.disable();}});});deletePromise.fail(function( error ) {that.isSupported = false;});};that.reset = function() {if ( isDisabled() ) return;if ( !that.isSupported ) return;var iterationPromise = that.objectStore.each(function( item ){if ( item.key > that.index ) item.delete();});};that.add = function( dataObj, $allSettingsBeforeChange ) {if ( isDisabled() ) return;if ( !that.isSupported ) return;if ( that.skipSave ) {that.skipSave = false;return;}
dataObj = new LocalDBObject(dataObj);if ( dataObj.type == 'wizard' ) {if ( JSON.stringify(tryParseJSON(that.lastSave)) === JSON.stringify(dataObj.allSettings) ) return;}
if ( that.inProgress ) {that.addRecordRequests.unshift(dataObj);} else {that.inProgress = true;handleAddRecordRequest(dataObj,$allSettingsBeforeChange);}};that.debug = async function( propName ) {const data = [];await that.objectStore.each(function( item ) {switch( propName ) {case 'tools_manage':data.push(tryParseJSON(item.value.allSettings[propName]));break;default:data.push(item.value.allSettings[propName]);break;}});return data;};function handleAddRecordRequest( dataObj, $allSettingsBeforeChange ) {that.reset();that.buttonsDisable();if ( that.lastModuleID != dataObj.moduleID ) {that.isDifferentType = true;if ( that.lastModuleID != null && that.index > 0 ) that.index ++;}
if ( dataObj.type == 'wizard' ) {getLastSave();if ( that.isDifferentType ) {dataObj.allSettings.wizardUndoRefreshHelper = $('#wizardUndoRefreshHelper').val();}}
var allSettingsBeforeChange = tryParseJSON($allSettingsBeforeChange.val());handleFirstRecord(new LocalDBObject({moduleID: dataObj.moduleID,styleObj: {style: allSettingsBeforeChange.style,moduleArrID: allSettingsBeforeChange.moduleArrID,},moduleTypeNUM: dataObj.moduleTypeNUM,allSettings: allSettingsBeforeChange.allSettings,type: dataObj.type}))
.then(function() {$.each(dataObj.allSettings, function(key, val) {allSettingsBeforeChange.allSettings[key] = val;});dataObj.allSettings = allSettingsBeforeChange.allSettings;$allSettingsBeforeChange.val(JSON.stringify(allSettingsBeforeChange));that.index ++;that.objectStore.get(that.index)
.done(function(result, event) {var overwrite = false;if ( result ) overwrite = true;that.lastModuleID = dataObj.moduleID;save(dataObj,overwrite, function() {if ( that.addRecordRequests.length > 0 ) {handleAddRecordRequest(that.addRecordRequests.pop(),$allSettingsBeforeChange);} else {that.inProgress = false;that.buttonsEnable();}});});});}
function handleFirstRecord( dataObj ) {return new Promise(function(resolve, reject) {if ( !that.isDifferentType ) {resolve();} else {that.objectStore.get(that.index)
.done(function(result, event) {var overwrite = false;if ( result ) overwrite = true;save(dataObj,overwrite,function() {that.isDifferentType = false;resolve();});});}});}
that.buttonsDisable = function() {if ( !that.isSupported ) return;if ( !that.$undoBtn && !that.$redoBtn ) return;that.$undoBtn.addClass('disabled');that.$redoBtn.addClass('disabled');};that.buttonsEnable = function() {if ( isDisabled() ) return;if ( !that.isSupported ) return;if ( !that.$undoBtn && !that.$redoBtn ) return;disableEnableButtons();};that.enable = function() {if ( !that.isSupported ) return;that.isDisable = false;that.buttonsEnable();};that.disable = function() {if ( !that.isSupported ) return;that.isDisable = true;that.buttonsDisable();};function isDisabled() {if ( that.isDisable ) return true;if ( $('html').data('device') === 'mobile' ) return true;return false;}
function createDataBase() {that.indexedDB = $.indexedDB(that.dataBase, {"schema": {"1": function( versionTransaction ) {versionTransaction.createObjectStore(that.tableNameSpace);}}});that.indexedDB.done(function( db, event ) {that.objectStore = that.indexedDB.objectStore(that.tableNameSpace,'readwrite');var promise = that.objectStore.clear();promise.done(function( result, event ) {addButtons();getLastSave();});});}
function LocalDBObject( data ) {function Def() {return {moduleID: '',moduleTypeNUM: '',type: '',styleObj: {},allSettings: {}};}
var def = new Def();if ( data ) {data = objectAssign(new Def(), data); // (objectAssign overwrite objects)
} else {data = def;}
return data;};function save( data, overwrite, callback ) {var promise = null;if ( overwrite ) {promise = that.objectStore.put(data,that.index);} else {promise = that.objectStore.add(data,that.index);}
promise.done(function(result, event) {if ( callback ) callback.call(this);});promise.fail(function(result, event) {if ( callback ) callback.call(this);});}
function disableEnableButtons() {if ( that.index >= 1 ) {that.$undoBtn.removeClass('disabled');} else {that.$undoBtn.addClass('disabled');}
var promise = that.objectStore.count();promise.done(function( result, event ){if ( that.index < result-1 ) {that.$redoBtn.removeClass('disabled');} else {that.$redoBtn.addClass('disabled');}});}
function addButtons() {var isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;var undoText = isMac ? escapeHtml(translations.undo).replace('{{shortcut}}','&#8984;Z') : escapeHtml(translations.undo).replace('{{shortcut}}','Ctrl+Z') ;var redoText = isMac ? escapeHtml(translations.redo).replace('{{shortcut}}','&#8984;Y') : escapeHtml(translations.redo).replace('{{shortcut}}','Ctrl+Y');that.$buttonsContainer.append($('<a id="wizardUndo" data-rel="tooltip-desk" data-title="'+undoText+'" data-speech="on" data-speech-text="'+escapeHtml(translations.undo)+'" data-track="undo"><i class="fal fa-undo" aria-hidden="true"></i></a><a id="wizardRedo" data-rel="tooltip-desk" data-title="'+redoText+'" data-speech="on" data-speech-text="'+escapeHtml(translations.redo)+'" data-track="undo"><i class="fal fa-redo" aria-hidden="true"></i></a>'));that.$undoBtn = that.$buttonsContainer.find('#wizardUndo');that.$undoBtn.on('click', function() {if ( !that.$undoBtn.is(':visible') || that.$undoBtn.hasClass('disabled') ) return;that.index --;var promise = that.objectStore.get(that.index);that.buttonsDisable();that.inProgress = true;promise.done(function( newSettings, event ) {if ( newSettings.moduleID != that.lastModuleID ) {that.index --;}
promise = that.objectStore.get(that.index);promise.done(function( newSettings, event ) {promise = that.objectStore.get(that.index+1);promise.done(function( prevSettings, event ) {if ( newSettings.type == 'wizard' ) {that.skipSave = true;handleWizardChanges(newSettings.allSettings,prevSettings.allSettings.wizardUndoRefreshHelper);} else {handleModuleChanges(newSettings);}
that.lastModuleID = newSettings.moduleID;that.inProgress = false;});});});});that.$redoBtn = that.$buttonsContainer.find('#wizardRedo');that.$redoBtn.on('click', function() {if ( !that.$redoBtn.is(':visible') || that.$redoBtn.hasClass('disabled') ) return;that.index ++;var promise = that.objectStore.get(that.index);that.buttonsDisable();that.inProgress = true;promise.done(function( newSettings, event ) {if ( newSettings.moduleID != that.lastModuleID ) {that.index ++;}
promise = that.objectStore.get(that.index);promise.done(function( newSettings, event ) {if ( newSettings.type == 'wizard' ) {that.skipSave = true;handleWizardChanges(newSettings.allSettings,newSettings.allSettings.wizardUndoRefreshHelper);} else {handleModuleChanges(newSettings);}
that.lastModuleID = newSettings.moduleID;that.inProgress = false;});});});InitializeToolTips();WizardUndoRedoHandler.buttonsDisable();}
function handleWizardChanges( dbSettings, wizardUndoRefreshHelper ) {window.scrollPreview = '#top-section';scrollToPointInPreview();that.buttonsDisable();if ( !dbSettings ) return;var lastSave = tryParseJSON(that.lastSave);var changedInputs = [];var changedSettings = {};holdWizardSave = true;$.each(dbSettings, function ( key, value ) {var $input = $('#'+key);if ( $input.length == 0 ) {$input = $('[name="'+key+'"]');}
switch ( $input.prop('type') ) {case 'checkbox':$input.prop('checked',value);break;case 'radio':$input = $('[name="'+$input.attr('name')+'"][value="'+value+'"]');$input.prop('checked',true);break
default:if ( $input.get(0).id === 'home_siteSlogan' ||$input.get(0).id === 'home_siteSlogan_2' ||$input.get(0).id === 'home_SecondSiteSlogan') {value = value.replace(/<br\/>/ig,"\n");value = value.replace(/<br>/ig,"\n");}
$input.val(value);break;}
if ( lastSave[key] != value ) {if ( isUploadFileInput($input) ) {uploadFileHandler($input);}
changedInputs.push($input);}});changedInputs = changedInputs.filter(function( $input ) {if ( $input.get(0).id === 'home_background_color' && $input.val().length === 0 ) return false;if ( $input.get(0).id === 'homepageGradientsColors' && $input.val().length === 0 ) return false;return true;});$.each(changedInputs, function( index, $input ) {var flagsArray = ['UndoRedoChange'];if ( isUploadFileInput($input) ) {flagsArray = [null,'UndoRedoChange'];}
$input.trigger('change',flagsArray);changedSettings[$input.get(0).id] = dbSettings[$input.get(0).id];});ShowHideTextLayoutElementsIfUnused();holdWizardSave = false;Wizard.render.init(changedSettings);if ( changedSettings.tools_manage ) {toolsManageHandler(changedSettings.tools_manage);}
WizardRefreshHandler(changedInputs,wizardUndoRefreshHelper);getLastSave();if ( Wizard.Preview.ready ) {Wizard.Preview.$document.trigger('undoRedo.change');}
that.buttonsEnable();$(document).trigger('user_action_update_flag',[{name: 'flag_UseUndoRedo', triggerName: false}]);}
function handleModuleChanges( dbSettings ) {that.buttonsDisable();Wizard.UpdateModuleItemSettings(dbSettings.moduleID,dbSettings.moduleTypeNUM,dbSettings.allSettings)
.then(function() {if ( [169,167].includes(parseInt(dbSettings.moduleTypeNUM)) ) {Wizard.InlineModuleEditor.im_reload(dbSettings.moduleID,dbSettings.moduleTypeNUM);}
ReloadPreviewAndGoToModule(dbSettings.moduleID,true);});that.buttonsEnable();$(document).trigger('user_action_update_flag',[{name: 'flag_UseUndoRedo', triggerName: false}]);}
function getLastSave() {that.lastSave = JSON.stringify(Wizard.getUndoFields());}
function uploadFileHandler( $input ) {var uploadFile = getUploadFileObjectByID($input.get(0).id);uploadFile.methods.rebuild();}
function isUploadFileInput( $input ) {return $input.hasClass('file-upload-input-field');}
function toolsManageHandler( new_tools_manage ) {g_ManageAddModuleData = null;new_tools_manage = tryParseJSON(new_tools_manage);const current_tools_manage = tryParseJSON(tools_manage);let restoredModules = [];let removeModules = [];$.each(new_tools_manage, function( index, newPage ) {if ( newPage.moduleID == 169 ) return;if ( !current_tools_manage.find(page => newPage.moduleID == page.moduleID) ) {const parentModule = new_tools_manage.find(page => newPage.parentId == page.moduleID);if (newPage.parentId.length > 0 && (RichPage.isRichPage(parentModule.moduleTypeNUM) ||parentModule.moduleTypeNUM == '78')) {newPage.isSubModule = true;}
restoredModules.push(newPage);}});restoredModules = restoredModules.filter(function( pageToRestore ) {if (pageToRestore.isSubModule && (restoredModules.find(page => RichPage.isRichPage(page.moduleTypeNUM)) ||restoredModules.find(page => page.moduleTypeNUM == '78'))) return false;return true;});restoreModules(restoredModules);$.each(current_tools_manage, function( index, currentPage ) {if ( currentPage.moduleID == 169 ) return;const isRemoved = new_tools_manage.filter(function( newPage, index ) {return currentPage.moduleID == newPage.moduleID && currentPage.moduleTypeNUM == newPage.moduleTypeNUM;}).length == 0;if ( isRemoved ) {const parentModule = current_tools_manage.find(page => currentPage.parentId == page.moduleID);if (currentPage.parentId.length > 0 && (RichPage.isRichPage(parentModule.moduleTypeNUM) ||parentModule.moduleTypeNUM == '78')) {currentPage.isSubModule = true;}
removeModules.push(currentPage);}});removeModules = removeModules.filter(function( pageToRestore ) {if (pageToRestore.isSubModule && (removeModules.find(page => RichPage.isRichPage(page.moduleTypeNUM)) ||removeModules.find(page => page.moduleTypeNUM == '78'))) return false;return true;});$.each(removeModules, function( index, pageToRemove ) {holdWizardSave = true;if ( RichPage.isRichPage(pageToRemove.moduleTypeNUM) ) {const currentPage = current_tools_manage.find(page => page.parentId == pageToRemove.moduleID);if ( currentPage ) {const newPage = new_tools_manage.find(page => page.moduleID == currentPage.moduleID);if ( newPage && newPage.parentId == '' ) {$(document).one('wizardUndoHelper.removeModule.success', function() {restoreModules([current_tools_manage.find(page => page.parentId == pageToRemove.moduleID)]);});}}}
$(document).one('removeModule.success', function() {if ( pageToRemove.moduleID == removeModules[removeModules.length-1].moduleID ) holdWizardSave = false;rebuildPagesTab(JSON.stringify(new_tools_manage),false);$(document).trigger('wizardUndoHelper.removeModule.success');});RemoveModule(Wizard.Pages.getPage(pageToRemove.moduleID).find(`.cards_buttons.delete[data-moduleid="${pageToRemove.moduleID}"]`));});if ( restoredModules.length == 0 && removeModules.length == 0 ) {$.each(new_tools_manage, function( index, newPage ) {if ( newPage.moduleTypeNUM != 167 ) return;if ( !$(`.inline-wizard-iframe[data-moduleid="${newPage.moduleID}"]`).is(':visible') ) return;const currentPage = current_tools_manage.find(currentPage => currentPage.moduleID == newPage.moduleID);if ( currentPage && (newPage.title != currentPage.title) ) {Wizard.InlineModuleEditor.im_reload(newPage.moduleID,newPage.moduleTypeNUM);}});rebuildPagesTab(JSON.stringify(new_tools_manage),true);}
function restoreModules( modulesToRestore ) {$.each(modulesToRestore, function( index, pageToRestore ) {holdWizardSave = true;$(document).one('PagesRecycle.restoreDeletedModule.success.restoreModules', function() {if ( pageToRestore.moduleID == modulesToRestore[modulesToRestore.length-1].moduleID ) holdWizardSave = false;rebuildPagesTab(JSON.stringify(new_tools_manage),false);});if ( RichPage.isRichPage(pageToRestore.moduleTypeNUM) ) {const newPage = new_tools_manage.find(page => page.parentId == pageToRestore.moduleID);if ( newPage ) {const currentPage = current_tools_manage.find(page => page.moduleID == newPage.moduleID);if ( currentPage && currentPage.parentId == '' ) {$(document).off('PagesRecycle.restoreDeletedModule.success.restoreModules').one('PagesRecycle.restoreDeletedModule.success.restoreModules', function() {RichPage.addExistingModule(pageToRestore.moduleID,currentPage.moduleID);const index = new_tools_manage.findIndex(page => page.moduleID == currentPage.moduleID);new_tools_manage[index].parentId = pageToRestore.moduleID;holdWizardSave = false;rebuildPagesTab(JSON.stringify(new_tools_manage),true);$("#wizardForm").off('ajaxSuccess.rebuildPagesTab').one('ajaxSuccess.rebuildPagesTab', function( event ) {Wizard.Pages.modeManager.set('richPage',pageToRestore.moduleID,true);});});}}}
PagesRecycle.restoreDeletedModule(pageToRestore.moduleID);});}
function rebuildPagesTab( new_tools_manage, isFullModuleListReload ) {$('#tools_manage.undo-helper').val(new_tools_manage);if ( isFullModuleListReload ) {$("#wizardForm").off('ajaxSuccess.rebuildPagesTab').one('ajaxSuccess.rebuildPagesTab', function( event ) {isPreviewReload = true;RefreshPreview();});if ( RichPage.isActive ) {const moduleID = RichPage.moduleID;Wizard.Pages.modeManager.set('pages','',false);$(document).one('LoadModulesLists.done', function() {Wizard.Pages.modeManager.set('richPage',moduleID,true);});$("#wizardForm").off('ajaxSuccess.rebuildPagesTab').one('ajaxSuccess.rebuildPagesTab', function( event ) {ReloadPreviewIframe('/'+RichPage.getPageUrl(Wizard.Pages.getPage(moduleID))+'?w=' + $('#id').val());});}
tools_manage = new_tools_manage;LoadModulesLists();tools_manage_is_change = true;AutoSaveWizard(false,true);}
Wizard.Tabs.pages.displayHideOthersPagesTabs();if ( g_ManageModuleID != '' && $('.modules-design-list').is(':visible') ) {if ( g_ManageModuleID == 169 ) {Wizard.Pages.homepage.$card.find('.designModuleButton').trigger('click');} else {Wizard.Pages.list.filter('[data-moduleid="'+g_ManageModuleID+'"]').find('.designModuleButton').trigger('click');}}}}
return that;}();var RecommendedImagesPagInation = new function() {var that = this;that.init = function( settings ) {if ( !settings ) return;that.isMobile = settings.isMobile;that.$recommendedImagesContainer = settings.$recommendedImagesContainer;that.$recommendedImages = settings.$recommendedImages;that.recommendedImagesPage = settings.recommendedImagesPage;if ( that.isMobile ) {if ( $('#loadMore').length !== 0 ) $('#loadMore').remove();that.$loadMore = $('<div class="text-center"><a id="loadMore" class="btn btn-primary">'+translations.loadmore+'</a></div>');that.$recommendedImagesContainer.append(that.$loadMore);}
that.addLoadNextPageAbility();};that.addLoadNextPageAbility = function() {if ( that.$loadMore ) {that.$loadMore.on('click', function() {that.getNextPage();});} else {that.$recommendedImagesContainer.scroll( function( e ) {var $this = $(this);var st = $this.scrollTop();if ( st > ( (that.$recommendedImagesContainer[0].scrollHeight - that.$recommendedImagesContainer[0].offsetHeight) * 0.80 ) ) {that.getNextPage();}});}};that.getNextPage = function() {if ( recommendedImagesLoading_start == false ) {that.recommendedImagesPage++;Wizard.homePageBgOptions.getRecommendedImages(that.$recommendedImagesContainer,that.recommendedImagesPage);}};that.destroy = function() {if ( that.$loadMore ) {that.$loadMore.remove();}
if ( that.$recommendedImagesContainer ) {that.$recommendedImagesContainer.off('scroll');}};return that;}();jQuery(function($) {SystemModals.sm_render({id: 'moduleWindow',disposable: false,$parent: $('body'),sizeClasses: '',headerSettings: {id: 'moduleWindowTitle',title: '&nbsp;'},bodySettings: { // body settings
content: '&nbsp;'},footerSettings: { // footer settings
isActive: false,buttons: []},showCallback: function ( event, modal ) {if ( $('#pagesTab').data('active-inline-module') ) {if ( isInlineEditorProccesing() ) {event.preventDefault();return;} else {$('#pagesTab').data('active-inline-module').trigger('OpenPromoInlineEdit.hide');}}
var $button = $(event.relatedTarget);           // Button that triggered the modal
var moduleID = $button.data('moduleid');        // Extract info from data-* attributes
var moduleTypeNUM = $button.data('moduletypenum');      // Extract info from data-*
modal.$html.data('module-type-num',moduleTypeNUM);var modalWidth = SetEnlargeWindow(moduleTypeNUM,$button);if ( $button && modalWidth === 'small' ) {$button.data('modal-height-limit',600);}
if ( moduleID ) {g_ManageModuleID = moduleID;var $wizardPage = Wizard.Pages.getPage(moduleID);OpenModuleWindow(moduleID,moduleTypeNUM,'',$button,'itemsPage');if ( !$button.data('prevent-module-scroll') ) {topWindow.scrollPreview = '#section-'+moduleID;topWindow.scrollToPointInPreview();} else {preventScrollOnModalClose = true;}}
$button.data('prevent-module-scroll',false);if ( $('html').data('ios-device') ) {var $modalContent = modal.$html.find('.modal-content');var $modalBody = modal.$html.find('.modal-body');var $moduleMobileBottomMenu = modal.$html.find('#moduleMobileBottomMenu');var $modalBody = modal.$html.find('.modal-body');if ( $modalBody.next().length == 0 ) {$moduleMobileBottomMenu.detach();$modalContent.append($moduleMobileBottomMenu);}
if ( $modalBody.find('#moduleMobileBottomMenu').length > 0 ) {$modalBody.find('#moduleMobileBottomMenu').remove();}}},hideCallback: function ( event, modal ) {modal.isKeepBackdrop = true;if ( !is_unsave_changes(modal.$html,modal.$html.find('#moduleItemsIframe'),event) ) {modal.isKeepBackdrop = false;(function () {var $module = $('#card_'+g_ManageModuleID+'');if ( $module.length === 0 ) return;var moduleTypeNUM = $module.data('moduletypenum');if ( moduleTypeNUM == '108' ) {UpdatePreviewAreaByAjax(['#mainNav ul.navPages','footer.global_footer ul.navPages','#header #top-menu .navPages'],false,false,'');}})();if ( $(this).find('#changeStyleModal').length === 0 ) {AutoSaveWizard(true,true);}
$('[data-tab-id="pagesTab"]').removeClass('activeWhite');$('.tabbable.tabs-left').removeClass('highOpacity');modal.$html.data('module-type-num',null);}
modal.$html.data('close-on-save',false);if ( event.target.id != 'moduleWindow' && !$(document.activeElement).hasClass('close') ) {if ( modal.$html.find('#moduleItemsIframe').contents().find('.SubmitButtonsArea').length === 0 ) {return true;} else {return false;}}
if ( $('html').data('ios-device') ) {modal.$html.find('#moduleMobileBottomMenu').remove();}}});SystemModals.sm_render({id: 'moduleSettingsWindow',disposable: false,$parent: $('body'),sizeClasses: 'size-l1',headerSettings: {id: 'moduleSettingsWindowTitle',title: translations.seo},bodySettings: { // body settings
content: '&nbsp;'},footerSettings: { // footer settings
isActive: false,buttons: []},showCallback: function ( event, modal ) {var button = $(event.relatedTarget);var moduleID = button.data('moduleid');var moduleTypeNUM = button.data('moduletypenum');var modalSize = button.data('modal-size');g_ManageModuleID = moduleID;modal.setWidth(modalSize);var src = '/versions/2/wizard/modules/'+modulesArr[moduleTypeNUM]['folder']+'/settings.php?w='+$('#id').val()+'&moduleID='+moduleID+'&moduleTypeNUM='+moduleTypeNUM+'';modal.updateHTML('body','<iframe id="moduleSettingsIframe" src="'+src+'" style="width:100%;height:600px;margin: 0;padding: 0;border: none;"></iframe>');}});SystemModals.sm_render({id: 'languagesManager',disposable: false,$parent: $('body'),sizeClasses: 'size-l1',headerSettings: {id: 'languagesManagerTitle',title: 'Languages Manager'},bodySettings: { // body settings
content: '&nbsp;'},footerSettings: { // footer settings
isActive: false,buttons: []},showCallback: function ( event, modal ) {var button = $(event.relatedTarget);var moduleID = button.data('moduleid');var moduleTypeNUM = button.data('moduletypenum');var modalSize = button.data('modal-size');var languageID = button.data('language-id');var modalID = $('#languagesManager');var activeTab = 'index.php';g_ManageModuleID = moduleID;var src = '/versions/2/wizard/languagesManager/index.php?w='+$('#id').val();var heighestHeightNUM = $(window).outerHeight(true)-170;modal.updateHTML('body',`<iframe id="languagesManagerIframe" src="${src}" style="width:100%;height:${heighestHeightNUM}px;margin: 0;padding: 0;border: none;"></iframe>`);var sideMenu = {"tabs" : [{"title" : translations.edit,"icon" : "","href" : "","divider" : "1"},{"id" : "languagesManager","title" : translations.languages,"icon" : "menu-icon fal fa-language","href" : "/versions/2/wizard/languagesManager/index.php?w={{websiteID}}"}]};if ( languageID ) {var src = '/versions/2/wizard/languagesManager/translate.php?w='+websiteID+'&id='+languageID;} else {var src = '/versions/2/wizard/languagesManager/index.php?w='+websiteID;}
if ( $('html').data('device') !== 'mobile' ) {html = BuildModuleSideMenu(moduleID,heighestHeightNUM,sideMenu,activeTab);ModuleSideMenuClickEvent('languagesManagerIframe',false,html,modalID,src,heighestHeightNUM);} else {heighestHeightNUM-=70;html = BuildMobileModuleSideMenu(moduleID,heighestHeightNUM,sideMenu,activeTab);ModuleSideMenuClickEvent('languagesManagerIframe',true,html,modalID,src,heighestHeightNUM);}
$('#languagesManager').find('#sidebar-preview-button').remove();},hideCallback: function ( event, modal ) {modal.isKeepBackdrop = true;if ( !is_unsave_changes(modal.$html,modal.$html.find('#languagesManagerIframe'),event) ) {modal.isKeepBackdrop = false;GetActiveLanguages();if (viewButtonReload==false) {isPreviewReload = true;RefreshPreview();} else {viewButtonReload = false;}}}});ActionButtons.init();GetImageAttributes();FitWizardTextToBox();FontsSelectInitialize();$('.s123-collapse-settings:not(.static) .title').on('click',function() {var $this = $(this);var $s123CollapseSettings = $this.parent('.s123-collapse-settings');var $content = $s123CollapseSettings.find('.content');if ( $s123CollapseSettings.hasClass('open') ) {close();} else {open();}
if ( $this.hasClass('s123-custom-settings') ) {if ( $('#websitePreviewIframe').attr('data-design-mobile-preview') == 'true' ) {Wizard.Preview.Scale.deviceButtonsClick($('#previewScaleDevices').find('li[data-device-type="computer"]'));$('#websitePreviewIframe').attr('data-design-mobile-preview',false);} else if ( $this.hasClass('s123-mobile-settings') ) {if ( Wizard.Preview.ready && $this.closest('.s123-collapse-settings').hasClass('open') ) {Wizard.Preview.Scale.deviceButtonsClick($('#previewScaleDevices').find('li[data-device-type="mobile"]'));}
$('#websitePreviewIframe').attr('data-design-mobile-preview',true);}}
$s123CollapseSettings.siblings('.s123-collapse-settings.open').find('.content').slideToggle();$s123CollapseSettings.siblings('.s123-collapse-settings').removeClass('open');function open() {$s123CollapseSettings.find('.content').slideToggle();$s123CollapseSettings.addClass('open');$(document).trigger('s123_collapse_settings.open',[$s123CollapseSettings]);$(document).on('animation_manager.hide.s123_collapse_settings', function( event, id ) {if ( $this.closest('.panel-collapse').length > 0 && id === '#'+$this.closest('.panel-collapse').get(0).id ) {close();}});}
function close() {$s123CollapseSettings.find('.content').slideToggle();$s123CollapseSettings.removeClass('open');$(document).trigger('s123_collapse_settings.close',[$s123CollapseSettings]);$(document).off('animation_manager.hide.s123_collapse_settings');}});$('#backgroundTypeSelect').click(function() {if ($('#backgroundTypeSelectBOX').is(":visible")) {$('#backgroundTypeSelectBOX').fadeOut();} else {$('#backgroundTypeSelectBOX').fadeIn();}});updateUserText();$('#home_siteSlogan, #home_siteSlogan_2, #home_SecondSiteSlogan, #home_buttonText, #home_buttonText_1').on('input',function() {updateUserText();});SetHomepageInlineType('onLoad');SetHomepageInlineType_Build_second_homepage_goal('onLoad','');SetHomepageInlineType_ShowHideAllSettingsBox('onLoad');SetHomepageInlineType_Build_homepage_goal_place('onLoad','');SetHomepageInlineType_homepage_layout_kind('onLoad');SetHomepageInlineType_Update_homepage_goal_place('onLoad');$('#homepage_goal_type').on('change.update_type', function(event, flagStatus) {var $this = $(this);var previousVal = $this.data('previous-val');$this.data('previous-val',$this.val());if ( !flagStatus ) {holdWizardSave = true;if ( previousVal == 'buttons' || $this.val() == 'buttons' ) {SetHomepageInlineType('');} else {if ( $this.find('option[value="'+$this.val()+'"]').data('paid-website') == false ) {$this.val(previousVal);$this.data('previous-val',previousVal);topWindow.upgradeFeaturesManager.show({featureID: 'homepageGoal'});return false;} else {SetHomepageInlineType('onChange');}}
holdWizardSave = false;} else {SetHomepageInlineType(flagStatus);}});$('#homepage_second_goal_type').on('change.update_type', function(event, flagStatus) {if ( !flagStatus ) {holdWizardSave = true;SetHomepageInlineType_ShowHideAllSettingsBox('onChange');holdWizardSave = false;} else {SetHomepageInlineType_ShowHideAllSettingsBox(flagStatus);}});$('#homepage_layout_kind').on('change', function(event, flagStatus) {if ( !flagStatus ) {holdWizardSave = true;SetHomepageInlineType_homepage_layout_kind('onChange');holdWizardSave = false;} else {SetHomepageInlineType_homepage_layout_kind(flagStatus);}});$('#homepage_goal_place').on('change.update_place', function(event, flagStatus) {if ( !flagStatus ) {holdWizardSave = true;SetHomepageInlineType_Update_homepage_goal_place('onChange');holdWizardSave = false;} else {SetHomepageInlineType_Update_homepage_goal_place(flagStatus);}});$('#homepage_goal_position').on('change', function(event, flagStatus) {});$('.btnSettings.s123-i-t-text-design').on('click.showFonts', function() {var $this = $(this);$($this.data('s-b-id')).find('.chosen-container.chosen-container-single').trigger('mousedown');$($this.data('s-b-id')).find('.chosen-drop').off('mousedown.stop-setting-box-mouse-click').on('mousedown.stop-setting-box-mouse-click','li', function( event ) {event.stopPropagation();});});window.onbeforeunload = function (e) {if (disableLeavePopup==false) {var message = "Do you want to leave the interface?",e = e || window.event;if (e) {e.returnValue = message;}
return message;}};window.wizardTitleSuffix = document.title.replace($('#name').val(),'');LayoutPickupManager();$('#template, #header_opacity, #header_width, #header_style, #header_size, #header_logo_back_color').on('change', function() {LayoutPickupManager();});WebsiteBackgroundImageHandler();$('#templates_tabs > div').on('click',function() {var tab = $(this).data('tab');$('#homepageTemplates .tabContent').removeClass('active');$('#'+tab).addClass('active');$('#templates_tabs > div').removeClass('active');$(this).addClass('active');});$('#alreadyHaveDomain a.old').on('click',function() {if ($('#newDomain').is(":visible")) {$('#newDomain').fadeOut(100,function() {$('#existingDomain').fadeIn();});$('#alreadyHaveDomain .old').hide();$('#alreadyHaveDomain .new').show();}});$('#alreadyHaveDomain a.new').on('click',function() {if (!$('#newDomain').is(":visible")) {$('#existingDomain').fadeOut(100,function() {$('#newDomain').fadeIn();});$('#alreadyHaveDomain .new').hide();$('#alreadyHaveDomain .old').show();}});$('.wizard-accordion').on('show.bs.collapse', function () {$(this).scrollParent().scrollTop(0);});$('#websitePreviewIframe').load(function() {$(this).data('reload-process',false);PreviewExternalLinksHandler();Wizard.Preview.init();scrollToPointInPreview();if ( $('#previewButtons').data('active-btn') === 'mobile'
|| $('#previewButtons').data('active-btn') == 'tablet' ) {if ( Wizard.Preview.ready ) {Wizard.Preview.window.Parallax_active(false);}}})
.attr('src','/?w='+$('#id').val()+'&disableCache='+getRandomInt(0,9999999));$("select[data-expandto]").focus(function(){$(this).attr("size",$(this).data("expandto"));var x = "select[tabindex='" + (parseInt($(this).attr('tabindex'),10) + 1) + "']";$(x).fadeTo(50,0);});$("select[data-expandto]").blur(function(){$(this).attr("size",1);var x = "select[tabindex='" + (parseInt($(this).attr('tabindex'),10) + 1) + "']";$(x).fadeTo('fast',1.0);});$(document).on('animation_manager.show', function( event, selector ) {switch ( selector ) {case '#homepageCollapse88':Wizard.readyTextLayoutsHandler.printTextLayouts();break;}});$('#home_buttonText_icon, #home_buttonText_1_icon').on('change',function( event, flagStatus ) {if ( flagStatus != 'ReadyTemplateChange' ) return;var id = $(this).attr('id');var icon = $(this).val();if ( icon.length > 0 ) {UpdateImagePreview(id, { icon: icon });} else {topWindow.uploadFiles[id].btns.remove.trigger('click');}});$('#home_video_background, #home_custom_image').on('change',function() {var id = $(this).attr('id');var uploadFile = topWindow.uploadFiles[id];if ( id != 'home_video_background' ) {var image = $('#'+id+'').val();var tiny_image = getImageWRV1(100,image);if ( image.indexOf('unsplash.com') !== -1 ) {tiny_image = image.replace("&w=2500", "&w=100");}
UpdateImagePreview(id, { normal: image, tiny: tiny_image });}
if ( id == 'home_custom_image' && $('#home_custom_image_size').val().length == 0 ) {$('#home_custom_image_size').val(500);}
UploadLibraryImageToUserWebsite(id);});PrintWebsiteStructures();ShowIconStyle();$('#siteLogo').on('change',function() {ShowIconStyle();var size = 80;$('#logo_img_size_slider').slider('value',size);$('#logo_img_size_view .slider-input-value').val(size);$('#logo_img_size').val(size);});logoFontStyleHandler();homepageFontsWeightHandler();$('#WebsiteThemeAdvancedOptions').click(function() {if ( !$('#WebsiteThemeAdvancedOptionsBOX').is(':visible') ) {$('#WebsiteThemeAdvancedOptions').html(translations.BackToReadyStructure);$('#WebsiteColorsManage').hide();$('#WebsiteThemeAdvancedOptionsBOX').fadeIn();} else {$('#WebsiteThemeAdvancedOptions').html(translations.AdvancedOptions);$('#WebsiteColorsManage').fadeIn();$('#WebsiteThemeAdvancedOptionsBOX').hide();}});$('.tab-content').addClass('fancy-scrollbar');ActiveDisableInsideAdsManager();$('#ad_manger_active').on('change',function() {ActiveDisableInsideAdsManager();if ($('#ad_manger_active').is(":checked")==true) {$('#adManagerInsideLevel').show();} else {$('#adManagerInsideLevel').hide();}});$('#wizardTab8button').on('click',function() {CheckIfTheUserHaveAdsPromoOnHomepageModules();});SetHomepageGoal();autosize($('textarea[class*=autosize]'));let congratulationModal = SystemModals.sm_get('congratulationModal');if ( newUser == true ) {if ( $('html').data('device') !== 'mobile' ) {if ( t_language == 'en' && s_whitelabel_uniqueID == 'site123_label' ) {} else {congratulationModal.$html.find('.modal-dialog').addClass('no-video');}
congratulationModal.show();}
if (window.fbq && fbq && numberOfWebsitesForUser=='1') {fbq('track', 'Lead');}}
$('#all_fonts').change(function( event, flag ) {if ( flag == 'UndoRedoChange' ) return;fontsGlobalChange();});$('#customTemplate').change(function(){SetLayout($('#customTemplate').val(),0);showHideStickyMenuSetting();});showHideStickyMenuSetting();Library.init({customClass: 'library-editor-b',translations: {imageLibrary: translations.library_imageLibrary,close: translations.library_close}});SystemModals.sm_get('videoLibrary').$html
.add(SystemModals.sm_get('imageLibrary').$html)
.on('show.bs.modal', function() {var $this = $(this);if ( !$this.hasClass('off-canvas-mode') ) return;var uploadFileInputId = $this.data('uploadFileInputId');if ( $this.get(0).id == 'videoLibrary' ) {if ( $this.get(0).lastUploadFileInputId && $this.get(0).lastUploadFileInputId != uploadFileInputId ) {$this.find('#videoLibraryModal').get(0).contentWindow.refreshLibrary();}
$this.get(0).lastUploadFileInputId = uploadFileInputId;} else if ( $this.get(0).id == 'imageLibrary' && $this.find('#flickrLibraryModal').get(0).contentWindow.refreshLibrary ) {$this.find('#flickrLibraryModal').get(0).contentWindow.refreshLibrary();}});$('#popUpPreview').on('show.bs.modal', function (event) {var modal = $(this);modal.find('.modal-body').html('<div style="width:100%;height:80vh;-webkit-overflow-scrolling:touch;overflow:auto;"><iframe id="popUpPreviewIframe" src="/?w='+websiteID+'&disableCache='+getRandomInt(0,9999999)+'" style="width:100%;height:80vh;margin:0;padding:0;border:none;"></iframe></div>');});$('#imageIcons').on('show.bs.modal', function (event) {var modal = $(this);var src = '/versions/2/wizard/imageIcons/index.php?w=' + websiteID;if ( modal.data('uploadFileInputId') === 'siteLogo' ) src += '&hideTrademark=1';modal.find('.modal-body').html('<iframe id="imageIconsModal" src="' + src + '" style="width:100%;height:500px;margin:0;padding:0;border:none;"></iframe>');});congratulationModal.eventReg('shown', function (event) {$.ajax({type: "POST",url: "/manager/domain/getDomainStringFromName.php",data: 'w='+$('#id').val()+'',success: function(data) {$('#welcomeMessage_showSearchDomainIframe').html('<div id="SetDomainQuickSearchWidget_gg3204343h122_welcome" class="SetDomainQuickSearchWidget" data-publish="1" data-website-id="'+websiteID+'" data-design-style="light" data-load-domain="'+data+'" data-upgrade-reason="multiSearchCongratulationModal"></div>');SearchDomain.init();}});});congratulationModal.eventReg('hide', function (event) {congratulationModal.updateHTML('body','');});LoadModulesLists();$("#wizardForm").submit(function(e) {SaveWizard();e.preventDefault(); // avoid to execute the actual submit of the form.
});var tid = setInterval(AutoSaveInerval, 2000);$(".inputChangeOnlySave").on('input', function() {if ( holdWizardSave ) return;clearTimeout(this.finishedTyping);this.finishedTyping = setTimeout( function() {AutoSaveWizard(false,true);},doneTypingInterval);});$(".inputChangeReload").on('change', function(event, flagStatus) {if ( holdWizardSave ) return; //Can be remove soon
if ( this.id === 'language' ) {window.reloadWizardAfterSave = true;window.reloadWizardAfterSaveMessage = translations.wizardLanguageReload;}
window.scrollPreview = $(this).data('scroll-preview');AutoSaveWizard(true,true);});$('input:not([type="checkbox"]):not([type="radio"]).inputChangeReload').on('input', function() {ChangePreviewLive(this);if ( holdWizardSave ) return;clearTimeout(typingTimer);typingTimer = setTimeout(doneTyping, doneTypingInterval);});$('.inputChangeLive').on('change', function(event, flagStatus) {ChangePreviewLive(this);if ( holdWizardSave ) return; //Can be remove soon
window.scrollPreview = $(this).data('scroll-preview');isWizardChange = true;isPreviewReload = false;});$("input.inputChangeLive,textarea.inputChangeLive").on('input', function( event, skipPreviewUpdate ) {if ( !skipPreviewUpdate ) ChangePreviewLive(this);if ( holdWizardSave ) return;clearTimeout(window.inputChangeLive_finishedTyping);window.inputChangeLive_finishedTyping = setTimeout( function() {window.scrollPreview = $(this).data('scroll-preview');AutoSaveWizard(false,true);},doneTypingInterval);});$(".inputReloadPreviewCSS").on('change', function(event, flagStatus) {if ( holdWizardSave ) return; //Can be remove soon
window.reloadPreviewCSS = ReloadPreviewCSS;AutoSaveWizard(false,true);});$("input.inputReloadPreviewCSS").on('input', function( event ) {if ( holdWizardSave ) return;window.reloadPreviewCSS = ReloadPreviewCSS;AutoSaveWizard(false,true);});$("[data-update-preview-area]").on('change', function(event, flagStatus) {var $this = $(this);if ( holdWizardSave ) return; //Can be remove soon
window.scrollPreview = $this.data('scroll-preview'); scrollToPointInPreview();$("#wizardForm").off('ajaxSuccess').one( 'ajaxSuccess', function( event ) {if ( $this.data('update-preview-homepage-redirect') && !IsPreviewAtHomepage() ) {isPreviewReload = true;RefreshPreview();if ( $('.chooseUniqueStyle').data('template-change-in-progress') ) {$('.chooseUniqueStyle').trigger('style_change',false);}} else {UpdatePreviewAreaByAjax($this.data('update-preview-area'),false,false,'');}});AutoSaveWizard(false,true);});$(".formatOptionsHelpLink").click(function() {$('#advancedFormatOptions').modal('show');});$("#publishWebsiteButton").on('click', function(event) {if (wizardReadyToGo==false) {WizardLoadError();return false;}
var isFormValid = CheckIfFormValid();let $this = $(this);if ( $this.attr('data-open-swal-popup') == 'false' ) {$this.attr('data-open-swal-popup','true');}});$("#publishWebsiteChanges").on('click', function() {$("#publishWebsiteButton").trigger('click');});$("#resetWebsiteChanges").on('click', function() {var $this = $(this);if( $this.data('main-manager') ) {bootbox.confirm({title: translations.websiteRestChanges.title,message: translations.websiteRestChanges.message,buttons: {confirm: {label: translations.ok,className: 'btn-danger',},cancel: {label: translations.Cancel,className: '',}},callback: function(result) {if (result==true) {if( result ) {$.ajax({type: "POST",url: "/versions/2/wizard/reset.php",data: 'w='+websiteID+'', // serializes the form's elements.
success: function(data) {location.reload();}});}}}});} else {var html = '<div style="margin-top:30px;"><b>' + translations.websiteRestChanges.blockMsg + '</b></div>';Swal.fire({html: $(html).get(0),icon: 'error',confirmButtonText: translations.ok,confirmButtonColor: 'var(--primary_color)',}).then(( result ) => {});}});$("#previewButtons").on('click', function() {if (wizardReadyToGo==false) {WizardLoadError();return false;}
var isFormValid = CheckIfFormValid();$("#previewButtons").tooltip('hide');$("#previewButtons").one('shown.bs.confirmation', function () {$('.popover.confirmation.in').off('click').click(function(event) {event.preventDefault();event.stopPropagation();});});if ( $('.previewDevices.popover').is(':visible') ) {hidePopover();return;}
$("#previewButtons").popover({container: 'body',content: $('#previewScaleDevices'),html: true,trigger: 'manual',template: '<div class="popover previewDevices" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',placement: window['isTouchSupported'] ? 'auto' : intrface_align_reverse});$("#previewButtons").popover('show');$('#previewButtons').on('shown.bs.popover', function () {setTimeout(function() {var prevActive = $('#previewButtons').attr('data-prev-active');if (typeof prevActive !== typeof undefined && prevActive !== false) {$('.previewDevices .devicesPreviewContent li').removeClass('active');$('.previewDevices .devicesPreviewContent li[data-device-width='+$('#previewButtons').attr('data-prev-active')+']').addClass('active');} else {$('.previewDevices .devicesPreviewContent li[data-device-width=1280]').addClass('active');}},100);});$('#previewButtons').on('shown.bs.popover', function () {$(document).on('mousedown.previewButtonDestroyPopover', function ( event ) {if ( $(event.target).closest('#previewButtons').length > 0 ) return;if ( $(event.target).closest('.popover.previewDevices').length === 0 ) {hidePopover();}});$(window).one('blur.previewButtonDestroyPopover', function( event ) {hidePopover();});});function hidePopover() {$('#previewButtons').popover('hide');$(document).off('mousedown.previewButtonDestroyPopover');$(window).off('blur.previewButtonDestroyPopover');}});$(document).on('click', '.bootbox', function(event) {var target = event.target;while(target !== this){target = target.parentNode;if(target.className.indexOf('modal-dialog') !== -1){return;}}
bootbox.hideAll();});$('#closeWizardSmallIcon').click(function() {website_desktop_view();});Wizard.Pages.sortable.init($('#sortable'),3);$('#wizardForm').validate({errorElement: 'div',errorClass: 'help-block',focusInvalid: true,ignore: '.ignore',highlight: function (e) {$(e).closest('.form-group').removeClass('has-info').addClass('has-error');},success: function (e) {$(e).closest('.form-group').removeClass('has-error');$(e).remove();},errorPlacement: function (error, element) {if( element.is('input[type=checkbox]') || element.is('input[type=radio]') ) {var controls = element.closest('div[class*="col-"]');if( controls.find(':checkbox,:radio').length > 1 ) controls.append(error);else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));}
else if( element.is('.select2') ) {error.insertAfter(element.siblings('[class*="select2-container"]:eq(0)'));}
else if( element.is('.chosen-select') ) {error.insertAfter(element.siblings('[class*="chosen-container"]:eq(0)'));}
else {error.appendTo(element.closest('.form-group'));}}});ShowEditButtonsOnActive();$('[data-toggle=mytabs]').click(function ( event, selector = '' ) {event.preventDefault();event.stopPropagation();var $this = $(this);if ( $this.hasClass('disable-open-wizard-tab') ) return;var isFormValid = CheckIfFormValid();var tabID = $this.data('tab-id');if ( tabID == 'pagesTab' && ($('#pagesTab').hasClass('inline-module-active') || RichPage.isActive) && selector != 'close-wizard-tab-btn' ) {$('#pagesTab .inline-module').hide();$('#pagesTab fieldset.pages').fadeIn(250);$('#pagesTab').removeClass('inline-module-active');OpenWizardTab(tabID,true,selector);} else if ( tabID == 'designTab' ) {$('#designSubTabs').val('colors');if ( $('#'+tabID).is(":visible") ) {$('#designSubTabs').trigger('change');} else {Wizard.tabEffectHandler.AnimationManager.designTab.$tab.find('.t-h-e-manual-static').attr('data-visible','true');Wizard.tabEffectHandler.AnimationManager.designTab.$tab.find('.t-h-e-manual-static .text-container').text($(this).data('static-tab-title-text'));Wizard.tabEffectHandler.designTabHandler.innerTabsHanler.$linkContainer.find('[data-tab="colorThemes"]').trigger('click');Wizard.tabEffectHandler.AnimationManager.designTab.$tab.find('.t-h-e-header-back-btn').hide();Wizard.tabEffectHandler.AnimationManager.designTab.$tab.find('#accordion_design').removeClass('back-btn-h');}
OpenWizardTab(tabID,false,selector);$this.trigger('wizard.tab.click');} else {OpenWizardTab(tabID,false,selector);$this.trigger('wizard.tab.click');}});$('.premiumFeatureMessage').click(function() {topWindow.upgradeFeaturesManager.show({featureID: $(this).data('u-f-m-id')});});$('.premiumFeatureMessageItem').click(function( event ) {event.preventDefault();event.stopPropagation();topWindow.upgradeFeaturesManager.show({featureID: $(this).data('u-f-m-id')});});$('#analytics_code,#google_webmaster_tool_code,#bing_webmaster_tool_code,#yandex_webmaster_tool_code,#google_remarketing_tag,#facebook_pixel_code').on('input', function() {$this = $(this);$this.trigger('change');if ($('#analytics_code').val()=='' && $('#google_webmaster_tool_code').val()=='' && $('#bing_webmaster_tool_code').val()=='' && $('#yandex_webmaster_tool_code').val()=='' && $('#google_remarketing_tag').val()=='' && $('#facebook_pixel_code').val()=='') {$('#managePluginButtons').show();} else {$('#managePluginButtons').hide();}});$('#pluginsModal').on('show.bs.modal', function (event) {var modal = $(this);var activeTab = 'index.php';var moduleID = '';var heighestHeightNUM = $(window).outerHeight(true) - 170;var sideMenu = {"tabs" : [{"title" : translations.edit,"icon" : "","href" : "","divider" : "1"},{"id" : "pluginsManager","title" : translations.plugins,"icon" : "menu-icon fal fa-plug","href" : "/versions/2/wizard/plugins/index.php?w={{websiteID}}"},{"id" : "addNewPlugin","title" : translations.addNewPlugin,"icon" : "menu-icon fal fa-plus","href" : "/versions/2/wizard/plugins/system/plugins.php?w={{websiteID}}"}]};if ( $(event.relatedTarget).data('plugin-id') ) {var src = '/versions/2/wizard/plugins/edit.php?w='+websiteID+'&id='+$(event.relatedTarget).data('plugin-id')+'';} else {var src = '/versions/2/wizard/plugins/index.php?w='+websiteID+'';}
if ( $('html').data('device') !== 'mobile' ) {html = BuildModuleSideMenu(moduleID,heighestHeightNUM,sideMenu,activeTab);ModuleSideMenuClickEvent('pluginsManagerIframe',false,html,modal,src,heighestHeightNUM);} else {html = BuildMobileModuleSideMenu(moduleID,heighestHeightNUM,sideMenu,activeTab);ModuleSideMenuClickEvent('pluginsManagerIframe',true,html,modal,src,heighestHeightNUM);}
modal.find('#sidebar-preview-button').remove();});$('#pluginsModal').on('hide.bs.modal', function (event) {var modal = $(this);modal.find('.modal-body').empty();AutoSaveWizard(true,true);});$('#globalModal').on('show.bs.modal', function (event) {var $modal = $(this);var $relatedTarget = $(event.relatedTarget);var modalID             = $modal.attr('id');var customZindex        = $relatedTarget.data('zindex');var customSize          = $relatedTarget.data('size');var customBeforerun     = $relatedTarget.data('beforerun');var customAfterhide     = $relatedTarget.data('afterhide');if (typeof customZindex !== "undefined" && customZindex=='high') {$modal.css('z-index',999999);$('#'+modalID+'_backdrop').css('z-index',999990);} else {$modal.css('z-index',1050);$('#'+modalID+'_backdrop').css('z-index',1040);}
if (customSize=='small') {$modal.find('.modal-dialog').css('width','600px');} else if (customSize=='medium') {$modal.find('.modal-dialog').css('width','900px');} else {$modal.find('.modal-dialog').css('width','90%');}
if (typeof customBeforerun !== "undefined" && customBeforerun!='') {window[customBeforerun]();}
if (typeof customAfterhide !== "undefined" && customAfterhide!='') {$modal.data('afterhide',customAfterhide);} else {$modal.removeData('afterhide');}
if ( $modal.data('manual') ) {var url = $modal.data('manual-url');var title = $modal.data('manual-title');var modalSize = $modal.data('manual-size');if ( modalSize == 'medium' ) {$modal.find('.modal-dialog').css('width','900px');}
$modal.data('manual',false);} else {var url = $relatedTarget.data('url');var title = escapeHtml($relatedTarget.data('title'));}
$modal.find('.modal-title').html(title);var heighestHeightNUM = $(window).outerHeight(true)-170;$modal.find('.modal-body').html('<iframe id="globalModalIframe" src="' + url + '" style="width: 100%;height: '+heighestHeightNUM+'px;margin: 0;padding: 0;border: none;"></iframe>');});$('#globalModal').on('hide.bs.modal', function (event) {var $modal = $(this);var modalID             = $modal.attr('id');var customAfterhide     = $modal.data('afterhide');var disableWizardSave   = $modal.data('disable-wizard-save');var noContentReset      = $modal.data('no-content-reset');if (typeof customAfterhide !== "undefined" && customAfterhide!='') {window[customAfterhide]();}
if ( !noContentReset ) $modal.find('.modal-body').empty();if ( !disableWizardSave ) AutoSaveWizard(true,true);});ManageLanguageButtonActiveEvent();LoadModuleFunctions();MakeSureWizardReadyToGo();AddKeyboardShortcuts();GetActivePlugins();GetActiveLanguages();(function() {$("#activeReplyMessageHomepage").on('change', function() {showHideContent();});if ( ProFeature_isLimit({'websiteID' : websiteID,'packageNUM' : packageNUM,'toolType': 'formAutoReplyMessage','openPremiumFeatures': openPremiumFeatures})) {$('#activeReplyMessageHomepage').off('click').on('click.pro',function( event ) {event.preventDefault();event.stopPropagation();ProFeature_limit({'websiteID' : websiteID,'packageNUM' : packageNUM,'toolType': 'formAutoReplyMessage','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'formAutoReplyMessage'});});$('#activeReplyMessageHomepage').prop('checked',false);showHideContent();}
ProFeature_addLabel({'websiteID' : websiteID,'packageNUM' : packageNUM,'limitedToPackageNUM' : '1','toolType' : 'formAutoReplyMessage','$element' : $('#homepage_auto_reply_message label')});function showHideContent() {if ( $('#activeReplyMessageHomepage').is(":checked") ) {$('#reply_subject_message_homepage').closest('.form-group').removeClass('hidden');$('#reply_message_homepage').closest('.form-group').removeClass('hidden');} else {$('#reply_subject_message_homepage').closest('.form-group').addClass('hidden');$('#reply_message_homepage').closest('.form-group').addClass('hidden');}}})();(function() {if ( ProFeature_isLimit({'websiteID' : websiteID,'packageNUM' : packageNUM,'toolType': 'formConversionCode','openPremiumFeatures': openPremiumFeatures})) {$('#homepage_conv_code').closest('.form-group').off('click').on('click.pro',function( event ) {event.preventDefault();event.stopPropagation();ProFeature_limit({'websiteID' : websiteID,'packageNUM' : packageNUM,'toolType': 'formConversionCode','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'formConversionCode'});});$('#homepage_conv_code').addClass('pro-feature-disable-field');}
ProFeature_addLabel({'websiteID' : websiteID,'packageNUM' : packageNUM,'limitedToPackageNUM' : '1','toolType' : 'formConversionCode','$element' : $('#homepage_conv_code').closest('.form-group').find('label')});})();$("#reply_message_homepage").change(function() {AutoSaveWizard(false,true);});$("#reply_subject_message_homepage").change(function() {AutoSaveWizard(false,true);});$("#activeReplyMessageHomepage").change(function() {AutoSaveWizard(false,true);});$('#unlockFeature').on('hide.bs.modal', function (event) {var modal = $(this);modal.find('.modal-body').empty();});$("#homepage_conv_code").change(function() {AutoSaveWizard(false,true);});var EmailCollector = new S123EmailCollector({$el: $('#homepage_email_collector'),addCallback: function() {AutoSaveWizard(false,true);},removeCallback: function() {AutoSaveWizard(false,true);}});$('#homepage_email_notification').off('change').on('change', function(){var $this = $(this);if ( $this.val() == '' ) {EmailCollector.$el.closest('.form-group').removeClass('hidden');} else {EmailCollector.$el.closest('.form-group').addClass('hidden');}}).trigger('change');$('#ad_manger_active').change(function() {AutoSaveWizard(true,true);});$('#ad_manager_code').on('input', function() {$('.ad_manager_code_warning').removeClass('hidden');$('#ad_manager_code').off('input');});Wizard.init();upgradeFeaturesManager.init({'websiteID': websiteID,'packageNUM': packageNUM,'website_uniqueID': website_uniqueID,});WebsiteNotification.init({page_type: 'wizard',user_id: user_id,websiteID: websiteID,website_uniqueID: website_uniqueID,trialBOO: trialBOO,light_mode: light_mode,$container: $('.site123-home-button'),popover_placement: intrface_align_reverse});SetVideoType();$('#videoType').on('change',function(){SetVideoType();});$('#mobileMenuColor').change(function() {var $input = $('#customTemplate');var $showMobileMenuColorExp = $('#showMobileMenuColorExp');var timer = null;if ( $input.children(':selected').data('header-layout') == 3 ) {$showMobileMenuColorExp.fadeIn(200,function(){setTimeout(function(){$showMobileMenuColorExp.stop().fadeOut(200);},20000);});} else {$showMobileMenuColorExp.stop().fadeOut();}});$("#activeHomepageCustomForm").on('change', function() {if ( $(this).is(":checked") ) {$('#customFormManageButton').show();} else {$('#customFormManageButton').hide();}});$('input[name=onepage]').on('change', function() {if ( IsSinglePage() ) {$('.one-page-no-popups-box').fadeIn(600);showWebsiteTypeVideo(1);} else {$('.one-page-no-popups-box').fadeOut(600);showWebsiteTypeVideo(2);}
$(document).trigger('websiteType.change',[IsSinglePage()]);if ( IsLandingPage() || (abTestTXT == 'siteEditor_b' && $('#collapseFour').data('previous-onepage') == '2') ) {var id = IsLandingPage() ? 1 : 16014;if ( abTestTXT != 'siteEditor_b' ) {id = 1;}
var module = websiteThemeArray[id];$('#websiteStructureNUM').val(id).trigger('change.updateActiveClass');$('#template').val(module.template);$('#header_width').val(module.header_width);$('#header_opacity').val(module.header_opacity);$('#header_logo_back_color').val(module.header_logo_back_color);PrintWebsiteStructures();}
$('#collapseFour').data('previous-onepage',$('input[name=onepage]:checked').val());AutoSaveWizard(true,true);});WizardMobileHendlar();$('#wizardTab9button,#domainAccordionLink').click(function() {if ($('#SetDomainQuickSearchWidget_wizardDomainTab').length==0) {$.get( '/manager/domain/checkDomainSuggestReturnHTML_v1.php', {w: websiteID}).done(function( data ) {if ($('#newDomain').find('.content').html()=='') {$('#newDomain').find('.content').html('<div id="SetDomainQuickSearchWidget_wizardDomainTab" class="SetDomainQuickSearchWidget" data-wizard="1" data-website-id="'+websiteID+'" data-load-domain="'+data+'" data-upgrade-reason="multiSearchDomainTab"></div>');SearchDomain.init();}});}});$('#home_background_color').on('change.reset_gradients',function( event, flagStatus ) {$('#homepageGradientsColors').val('');Wizard.render.init('home_background_color');Wizard.render.init('homepageGradientsColors');if ( ['UndoRedoChange','uploadFileChange','ReadyTemplateChange','homepageImageLibraryChange'].indexOf(flagStatus) == -1 ) {Wizard.homePageChangingImages.removeMedia();$('#homepage_style').val('3').trigger('change.set_homepage_style');if ( Wizard.Preview.ready ) {Wizard.Preview.window.Parallax_active(false);}}});$('#homepageGradientsColors').on('change.reset_bg_color',function( event, flagStatus ) {$('#home_background_color').spectrum("set",'#222');$('#home_background_color').val('');Wizard.render.init('home_background_color');Wizard.render.init('homepageGradientsColors');if ( flagStatus != 'UndoRedoChange' ) {Wizard.homePageChangingImages.removeMedia();if ( Wizard.Preview.ready ) {Wizard.Preview.window.Parallax_active(false);}}});AddModuleWinHandler();(function() {ProFeature_addLabel({'userID' : user_id,'packageNUM' : packageNUM,'limitedToPackageNUM' : '1','toolType' : 'showHeaderSearch','$element' : $('.searchToolLabel'),'clickable' : true,'upgradeReason' : 'showHeaderSearch'});$('#showHeaderSearch').on('change.limit_pro', function( event ) {return false;var $this = $(this);ProFeature_limit({'userID' : user_id,'packageNUM' : packageNUM,'toolType': 'showHeaderSearch','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'showHeaderSearch',callback : function( limit ) {if ( limit ) $this.prop('checked',false);}});});if ( ProFeature_isLimit({'userID' : user_id,'packageNUM' : packageNUM,'toolType': 'showHeaderSearch','openPremiumFeatures': openPremiumFeatures})) {$('#showHeaderSearch').off('click').on('click.pro',function( event ) {event.preventDefault();event.stopPropagation();ProFeature_limit({'userID' : user_id,'packageNUM' : packageNUM,'toolType': 'showHeaderSearch','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'showHeaderSearch'});});$('#showHeaderSearch').prop('checked',false);}
ProFeature_addLabel({'websiteID' : websiteID,'packageNUM' : packageNUM,'limitedToPackageNUM' : '1','toolType' : 'menuActionButtons','$element' : $('.actionButtonsToolLabel'),'clickable' : true,'upgradeReason' : 'menuActionButtons'});if ( ProFeature_isLimit({'websiteID' : websiteID,'packageNUM' : packageNUM,'toolType': 'menuActionButtons','openPremiumFeatures': openPremiumFeatures})) {$('#showActionsButtons').off('click').on('click.pro',function( event ) {event.preventDefault();event.stopPropagation();ProFeature_limit({'websiteID' : websiteID,'packageNUM' : packageNUM,'toolType': 'menuActionButtons','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'menuActionButtons'});});$('#showActionsButtons').prop('checked',false);ShowEditButtonsOnActive();}})();(function() {$('#showMailing,#showTerms,#showPrivacy,#showCookieConsent,#showAccessibility').each(function( index, el ) {const $el = $(this);let toolType = 'footerLimit';switch( $el.get(0).id ) {case 'showMailing':toolType = 'footerLimit_mailing';break;case 'showTerms':toolType = 'footerLimit_termsAndService';break;case 'showPrivacy':toolType = 'footerLimit_privacyAndPolicy';break;case 'showCookieConsent':toolType = 'footerLimit_cookie';break;case 'showAccessibility':toolType = 'footerLimit_accessibility';break;}
ProFeature_addLabel({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': toolType,'$element': $(`.footerLimitProLabel[data-pro-rel="${$el.get(0).id}"]`),'clickable': true,'upgradeReason': toolType});if ( ProFeature_isLimit({'websiteID': websiteID,'packageNUM': packageNUM,'toolType': toolType,'openPremiumFeatures': openPremiumFeatures})) {$el.off('click').on('click.pro',function( event ) {event.preventDefault();event.stopPropagation();ProFeature_limit({'websiteID': websiteID,'packageNUM': packageNUM,'toolType': toolType,'openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': toolType});});$el.prop('checked',false);}});})();$('#s123PopupsEditButton').off('click').on('click', function() {if ( $('#popupsWindow').length > 0 ) {SystemModals.sm_remove('popupsWindow');}
SystemModals.sm_render({id: 'popupsWindow',disposable: false,$parent: $('body'),sizeClasses: 'size-l1',headerSettings: {id: 'moduleSettingsWindowTitle',title: translations.popups.title},bodySettings: { // body settings
content: '&nbsp;'},footerSettings: { // footer settings
isActive: false,buttons: []},showCallback: function ( event, modal ) {var src = '/files/vendor/site123/popups/interface/addPopup.php?w='+ websiteID;var heighestHeightNUM = $(window).outerHeight(true)-170;modal.updateHTML('body','<iframe id="s123PopupsIframe" src="'+src+'" style="width:100%;height:'+heighestHeightNUM+'px;margin: 0;padding: 0;border: none;"></iframe>');}});$('#popupsWindow').modal('show');});$('#s123PopupsPreviewButton').off('click').on('click', function() {if ( !Wizard.Preview.ready ) return;Wizard.Preview.window.s123Popups.displayPopupFromWizard();});(function() {ProFeature_addLabel({'websiteID' : websiteID,'packageNUM' : packageNUM,'limitedToPackageNUM' : '3','toolType' : 's123PopupsLimit','$element' : $('.s123PopupsLimitProLabel'),'clickable' : true,'upgradeReason' : 's123PopupsLimit'});if ( ProFeature_isLimit({'websiteID' : websiteID,'packageNUM' : packageNUM,'limitedToPackageNUM' : '3','toolType': 's123PopupsLimit','openPremiumFeatures': openPremiumFeatures})) {$('#showS123Popups').off('click').on('click.pro',function( event ) {event.preventDefault();event.stopPropagation();ProFeature_limit({'websiteID' : websiteID,'packageNUM' : packageNUM,'limitedToPackageNUM' : '3','toolType': 's123PopupsLimit','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 's123PopupsLimit'});});$("#showS123Popups").prop('checked',false);}})();(function() {ProFeature_addLabel({'websiteID' : websiteID,'packageNUM' : packageNUM,'limitedToPackageNUM' : '1','toolType' : 'footerLayoutLimit','$element' : $('.footerLayoutLimitProLabel'),'clickable' : true,'upgradeReason' : 'footerLayoutLimit'});if ( ProFeature_isLimit({'websiteID' : websiteID,'packageNUM' : packageNUM,'toolType': 'footerLayoutLimit','openPremiumFeatures': openPremiumFeatures})) {$('#footer_layout').css('pointer-events','none');$('#footer_layout').off('click').on('click.pro',function( event ) {event.preventDefault();event.stopPropagation();ProFeature_limit({'websiteID' : websiteID,'packageNUM' : packageNUM,'toolType': 'footerLayoutLimit','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'footerLayoutLimit'});});}})();$('#homepage_style_tabs').click(function() {imageHomepageLiveEleID = '';});(function () {var milliseconds = newUser ? 120000 : 2000;setTimeout(function() {if ( $('.upgrade-and-discount-button-box').length === 0 ) return;$('.upgrade-and-discount-button-box').css({display: 'flex'}).hide().fadeIn(1000, function() {FitWizardTextToBox();});},milliseconds);})();WizardAddImagesToHistory.init({websiteID: websiteID,$container: $('.lastImages')});Wizard.homePageChangingImages.init();Wizard.homePageBgOptions.init({$container: $('#backgroundOptionsTab'),$popUpContainer: $('body')});Wizard.progressiveWebApp.init({$container: $('#pwaContainer')});$('.chooseUniqueStyle').on('style_change', function( event, showLoading ) {var $this = $(this);$('.chooseUniqueStyle').find('.loading-container').remove();$this.data('template-change-in-progress',false);if ( showLoading ) {$this.data('template-change-in-progress',true);var html = '';html += '<div class="loading-container">';html += '<div class="custom-cover"></div>';html += '<i class="ace-icon fal fa-spinner fa-solid fa-spin white fa-5x"></i>';html += '<div>';$('.chooseUniqueStyle').find('.unique-styles-button-container.active').append(html);}});$('#homepageTab').click(function( event ) {if ( !Wizard.Preview.ready ) return;if ( Wizard.Preview.$('#home_siteSlogan').length === 0 ) return;if ( !Wizard.Preview.window.elementInViewport(Wizard.Preview.$('#home_siteSlogan').parent().get(0)) ) {window.scrollPreview = '#top-section';scrollToPointInPreview();}});addShowHideFontFamilySettingBox();ProFeature_addLabel({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM' : '1','toolType': 'externalLink','$element': $('li .Add-External-Link'),'text': translations.pro});$('#stickyMenu').on('change.preview_helper', function() {GetMenuScrollOffset($('#template').val());});disableEnableMultiPhonesStyle((multiPhones.length > 1 ? 'disable' : 'enable'));Wizard.magicContactButton = new MagicButton({$container: $('#magicButtonContainer'),$json: $('#magicButtonSettings'),translations: translations.magicButton,isRtl: $('html[dir=rtl]').length !== 0,doneTypingInterval: doneTypingInterval,$GLOBALS: $GLOBALS,user_country_code: user_country_code,type: 'contact',availableNetworks: ['faceBookMessanger','whatsApp','phone','contactUs','skype','telegram'],hasGreeter: true,user_name_email: user_name_email,onInitCallback: function( instance ) {if ( ProFeature_isLimit({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': 'contactMagicBtnGreeter'})) {instance.Greeter.disable();ProFeature_addLabel({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': 'contactMagicBtnGreeter','$element': instance.Greeter.$html.find('.g-m-title .pro-label-container')});instance.Greeter.$statusController.on('change.proLimit', function() {ProFeature_limit({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': 'contactMagicBtnGreeter','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'contactMagicBtnGreeter'});});instance.disableOptions(['whatsApp']);ProFeature_addLabel({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': 'contactMagicBtnGreeter','$element': instance.$optionsContainer.find(instance.getDisabledOptionsIDS().join(','))});}},onDisabledOptionClick: function( $option ) {if ( ProFeature_isLimit({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': 'contactMagicBtnGreeter','openPremiumFeatures': openPremiumFeatures})) {ProFeature_limit({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': 'contactMagicBtnGreeter','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'contactMagicBtnGreeter'});}}});Wizard.magicShareButton = new MagicButton({$container: $('#shareMagicButtonContainer'),$json: $('#shareMagicButtonSettings'),translations: translations.magicButton,isRtl: $('html[dir=rtl]').length !== 0,doneTypingInterval: doneTypingInterval,$GLOBALS: $GLOBALS,user_country_code: user_country_code,type: 'share',availableNetworks: ['faceBook','twitter','pinterest','gmail','linkedIn','whatsApp','telegram','tumblr'],hasGreeter: false,onInitCallback: function( instance ) {if ( ProFeature_isLimit({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': 'contactMagicBtnGreeter','openPremiumFeatures': openPremiumFeatures})) {instance.disableOptions(['whatsApp','linkedIn']);ProFeature_addLabel({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': 'contactMagicBtnGreeter','$element': instance.$optionsContainer.find(instance.getDisabledOptionsIDS().join(','))});}},onDisabledOptionClick: function( $option ) {if ( ProFeature_isLimit({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': 'contactMagicBtnGreeter','openPremiumFeatures': openPremiumFeatures})) {ProFeature_limit({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': 'contactMagicBtnGreeter','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'contactMagicBtnGreeter'});}}});$('#homepage_form_button_click_action').change(function() {var $buttonClickActionRedirect = $('.button-click-action-redirect');if ( $(this).val() == 'redirect' ) {$buttonClickActionRedirect.show();} else {$buttonClickActionRedirect.hide();}}).trigger('change');$('#homepage_form_button_link, #homepage_form_button_click_action, #homepage_email_notification').change(function() {AutoSaveWizard(false,true);});(function() {if ( ProFeature_isLimit({'websiteID' : websiteID,'packageNUM' : packageNUM,'toolType': 'formAfterSubmitActions','openPremiumFeatures': openPremiumFeatures})) {$('#homepage_form_button_click_action').off('click').on('click.pro',function( event ) {event.preventDefault();event.stopPropagation();ProFeature_limit({'websiteID' : websiteID,'packageNUM' : packageNUM,'toolType': 'formAfterSubmitActions','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'formAfterSubmitActions'});});$('#homepage_form_button_click_action').addClass('pro-feature-disable-field');}
ProFeature_addLabel({'websiteID' : websiteID,'packageNUM' : packageNUM,'limitedToPackageNUM' : '1','toolType' : 'formAfterSubmitActions','$element' : $('#homepage_form_button_click_action').closest('.form-group').find('label')});})();$('.empty-input-handler').off('focus').on('focus', function() {$(this).data('name',$(this).val());});$('.empty-input-handler').off('blur').on('blur', function() {var $this = $(this);if ( $this.val().length == 0 || $this.val().trim().length == 0 ) {$this.val($this.data('name')).trigger('input');}});RichPage.init({$iframe: $('#websitePreviewIframe')});$(".websitePublishChanges").on('click', function() {if (wizardReadyToGo==false) {WizardLoadError();return false;}
var isFormValid = CheckIfFormValid();var $this = $(this);bootbox.dialog({message: translations.websitePublishChanges.msg.replace('{{changes_number}}',$('#unPublishChanges').val()),buttons: {publishWebsite: {label: translations.websitePublishChanges.publishBtn,className: 'btn-success btn-sm',callback: function(){wizardPublish();}},goTOLink: {label: translations.websitePublishChanges.domainLinkBtn,className: 'btn-sm',callback: function(){window.open($this.data("href"),"_blank");}}},});});$('.tab-content .close-wizard-tab-btn').off('click').on('click', function() {if ( $('#homepageTab').hasClass('active') ) {Wizard.Tabs.home.t.trigger('click');} else if ( $('#pagesTab').hasClass('active') ) {Wizard.Tabs.pages.t.trigger('click','close-wizard-tab-btn');} else if ( $('#designTab').hasClass('active') ) {Wizard.Tabs.design.t.trigger('click','close-wizard-tab-btn');} else if ( $('#settingsTab').hasClass('active') ) {Wizard.Tabs.settings.t.trigger('click','close-wizard-tab-btn');} else if ( $('#domainTab').hasClass('active') ) {Wizard.Tabs.domain.t.trigger('click','close-wizard-tab-btn');} else if ( $('#structureTab').hasClass('active') ) {Wizard.Tabs.structure.t.trigger('click','close-wizard-tab-btn');}});(function() {ProFeature_addLabel({'websiteID' : websiteID,'packageNUM' : packageNUM,'limitedToPackageNUM' : '1','toolType' : 'siteFavicon','$element' : $('#siteFavicon_uploadFileContaner label')});if ( ProFeature_isLimit({'websiteID' : websiteID,'packageNUM' : packageNUM,'toolType': 'siteFavicon','openPremiumFeatures': openPremiumFeatures})) {$('#siteFavicon_uploadFileContaner').addClass('pro-feature');$('#siteFavicon_uploadFileContaner').off('click').on('click.pro',function( event ) {event.preventDefault();event.stopPropagation();ProFeature_limit({'websiteID' : websiteID,'packageNUM' : packageNUM,'toolType': 'siteFavicon','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'siteFavicon'});});}})();ChangeWizardTheme();window.wizardLastChanges = $("#wizardForm").serialize();$('#editEmails').on('click', function() {var $modal = window.top.$('#globalModal');$modal.data('manual',true);$modal.data('manual-url',$(this).data('url'));$modal.data('manual-title',$(this).data('title'));$modal.data('manual-size',$(this).data('size'));$modal.one('show.bs.modal.editEmails', function (event) {g_ManageModuleID = 115;$modal.data('no-content-reset',true);});$modal.one('hide.bs.modal.editEmails', function (event) {g_ManageModuleID = '';$modal.removeData('no-content-reset');});});s123IconsPopup.init({translations: translations.s123IconsPopup,$GLOBALS: $GLOBALS,onIconChange: function( inputID, newIcon ) {if ( inputID == 'siteLogo' ) {var uploadFile = topWindow.uploadFiles['siteFavicon'];UpdateImagePreview('siteFavicon',{ normal: newIcon, tiny: newIcon });uploadFile.input.val(newIcon).trigger('change');}}});$(document).on('saveWizard', function( event, isPreviewReloadStatus, force, settings ) {switch( settings.type ) {case 'videoLibrary':filterHomepageOptionsList();GetImageMainColors(settings.data['n']);$(document).trigger('user_action_update_flag',[{name: 'flag_HomepageChooseGalleryImage', triggerName: false}]);break;}
AutoSaveWizard(isPreviewReloadStatus,force);});$(document).one('assets_loaded.wizard_loader',function() {if ( 1 ) {$('.close-wizard-tab-btn').addClass('hidden');OpenWizardTab('pagesTab',true);Wizard.Pages.modeManager.set('pages','',false);}});smartMobileMenuManager();(function() {var $wizardUndoHelper = $('<textarea id="wizardUndoHelper" class="undo-helper hidden"></textarea>');$wizardUndoHelper.val(JSON.stringify({allSettings: Wizard.getUndoFields()}));$('body').append($wizardUndoHelper);WizardUndoRedoHandler.init({dataBase: websiteID + '_wizard_undo',$buttonsContainer: $('.wizard-u-r-container')});})();$('#headerCallToActionsButtonsTitle').on('click',function(){ArrangeCallToActionsButtons();});if ( IsLandingPage() ) {LandingPage_HideNotInUseInputs();}
$('#header_size_copy').on('change',function(){$('#header_size').val($(this).val()).trigger('change');});$('#header_size').on('change',function(){$('#header_size_copy').val($(this).val());});});function disableEnableMultiPhonesStyle( action ) {var $el = $('#headerPhoneNumber_style_modalSelect');if ( action === 'disable' ) {$el.addClass('disabled');$el.attr('data-rel','tooltip');InitializeToolTips();} else {$el.removeClass('disabled');$el.tooltip('destroy');$el.attr('data-rel','');}}
function log_home() {PrintHomepageLayoutLog();}
function log_text() {PrintTextLayoutLog();}
function log_styles() {PrintStylesLayoutLog();}
function log_admin() {console.log('bla bla bla');}
function log_themes( type ) {if ( type == 'colors') {PrintColorThemesLayoutLog();} else if ( type == 'fonts' ) {PrintFontThemesLayoutLog();} else {PrintThemesLayoutLog();}}
function AddModuleWinHandler() {$('#AddModuleWin').on('show.bs.modal', function ( event ) {if ( PagesLimitations() ) event.preventDefault();if (0 && OpenPremiumFeatures(packageNUM)==1) {if ((abTestTXT=='10pages' && Wizard.Pages.list.length>=10) || (abTestTXT=='7pages' && Wizard.Pages.list.length>=7)) {event.preventDefault();if (abTestTXT=='7pages') {$limited_pages_number = '7';}
if (abTestTXT=='10pages') {$limited_pages_number = '10';}
bootbox.confirm({title: translations.freePagesLimitHeader.replace('{{limited_pages_number}}',$limited_pages_number),message: translations.freePagesLimitMessage.replace('{{limited_pages_number}}',$limited_pages_number),buttons: {confirm: {label: translations.freePagesLimitMessage_GO_PREMIUM,className: 'btn-success'},cancel: {label: translations.freePagesLimitMessage_Not_now,className: 'btn-link'}},callback: function( result ) {if (result) {disableLeavePopup = true;location.href = '/manager/upgrade/index.php?w='+websiteID+'&r=10pages';}}});}}});}
function PagesLimitations() {var $limited_pages_number = 200;var pagesCount = 0;Wizard.Pages.list.each(function() {var $page = $(this);var parentId = $page.data('parentId') || $page.data('parent-id') || '';if (!parentId) {pagesCount++;} else {var $parentPage = Wizard.Pages.getPage(parentId);if (!$parentPage.length || $parentPage.data('moduletypenum') != '128') {pagesCount++;}}});if ( pagesCount > $limited_pages_number ) {bootbox.alert({title: translations.pagesLimitHeader,message: translations.pagesLimitMessage.replace('{{limited_pages_number}}',$limited_pages_number)});return true;}
return false;}
function closeChangeSubDomain() {var $publishSiteModal = SystemModals.sm_get('publishSiteModal');$publishSiteModal.hide();UpdateSubDomainAndUniqueDomainIndifferentPlaceInInterfaceAfterUpdate();}
function SetHomepageInlineType( flagStatus ) {if ( $('#homepage_goal_type').val() == 'no' ) {$('#homepage_goal_positionBOX').hide();$('.second-goal-seperator').hide();$('#homepage_goal_placeBOX').hide();$('#homepage_second_goal_typeBOX').hide();$('#homepage_second_goal_placeBOX').hide();$('#homepage_second_goal_type').val('no');$('.homepage_goal_type_box').hide();$('#homepage_goal_type_settings').hide();} else {$('#homepage_goal_positionBOX').show();$('.second-goal-seperator').show();$('#homepage_goal_placeBOX').show();$('#homepage_second_goal_typeBOX').show();$('#homepage_goal_type_settings').show();if ( flagStatus != 'UndoRedoChange' ) {SetHomepageInlineType_Build_second_homepage_goal(flagStatus,'');SetHomepageInlineType_Build_homepage_goal_place(flagStatus,'');}}
SetHomepageInlineType_ShowHideAllSettingsBox(flagStatus);SetHomepageInlineType_homepage_layout_kind(flagStatus);}
function SetHomepageInlineType_ShowHideAllSettingsBox(flagStatus) {var homepage_goal_type                = $('#homepage_goal_type').val();var homepage_goal_type_setting_box    = $('#homepage_goal_type option[value="'+homepage_goal_type+'"]').data('setting-box');var homepage_goal_type_setting_box_extra    = $('#homepage_goal_type option[value="'+homepage_goal_type+'"]').data('setting-box-extra');var homepage_second_goal_type         = $('#homepage_second_goal_type').val();var homepage_second_goal_place         = $('#homepage_second_goal_place').val();var homepage_second_goal_type_setting_box    = $('#homepage_second_goal_type option[value="'+homepage_second_goal_type+'"]').data('setting-box');var homepage_second_goal_type_setting_box_extra    = $('#homepage_second_goal_type option[value="'+homepage_second_goal_type+'"]').data('setting-box-extra');$('.homepage_goal_type_box').hide();if (homepage_goal_type!='no') {$('#homepage_goal_type_'+homepage_goal_type).show();$('#homepage_goal_type_'+homepage_goal_type_setting_box).show();$('#homepage_goal_type_'+homepage_goal_type_setting_box_extra).show();$('#homepage_goal_type_'+homepage_second_goal_type).show();$('#homepage_goal_type_'+homepage_second_goal_type_setting_box).show();$('#homepage_goal_type_'+homepage_second_goal_type_setting_box_extra).show();}
if ( homepage_second_goal_type == 'no' ) {$('#homepage_second_goal_placeBOX').hide();} else {$('#homepage_second_goal_placeBOX').show();if (flagStatus=='onChange') { //Don't use it on user use the ready template so we don't have a conflict
if ( homepage_second_goal_place == 'top' ) {$('#homepage_second_goal_margin_bottom').val('20').trigger('change');} else if ( homepage_second_goal_place == 'bottom' ) {$('#homepage_second_goal_margin_top').val('20').trigger('change');}}}
SetHomepageInlineType_ShowHideAccordion(homepage_goal_type_setting_box,homepage_goal_type,homepage_second_goal_type_setting_box,homepage_second_goal_type);}
function SetHomepageInlineType_ShowHideAccordion( setting_box, goal_type, second_goal_type_setting_box, second_goal_type ) {var hGoalTitle = '';var hSecondGoalTitle = '';var title = Array();$('.chooseUniqueStyle').removeClass('has-homepage-goal');if ( $('#homepage_goal_type_'+setting_box).length === 0 && $('#homepage_goal_type_'+goal_type).length === 0 && $('#homepage_goal_type_'+second_goal_type_setting_box).length === 0 && $('#homepage_goal_type_'+second_goal_type).length === 0  ) {return;}
$('.chooseUniqueStyle').addClass('has-homepage-goal');}
function SetHomepageInlineType_homepage_layout_kind(flagStatus) {switch($('#homepage_layout_kind').val()) {case '1': //Simple - full screen and full screen with side by side elements
$('#layout_homepage_full_widthBOX').show();$('#homepage_goal_type').find('option[data-side-by-side-disable="1"]').show();if ($('#homepage_goal_type').val()=='no' || $('#homepage_goal_place').val()=='top' || $('#homepage_goal_place').val()=='bottom') {$('#layout_bottom_spacingBOX').show();if (flagStatus=='onChange') { //Don't use it on user use the ready template so we don't have a conflict
$('#layout_text_position').val('center_center').trigger('change');$('#layout_text_align').val('center').trigger('change');$('#layout_text_box_width').val('100').trigger('change');}} else {$('#layout_bottom_spacingBOX').show();$('#homepage_goal_type').find('option[data-side-by-side-disable="1"]').hide();if (flagStatus=='onChange') { //Don't use it on user use the ready template so we don't have a conflict
$('#layout_homepage_full_width').val('box').trigger('change');$('#layout_text_align').val('left').trigger('change');$('#layout_text_box_width').val('100').trigger('change');$('#layout_left_side_width').val('50').trigger('change');$('#layout_text_position').val('center_left').trigger('change');$('#homepage_goal_position').val('center_right').trigger('change');}}
break;case '2': //Two parts homepage
case '3': //Two parts homepage
$('#layout_homepage_full_widthBOX').hide();$('#homepage_goal_type').find('option[data-side-by-side-disable="1"]').hide();$('#layout_bottom_spacingBOX').hide();if (flagStatus=='onChange') { //Don't use it on user use the ready template so we don't have a conflict
$('#layout_left_side_width').val('50').trigger('change');$('#layout_text_box_width').val('100').trigger('change');$('#layout_text_align').val('center').trigger('change');$('#layout_text_position').val('center_center').trigger('change');$('#homepage_goal_position').val('center_center').trigger('change');}
break;}
if ( flagStatus != 'onLoad' ) {Wizard.readyTextLayoutsHandler.printTextLayouts();}}
function SetHomepageInlineType_Build_second_homepage_goal( flagStatus, prev_goal ) {var $homepage_goal_type = $('#homepage_goal_type');var $homepage_second_goal_type = $('#homepage_second_goal_type');$homepage_second_goal_type.empty();$homepage_goal_type.find('option').each(function() {var $this = $(this);if ( $this.data('support-second') == 1 && $this.attr('value') != $homepage_goal_type.val() ) {$homepage_second_goal_type.append($this.clone());}});if ( flagStatus == 'onLoad' && $homepage_second_goal_type.data('default').length > 0 ) {$homepage_second_goal_type.val($homepage_second_goal_type.data('default'));} else {$homepage_second_goal_type.val('no');}
if ( flagStatus == 'UndoRedoChange' && prev_goal != '' ) {$homepage_second_goal_type.val(prev_goal);}}
function SetHomepageInlineType_Update_homepage_goal_place( flagStatus ) {switch( $('#homepage_layout_kind').val() ) {case '1':if ( $('#homepage_goal_place').val() == 'top' || $('#homepage_goal_place').val() == 'bottom' ) {$('#homepage_goal_positionBOX').fadeOut();$('.second-goal-seperator').fadeOut();} else {$('#homepage_goal_positionBOX').fadeIn();$('.second-goal-seperator').fadeIn();}
break;case '2':case '3':if ( $('#homepage_goal_type').val() != 'no' && ( $('#homepage_goal_place').val() == 'top' || $('#homepage_goal_place').val() == 'bottom') ) {$('#homepage_goal_positionBOX').fadeOut();$('.second-goal-seperator').fadeOut();} else {$('#homepage_goal_positionBOX').fadeIn();$('.second-goal-seperator').fadeIn();}
break;}
if (flagStatus=='onChange') {switch($('#homepage_goal_place').val()) {case 'right':$('#layout_homepage_full_width').val('box').trigger('change');$('#layout_text_align').val('left').trigger('change');$('#layout_text_box_width').val('100').trigger('change');$('#layout_left_side_width').val('50').trigger('change');$('#layout_text_position').val('center_left').trigger('change');$('#homepage_goal_position').val('center_right').trigger('change');break;case 'left':$('#layout_homepage_full_width').val('box').trigger('change');$('#layout_text_align').val('left').trigger('change');$('#layout_text_box_width').val('100').trigger('change');$('#layout_left_side_width').val('50').trigger('change');$('#layout_text_position').val('center_left').trigger('change');$('#homepage_goal_position').val('center_left').trigger('change');break;case 'bottom':case 'top':$('#layout_homepage_full_width').val('box').trigger('change');$('#layout_text_align').val('center').trigger('change');$('#layout_text_box_width').val('100').trigger('change');$('#layout_left_side_width').val('50').trigger('change');$('#layout_text_position').val('center_center').trigger('change');$('#homepage_goal_position').val('center_center').trigger('change');break;}}}
function SetHomepageInlineType_Build_homepage_goal_place( flagStatus, prev_goal_place ) {var homepage_goal_type = $('#homepage_goal_type').val();var homepage_goal_type_align_limit = $('#homepage_goal_type option[value="'+homepage_goal_type+'"]').data('align-limit');var $homepage_goal_place = $('#homepage_goal_place');var $homepage_layout_kind = $('#homepage_layout_kind');$homepage_goal_place.empty();var elementSupportedPositions = 'right,left,top,bottom';if ( typeof homepage_goal_type_align_limit !== 'undefined' && homepage_goal_type_align_limit.length > 0 ) {elementSupportedPositions = homepage_goal_type_align_limit;}
if ( $homepage_layout_kind.val() == '2' || $homepage_layout_kind.val() == '3' ) {elementSupportedPositions = elementSupportedPositions.replace('right,left','side');}
elementSupportedPositions = elementSupportedPositions.split(',');$(elementSupportedPositions).each(function( e ) {$homepage_goal_place.append('<option value="'+elementSupportedPositions[e]+'">'+translations_homepage_goal_place[elementSupportedPositions[e]]+'</option>');});var homepage_goal_type_default_pos = $('#homepage_goal_type option[value="'+$('#homepage_goal_type').val()+'"]').data('default-position');if ( flagStatus == 'UndoRedoChange' && prev_goal_place != '' ) {homepage_goal_type_default_pos = prev_goal_place;}
if ( homepage_goal_type_default_pos == 'side' ) {if ( $homepage_layout_kind.val() == '2' || $homepage_layout_kind.val() == '3' ) {$homepage_goal_place.val('side').trigger('change.update_place',flagStatus);} else {$homepage_goal_place.val('right').trigger('change.update_place',flagStatus);}} else {$homepage_goal_place.val(homepage_goal_type_default_pos);}
if ( flagStatus == 'onLoad' ) {$homepage_goal_place.val($homepage_goal_place.data('default')).trigger('change.update_place');}
if ( $homepage_goal_place.val() == 'top' || $homepage_goal_place.val() == 'bottom' ) {$('#homepage_goal_positionBOX').fadeOut();$('.second-goal-seperator').fadeOut();} else {$('#homepage_goal_positionBOX').fadeIn();$('.second-goal-seperator').fadeIn();}}
function WizardMobileHendlar() {if ( $('html').data('device') !== 'mobile' ) return;$('.explanation-video').addClass('hidden');var $MainScreenTabsContainer = $('#wizardBox .wizardSideTabs');var $site123Button = $('#wizardBox .top-nav .logo-container');var $topNav = $('#wizardBox .top-nav');var $bottomNav = $('#wizardBox .bottom-nav');var prevStep = [];var $backButton = $('#wizardBox .wizardBackToTabs-container');var $currentPage = $('#wizardBox .current-page').parent();var $accordions = $('.accordion-toggle');var $accordionsContainer = $('#wizardBox .tab-content');var $upgradeButton = $('#upgradeButton').parent();var $dashboardButton = $('#backToDashBoard').parent();var $addNewPageButton = $('#wizardBox #addNewPageModule');var $mobilePreviewButtons = $('#wizardBox #mobilePreviewButtons');var $wizardIFrames = $('#wizardBox iframe');$addNewPageButton.hide();$accordionsContainer.hide();var fadeTime = 200;var stepTree = [];var goBack = true;$backButton.off('click').on('click',function() {if ( $(this).data('custom-event') ) return;backEventHandler();});$mobilePreviewButtons.on('click',function() {window.open('/?w='+$('#id').val()+'&disableCache='+getRandomInt(0,9999999),'_blank');});$('#theme_style').on('change',function() {$('#all_style_pelletes').fadeOut(fadeTime);});function removeOrangeColorFromAccordion() {$('#homepageAccordion').children().each(function() {$(this).removeClass('orangeFlash');});}
function mainScreenFunction() {$upgradeButton.addClass('hidden');$dashboardButton.fadeOut(fadeTime);$site123Button.fadeOut(fadeTime);$MainScreenTabsContainer.fadeOut(fadeTime,function() {$addNewPageButton.show();$backButton.show();$currentPage.show().find('a').text(prevStep[prevStep.length-1]);});}
function accordionsFunctions() {var $this = $accordions.filter('.selected-accordion');var $mainContainer = $this.closest('.wizard-accordion');$mainContainer.find('.panel:visible').each(function(index, option) {$(this).addClass('active-option');});var $panelHeading = $this.closest('.panel-heading');var $selectedTab = $panelHeading.next();$selectedTab.hide();var currentPageText = $panelHeading.text().trim();prevStep.push(currentPageText);$currentPage.hide();$currentPage.find('a').text(prevStep[prevStep.length-1]);$currentPage.fadeIn(fadeTime);$selectedTab.fadeIn(fadeTime, function() {$(document).trigger('wizard_mobile_hendlar.accordion.show',[$selectedTab.get(0).id]);});$panelHeading.hide();$mainContainer.find('.active-option').removeClass('panel');$mainContainer.find('.active-option .panel-collapse').each(function() {if ($(this).attr('id') != $selectedTab.attr('id')) {$(this).parent().addClass('hidden');}});}
function backEventHandler() {var action = stepTree.pop();switch(action) {case 'mainScreen':$MainScreenTabsContainer.parent().css('height','100%');$('.tab-pane.fade.in.active').fadeOut(fadeTime,function() {$(this).removeClass('active');$addNewPageButton.hide();$currentPage.hide();$backButton.hide();$site123Button.fadeIn(fadeTime);$MainScreenTabsContainer.fadeIn(fadeTime);$upgradeButton.removeClass('hidden');$dashboardButton.fadeIn(fadeTime);});$MainScreenTabsContainer.find('a').each(function(index, a) {$MainScreenTabsContainer.parent().next().find('#'+$(a).data('tab-id')).fadeOut(fadeTime);});prevStep.pop();$(document).trigger('wizard_tabs_closed');break;case 'accordions':var $this = $accordions.filter('.selected-accordion');var $mainContainer = $this.closest('.wizard-accordion');$mainContainer.find('.panel:visible').each(function(index, option) {$(this).addClass('active-option');});var $panelHeading = $this.closest('.panel-heading');var $selectedTab = $panelHeading.next();$selectedTab.fadeOut(fadeTime,function() {$(this).removeClass('active');$this.removeClass('selected-accordion');$mainContainer.fadeIn(fadeTime);$panelHeading.show();$mainContainer.find('.active-option').addClass('panel');$mainContainer.find('.active-option .panel-collapse').each(function() {$(this).parent().removeClass('hidden').removeClass('active-option');});prevStep.pop();mainScreenFunction();SetHomepageGoal();removeOrangeColorFromAccordion();});break;case 'modal-opened':if ($('.modal:visible').length > 0) {goBack = false;$('.modal').each(function() {if ($(this).hasClass('in')) {$(this).modal('hide');}});}
break;case 'pages':var $this = $accordionsContainer.find('.tab-pane.active');var $pages = $accordionsContainer.find('.tab-pane#pagesTab');$this.fadeOut(fadeTime,function() {$this.removeClass('active');$pages.show();$pages.addClass('active');$currentPage.show().find('a').text(prevStep[prevStep.length-1]);});prevStep.pop();break;}}
function mobileKeyboardEvent(customDocument) {$(customDocument).on('click',function() {if ($(customDocument.activeElement).is("input") || $(customDocument.activeElement).is("textarea")) {$bottomNav.fadeOut(fadeTime);} else {setTimeout(function() {$bottomNav.fadeIn(fadeTime);},200);}});}
function cancelAccordionEvent() {$accordionsContainer.find('a.accordion-toggle').click(function(e){return false;});}
$MainScreenTabsContainer.find('a:not(#eCommerceTab)').on('click',function() {stepTree.push('mainScreen');if ($(this).data('tab-id') == 'homepageTab') {SetHomepageGoal();removeOrangeColorFromAccordion();}
prevStep.push($(this).text().trim());var tabToShow = $(this).data('tab-id');$(document).trigger('wizard_tabs_opened',[tabToShow]);$accordionsContainer.children().each(function() {if ($(this).attr('id') == tabToShow) {$(this).addClass('active');} else {$(this).removeClass('active');$(this).fadeOut(fadeTime);}});mainScreenFunction();});(function() {$accordionsContainer.find('#homepageAlternativeName_edit').click( function() {$accordionsContainer.find('#homepageTab').data('alternative-name-edit',true);});$MainScreenTabsContainer.find('a[data-tab-id="homepageTab"]').on('click',function( e ) {if ( $accordionsContainer.find('#homepageTab').data('alternative-name-edit') ) {stepTree.pop();stepTree.push('pages');$accordionsContainer.find('#homepageTab').data('alternative-name-edit',false);}});})();$accordions.off('click').on('click',function() {stepTree.push('accordions');$(this).addClass('selected-accordion');accordionsFunctions();});cancelAccordionEvent();window.top.s123_mobilePreview = true;$('.modal').on('show.bs.modal',function() {goBack = true;if ($(this).find('#moduleMobileBottomMenu').length > 0) {$(this).find('iframe').addClass('custom-padding');}});$('a[href="#"]').removeAttr('href');mobileKeyboardEvent(document);$wizardIFrames.on('load',function() {var $iframe = $(this);var iframeDocument = $iframe.get(0).contentWindow.document;mobileKeyboardEvent(iframeDocument);});(function() {return;if (window.location.href.indexOf('#') != -1) {var timeOutInterval = 0;setTimeout(removeHash,timeOutInterval);function removeHash() {window.history.go(-1);}
function onhashchangeFun() {if (window.location.href.indexOf('#') != -1) {setTimeout(removeHash,timeOutInterval);} else {window.removeEventListener('hashchange',onhashchangeFun);}}
window.addEventListener('hashchange',onhashchangeFun);}})();}
function SetVideoType() {var videoSettings = {'buttonVideoPopup': {'videoType': $('#videoType'),'extVideoUrl': $('#home_video'),'videoShow': getUploadFileObjectByID('home_custom_video').input}}
$.each($('.popupVideoButtons'),function(index,value) {var popupVideoButtons = $(this);if ( videoSettings[popupVideoButtons.data('type')]['videoType'].val() == 1 ) {videoSettings[popupVideoButtons.data('type')]['extVideoUrl'].removeAttr('required');videoSettings[popupVideoButtons.data('type')]['extVideoUrl'].closest('.form-group').hide();videoSettings[popupVideoButtons.data('type')]['videoShow'].attr('required','');videoSettings[popupVideoButtons.data('type')]['videoShow'].closest('.form-group').show();} else {videoSettings[popupVideoButtons.data('type')]['videoShow'].removeAttr('required');videoSettings[popupVideoButtons.data('type')]['videoShow'].closest('.form-group').hide();videoSettings[popupVideoButtons.data('type')]['extVideoUrl'].attr('required','');videoSettings[popupVideoButtons.data('type')]['extVideoUrl'].closest('.form-group').show();}});}
function ShowHideTextLayoutElementsIfUnused() {var titleIndex = 1;$('#homepageTitle1').hide();$('#homepageTitle2').hide();$('#homepageTitle3').hide();if ( $('#home_siteSlogan').val().length > 0 || ( $('#home_siteSlogan_2').val().length == 0 && $('#home_SecondSiteSlogan').val().length == 0 ) ) {$('#homepageTitle1').show();$('#homepageTitle1 .fieldHeaders label .titleCount').remove();$('#homepageTitle1 .fieldHeaders label').append(' <span class="titleCount">' + titleIndex + '</span>');titleIndex++;}
if ( $('#home_siteSlogan_2').val().length > 0 || $('#home_SecondSiteSlogan').val().length == 0 ) {$('#homepageTitle2').show();$('#homepageTitle2 .fieldHeaders label .titleCount').remove();$('#homepageTitle2 .fieldHeaders label').append(' <span class="titleCount">' + titleIndex + '</span>');titleIndex++;}
if ( $('#home_SecondSiteSlogan').val().length > 0 ) {$('#homepageTitle3').show();$('#homepageTitle3 .fieldHeaders label .titleCount').remove();$('#homepageTitle3 .fieldHeaders label').append(' <span class="titleCount">' + titleIndex + '</span>');titleIndex++;}}
function resetHomepageTextStyles( $el ) {switch( $el.get(0).id ) {case 'home_siteSlogan':fontSizeSelector = '#home_text_size';letterSpacingSelector = '#home_text_letter_spacing_1';wordSpacingSelector = '#home_text_word_spacing_1';lineHeightSelector = '#home_text_line_height_1';topSpacingSelector = '#home_text_top_space_1';bottomSpacingSelector = '#home_text_bottom_space_1';break;case 'home_siteSlogan_2':fontSizeSelector = '#home_text_size_2';letterSpacingSelector = '#home_text_letter_spacing_2';wordSpacingSelector = '#home_text_word_spacing_2';lineHeightSelector = '#home_text_line_height_2';topSpacingSelector = '#home_text_top_space_2';bottomSpacingSelector = '#home_text_bottom_space_2';break;case 'home_SecondSiteSlogan':fontSizeSelector = '#slogan_text_size';letterSpacingSelector = '#home_text_letter_spacing_3';wordSpacingSelector = '#home_text_word_spacing_3';lineHeightSelector = '#home_text_line_height_3';topSpacingSelector = '#home_text_top_space_3';bottomSpacingSelector = '#home_text_bottom_space_3';break;}
$(fontSizeSelector).val(getTextDefaultStyles('fontSize')).trigger('change');$(letterSpacingSelector).val(getTextDefaultStyles('letterSpacing')).trigger('change');$(wordSpacingSelector).val(getTextDefaultStyles('wordSpacing')).trigger('change');$(lineHeightSelector).val(getTextDefaultStyles('lineHeight')).trigger('change');$(topSpacingSelector).val(getTextDefaultStyles('marginTop')).trigger('change');$(bottomSpacingSelector).val(getTextDefaultStyles('marginBottom')).trigger('change');}
function getTextDefaultStyles( style ) {switch(style) {case 'fontSize':return 40;break;case 'letterSpacing':return 0;break;case 'wordSpacing':return 0;break;case 'lineHeight':return 1.2;break;case 'marginTop':return 0;break;case 'marginBottom':return 10;break;}}
function PrintUniqueStylesLayouts( stylesModulesArr, $container ) {var $chooseUniqueStyle = $('.chooseUniqueStyle');var $styles = $container.find('.unique-styles');for ( id in stylesModulesArr ) {var html = '';var module = stylesModulesArr[id];module.package = module.package ? module.package : '1';var more_settings = module.more_settings;more_settings = tryParseJSON(more_settings);if (childLanguage=='zh-CHT' || childLanguage=='zh-CHS') {var two_letter_language = childLanguage;} else {var two_letter_language = childLanguage.substring(0, 2);}
if ($.inArray(two_letter_language, ['he','pl','ar','ja','sv','no','tr','ru','de','el','ko','zh-CHT','zh-CHS','fr','es','pt','it','ro'])!='-1') {var templateImagePath = 'https://cdn-cms-localhost.f-static.com/admin/InterfaceStatisFiles/stylesImages/800_'+module.id+'-'+two_letter_language+'-stylesLayoutV7.jpg?v=' + $GLOBALS['v-cache-long'] +'';} else {var templateImagePath = 'https://cdn-cms-localhost.f-static.com/admin/InterfaceStatisFiles/stylesImages/800_'+module.id+'-en-stylesLayoutV7.jpg?v=' + $GLOBALS['v-cache-long'] +'';}
html += '<div style="order:' + module.order + ';" data-id="' + module.id + '" class="unique-styles-button-container">';html += '<img class="unique-styles-button-image website_package_'+packageNUM+'"  data-package="' + module.package + '" src="'+templateImagePath+'" style="z-index:1;opacity: 1;">';if ( parseInt(module.package) > OpenPremiumFeatures(packageNUM) ) {html +='<span class="label label-warning label-sm btn-upper pro-feature-label">' + translations.premium + '</span>';}
html += '</div>';var $style = $(html);$style.appendTo($styles);$style.data('module-style',module);$style.find('.unique-styles-button-image').on('ready_template_change',function( event ) {var $this = $(this);var $parentEle = $this.closest('.unique-styles-button-container');var $homepage_layout_kind = $('#homepage_layout_kind');$chooseUniqueStyle.find('.unique-styles-button-container').removeClass('active');$parentEle.addClass('active');var id = $parentEle.data('id');var style = $this.closest('.unique-styles-button-container').data('module-style');var more_settings = style.more_settings;$chooseUniqueStyle.trigger('style_change',true);$homepage_layout_kind.data('p-val',$homepage_layout_kind.val());holdWizardSave = true;ResetAllTextSettings();if (more_settings !== 'undefined' && more_settings!='') {var more_settings = jQuery.parseJSON(more_settings);$.each(more_settings, function( key, value ) {if ( key == 'footer_layout' ) return;var $input = $('#'+key);switch ( $input.prop('type') ) {case 'checkbox':$input.prop('checked',value);break;case 'radio':$('[name="'+$input.attr('name')+'"][value="'+value+'"]').prop('checked',true);break
default:if ( homepageGoalsDefaultValues[key] && value.length == '' ) {value = homepageGoalsDefaultValues[key];}
if ( key == 'home_siteSlogan' || key == 'home_siteSlogan_2' || key == 'home_SecondSiteSlogan' ) {value = value.replace(/<br\/>/ig,"\n");value = value.replace(/<br>/ig,"\n");}
if ( key == 'font_slogan' || key == 'font_slogan_2' || key == 'font_second_slogan' ) {if ( childLanguage == 'he' ) value = 'Assistant';if ( childLanguage == 'ar' ) value = 'Amiri';}
$input.val(value);break;}
$input.trigger('change',['ReadyTemplateChange']);});if ( more_settings.homepageGradientsColors && more_settings.homepageGradientsColors.length !== 0 ) {$('#homepageGradientsColors').val(more_settings.homepageGradientsColors).trigger('change',[ "ReadyTemplateChange" ]);}
$('#stickyMenu').prop('checked',true);Wizard.footerHandler.reset();}
holdWizardSave = false;if ( $homepage_layout_kind.data('p-val') === '1' ) {if ( $homepage_layout_kind.val() === '2' || $homepage_layout_kind.val() === '3' ) {Wizard.homePageBgOptions.inlineLibrary.reset();}} else if ( $homepage_layout_kind.data('p-val') === '2' || $homepage_layout_kind.data('p-val') === '3' ) {if ( $homepage_layout_kind.val() === '1' ) {Wizard.homePageBgOptions.inlineLibrary.reset();}}
$('#wizardUndoRefreshHelper').val('structuresHandler');$('#template').trigger('change');GetImageMainColors(getImageWRV1(400,$('#home_slider_image_1').val()));ShowHideTextLayoutElementsIfUnused();Wizard.homePageBgOptions.showHideBackgroundOptions();updateUserText();$(document).trigger('ready_template.changed');});$style.find('.unique-styles-button-image').on('click',function( event ) {var $this = $(this);var package = $this.data('package');if ( parseInt(package) > OpenPremiumFeatures(packageNUM) ) {topWindow.upgradeFeaturesManager.show({featureID: ''});return;}
var changeTemplate = false;if ( $.cookie(websiteID + '_readyTemplateSkipWarning') ) {$this.trigger('ready_template_change');} else {$this.popover({container: 'body',title: translations.readyTemplates.warningTitle,content: translations.readyTemplates.warningContent,html: true,trigger: 'manual',template: '<div class="popover r-t"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div><h3 class="popover-footer"> <div class="btn-group">  <a class="confirmation btn btn-success btn-mini"><i class="fal fa-check"></i> <i class="icon-ok-sign icon-white"></i> '+translations.Continue+'</a><a class="cancel btn btn-default btn-mini"><i class="fal fa-times"></i> <i class="icon-remove-sign"></i> '+translations.Cancel+'</a></div></h3></div>',placement: $('html').data('device') === 'mobile' ? 'auto' : intrface_align_reverse})
.one('shown.bs.popover.rt_warning', function () {$('.popover.r-t .confirmation').on('click.rt_warning', function( event ) {readyTemplates_SetCookieForOneHour();changeTemplate = true;$this.popover('hide');});$('.popover.r-t .cancel').on('click.rt_warning', function( event ) {$this.popover('hide');});})
.one('show.bs.popover.rt_warning', function () {$('body').append('<div class="backdropManaul"></div>');$(window).one('blur.rt_warning', function( event ) {$this.popover('hide');});$('.backdropManaul').one('click.rt_warning', function () {$this.popover('hide');});})
.one('hide.bs.popover.rt_warning', function () {$('.backdropManaul').remove();})
.one('hidden.bs.popover.rt_warning', function () {if ( changeTemplate ) $this.trigger('ready_template_change');})
.popover('show');}});}
$container.prependTo($chooseUniqueStyle);if ( newUser ) readyTemplates_SetCookieForOneHour();function readyTemplates_SetCookieForOneHour() {var now = new Date();var time = now.getTime();time += 3600 * 1000;now.setTime(time);document.cookie = websiteID + '_readyTemplateSkipWarning = 1' + '; expires=' + now.toUTCString() + '; path=/';}
$chooseUniqueStyle.imagesLoaded(function( instance ) {$(document).trigger('ready_template.loaded',[instance.images]);});}
function PrintWebsiteStructures() {var $chooseWebsiteTheme = $('.chooseWebsiteTheme');var $container  = $('<div class="container-fluid">' +'<div class="row modules-design-styles"></div>' +'</div>');var $styles = $container.find('.modules-design-styles');var unsupportedThemes = abTestTXT == 'siteEditor_b' ? ['8','261902','15946','7'] : [];if ( abTestTXT == 'siteEditor_b' && !IsLandingPage() && ($('#header_width').val() != 'wide' || layoutArr[$('#template').val()].menuPlace != 'top') ) {unsupportedThemes.push('1','11835','11786');}
for ( id in websiteThemeArray ) {var module = websiteThemeArray[id];if ( IsLandingPage() && !module.hasOwnProperty('landing_page') ) continue;if ( !IsLandingPage() && module.hasOwnProperty('landing_page_only') ) continue;var idDisabledTheme = unsupportedThemes.indexOf(id) != -1;var previewImage = module.preview_image;if ( IsLandingPage() && !module.hasOwnProperty('landing_page_only') ) {previewImage = module.preview_image.replace('.png','_landingpage.png')}
var $style = $('<div style="order:' + module.order + ';background-image:url(' + previewImage + '?v=' + $GLOBALS['v-cache'] +');" data-id="' + module.id + '" data-template="' + module.template + '" class="col-xs-12 col-sm-12 homepage-design-button-container'+(idDisabledTheme ? ' hidden' : '')+'">'
+ '<div class="homepage-design-button">'
+ '<i class="ace-icon fal fa-check-circle"></i>'
+ '</div>'
+ '</div>').appendTo($styles);if ( module.id == $('#websiteStructureNUM').val() ) {$style.find('.homepage-design-button').addClass('active');}
$style.click( function( event ) {var $this = $(this);var id = $this.data('id');var module = websiteThemeArray[id];var header_opacity = module.header_opacity;if ( id == 5 || id == 8721 ) {if ( !IsLandingPage() && abTestTXT == 'siteEditor_b' && $('li#card_169').length > 0 && header_opacity != 'no' ) {if ( [169,169030,169025,169024,169023,169038,169042,169026,169029,169036,169037,169043,169048,169049,169050,169055,169056,169051].indexOf($('li#card_169').data('modules-arr-id')) != -1 ) {header_opacity = 'no';}}}
$('#websiteStructureNUM').val(id).trigger('change.updateActiveClass');$('#template').val(module.template);$('#header_width').val(module.header_width);$('#header_opacity').val(header_opacity);$('#header_logo_back_color').val(module.header_logo_back_color);if ( module.header_width == 'fullbox' || module.header_width == 'flyfullbox' ) {if ( $('#website_background_color').val() == '#ffffff' || $('#website_background_color').val().length == 0 ) {$('#website_background_color').spectrum('set','#e8eae2');}}
SetLayout($this.data('template'),1);});}
$chooseWebsiteTheme.empty();$container.appendTo($chooseWebsiteTheme);$('#websiteStructureNUM').on('change.updateActiveClass', function( event ) {$styles.find(`.homepage-design-button`).removeClass('active');$styles.find(`.homepage-design-button-container[data-id="${$(this).val()}"] .homepage-design-button`).addClass('active');});}
function PrintHomepagePopularGoals() {var homepagePopularGoalsArray = {'noGoal': {'order': 1,'goalName': 'no','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal.png','position': '','secondGoal': ''},'buttons': {'order': 2,'goalName': 'buttons','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-button.png','position': 'bottom','secondGoal': ''},'video_popup_bottom': {'order': 3,'goalName': 'video_popup_icon','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-popup-video-bottom.png','position': 'bottom','secondGoal': ''},'video_popup_top': {'order': 4,'goalName': 'video_popup_icon','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-popup-video-top.png','position': 'top','secondGoal': ''},'vertical_form_right': {'order': 5,'goalName': 'vertical_form','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-vertical-form-right.png','position': 'right','secondGoal': ''},'vertical_form_left': {'order': 6,'goalName': 'vertical_form','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-vertical-form-left.png','position': 'left','secondGoal': ''},'vertical_form_bottom': {'order': 7,'goalName': 'vertical_form','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-vertical-form-bottom.png','position': 'bottom','secondGoal': ''},'horizontal_form': {'order': 8,'goalName': 'horizontal_form','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-horizontal-form.png','position': 'bottom','secondGoal': ''},'image_right': {'order': 9,'goalName': 'image','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-image-right.png','position': 'right','secondGoal': ''},'image_left': {'order': 10,'goalName': 'image','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-image-left.png','position': 'left','secondGoal': ''},'image_top': {'order': 11,'goalName': 'image','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-image-top.png','position': 'top','secondGoal': ''},'image_bottom': {'order': 12,'goalName': 'image','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-image-bottom.png','position': 'bottom','secondGoal': ''},'search': {'order': 13,'goalName': 'search','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-search.png','position': 'bottom','secondGoal': ''},'mailingList': {'order': 14,'goalName': 'mailingList','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-subscription.png','position': 'bottom','secondGoal': ''},'image_and_buttom_top_bottom': {'order': 15,'goalName': 'image','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-image-and-button-1.png','position': 'top','secondGoal': {'name': 'buttons','position': 'bottom'}},'image_and_buttom_right_bottom': {'order': 16,'goalName': 'image','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-image-and-button-2.png','position': 'right','secondGoal': {'name': 'buttons','position': 'bottom'}},'image_and_buttom_bottom': {'order': 17,'goalName': 'image','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-image-and-button-3.png','position': 'bottom','secondGoal': {'name': 'buttons','position': 'bottom'}},'image_and_buttom_left_bottom': {'order': 18,'goalName': 'image','preview_image': $GLOBALS["cdn-interface-files"] + '/admin/InterfaceStatisFiles/modulesImages/structures/goal-image-and-button-4.png','position': 'left','secondGoal': {'name': 'buttons','position': 'bottom'}},};var $chooseHomepagePopularGoals = $('.homepage-popular-goals');var $container  = $('<div class="popular-goals-container">' +'<h4>' + translations.popularGoals + '</h4>' +'<div class="popular-goals fancy-scrollbar"></div>' +'</div>');var $goals = $container.find('.popular-goals');$.each(homepagePopularGoalsArray,function( index, goal ) {var secondGoalName = goal.secondGoal ? goal.secondGoal.name : '';var secondGoalPosition = goal.secondGoal ? goal.secondGoal.position : '';var $goal = $('<div style="order:' + goal.order + ';background-image:url(' + goal.preview_image + '?v=' + $GLOBALS['v-cache'] +');" data-goal-name="' + goal.goalName + '" data-goal-position="' + goal.position + '" data-second-goal-position="' + secondGoalPosition + '" data-second-goal-name="' + secondGoalName + '" data-active-name="' + index + '" class="col-xs-12 col-sm-12 popular-goal-button-container"></div>').appendTo($goals);$goal.click( function( event ) {var $this = $(this);var goalPosition = $this.data('goal-position');$('#homepage_goal_type').val($this.data('goal-name')).trigger('change.update_type');if ( $this.data('goal-name') != 'no' ) {if ( $('#homepage_layout_kind').val() == '2' || $('#homepage_layout_kind').val() == '3' ) {if ( goalPosition == 'left' || goalPosition == 'right' ) {var goalPosition = 'side';}}
$('#homepage_goal_place').val(goalPosition).trigger('change.update_place');}
if ( $this.data('second-goal-position') && $this.data('second-goal-name') ) {$('#homepage_second_goal_type').val($this.data('second-goal-name')).trigger('change.update_type');$('#homepage_second_goal_place').val($this.data('second-goal-position'));}
$("#wizardForm").off('ajaxSuccess').one( 'ajaxSuccess', function( event ) {UpdatePreviewAreaByAjax('#top-section',false,false,'');});AutoSaveWizard(false,true);});});$container.appendTo($chooseHomepagePopularGoals);}
function ManageLanguageButtonActiveEvent() {var upgradeReason = 'languagesManager';var settings = {'websiteID' : websiteID,'packageNUM' : packageNUM,'limitedToPackageNUM' : '3','toolType' : 'languageManager','upgradeReason' : upgradeReason,'clickable': true,'$element' : $('.manage-language-container')};if ( websiteID < 9203625 ) settings.limitedToPackageNUM = '2';if ( websiteID < 642600 ) settings.limitedToPackageNUM = '1';if ( $('.manage-language-container .pro-feature-label').length == 0 ) {ProFeature_addLabel(settings);}
$('.ManageLanguageButton').off('click').on('click',function() {if ( !$.isNumeric(packageNUM) ) return;var upgrade = OpenPremiumFeatures(packageNUM) < 4;if ( upgrade && OpenPremiumFeatures(packageNUM) == 2 && websiteID < 642600 ) upgrade = false;if ( upgrade && OpenPremiumFeatures(packageNUM) == 3 && websiteID < 9203625 ) upgrade = false;if ( upgrade ) {topWindow.upgradeFeaturesManager.show({featureID: upgradeReason});return;}
var $this = $(this);$('#languagesManager').modal('show');});}
function UpdateJquerySlider(id) {var val = $('#'+id+'').val();$('#'+id+'_slider').slider('value',val);$('#'+id+'_view input').val(val);}
function AfterPublishReinitialize() {GetActivePlugins();GetActiveLanguages();}
function SortPreviewModules( sortMenus ) {if ( !Wizard.Preview.ready ) return;Wizard.Preview.$('#s123ModulesContainer').css({display: 'flex',flexDirection: 'column'});var order = 0;var $sortable = RichPage.isActive ? RichPage.getSortable() : $('#sortable');const nestedSortableArray = [];function toArray(element, parentId = null) {Array.from(element.children).forEach((child, index) => {const $child = $(child);const item = {id: $child.data('moduleid'),parent_id: $child.data('parent-id'),order: index};nestedSortableArray.push(item);if ( $child.find('ul').length > 0 ) {toArray($child.find('ul').get(0),$child.data('moduleid'));}});}
toArray($sortable.get(0));nestedSortableArray.forEach( function( module ) {if ( !module.id ) return;var $page = Wizard.Pages.getPage(module.id);if ( $page.data('moduletypenum') == '78' ) return;if ( RichPage.isRichPage($page.data('moduletypenum')) ) return;if ( !IsSinglePage() && !IsLandingPage() && $page.data('module-mp-show-in-home') != '1' && !RichPage.isActive && !RichPage.isRelated(Wizard.Pages.highlight.$page) ) return;var $p_module = Wizard.Preview.getModule(module.id);if ( RichPage.isActive || (RichPage.isRelated(Wizard.Pages.highlight.$page) && !RichPage.isRichPage(Wizard.Pages.highlight.$page.data('moduletypenum'))) ) {if ( !$p_module.is(':visible') ) return;$p_module.removeClass('r-c-f-c');if ( order == 0 ) $p_module.addClass('r-c-f-c');}
$p_module.css({ order: order });if ( order % 2 == 0 ) {$p_module.addClass('bg-primary');} else {$p_module.removeClass('bg-primary');}
order += 1;});Wizard.Preview.$document.trigger('s123.page.ready.refreshParallaxImages');Wizard.Preview.$document.trigger('s123.page.ready.refreshAOS');Wizard.Preview.$document.trigger('s123.page.ready.refreshPageOrder');if ( sortMenus ) {$("#wizardForm").off('ajaxSuccess').one( 'ajaxSuccess', function( event ) {UpdatePreviewAreaByAjax(['#websiteHeader','footer.global_footer ul.navPages','#header #top-menu .navPages'],false,true,'');});}}
function ReloadPreviewIframe( url ) {if ($.browser.msie || $.browser.msedge) {setTimeout(function() {MakeThePreview(url);},100);} else {MakeThePreview(url);}}
function MakeThePreview(url) {var $frame = $('#websitePreviewIframe');$frame.contents().find('html, body').stop(true,false);$frame.data('reload-process',true);$frame.attr( 'src', url);}
function ShowIconStyle() {if ( $('#siteLogo').val().indexOf('site123-image-icon') !== -1 || $('#siteLogo').val().indexOf('.svg') !== -1 ) {$('#logoFileSizeBox').hide();$('#logo_size').show();$('#websiteLogoAndName [data-logo-require="text"]').show();if ( Wizard.websiteLogoMakerTool.noTextStyles.indexOf($('#siteLogoStyle').val()) !== -1 ) {$('#websiteLogoAndName [data-logo-require="text"]:not([data-logo-except="icon"])').hide();}} else if ( $('#siteLogo').val() != '' ) {$('#logoFileSizeBox').show();$('#logo_size').hide();if ( $('#siteLogoImageStyle').val() === 'website-name-active' ) {$('#websiteLogoAndName [data-logo-require="text"]').show();} else {$('#websiteLogoAndName [data-logo-require="text"]').hide();}} else {$('#logoFileSizeBox').hide();$('#websiteLogoAndName [data-logo-require="text"]').show();}}
function AddKeyboardShortcuts() {keydown($(document));$('#websitePreviewIframe').load( function() {keydown($(this).contents());});function keydown( $document ) {$document.keydown( function(event) {var $el = $(event.target);var tag = $el.get(0).tagName.toLowerCase();if ( $el.closest('[data-s123-editable-elements="true"]').length > 0 ) return;if ( $el.closest('[data-cpl]').length > 0 ) return;if ( $('.modal.in').length !== 0 ) return;if ( tag !== 'input' && tag !== 'textarea' ) {switch (event.which) {case 27:event.preventDefault();$('#website_desktop_view').trigger( 'click' );break;case 48:event.preventDefault();$('#wizardTab0button').trigger( 'click' );break;case 96:event.preventDefault();$('#wizardTab0button').trigger( 'click' );break;case 98:event.preventDefault();$('#wizardTab4button').trigger( 'click' );break;case 99:event.preventDefault();$('#wizardTab6button').trigger( 'click' );break;case 9:event.preventDefault();$(this).trigger( 'tab_key_press' );break;}}
if (event.ctrlKey || event.metaKey) {switch (String.fromCharCode(event.which).toLowerCase()) {case 's':event.preventDefault();$('#publishWebsiteButton').trigger( 'click' );break;case 'z':if ( !$(event.target).is('textarea') && !$(event.target).is('input') ) {event.preventDefault();WizardUndoRedoHandler.$undoBtn.trigger( 'click' );}
break;case 'y':if ( !$(event.target).is('textarea') && !$(event.target).is('input') ) {event.preventDefault();WizardUndoRedoHandler.$redoBtn.trigger( 'click' );}
break;}}});}}
var alreadyRunningScrollID;function CheckIfFormValid() {var result = true;if ( !$('#wizardForm #name').valid() ) {result = false;}
if ( $('#sortable li').length > 0 ) {$("#sortable li").each( function() {var $this = $(this);if ($this.find('.module_name').length>0 && $.trim($this.find('.module_name').val()).length==0) {result = false;if ($this.find('.alertModuleNameEmpty').length==0) {$('<div class="alertModuleNameEmpty" style="color:red;">'+translations.fieldRequired+'</div>').insertAfter($this.find('.input-group'));}} else {if ($this.find('.alertModuleNameEmpty').length>0) {$this.find('.alertModuleNameEmpty').remove();}}});}
return result;}
function ShowFormErrorToUser() {bootbox.alert({title: translations.Warning,message: translations.beforeMoveTabExp});trackJsEvent(true,'User cant move to the next tab in his wizard');var validator = $("#wizardForm").validate();if (validator.errorList.length>0) {var firstIdError = $(validator.errorList[0].element).attr('id');var tabID = $('#'+firstIdError).parents('.tab-pane').attr('id');} else {var tabID = 'pagesTab';}
OpenWizardTab(tabID,true);ShowWizard();}
function ActiveDisableInsideAdsManager() {if ($('#ad_manger_active').is(":checked")==true) {$('#adManagerInsideLevel').show();} else {$('#adManagerInsideLevel').hide();}}
function CheckIfTheUserHaveAdsPromoOnHomepageModules() {var json = new Array();var i = $('#sortable li.moduleSortList').length;var adsOnHomepage = false;if ( i > 0 ) {$("#sortable li.moduleSortList").each( function() {var $this = $(this);var toolID          = $this.data('moduletypenum');if (toolID=='86') {adsOnHomepage = true;}
$this.css('z-index',i);i--;});}
if (adsOnHomepage==true) {$('#adHomepageActive').show();$('#adHomepageDisable').hide();} else {$('#adHomepageActive').hide();$('#adHomepageDisable').show();}}
function OpenWizardTab(tabID,fromError,selector='') {var $tabContent = $('#'+tabID);SettingsBox.hide();if ( !$tabContent.is(":visible") || fromError==true ) {$('.wizardSideTabs > li.active').removeClass('active');$('.tab-pane').hide().removeClass('active');$('[data-tab-id='+tabID+']').parent('li').addClass('active');$tabContent.show().addClass('active');ShowWizard();if ( tabID == 'pagesTab' ) {Wizard.Tabs.pages.setAddNewPagePosition();Wizard.Tabs.pages.displayHideOthersPagesTabs();Wizard.Tabs.pages.t.trigger('open_wizard_tabs');}
if ( tabID == 'homepageTab' ) {$('#wizardTab2button').trigger('click.home_page_load');Wizard.Tabs.home.t.trigger('open_wizard_tabs');} else {if ( tabID == 'designTab' ) {Wizard.Tabs.design.t.trigger('open_wizard_tabs');} else if ( tabID == 'settingsTab' ) {Wizard.Tabs.settings.t.trigger('open_wizard_tabs');} else if ( tabID == 'structureTab' ) {Wizard.Tabs.structure.t.trigger('open_wizard_tabs');} else if ( tabID == 'domainTab' ) {Wizard.Tabs.domain.t.trigger('open_wizard_tabs');}}} else {var $accordionsContainer = $('#wizardBox .tab-content');$accordionsContainer.addClass('flicker');setTimeout(function() {$accordionsContainer.removeClass('flicker');},600);if ( selector != 'close-wizard-tab-btn' ) return;if( $('html').data('device') === 'mobile' ) {return;}
website_desktop_view();if ( tabID == 'pagesTab' ) {Wizard.Tabs.pages.setAddNewPagePosition();}
if ( tabID == 'homepageTab' ) {$('#wizardTab2button').trigger('click.home_page_load');}}
if ( $('.wizardSideTabs > li.active').length > 0 ) {$(document).trigger('wizard_tabs_opened',[tabID]);$('#wizardBox .tab-content').attr('data-active-tab',tabID);} else {$(document).trigger('wizard_tabs_closed');$('#wizardBox .tab-content').attr('data-active-tab',tabID);}
if ( $('#websitePreviewIframe').attr('data-design-mobile-preview') == 'true' ) {Wizard.Preview.Scale.deviceButtonsClick($('#previewScaleDevices').find('li[data-device-type="computer"]'));$('#websitePreviewIframe').attr('data-design-mobile-preview',false);}
if ( $('#websitePreviewIframe').attr('settings-app-preview') == 'true' ) {Wizard.Preview.Scale.deviceButtonsClick($('#previewScaleDevices').find('li[data-device-type="computer"]'));$('#websitePreviewIframe').attr('settings-app-preview',false);}}
function scrollToPointInPreview() {if ( $('#websitePreviewIframe').data('reload-process') ) return;var $frame = $('#websitePreviewIframe').contents();var $section = $frame.find(window.scrollPreview);if ( window.scrollPreview && $section.length !== 0 ) {var offset = $frame.find('#mainNav').outerHeight();if ( !$.isNumeric(offset) ) offset = 0;$frame.find('html, body').scrollTop($section.offset().top - offset);if ( Wizard.Preview.ready ) {Wizard.Preview.window.S123.Jarallax.refresh();}}
window.scrollPreview = '';}
function AutoSaveWizard(isPreviewReloadStatus,force) {isPreviewReload = isPreviewReloadStatus;isWizardChange = true;clearTimeout(window.inputChangeLive_finishedTyping);if (force==true) {SaveWizard();}}
function AutoSaveInerval() {SaveWizard();}
function GetMenuScrollOffset(tempNUM) {var header_size = $('#header_size').val();var scrollHeaderSize = 60;if (tempNUM!=2) {switch (header_size) {case '1':scrollHeaderSize = 60;break;case '2':scrollHeaderSize = 70;break;case '3':scrollHeaderSize = 80;break;case '3':scrollHeaderSize = 100;break;}} else {switch (header_size) {case '1':scrollHeaderSize = 60;break;case '2':scrollHeaderSize = 70;break;case '3':scrollHeaderSize = 80;break;case '4':scrollHeaderSize = 100;break;}}
if (layoutArr[tempNUM].menuPlace=='left' || layoutArr[tempNUM].menuPlace=='right') {scrollHeaderSize = 0;}
if ( !$('#stickyMenu').is(':checked') ) {scrollHeaderSize = 0;}
if (typeof Wizard.Preview.window !== "undefined") {Wizard.Preview.window.menuScrollOffset = scrollHeaderSize;}}
function SetLayout(val,templateWizard) {var $frame = $('#websitePreviewIframe').contents();$frame.find('#layoutNUM').val(val);$frame.find('#layoutMenuPositionTXT').val(layoutArr[val].menuPlace);GetMenuScrollOffset(val);if (templateWizard!=1) {$('#header_width').val('wide');if ( abTestTXT == 'siteEditor_b' ) {$('#header_opacity').val('no');} else {$('#header_opacity').val('full');}
$('#header_style').val('1');$('#header_size').val('1');$('#header_logo_back_color').val('2');}
$('#template').val(val).trigger('change');SetHomepageGoal();LayoutPickupManager();}
function SaveWizard() {if ( isWizardChange == true ) {if (holdWizardSave==true) {return false;}
if (wizardReadyToGo==false) {WizardLoadError();return false;}
var isFormValid = CheckIfFormValid();if ( !isFormValid ) return false;if ( !isLastAndCurrentChangesEquel($("#wizardForm").serialize())) {Wizard.Save.inProgress();WizardUndoRedoHandler.add({type: 'wizard',allSettings: Wizard.getUndoFields()},$('#wizardUndoHelper'));$.ajax({type: "POST",url: "/versions/2/wizard/wizardO.php",context: $("#wizardForm"),data: (tools_manage_is_change == true) ? $("#wizardForm").serialize()+'&tools_manage='+encodeURIComponent(tools_manage)+'&wizardVersionNUM='+wizardVersionNUM : $("#wizardForm").serialize()+'&wizardVersionNUM='+wizardVersionNUM, // serializes the form's elements.
success: function( data ) {SaveWizardSuccess(data);window.wizardLastChanges = $("#wizardForm").serialize();},error: function(data) {Wizard.Save.error();console.log(translations.sorryGotError);}});} else {SaveWizardSuccess('.');}
tools_manage_is_change = false;isWizardChange = false;}}
function SaveWizardSuccess( data ) {$('#wizardUndoRefreshHelper').val('');if ( data == 'Version Update!') {bootbox.confirm({title: '<span><b>'+translations.wizardVersionUpdateTitle+'</b></span>',message: translations.wizardVersionUpdateExp,buttons: {confirm: {label: translations.update,className: 'btn-danger'},cancel: {label: translations.Cancel,className: 'btn-default'}},callback: function( result ) {if ( result ) window.location.reload();}});}
if ( window.reloadWizardAfterSave ) {disableLeavePopup = true;bootbox.alert({message: window.reloadWizardAfterSaveMessage,}).on("hidden.bs.modal", function() {window.location.reload();});}
if ( data == 'Admin User') {bootbox.alert({title: '<span class="text-danger"><b>Admin user can not update user website. Sorry :)</b></span>',message: 'Admin user can not update user website. Sorry :)'});}
if ( window.reloadPreviewCSS ) window.reloadPreviewCSS();RefreshPreview();if ( data != '.') {Wizard.Save.error();} else {setTimeout(function() {Wizard.Save.success();},500);}}
function BuildToolJSON() {var json = new Array();var i = $('#sortable li.moduleSortList, #card_homepage li.moduleSortList').length;var promoCount = 1;if ( i > 0 ) {$("#card_homepage li.moduleSortList, #sortable li.moduleSortList").each( function() {var $this = $(this);var moduleID        = $this.data('moduleid');var parentId        = $this.data('parent-id');var toolID          = $this.data('moduletypenum');var showInMenu      = $this.data('module-showInMenu');var showInFooter    = $this.data('module-show-in-footer');var hideFrontModule = $this.data('module-hide-front-module');var mp_showInMenu   = $this.data('module-mp-show-in-menu');var mp_showInHome   = $this.data('module-mp-show-in-home');var style           = $this.data('module-style');var modulesArrID    = $this.data('modules-arr-id');var styleContent    = $this.data('module-style-content');var title           = $this.find('.module_name').val();var slogan          = GetModuleSetting(moduleID,'slogan');var url             = GetModuleSetting(moduleID,'url');var settings        = GetModuleSetting(moduleID,'settings');var hideFromMobile  = $this.data('module-hide-from-mobile');if ( typeof $this.data('set-settings') == 'string' ) {settings = $this.data('set-settings');}
if ( toolID == 1000 ) {$this.find('.promoModuleInput').val(translations.Promo + ' ' + promoCount);promoCount++;}
if (url=='' || !url) {url             = $this.data('url');url             = CheckPageURLinsideJSON(moduleID,url);if (url=='' || !url) {url         = moduleID;}}
json.push({moduleID: moduleID,parentId: parentId,toolID: toolID,moduleTypeNUM: toolID,title: title,slogan: slogan,showInMenu: showInMenu,showInFooter: showInFooter,hideFrontModule: hideFrontModule,mp_showInMenu: mp_showInMenu,mp_showInHome: mp_showInHome,style: style,modulesArrID: modulesArrID,styleContent: styleContent,url: url,settings: settings,hideFromMobile: hideFromMobile});$this.css('z-index',i);i--;});}
tools_manage = JSON.stringify(json);tools_manage_is_change = true;$('#tools_manage.undo-helper').val(tools_manage);}
function ReloadPreviewCSS( callback ) {var $frame = $('#websitePreviewIframe').contents();if ( $frame.find('link.reloadable-css.rpc-loading').length !== 0 ) {clearTimeout(window.reloadPreviewCssTimeout);window.reloadPreviewCssTimeout = setTimeout( function() {ReloadPreviewCSS(callback);}, 500);return;}
var $css = $frame.find('link.reloadable-css');$css.each( function() {var $this = $(this);var $clone = $('<link class="reloadable-css" href="'+PreventUrlBrowserCache($this.get(0).getAttribute('href'))+'" rel="stylesheet" type="text/css">');var loaded = false;$clone.addClass('rpc-loading').load(function() {$this.remove();$clone.removeClass('rpc-loading');if ( callback ) callback.call(this);loaded = true;Preview_TriggerS123CSSReload();$(document).trigger('reloadPreviewCSS.reloaded');if ( Wizard.Preview.ready ) {Wizard.Preview.window.previewReloadPreviewCSSReloaded();}});$clone.insertAfter($this);setTimeout(function() {if (loaded) return;$this.remove();$clone.removeClass('rpc-loading');if ( callback ) callback.call(this);},5000);});window.reloadPreviewCSS = false;$(window).trigger('resize');Preview_TriggerS123PageReadyAndLoad();$frame.find('iframe.reloadable-iframe').each( function( index, iframe ) {iframe.src = iframe.src;});}
function PreventUrlBrowserCache( url ) {var timestamp = new Date().getTime();var regObj = new RegExp('site123C=[0-9]*','ig');if( regObj.test(url) ) {url = url.replace(regObj,'site123C=' + timestamp);} else {url += (url.indexOf('?') === -1 ? '?' : '&') + 'site123C=' + timestamp;}
return url;}
function ChangePreviewLive( obj ) {var $eID = typeof obj === 'string' ? obj : $(obj).attr('id');var tempNUM = $('#template').val();var $frame = $('#websitePreviewIframe').contents();if ( !Wizard.Preview.ready || $frame.length === 0 ) return;if ( Wizard.Preview.ready && $eID == 'mobileAppHomepageType' ) {AutoSaveWizard(false,true);setTimeout(function() {ReloadPreviewIframe('/?w='+$('#id').val()+'&app=1&disableCache='+getRandomInt(0,9999999));},500);return;}
if ( !IsPreviewAtHomepage() ) {clearTimeout(window.ChangePreviewLive_finishedEditing);window.ChangePreviewLive_finishedEditing = setTimeout( function() {AutoSaveWizard(true,true);},500);return;}
if ( Wizard.Preview.ready && Wizard.Preview.window.multiLanCode != '' ) {PreviewWebsiteLanguage();return;}
if ( $eID=='name' ) {$('.breadcrumb').find('.active').html(escapeHtml($('#name').val()));$('.page-header').find('h1').html(escapeHtml($('#name').val()));$frame.find('.logo_name .website-name,.website-name.website-name-preview-helper,.footer_2 .website-name-preview-helper').html(escapeHtml($('#name').val()));document.title = escapeHtml($('#name').val() + window.wizardTitleSuffix);$frame.find('.footer_name').html(escapeHtml($('#name').val()));$('#wesiteNameChange').val('changed');clearTimeout(window.wesiteNameChange_Delay);window.wesiteNameChange_Delay = setTimeout( function() {if ( Wizard.Preview.ready ) {Wizard.Preview.window.ResetMoreButton();}},100);}
if ( $eID == 'home_custom_image_size' ) {$frame.get(0).documentElement.style.setProperty('--home_custom_image_size', $('#home_custom_image_size').val()+'px' );}
if ( $eID == 'home_custom_image_width' ) {$frame.get(0).documentElement.style.setProperty('--home_custom_image_width', $('#home_custom_image_width').val()+'px' );}
if ($eID=='homepageAlternativeName' || $eID=='home_siteSlogan' || $eID=='home_siteSlogan_2' || $eID=='home_SecondSiteSlogan') {if ($('#homepageAlternativeName').val().trim()!='') {$frame.find('.homepageMenu .txt-container').html(escapeHtml($('#homepageAlternativeName').val()));} else {$('#homepageAlternativeName').val('');$frame.find('.homepageMenu .txt-container').html(escapeHtml($('#homepageAlternativeName').attr('placeholder')));}
if ($('#home_siteSlogan').val()!='') {$frame.find('#home_siteSlogan').html(HomepageTextFormat(escapeHtml($('#home_siteSlogan').val())));Wizard.Preview.$('#top-section').trigger('textAdded',['home_siteSlogan']);} else {Wizard.Preview.$('#top-section').trigger('textRemoved',['home_siteSlogan']);}
if ($('#home_siteSlogan_2').val()!='') {$frame.find('#home_siteSlogan_2').html(HomepageTextFormat(escapeHtml($('#home_siteSlogan_2').val())));Wizard.Preview.$('#top-section').trigger('textAdded',['home_siteSlogan_2']);} else {Wizard.Preview.$('#top-section').trigger('textRemoved',['home_siteSlogan_2']);}
if ($('#home_SecondSiteSlogan').val()!='') {$frame.find('#home_SecondSiteSlogan').html(HomepageTextFormat(escapeHtml($('#home_SecondSiteSlogan').val())));Wizard.Preview.$('#top-section').trigger('textAdded',['home_SecondSiteSlogan']);} else {Wizard.Preview.$('#top-section').trigger('textRemoved',['home_SecondSiteSlogan']);}
if ( $('#home_siteSlogan').val().length === 0 || $('#home_SecondSiteSlogan').val().length === 0) {$frame.find('.home-site-slogan-hr').hide();} else {$frame.find('.home-site-slogan-hr').show();}
if (0) {}}
if ( $eID == 'homepage_main_goal_margin_top' || $eID == 'homepage_main_goal_margin_bottom' || $eID == 'homepage_second_goal_margin_top' || $eID == 'homepage_second_goal_margin_bottom' ) {switch( $eID ) {case 'homepage_main_goal_margin_top':case 'homepage_main_goal_margin_bottom':var $marginBtn = $frame.find('.mainGoal .previewManageButtons[data-type="goalSpacing"]');$marginBtn.removeClass('active');if ( parseInt($('#homepage_main_goal_margin_top').val()) > parseInt($('#homepage_main_goal_margin_top').data('min-val')) ) {$marginBtn.addClass('active');}
if ( parseInt($('#homepage_main_goal_margin_bottom').val()) > parseInt($('#homepage_main_goal_margin_bottom').data('min-val')) ) {$marginBtn.addClass('active');}
break;case 'homepage_second_goal_margin_top':case 'homepage_second_goal_margin_bottom':var $marginBtn = $frame.find('.secondGoal .previewManageButtons[data-type="goalSpacing"]');$marginBtn.removeClass('active');if ( parseInt($('#homepage_second_goal_margin_top').val()) > parseInt($('#homepage_second_goal_margin_top').data('min-val')) ) {$marginBtn.addClass('active');}
if ( parseInt($('#homepage_second_goal_margin_bottom').val()) > parseInt($('#homepage_second_goal_margin_bottom').data('min-val')) ) {$marginBtn.addClass('active');}
break;}
$frame.get(0).documentElement.style.setProperty('--'+$eID, $('#'+$eID).val()+'px');}
if ( $eID=='home_text_size' || $eID=='home_text_size_2' || $eID=='slogan_text_size' || $eID=='home_text_size_weight' || $eID=='home_text_italic' || $eID=='home_text_size_2_weight' || $eID=='home_text_2_italic' || $eID=='slogan_text_size_weight'|| $eID=='slogan_text_italic' || $eID=='home_text_background_1' || $eID=='home_text_background_2' || $eID=='home_text_background_3' || $eID=='home_text_letter_spacing_1' || $eID=='home_text_letter_spacing_2' || $eID=='home_text_letter_spacing_3' || $eID=='home_text_word_spacing_1' || $eID=='home_text_word_spacing_2' || $eID=='home_text_word_spacing_3' || $eID=='home_text_line_height_1' || $eID=='home_text_line_height_2' || $eID=='home_text_line_height_3' || $eID=='home_text_top_space_1' || $eID=='home_text_bottom_space_1' || $eID=='home_text_top_space_2' || $eID=='home_text_bottom_space_2' || $eID=='home_text_top_space_3' || $eID=='home_text_bottom_space_3' || $eID=='home_text_rotate_1' || $eID=='home_text_rotate_2' || $eID=='home_text_rotate_3') {var docEl = $frame.get(0).documentElement;var $home_siteSlogan = $frame.find('#top-section #home_siteSlogan');var $home_siteSlogan_2 = $frame.find('#top-section #home_siteSlogan_2');var $home_SecondSiteSlogan = $frame.find('#top-section #home_SecondSiteSlogan');var $el = $('#' + $eID);switch ( $eID ) {case 'home_text_size':case 'home_text_size_2':case 'slogan_text_size':if ( $eID == 'home_text_size' ) {docEl.style.setProperty('--home_text_size_px',$el.val()+'px');docEl.style.setProperty('--home_text_size',$el.val());} else if ( $eID == 'home_text_size_2' ) {docEl.style.setProperty('--home_text_size_2_px',$el.val()+'px');docEl.style.setProperty('--home_text_size_2',$el.val());} else if ( $eID == 'slogan_text_size' ) {docEl.style.setProperty('--slogan_text_size_px',$el.val()+'px');docEl.style.setProperty('--slogan_text_size',$el.val());}
break;case 'home_text_size_weight':case 'home_text_size_2_weight':case 'slogan_text_size_weight':if ( $eID == 'home_text_size_weight' ) {$el.children().each(function(index, option) {$home_siteSlogan.removeClass($(option).val());});$home_siteSlogan.addClass($el.val());} else if ( $eID == 'home_text_size_2_weight' ) {$el.children().each(function(index, option) {$home_siteSlogan_2.removeClass($(option).val());});$home_siteSlogan_2.addClass($el.val());} else if ( $eID == 'slogan_text_size_weight' ) {$el.children().each(function(index, option) {$home_SecondSiteSlogan.removeClass($(option).val());});$home_SecondSiteSlogan.addClass($el.val());}
break;case 'home_text_italic':case 'home_text_2_italic':case 'slogan_text_italic':if ( $eID == 'home_text_italic' ) {$home_siteSlogan.removeClass('italic');$home_siteSlogan.addClass($el.val());} else if ( $eID == 'home_text_2_italic' ) {$home_siteSlogan_2.removeClass('italic');$home_siteSlogan_2.addClass($el.val());} else if ( $eID == 'slogan_text_italic' ) {$home_SecondSiteSlogan.removeClass('italic');$home_SecondSiteSlogan.addClass($el.val());}
break;case 'home_text_letter_spacing_1':case 'home_text_letter_spacing_2':case 'home_text_letter_spacing_3':if ( $eID == 'home_text_letter_spacing_1' ) {$home_siteSlogan.css('letter-spacing',$el.val()+'px');} else if ( $eID == 'home_text_letter_spacing_2' ) {$home_siteSlogan_2.css('letter-spacing',$el.val()+'px');} else if ( $eID == 'home_text_letter_spacing_3' ) {$home_SecondSiteSlogan.css('letter-spacing',$el.val()+'px');}
break;case 'home_text_word_spacing_1':case 'home_text_word_spacing_2':case 'home_text_word_spacing_3':if ( $eID == 'home_text_word_spacing_1' ) {$home_siteSlogan.css('word-spacing',$el.val()+'px');} else if ( $eID == 'home_text_word_spacing_2' ) {$home_siteSlogan_2.css('word-spacing',$el.val()+'px');} else if ( $eID == 'home_text_word_spacing_3' ) {$home_SecondSiteSlogan.css('word-spacing',$el.val()+'px');}
break;case 'home_text_rotate_1':case 'home_text_rotate_2':case 'home_text_rotate_3':if ( $eID == 'home_text_rotate_1' ) {$home_siteSlogan.css('transform','rotate('+$el.val()+'deg)');} else if ( $eID == 'home_text_rotate_2' ) {$home_siteSlogan_2.css('transform','rotate('+$el.val()+'deg)');} else if ( $eID == 'home_text_rotate_3' ) {$home_SecondSiteSlogan.css('transform','rotate('+$el.val()+'deg)');}
break;case 'home_text_line_height_1':case 'home_text_line_height_2':case 'home_text_line_height_3':if ( $eID == 'home_text_line_height_1' ) {$home_siteSlogan.css('line-height',''+$el.val()+'');} else if ( $eID == 'home_text_line_height_2' ) {$home_siteSlogan_2.css('line-height',$el.val());} else if ( $eID == 'home_text_line_height_3' ) {$home_SecondSiteSlogan.css('line-height',$el.val());}
break;case 'home_text_top_space_1':case 'home_text_top_space_2':case 'home_text_top_space_3':if ( $eID == 'home_text_top_space_1' ) {$home_siteSlogan.css('margin-top',$el.val()+'px');docEl.style.setProperty('--home_text_top_space_1',$el.val()+'px');} else if ( $eID == 'home_text_top_space_2' ) {$home_siteSlogan_2.css('margin-top',$el.val()+'px');docEl.style.setProperty('--home_text_top_space_2',Number($el.val())+'px');} else if ( $eID == 'home_text_top_space_3' ) {$home_SecondSiteSlogan.css('margin-top',$el.val()+'px');docEl.style.setProperty('--home_text_top_space_3',$el.val()+'px');}
break;case 'home_text_bottom_space_1':case 'home_text_bottom_space_2':case 'home_text_bottom_space_3':if ( $eID == 'home_text_bottom_space_1' ) {$home_siteSlogan.css('margin-bottom',$el.val()+'px');docEl.style.setProperty('--home_text_bottom_space_1',$el.val()+'px');} else if ( $eID == 'home_text_bottom_space_2' ) {$home_siteSlogan_2.css('margin-bottom',$el.val()+'px');docEl.style.setProperty('--home_text_bottom_space_2',$el.val()+'px');} else if ( $eID == 'home_text_bottom_space_3' ) {$home_SecondSiteSlogan.css('margin-bottom',$el.val()+'px');docEl.style.setProperty('--home_text_bottom_space_3',$el.val()+'px');}
break;case 'home_text_background_1':case 'home_text_background_2':case 'home_text_background_3':if ( $eID == 'home_text_background_1' ) {$el.children().each(function(index, option) {$home_siteSlogan.removeClass($(option).val());});$home_siteSlogan.addClass($el.val());} else if ( $eID == 'home_text_background_2' ) {$el.children().each(function(index, option) {$home_siteSlogan_2.removeClass($(option).val());});$home_siteSlogan_2.addClass($el.val());} else if ( $eID == 'home_text_background_3' ) {$el.children().each(function(index, option) {$home_SecondSiteSlogan.removeClass($(option).val());});$home_SecondSiteSlogan.addClass($el.val());}
break;}}
if ( $eID=='menu_font_size' || $eID=='logo_font_size' || $eID=='logo_size' || $eID=='logo_text_size_weight'  || $eID=='logo_text_italic' || $eID=='mobileMenuColor' || $eID=='mobileMenuFontSize' || $eID=='mobileMenuPagesSpace' || $eID=='menu_pages_space' || $eID=='menu_pages_side_padding' || $eID=='menu_pages_letter_spacing' || $eID=='menu_pages_word_spacing' || $eID=='mainNavMobileHeight' ) {$frame.find('#websiteHeader .moduleMenu a').css('font-size',Number($('#menu_font_size').val()));$frame.find('#websiteHeader .navActions a, #websiteHeader .navActions button, #header .headerSocial a').css('font-size',Number($('#menu_font_size').val()));$frame.get(0).documentElement.style.setProperty('--menu_font_size',Number($('#menu_font_size').val())+'px');$frame.find('#websiteHeader .s123-w-l-s .website-name').css('font-size',Number($('#logo_font_size').val()));$frame.find('#websiteHeader .s123-w-l-s div').css('font-size',Number($('#logo_size').val()));$frame.find('#websiteHeader .logo_name,.website-name').css({fontWeight: $('#logo_text_size_weight').val() == 'weight700' ? '700' : 'normal'});$frame.find('#websiteHeader .logo_name,.website-name').removeClass('italic');$frame.find('#websiteHeader .logo_name,.website-name').addClass($('#logo_text_italic').val());if ( $eID == 'mainNavMobileHeight' ) {$frame.get(0).documentElement.style.setProperty('--mainNavMobileHeight',Number($('#mainNavMobileHeight').val())+'px');}
if ( $eID == 'menu_pages_space' ) {$frame.get(0).documentElement.style.setProperty('--menu_pages_space',Number($('#menu_pages_space').val())+'px');}
if ( $eID == 'menu_pages_side_padding' ) {$frame.get(0).documentElement.style.setProperty('--menu_pages_side_padding',Number($('#menu_pages_side_padding').val())+'px');}
if ( $eID == 'menu_pages_letter_spacing' ) {$frame.get(0).documentElement.style.setProperty('--menu_pages_letter_spacing',Number($('#menu_pages_letter_spacing').val())+'px');}
if ( $eID == 'menu_pages_word_spacing' ) {$frame.get(0).documentElement.style.setProperty('--menu_pages_word_spacing',Number($('#menu_pages_word_spacing').val())+'px');}
if ( Wizard.Preview.ready ) {Wizard.Preview.window.ResetMoreButton();}
setTimeout(function() {$frame.find('#websiteHeader .moduleMenu a').css('font-size',Number($('#menu_font_size').val()));},200);$frame.get(0).documentElement.style.setProperty('--mobileMenuFontSize', $('#mobileMenuFontSize').val()+'px' );$frame.get(0).documentElement.style.setProperty('--mobileMenuPagesSpace', $('#mobileMenuPagesSpace').val()+'px' );if ( $eID == 'mobileMenuColor' ) {$frame.find('#popupFloatDivMenu').removeClass(function (index, className) {return (className.match (/(^|\s)m-\S+/g) || []).join(' ');})
.addClass($('#mobileMenuColor').val());$frame.find('#popupFloatDivMenu').removeClass('color-contrast');$frame.find('#popupFloatDivMenu').removeClass('color-contrast-black');$(document).trigger('mobileMenuColorCorrection',$('#mobileMenuColor').val());$frame.find('.mobile-menu-btn').attr('data-menu-color',$('#mobileMenuColor').val());}
if ( !document.getElementById('websitePreviewIframe') || ! document.getElementById('websitePreviewIframe').contentWindow ) {return;}
CheckMenuSizeAndMoreButton(tempNUM);}
if ($eID=='logo_img_size') {if (layoutArr[tempNUM].menuPlace=='left' || layoutArr[tempNUM].menuPlace=='right') {$frame.find('.s123-site-logo > img').css({'width':$('#logo_img_size').val()+'%','max-width':'100%','height':'auto'});}
if (layoutArr[tempNUM].menuPlace=='top' || layoutArr[tempNUM].menuPlace=='bottom') {$frame.find('.s123-site-logo > img').css({'width':'auto','height':$('#logo_img_size').val()+'%','max-height':'100%'});}
if ( !document.getElementById('websitePreviewIframe') || ! document.getElementById('websitePreviewIframe').contentWindow ) {return;}
CheckMenuSizeAndMoreButton(tempNUM);}
if ( $eID == 'logo_text_letter_spacing' ) {$frame.find('#websiteHeader .logo_name,.website-name').css('letter-spacing',Number($('#logo_text_letter_spacing').val()));}
if ( $eID == 'logo_text_word_spacing' ) {$frame.find('#websiteHeader .logo_name,.website-name').css('word-spacing',Number($('#logo_text_word_spacing').val()));}
if ( $eID == 'logo_icon_text_spacing' ) {var marginType = $('#websitePreviewIframe html[dir=rtl]').length !== 0 ? 'margin-left' : 'margin-right';$frame.find('#websiteHeader .logo_name div:not(.logoLayout):not(.svg-m), #mainNavMobile .logo_name div:not(.logoLayout):not(.svg-m)').css(marginType,Number($('#logo_icon_text_spacing').val()));$frame.find('#websiteHeader .s123-site-logo .img-responsive').css(marginType,Number($('#logo_icon_text_spacing').val()));$frame.find('#websiteHeader .s123-site-logo .logoLayout_text').css(marginType,Number($('#logo_icon_text_spacing').val()));}
if ($eID=='home_opacity') {Wizard.Preview.$('#top-section .carousel, #top-section #video-bg, #top-section .home-image-bg, #parallax_home_opacity img').css('opacity',Number($('#home_opacity').val())*0.1);Wizard.Preview.$('#top-section .carousel, #top-section #video-bg, #top-section .home-image-bg').data('opacity',Number($('#home_opacity').val())*0.1);}
if ( $eID == 'homepageFilterImage' ) {if ( $.inArray($('#homepage_style').val(),['2','3']) && $('#parallax_homepage_image').is(':checked') ) {$frame.find('#top-section .home-image-bg').css('filter','none');$frame.find('#top-section .home-image-bg .jarallax-container > div').css('filter',$('#homepageFilterImage').val());} else {$frame.find('#top-section .carousel, #top-section #video-bg, #top-section .home-image-bg, #parallax_home_opacity img').css('filter',$('#homepageFilterImage').val());$frame.find('#top-section .carousel, #top-section #video-bg, #top-section .home-image-bg').data('filter',$('#homepageFilterImage').val());}}
if ( $eID == 'home_button_spacing' ) {if ( $frame.find('html[dir=rtl]').length > 0 ) {$frame.find('#home_buttonText').css({marginLeft: (parseInt($('#home_button_spacing').val())/2)+'px'});$frame.find('#home_buttonText_1').css({marginRight: (parseInt($('#home_button_spacing').val())/2)+'px'});} else {$frame.find('#home_buttonText').css({marginRight: (parseInt($('#home_button_spacing').val())/2)+'px'});$frame.find('#home_buttonText_1').css({marginLeft: (parseInt($('#home_button_spacing').val())/2)+'px'});}}
if ( $eID == 'home_buttonText' || $eID == 'home_buttonRedirect' || $eID == 'home_buttonText_style' || $eID == 'home_buttonPhoneNumber' || $eID == 'home_buttonEmail' ) {$frame.find('#home_buttonText').show().find('.h-b-t').html(escapeHtml($('#home_buttonText').val()));$frame.find('#home_buttonText').removeClass('btn-primary-transparent btn-primary-white btn-primary-black btn-primary-grey btn-primary-transparent-main btn-primary-simplelink btn-primary-simplelink-text-color');if ( $('#home_buttonText_style').val() == '2' ) {$frame.find('#home_buttonText').addClass('btn-primary-transparent');}
if ( $('#home_buttonText_style').val() == '3' ) {$frame.find('#home_buttonText').addClass('btn-primary-white');}
if ( $('#home_buttonText_style').val() == '4' ) {$frame.find('#home_buttonText').addClass('btn-primary-black');}
if ( $('#home_buttonText_style').val() == '5' ) {$frame.find('#home_buttonText').addClass('btn-primary-grey');}
if ( $('#home_buttonText_style').val() == '6' ) {$frame.find('#home_buttonText').addClass('btn-primary-transparent-main');}
if ($('#home_buttonText_style').val() == '7') {$frame.find('#home_buttonText').addClass('btn-primary-simplelink');}
if ($('#home_buttonText_style').val() == '8') {$frame.find('#home_buttonText').addClass('btn-primary-simplelink-text-color');}
if ( $('#home_buttonText_type').val() == '1' ) {$frame.find('#home_buttonText').removeAttr('href');} else {$frame.find('#home_buttonText').attr('href',$('#home_buttonRedirect').val() + '/?w=' + $('#id').val() );}
if ( $eID == 'home_buttonPhoneNumber' ) {var $link = $frame.find('#home_buttonText');$link.attr('onclick','');$link.attr('href','tel:'+$('#'+$eID).val());}
if ( $eID == 'home_buttonEmail' ) {var $link = $frame.find('#home_buttonText');$link.attr('onclick','');$link.attr('href','mailto:'+$('#'+$eID).val());}}
if ( $eID == 'home_buttonText_1' || $eID == 'home_buttonRedirect_1' || $eID == 'home_buttonText_1_style' || $eID == 'home_buttonPhoneNumber_1' | $eID == 'home_buttonEmail_1' ) {if ( $('#home_buttonText_1').val() != '' ) {$frame.find('#home_buttonText_1').show().find('.h-b-t').html(escapeHtml($('#home_buttonText_1').val()));$('#home_button_spacing').closest('.form-group.h-p-btns-spacing').slideDown(350);} else {$frame.find('#home_buttonText_1').hide();$('#home_button_spacing').closest('.form-group.h-p-btns-spacing').slideUp(350);}
$frame.find('#home_buttonText_1').removeClass('btn-primary-transparent btn-primary-white btn-primary-black btn-primary-grey btn-primary-transparent-main btn-primary-simplelink btn-primary-simplelink-text-color');if ( $('#home_buttonText_1_style').val() == '2' ) {$frame.find('#home_buttonText_1').addClass('btn-primary-transparent');}
if ( $('#home_buttonText_1_style').val() == '3' ) {$frame.find('#home_buttonText_1').addClass('btn-primary-white');}
if ( $('#home_buttonText_1_style').val() == '4' ) {$frame.find('#home_buttonText_1').addClass('btn-primary-black');}
if ( $('#home_buttonText_1_style').val() == '5' ) {$frame.find('#home_buttonText_1').addClass('btn-primary-grey');}
if ( $('#home_buttonText_1_style').val() == '6' ) {$frame.find('#home_buttonText_1').addClass('btn-primary-transparent-main');}
if ( $('#home_buttonText_1_style').val() == '7' ) {$frame.find('#home_buttonText_1').addClass('btn-primary-simplelink');}
if ($('#home_buttonText_1_style').val() == '8') {$frame.find('#home_buttonText_1').addClass('btn-primary-simplelink-text-color');}
if ( $('#home_buttonText_1_type').val() == '1' ) {$frame.find('#home_buttonText_1').removeAttr('href');} else {$frame.find('#home_buttonText_1').attr('href',$('#home_buttonRedirect_1').val() + '/?w=' + $('#id').val() );}
if ( $eID == 'home_buttonPhoneNumber_1' ) {var $link = $frame.find('#home_buttonText_1');$link.attr('onclick','');$link.attr('href','tel:'+$('#'+$eID).val());}
if ( $eID == 'home_buttonEmail_1' ) {var $link = $frame.find('#home_buttonText_1');$link.attr('onclick','');$link.attr('href','mailto:'+$('#'+$eID).val());}}
if ( $eID == 'topAction_buttonText_1' || $eID == 'topAction_buttonText_1_style' || $eID == 'topAction_buttonRedirect_1' || $eID == 'topAction_buttonPhoneNumber_1' || $eID == 'topAction_buttonEmail_1' ) {if ( $('#topAction_buttonText_1').val() != '' ) {if ( $frame.find('#topAction_buttonText_1').length == 0 ) {if ( Wizard.Preview.ready ) {clearTimeout(window.topAction_buttonText_1_Delay);window.topAction_buttonText_1_Delay = setTimeout( function() {AutoSaveWizard(true,true);},500);}} else {$frame.find('#topAction_buttonText_1').show().find('.m-b-t').html(escapeHtml($('#topAction_buttonText_1').val()));}} else {$frame.find('#topAction_buttonText_1').hide();}
$frame.find('#topAction_buttonText_1').removeClass('btn-primary-action-button-1').removeClass('btn-primary-action-button-2').removeClass('btn-primary-action-button-3').removeClass('btn-primary-action-button-4 btn-primary-action-button-5 btn-primary-action-button-6');$frame.find('#topAction_buttonText_1').addClass('btn-primary-action-button-'+$('#topAction_buttonText_1_style').val());if ( $eID == 'topAction_buttonPhoneNumber_1' ) {var $link = $frame.find('#topAction_buttonText_1').parent();$link.attr('onclick','');$link.attr('href','tel:'+$('#'+$eID).val());}
if ( $eID == 'topAction_buttonEmail_1' ) {var $link = $frame.find('#topAction_buttonText_1').parent();$link.attr('onclick','');$link.attr('href','mailto:'+$('#'+$eID).val());}
CheckMenuSizeAndMoreButton(tempNUM);}
if ( $eID == 'topAction_buttonText_2' || $eID == 'topAction_buttonText_2_style' || $eID == 'topAction_buttonRedirect_2' || $eID == 'topAction_buttonPhoneNumber_2' || $eID == 'topAction_buttonEmail_2' ) {if ( $('#topAction_buttonText_2').val() != '' ) {if ( $frame.find('#topAction_buttonText_2').length == 0 ) {if ( Wizard.Preview.ready ) {clearTimeout(window.topAction_buttonText_2_Delay);window.topAction_buttonText_2_Delay = setTimeout( function() {AutoSaveWizard(true,true);},500);}} else {$frame.find('#topAction_buttonText_2').show().find('.m-b-t').html(escapeHtml($('#topAction_buttonText_2').val()));}} else {$frame.find('#topAction_buttonText_2').hide();}
$frame.find('#topAction_buttonText_2').removeClass('btn-primary-action-button-1').removeClass('btn-primary-action-button-2').removeClass('btn-primary-action-button-3').removeClass('btn-primary-action-button-4 btn-primary-action-button-5');$frame.find('#topAction_buttonText_2').addClass('btn-primary-action-button-'+$('#topAction_buttonText_2_style').val());if ( $eID == 'topAction_buttonPhoneNumber_2' ) {var $link = $frame.find('#topAction_buttonText_2').parent();$link.attr('onclick','');$link.attr('href','tel:'+$('#'+$eID).val());}
if ( $eID == 'topAction_buttonEmail_2' ) {var $link = $frame.find('#topAction_buttonText_2').parent();$link.attr('onclick','');$link.attr('href','mailto:'+$('#'+$eID).val());}
if ( ['topAction_buttonText_1_style','topAction_buttonText_2_style'].includes($eID) ) {Wizard.render.init($eID);}
CheckMenuSizeAndMoreButton(tempNUM);}
if ($eID=='layout_text_box_width') {$frame.get(0).documentElement.style.setProperty('--layout_text_box_width', $('#layout_text_box_width').val()+'%' );}
if ($eID=='layout_left_side_width') {$frame.get(0).documentElement.style.setProperty('--layout_left_side_width', $('#layout_left_side_width').val()+'%' );$frame.get(0).documentElement.style.setProperty('--layout_left_side_width_vh', $('#layout_left_side_width').val()+'vh' );}
if ($eID=='layout_bottom_spacing') {$frame.get(0).documentElement.style.setProperty('--layout_bottom_spacing', $('#layout_bottom_spacing').val()+'px' );}
if ($eID=='homepage_layout_height') {$frame.get(0).documentElement.style.setProperty('--homepage_layout_height', $('#homepage_layout_height').val()+'%' );$frame.get(0).documentElement.style.setProperty('--homepage_layout_height_vh', $('#homepage_layout_height').val()+'vh' );}
if ($eID=='homepageShapeDividerList_Size') {$frame.get(0).documentElement.style.setProperty('--homepageShapeDividerList_Size', $('#homepageShapeDividerList_Size').val()+'%' );}
if ($eID=='footer_layout') {$frame.find('#footer_layout').val($('#footer_layout').val());}
if ( $eID == 'embed_url_width_facebook' || $eID == 'embed_url_height_facebook' ) {var $facebook_iframe = $frame.find('.homepage_goal iframe.facebook');$facebook_iframe.width($('#embed_url_width_facebook').val());$facebook_iframe.height($('#embed_url_height_facebook').val());}
if ( $eID == 'embed_url_width_twitter' || $eID == 'embed_url_height_twitter' ) {var $twitter_iframe = $frame.find('.homepage_goal iframe.twitter');$twitter_iframe.width($('#embed_url_width_twitter').val());$twitter_iframe.height($('#embed_url_height_twitter').val());}
if ( $eID == 'embed_url_width_pinterest' || $eID == 'embed_url_height_pinterest' ) {var $pinterest_iframe = $frame.find('.homepage_goal iframe.pinterest');$pinterest_iframe.width($('#embed_url_width_pinterest').val());$pinterest_iframe.height($('#embed_url_height_pinterest').val());}
if ( $eID == 'embed_url_width_sound_cloud' || $eID == 'embed_url_height_sound_cloud' ) {var $soundcloud_iframe = $frame.find('.homepage_goal iframe.sound_cloud');$soundcloud_iframe.width($('#embed_url_width_sound_cloud').val());$soundcloud_iframe.height($('#embed_url_height_sound_cloud').val());}
if ( $eID == 'homepage_video_width' ) {var $homepage_video_box = $frame.find('.homepage_goal > div');$homepage_video_box.css({ width: $('#homepage_video_width').val()+'px' });}
if ( $eID == 'homepage_mailing_placeholder' ) {var $mailingListField = $frame.find('.homepage_goal .MailingTool [name="widget-subscribe-form-email"]');$mailingListField.attr('placeholder',$('#'+$eID).val());}
if ( $eID == 'homepage_mailing_button_text' ) {var $mailingListButton = $frame.find('.homepage_goal .MailingTool [type="submit"]');$mailingListButton.text($('#'+$eID).val());}
if ( $eID == 'homepage_search_placeholder' ) {var $SearchField = $frame.find('.homepage_goal .searchBox [name="widget-search-form-keyword"]');$SearchField.attr('placeholder',$('#'+$eID).val());}
if ( $eID == 'homepage_search_button_text' ) {var $SearchFieldButton = $frame.find('.homepage_goal .searchBox [type="submit"]');$SearchFieldButton.text($('#'+$eID).val());}
if ( $eID == 'homepage_icons_style_select' ){$frame.find('.homepage_goal #homepage-social-icons .social-icons .list-inline > li > a').removeClass('social-style-1 social-style-2 social-style-3 social-style-4');if ($('#homepage_icons_style_select').val()=='social-style-1') {$frame.find('.homepage_goal #homepage-social-icons .social-icons .list-inline > li > a').addClass('social-style-1');}
if ($('#homepage_icons_style_select').val()=='social-style-2') {$frame.find('.homepage_goal #homepage-social-icons .social-icons .list-inline > li > a').addClass('social-style-2');}
if ($('#homepage_icons_style_select').val()=='social-style-3') {$frame.find('.homepage_goal #homepage-social-icons .social-icons .list-inline > li > a').addClass('social-style-3');}
if ($('#homepage_icons_style_select').val()=='social-style-4') {$frame.find('.homepage_goal #homepage-social-icons .social-icons .list-inline > li > a').addClass('social-style-4');}}
if ( $eID == 'homepage_icons_size_select' ) {$frame.find('.homepage_goal #homepage-social-icons .social-icons .list-inline > li > a').removeClass('social-size-normal social-size-big social-size-large');if ($('#homepage_icons_size_select').val()=='social-size-normal') {$frame.find('.homepage_goal #homepage-social-icons .social-icons .list-inline > li > a').addClass('social-size-normal');}
if ($('#homepage_icons_size_select').val()=='social-size-big') {$frame.find('.homepage_goal #homepage-social-icons .social-icons .list-inline > li > a').addClass('social-size-big');}
if ($('#homepage_icons_size_select').val()=='social-size-large') {$frame.find('.homepage_goal #homepage-social-icons .social-icons .list-inline > li > a').addClass('social-size-large');}}
if ( $eID == 'homepage_sound_color_select' || $eID == 'homepage_sound_theme_select' ) {SetHomepageGoal_SoundPlayerSettings();}
if ( $eID == 'home_button_size' ) {if ( $('#home_button_size').val() == '1' ) {$frame.find('#home_buttonText').removeClass('btn-xxl');$frame.find('#home_buttonText_1').removeClass('btn-xxl');$frame.find('#home_buttonText').addClass('btn-xl');$frame.find('#home_buttonText_1').addClass('btn-xl');}
if ( $('#home_button_size').val() == '2' ) {$frame.find('#home_buttonText').removeClass('btn-xl');$frame.find('#home_buttonText_1').removeClass('btn-xl');$frame.find('#home_buttonText').addClass('btn-xxl');$frame.find('#home_buttonText_1').addClass('btn-xxl');}}
if ( $eID == 'embed_url_width_custom_code' || $eID == 'embed_url_height_custom_code' ) {var $customCode_iframe = $frame.find('.homepage_goal iframe.customCode');$customCode_iframe.width($('#embed_url_width_custom_code').val());$customCode_iframe.height($('#embed_url_height_custom_code').val());}
if ( $eID == 'sectionsPadding' ) {$frame.get(0).documentElement.style.setProperty('--sectionsPadding',$('#sectionsPadding').val()+'px');}
scrollToPointInPreview();}
function HomepageTextFormat(text) {if ( abTestTXT == 'siteEditor_b' ) {text = TextMarkDown.formatText(text);text = TextMarkDown.formatText(text);text = TextMarkDown.formatText(text);text = TextMarkDown.formatText(text);text = TextMarkDown.formatText(text);} else {text = HomepageTextFormatAction(text);text = HomepageTextFormatAction(text);text = HomepageTextFormatAction(text);text = HomepageTextFormatAction(text);text = HomepageTextFormatAction(text);}
return text;}
function HomepageTextFormatAction(text) {text = text.replace(/\r\n|\r|\n/g,"<br/>");text = text.replace(/\*\*([\s\S]*?)\*\*/g, '<span class="mainWebsiteColor">$1</span>');text = text.replace(/\*([\s\S]*?)\*/g, '<span style="font-weight:bold;">$1</span>');text = text.replace(/___([\s\S]*?)___/g, '<span style="text-decoration:line-through;">$1</span>');text = text.replace(/__([\s\S]*?)__/g, '<span style="text-decoration:overline;">$1</span>');text = text.replace(/_([\s\S]*?)_/g, '<span style="text-decoration:underline;">$1</span>');text = text.replace(/\#\#([\s\S]*?)\#\#/g, '<span class="homepageRandomText" data-text="$1"></span>');text = text.replace(/\#([\s\S]*?)\#/g, '<span class="homepageRandomTextStop" data-text="$1"></span>');return text;}
function isTextFormated( text ) {if ( text.match(/\*\*([\s\S]*?)\*\*/g) ) return true;if ( text.match(/\*([\s\S]*?)\*/g) ) return true;if ( text.match(/___([\s\S]*?)___/g) ) return true;if ( text.match(/__([\s\S]*?)__/g) ) return true;if ( text.match(/_([\s\S]*?)_/g) ) return true;if ( text.match(/\#\#([\s\S]*?)\#\#/g) ) return true;if ( text.match(/\#([\s\S]*?)\#/g) ) return true;return false;}
function SetFontSizeByDevice(fontSize,screenWidth) {var existingFontSizeNUM    = Number(fontSize);var newFontSizeNUM         = existingFontSizeNUM;if (existingFontSizeNUM>18) {newFontSizeNUM = existingFontSizeNUM * (screenWidth / 1170);}
return newFontSizeNUM;}
function CheckMenuSizeAndMoreButton(tempNUM) {if ( !Wizard.Preview.ready ) return;if ( tempNUM == '9'
|| tempNUM == '1'
|| tempNUM == '10'
|| tempNUM == '2'
|| tempNUM == '5'
|| tempNUM == '13' ) {Wizard.Preview.window.ReduseMenuSizeWhenWeDontHavePlace();} else {Wizard.Preview.window.ReduseMenuSizeWhenWeDontHavePlaceHeight();}}
function UpdatePreviewModuleByAjax( moduleID, activeAjax ) {if ( !moduleID ) return;var url = '/?w=' + $('#id').val() +'&interfacePreviewAjax=1&interfacePreviewAjaxTag=section&interfacePreviewAjaxID=section-'+moduleID+'';if ( Wizard.Preview.ready && (Wizard.Preview.iframe.attr('data-device-type') == 'mobile' || Wizard.Preview.iframe.attr('data-device-type') == 'tablet') ) {url += '&interfacePreviewAjaxDevice='+Wizard.Preview.iframe.attr('data-device-type');}
if ( Wizard.Preview.ready && Wizard.Preview.window.multiLanCode != '' ) {window.scrollPreview = '#section-'+moduleID;PreviewWebsiteLanguage();return;}
if ( activeAjax ) {previewLoadingMessage.show();$.get( url, function( data ) {var $frame = $('#websitePreviewIframe').contents();var $currentModule =  $frame.find('#section-'+moduleID);if ( $currentModule.length === 0 ) {previewLoadingMessage.hide();return;}
var newModule = GetTagByIdUsingRegex('section',$currentModule[0].id,data);if ( !newModule ) {previewLoadingMessage.hide();return;}
if ( Wizard.Preview.ready ) {Wizard.Preview.window.DestroyParallaxImages();}
$currentModule.replaceWith(newModule);var $moduleMenusAnchor = $frame.find('li[data-menu-module-id="'+moduleID+'"] a');if ( $moduleMenusAnchor.length > 0 ) {updateModuleName($moduleMenusAnchor,escapeHtml(GetModuleSetting(moduleID,'title')));}
Preview_TriggerS123PageReadyAndLoad();Wizard.refresh();PreviewExternalLinksHandler();SortPreviewModules(false);if ( !preventScrollOnModalClose ) {window.scrollPreview = '#section-'+moduleID;scrollToPointInPreview();} else {preventScrollOnModalClose = false;}
previewLoadingMessage.hide();});} else {window.scrollPreview = '#section-'+moduleID;scrollToPointInPreview();}}
function UpdatePreviewAreaByAjax( selectors, callback, noLoading, url, device = '' ) {if ( typeof url == 'number' ) {url = url.toString();}
var structuresHandler = false;if ( selectors === 'structuresHandler' ) {selectors = ['#websiteHeader','#top-section','footer.global_footer'];if ( abTestTXT == 'siteEditor_b' ) {selectors.push('#section-169');}
structuresHandler = true;}
if ( typeof selectors === 'string' ) selectors = selectors.split(",");var isInitializeHeaderActionButtons = false;$.each(['.navActions','#mainNav'], function(index, subString) {$.each(selectors, function( index, value ) {if (value.indexOf(subString) !== -1) {selectors.splice(index,1);isInitializeHeaderActionButtons = true;return false;}});});if ( isInitializeHeaderActionButtons && selectors.indexOf('#websiteHeader') === -1 ) {selectors.push('#websiteHeader');} else if ( selectors.indexOf('#websiteHeader') !== -1 ) {isInitializeHeaderActionButtons = true;}
var defUrl = url.length > 0 ? '/' + url : '/';if (selectors.toString()=='#top-section') {var path = defUrl + '?w=' + $('#id').val() +'&interfacePreviewAjax=1&interfacePreviewAjaxTag=section&interfacePreviewAjaxID=top-section';} else {if ( $.inArray( "#s123ModulesContainer", selectors ) !== -1 || 1 ) { //Still don't use the ELSE because some tool like PHONE and address use it§
var path = defUrl + '?w=' + $('#id').val() +'&interfacePreviewAjax=1&interfacePreviewAjaxTag='+encodeURIComponent(selectors.toString())+'';} else {var path = defUrl + '?w=' + $('#id').val() +'&interfacePreviewAjax=1&interfacePreviewAjaxTag='+encodeURIComponent(selectors.toString())+'&interfacePreviewNoModulesAjax=1';}}
if ( device.length > 0 ) {path = path + '&interfacePreviewAjaxDevice='+device;}
if ( Wizard.Preview.ready && (Wizard.Preview.iframe.attr('data-device-type') == 'mobile' || Wizard.Preview.iframe.attr('data-device-type') == 'tablet') ) {path = path + '&interfacePreviewAjaxDevice='+Wizard.Preview.iframe.attr('data-device-type');}
if ( Wizard.Preview.ready && Wizard.Preview.window.multiLanCode != '' ) {PreviewWebsiteLanguage();return;}
if ( !noLoading ) {previewLoadingMessage.show(structuresHandler);}
$.get( path, function( data ) {var $frame = $('#websitePreviewIframe').contents();Wizard.Preview.closePopups();var $data  = $(data);var videoTagFix = data.indexOf('<video') !== -1 ? true : false;$(selectors).each( function( index, selector ) {var $area = $frame.find(selector);if ( $area.length === 0 ) return;if ( Wizard.Preview.ready ) {Wizard.Preview.window.DestroyParallaxImages();}
if ( videoTagFix ) {var pattern = /<video[^>]*autoplay[^>]*>/ig;while (match = pattern.exec(data)) {data = data.replace(match[0],match[0].replace(/autoplay/ig,'dataautop'));}}
var $f = $data.find(selector);$area.replaceWith($f);if ( videoTagFix ) {$f.find('video[dataautop]').each(function() {var $this = $(this);$this.removeAttr('dataautop').attr('autoplay','true');});}});if ( isInitializeHeaderActionButtons && Wizard.Preview.ready ) {Wizard.Preview.window.S123Header_InitializeActionButtons();}
ReloadPreviewCSS(function() {if ( structuresHandler && Wizard.Preview.ready ) {Wizard.Preview.window.S123Header_InitializeActionButtons();}
if ( !noLoading ) {previewLoadingMessage.hide();}});Wizard.refresh();SortPreviewModules(false);PreviewExternalLinksHandler();if ( selectors.indexOf('#top-section') != -1 && $('#homepage_style').val() == '3' ) {if ( Wizard.Preview.ready ) {Wizard.Preview.$('.home_background_wrapper').find('.carousel').carousel();}}
if ( callback ) callback();$(document).trigger('UpdatePreviewAreaByAjax.success');});}
function PreviewExternalLinksHandler() {var $frame = $('#websitePreviewIframe').contents();var host = new RegExp('/' + window.location.host + '/');$frame.find('a').not('[data-allow-external-link="true"]').each(function() {if( this.href && !host.test(this.href) && this.href.toLowerCase() !== 'javascript:void(0);' ) {$(this).off('click.previewExternalLinks').on('click.previewExternalLinks', function( event ) {showMessage(event,this.href);});}});$frame.find('a[target="_parent"], a[target="_top"]').each(function() {$(this).attr('target','_self');});$frame.find('form').each(function() {if( this.action && !host.test(this.action)) {$(this).off('submit.previewExternalLinks').on('submit.previewExternalLinks', function( event ) {showMessage(event,this.action);});}});function showMessage( event, link ) {event.preventDefault();event.stopPropagation();var $externalLinksMessage = bootbox.alert({title: translations.previewExternalLinkTitle,message: translations.previewExternalLinkMsg.replace('{{externalLink}}','<b>'+link+'</b>'),className: 'externalAlert'});$externalLinksMessage.on('hidden.bs.modal',function() {Wizard.Preview.$document.trigger('previewExternalLinksClosedBootbox');});}}
function Preview_TriggerS123PageReadyAndLoad() {var websitePreviewIframe = document.getElementById("websitePreviewIframe");if ( websitePreviewIframe && websitePreviewIframe.contentWindow
&& websitePreviewIframe.contentWindow.TriggerS123PageReady ) {websitePreviewIframe.contentWindow.TriggerS123PageReady();websitePreviewIframe.contentWindow.TriggerS123PageLoad();}}
function Preview_TriggerS123CSSReload() {var websitePreviewIframe = document.getElementById("websitePreviewIframe");if ( websitePreviewIframe && websitePreviewIframe.contentWindow
&& websitePreviewIframe.contentWindow.TriggerS123CSSReload ) {websitePreviewIframe.contentWindow.TriggerS123CSSReload();}}
function GetTagByIdUsingRegex(tag,id,html) {return new RegExp("<" + tag + "[^>]*id[\\s]?=[\\s]?['\"]" + id + "['\"][\\s\\S]*?<\/" + tag + ">").exec(html);}
function RefreshPreview() {if ( isPreviewReload == false || viewButtonReload==true ) {viewButtonReload = false;return;}
if ( Wizard.Preview.ready && Wizard.Preview.window.multiLanCode != '' ) {PreviewWebsiteLanguage();return;}
if ( g_ManageModuleID && g_ManageModuleID!='' ) {ReloadPreviewAndGoToModule(g_ManageModuleID,true);} else {ReloadPreviewIframe('/?w='+$('#id').val()+'&disableCache='+getRandomInt(0,9999999));}}
function PreviewWebsiteLanguage( languageCode ) {if ( languageCode && languageCode.length !== 0 ) {ReloadPreviewIframe('/t-'+languageCode+'?w='+$('#id').val()+'&disableCache='+getRandomInt(0,9999999));} else {ReloadPreviewIframe('/?w='+$('#id').val()+'&disableCache='+getRandomInt(0,9999999));}}
function PreviewModulePage(url) {if ( url && url.length !== 0 ) {ReloadPreviewIframe(url+'?w='+$('#id').val()+'&disableCache='+getRandomInt(0,9999999));} else {ReloadPreviewIframe('/?w='+$('#id').val()+'&disableCache='+getRandomInt(0,9999999));}}
function isNumeric(n) {return !isNaN(parseFloat(n)) && isFinite(n);}
function ReloadPreviewAndGoToModule( moduleID, activeAjax ) {var $module = $('#card_'+moduleID+'');var moduleTypeNUM = $module.data('moduletypenum');var systemModule = false;if ( moduleTypeNUM == '78' ||  moduleTypeNUM == '108' ) return;var reload = false;if ( !isNumeric(moduleTypeNUM) ) {moduleTypeNUM = moduleID;systemModule = true;}
if ( isNumeric(moduleTypeNUM) &&modulesArr[Number(moduleTypeNUM)] &&modulesArr[Number(moduleTypeNUM)]['module_kind'] &&modulesArr[Number(moduleTypeNUM)]['module_kind'] == '2' ) {if ( moduleTypeNUM == '115' ) {UpdatePreviewAreaByAjax(['#header .header-column-menu-actions','#mainNav .header-phone-wrapper','#mainNavMobile .header-phone-wrapper','#header-phone-content','#mainNav .header-email-wrapper','#mainNavMobile .header-email-wrapper','#header-email-content','#header-address','#globalContactEmailSettings','#s123ModulesContainer'],false,false,'');return;} else {reload = true;}}
var disableAjaxRedirect = ( (IsSinglePage() || IsLandingPage()) && !IsPreviewAtHomepage() );if ( !IsSinglePage() && !IsLandingPage() && Wizard.Preview.Scale.mode == 'mobile' && $module.data('module-hide-from-mobile') == '1' && IsPreviewAtHomepage() ) {reload = true;}
var scrollInRichPage = false;if ( IsPreviewAtRichPage(RichPage.moduleID) && RichPage.isChild($module) ) scrollInRichPage = true;if ( IsPreviewAtRichPage($module.data('moduleid')) && RichPage.isRichPage($module.data('moduletypenum')) ) scrollInRichPage = true;if ( !reload && !disableAjaxRedirect && (IsSinglePage() || IsLandingPage() || (IsPreviewAtHomepage() && $module.data('module-mp-show-in-home') == '1') || scrollInRichPage || isEcommerceAjaxReload(moduleTypeNUM,$module) ) ) {if ( RichPage.isActive && IsPreviewAtRichPage(RichPage.moduleID) && (RichPage.isChild($module) || RichPage.isRichPage($module.data('moduletypenum'))) ) {if ( activeAjax ) {let selectors = ['#section-'+moduleID];if ( moduleTypeNUM == '112' ) {selectors = ['#top-menu-mobile','#mainNav ul.navPages','footer.global_footer ul.navPages',...Wizard.Ecommerce.getPreviewSelectors()];}
if ( $module.data('items-module-id') && $module.data('items-module-id').length > 0 ) {var itemsModuleID = $module.data('items-module-id');var $itemsModules = Wizard.Pages.list.filter('[data-items-module-id="'+itemsModuleID+'"]:not(#card_'+moduleID+'),#card_'+itemsModuleID);} else {var $itemsModules = Wizard.Pages.list.filter('[data-items-module-id="'+moduleID+'"]');}
if ( $itemsModules.length > 0 ) {$itemsModules.each(function() {selectors.push('#section-'+$(this).data('moduleid'));});}
UpdatePreviewAreaByAjax(selectors
,function() {window.scrollPreview = RichPage.isFirstChild($module) ? '#section-' + RichPage.moduleID : '#section-' + $module.data('moduleid');window.scrollPreview = '#section-'+moduleID;scrollToPointInPreview();},false,RichPage.getPageUrl($module));} else {window.scrollPreview = RichPage.isFirstChild($module) ? '#section-' + RichPage.moduleID : '#section-' + $module.data('moduleid');scrollToPointInPreview();}
return;}
if ( activeAjax && moduleTypeNUM == '7' ) {UpdatePreviewAreaByAjax(['#header-phone-content','#header-address','#s123ModulesContainer'],function() {window.scrollPreview = '#section-'+moduleID;scrollToPointInPreview();},false,'');} else if ( activeAjax && moduleTypeNUM == '112' ) {var pageUrl = '';if ( IsPreviewAtAnyRichPage() ) {pageUrl = GetModuleSetting(Wizard.Preview.$('.s123-module-rich-page').data('module-id'),'url');} else if ( !IsPreviewAtHomepage() && Wizard.Preview.ready ) {Wizard.Preview.window.location.reload();previewLoadingMessage.hide();return;}
UpdatePreviewAreaByAjax(['#top-menu-mobile','#mainNav ul.navPages','footer.global_footer ul.navPages',...Wizard.Ecommerce.getPreviewSelectors()],false,false,pageUrl);} else if ( activeAjax && Wizard.Ecommerce.isEcommerceHighlight(moduleTypeNUM) ) {UpdatePreviewAreaByAjax(['#section-' + moduleID],false,false,'');} else {var $wizardPage = Wizard.Pages.getPage(moduleID);if ( $wizardPage.data('items-module-id') && $wizardPage.data('items-module-id').length > 0 ) {var itemsModuleID = $wizardPage.data('items-module-id');var $itemsModules = Wizard.Pages.list.filter('[data-items-module-id="'+itemsModuleID+'"]:not(#card_'+moduleID+'),#card_'+itemsModuleID);} else {var $itemsModules = Wizard.Pages.list.filter('[data-items-module-id="'+moduleID+'"]');}
if ( $itemsModules.length > 0 ) {var selectors = ['#section-'+moduleID];$itemsModules.each(function() {selectors.push('#section-'+$(this).data('moduleid'));});UpdatePreviewAreaByAjax(selectors,function() {window.scrollPreview = '#section-'+moduleID;scrollToPointInPreview();},false,'');} else {UpdatePreviewModuleByAjax(moduleID,activeAjax);}}} else {if ( $('#moduleWindow').data('opened-from-preview') ) {$('#moduleWindow').data('opened-from-preview',false);if ( Wizard.Preview.ready ) Wizard.Preview.window.location.reload();return;}
var homepageRedirect = false;if ( !GetModuleSetting(moduleID,'parentId') &&GetModuleSetting(moduleID,'mp_showInMenu') == '0' &&GetModuleSetting(moduleID,'mp_showInHome') == '1' &&GetModuleSetting(moduleID,'showInFooter') == '0') {homepageRedirect = true;}
if ( Wizard.Ecommerce.isEcommerceHighlight(moduleTypeNUM) && !RichPage.isChild($module) ) {homepageRedirect = true;}
if ( isNumeric(moduleTypeNUM) &&modulesArr[Number(moduleTypeNUM)] &&modulesArr[Number(moduleTypeNUM)]['module_kind'] &&modulesArr[Number(moduleTypeNUM)]['module_kind'] == '3' &&!RichPage.isActive ) {homepageRedirect = true;}
if ( moduleTypeNUM == '24' ) homepageRedirect = true;if ( IsSinglePage() || IsLandingPage() ) homepageRedirect = true;if ( homepageRedirect ) {if ( !systemModule ) window.scrollPreview = '#section-' + moduleID;ReloadPreviewIframe( '/?w=' + $('#id').val() );} else if ( RichPage.isChild($module) ) {if ( RichPage.isFirstChild($module) ) {window.scrollPreview = '#section-' + RichPage.moduleID;} else {window.scrollPreview = '#section-' + $module.data('moduleid');}
ReloadPreviewIframe('/'+RichPage.getPageUrl($module)+'?w=' + $('#id').val());scrollToPointInPreview();} else {var url = '/' + GetModuleSetting(moduleID,'url') + '?w=' + $('#id').val();if ( !activeAjax && Wizard.Preview.ready && Wizard.Preview.window.location.href.indexOf(url) !== -1 ) return;ReloadPreviewIframe(url);}}
function isEcommerceAjaxReload( moduleTypeNUM, $module ) {if ( moduleTypeNUM != '112' ) return false;return $module.data('module-mp-show-in-home') == '1';}}
function SetHomepageModule(id, name) {$('#homepage_goal').val(id);SetHomepageGoal();$('#homepage_goal').trigger('change');$('#SetHomepageGoalWin').modal('hide');}
function SetHomepageGoal() {var homepage_goal = $('#homepage_goal').val();var template = $('#template').val();if ( template == '15' || template == '20' ) {$('#homepage_layout_height').val(100).trigger('change'); //The homepage need to be 100% from the screen
}
if ( Wizard.Preview.ready ) {Wizard.Preview.$document.trigger('SetHomepageGoal',[template]);}
$('#home_secondary_background_color').closest('.form-group').addClass('hidden');ShowHideTextLayoutElementsIfUnused();if (homepage_goal=='12') {$('#home_secondary_background_color').closest('.form-group').removeClass('hidden');}
Wizard.readyTextLayoutsHandler.printTextLayouts();if ( $('#home_buttonText').val() == '' ) $('#home_buttonText').val(translations.learnMore);}
function ShowEditButtonsOnActive() {if ( !$("#showMailing").get(0).checked ) $("#showMailingEditButton").hide();$("#showMailing").on('change', function() {this.checked ? $("#showMailingEditButton").show() :$("#showMailingEditButton").hide();});if ( !$("#showSocial").get(0).checked ) $("#showSocialEditButton").hide();$("#showSocial").on('change', function() {this.checked ? $("#showSocialEditButton").show() :$("#showSocialEditButton").hide();});if ( !$("#showHeaderSocial").get(0).checked ) $("#showSocialEditButtonForHeader").hide();$("#showHeaderSocial").on('change', function() {if ( this.checked ) {$("#showSocialEditButtonForHeader").show();$('.showHeaderSocial-missing-value').closest('.header-menu-missing-value').show();} else {$("#showSocialEditButtonForHeader").hide();$('.showHeaderSocial-missing-value').closest('.header-menu-missing-value').hide();}});if ( !$("#showHeaderPhone").get(0).checked ) $("#collapseHeaderOptionsEnterPhoneNumber").hide();$("#showHeaderPhone").on('change', function() {this.checked ? $("#collapseHeaderOptionsEnterPhoneNumber").show() :$("#collapseHeaderOptionsEnterPhoneNumber").hide();});if ( !$("#showHeaderEmail").get(0).checked ) $("#collapseHeaderOptionsEnterEmail").hide();$("#showHeaderEmail").on('change', function() {this.checked ? $("#collapseHeaderOptionsEnterEmail").show() :$("#collapseHeaderOptionsEnterEmail").hide();});if ( !$("#showHeaderAddress").get(0).checked ) $("#collapseHeaderOptionsEnterAddress").hide();$("#showHeaderAddress").on('change', function() {this.checked ? $("#collapseHeaderOptionsEnterAddress").show() :$("#collapseHeaderOptionsEnterAddress").hide();});if ( !$("#showTerms").get(0).checked ) $("#showTermsEditButton").hide();$("#showTerms").on('change', function() {this.checked ? $("#showTermsEditButton").show() :$("#showTermsEditButton").hide();});if ( !$("#showPrivacy").get(0).checked ) $("#showPrivacyEditButton").hide();$("#showPrivacy").on('change', function() {this.checked ? $("#showPrivacyEditButton").show() :$("#showPrivacyEditButton").hide();});if ( !$("#showAccessibility").get(0).checked ) $("#showAccessibilityEditButton").hide();$("#showAccessibility").on('change', function() {this.checked ? $("#showAccessibilityEditButton").show() :$("#showAccessibilityEditButton").hide();});if ( !$("#showActionsButtons").get(0).checked ) $("#showActionsButtonsBOX").hide();$("#showActionsButtons").on('change', function() {if (this.checked) {if ($('#topAction_buttonText_1').val()=='' && $('#topAction_buttonText_2').val()=='') {$('#topAction_buttonText_1').val(translations.buttonOne).trigger('change');}
$("#showActionsButtonsBOX").show();} else {$("#showActionsButtonsBOX").hide();}});if ( !$("#showMailing").get(0).checked ) $("#footerMailingListEditButton").parent().hide();$("#showMailing").on('change', function() {this.checked ? $("#footerMailingListEditButton").parent().show() : $("#footerMailingListEditButton").parent().hide();});if ( !$("#showCookieConsent").get(0).checked ) $("#footerCookieEditButton").parent().hide();$("#showCookieConsent").on('change', function() {this.checked ? $("#footerCookieEditButton").parent().show() : $("#footerCookieEditButton").parent().hide();});if ( !$("#showHeaderClientZone").get(0).checked ) $("#headerLoginEditButton").parent().hide();$("#showHeaderClientZone").on('change', function() {this.checked ? $("#headerLoginEditButton").parent().show() : $("#headerLoginEditButton").parent().hide();});if ( !$("#showHeaderSearch").get(0).checked ) $("#headersearchEditButton").parent().hide();$("#showHeaderSearch").on('change', function() {this.checked ? $("#headersearchEditButton").parent().show() : $("#headersearchEditButton").parent().hide();});if ( !$("#showS123Popups").get(0).checked ) {$("#s123PopupsEditButton").parent().hide();$("#s123PopupsPreviewButton").parent().hide();}
$("#showS123Popups").on('change', function() {this.checked ? $("#s123PopupsEditButton").parent().show() : $("#s123PopupsEditButton").parent().hide();this.checked ? $("#s123PopupsPreviewButton").parent().show() : $("#s123PopupsPreviewButton").parent().hide();});}
function getRandomInt(min, max) {return Math.floor(Math.random() * (max - min + 1)) + min;}
function doneTyping () {BuildToolJSON();AutoSaveWizard(true,true);}
function wizardTour() {var voiceOver = '_v2';var wizardTour = new Tour({steps: [{element: "#wizardTab2button",title: translations.Homepage,content: translations.editHomepageText + '<div class="media" data-title="'+translations.Homepage+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/homepage_beta_tour_v1.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/homepage.jpg?v=2"><img src="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/homepage.jpg?v=2"></div>'},{element: "#wizardTab4button",title: translations.Pages,content: translations.useReadyMadeModules + '<div class="media" data-title="'+translations.Pages+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/pages'+voiceOver+'.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/pages.jpg?v=2"><img src="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/pages.jpg?v=2"></div>'},{element: "#wizardTab6button",title: translations.Design,content: translations.designCustomize + '<div class="media" data-title="'+translations.Design+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/design'+voiceOver+'.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/design.jpg?v=2"><img src="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/design.jpg?v=2"></div>'},{element: "#wizardTab8button",title: translations.Settings,content: translations.settingsGeneral + '<div class="media" data-title="'+translations.Settings+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/settings'+voiceOver+'.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/settings.jpg?v=2"><img src="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/settings.jpg?v=2"></div>'},{element: "#wizardTab9button",title: translations.Domain,content: translations.DomainTourExplain + '<div class="media" data-title="'+translations.Domain+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/domain'+voiceOver+'.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/domain.jpg?v=2"><img src="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/domain.jpg?v=2"></div>'},{element: "#previewButtons",title: translations.Preview,content: translations.previewCheckLooks + '<div class="media" data-title="'+translations.Preview+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/preview'+voiceOver+'.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/preview.jpg?v=2"><img src="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/preview.jpg?v=2"></div>'},{element: "#publishWebsiteButton",title: translations.Publish,content: translations.PublishChangeExp + '<div class="media" data-title="'+translations.Publish+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/publish'+voiceOver+'.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/publish.jpg?v=2"><img src="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/publish.jpg?v=2"></div>'}],template : function(tour) {var html = '';html += "<div class='popover tour tour3'>";html += "<div class='arrow'></div>";html += "<button type='button' class='close' style='opacity:1;' aria-label='Close' data-role='end'><span aria-hidden='true'><i class='ace-icon fal fa-times red2'></i></span></button>";html += "<h3 class='popover-title'></h3>";html += "<div class='popover-content'></div>";html += "<div class='popover-navigation'>";html += "<div style='width:100%;display:flex;justify-content:flex-end;'>";html += "<button type='button' class='btn btn-link btn-sm' data-role='prev'>« "+translations.Previous+"</button>";if ( wizardTour._options.steps.length === (wizardTour.getCurrentStep() + 1) ) {html += "<button type='button' class='btn btn-primary btn-sm finish-tour' data-role='end'>"+translations.Finish+"</button>";} else {html += "<button type='button' class='btn btn-primary btn-sm' data-role='next'>"+translations.Next+" »</button>";}
html += "</div>";html += "</div>";html += "</div>";return html;},backdrop: true,onShown: function(tour) {if ( $('html[dir=rtl]').length > 0 ) {var getFocusEle = tour.getStep(tour.getCurrentStep()).element;$('.tour-tour').css({left: 'auto',right: $(window).width()-$(getFocusEle).offset().left+'px'});$('.popover.right > .arrow').css({left: 'auto',right: '-11px',transform: 'scale(-1, 1)'});}
$('.popover.tour.tour3').find('.media').click(function() {var $this = $(this);ShowTourVideoExplain($this.data('title'),$this.data('video'),$this.data('image-preview'));});$('.popover.tour.tour3').find('.finish-tour').click(function() {$(document).trigger('user_action_update_flag',[{name: 'flag_FinishTour', triggerName: false}]);});},onHidden: function(tour) {}});wizardTour.restart();}
function ShowTourVideoExplain( title, video, imagePreview ) {var bootMessage = '';bootMessage += '<div class="s-v-e">';bootMessage += '<div class="hidden-xs">';bootMessage += '<ul class="side-tabs list-group">';bootMessage += '<li class="list-group-item" data-title="'+translations.Homepage+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/homepage_beta_tour_v1.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/homepage.jpg?v=2">';bootMessage += '<i class="fal fa-home"></i>';bootMessage += '<span>'+translations.Homepage+'</span>';bootMessage += '</li>';bootMessage += '<li class="list-group-item" data-title="'+translations.Pages+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/pages_v2.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/pages.jpg?v=2">';bootMessage += '<i class="fal fa-tasks"></i>';bootMessage += '<span>'+translations.Pages+'</span>';bootMessage += '</li>';bootMessage += '<li class="list-group-item" data-title="'+translations.Design+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/design_v2.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/design.jpg?v=2">';bootMessage += '<i class="fal fa-paint-brush"></i>';bootMessage += '<span>'+translations.Design+'</span>';bootMessage += '</li>';bootMessage += '<li class="list-group-item" data-title="'+translations.Settings+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/settings_v2.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/settings.jpg?v=2">';bootMessage += '<i class="fal fa-cog"></i>';bootMessage += '<span>'+translations.Settings+'</span>';bootMessage += '</li>';bootMessage += '<li class="list-group-item" data-title="'+translations.Domain+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/domain_v2.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/domain.jpg?v=2">';bootMessage += '<i class="fal fa-globe"></i>';bootMessage += '<span>'+translations.Domain+'</span>';bootMessage += '</li>';bootMessage += '<li class="list-group-item" data-title="'+translations.Preview+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/preview_v2.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/preview.jpg?v=2">';bootMessage += '<i class="fal fa-desktop"></i>';bootMessage += '<span>'+translations.Preview+'</span>';bootMessage += '</li>';bootMessage += '<li class="list-group-item" data-title="'+translations.Publish+'" data-video="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/publish_v2.mp4?v=2" data-image-preview="'+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/wizardTour/publish.jpg?v=2">';bootMessage += '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bullhorn" class="svg-inline--fal fa-bullhorn fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M576 240c0-23.63-12.95-44.04-32-55.12V32.01C544 23.26 537.02 0 512 0c-7.12 0-14.19 2.38-19.98 7.02l-85.03 68.03C364.28 109.19 310.66 128 256 128H64c-35.35 0-64 28.65-64 64v96c0 35.35 28.65 64 64 64h33.7c-1.39 10.48-2.18 21.14-2.18 32 0 39.77 9.26 77.35 25.56 110.94 5.19 10.69 16.52 17.06 28.4 17.06h74.28c26.05 0 41.69-29.84 25.9-50.56-16.4-21.52-26.15-48.36-26.15-77.44 0-11.11 1.62-21.79 4.41-32H256c54.66 0 108.28 18.81 150.98 52.95l85.03 68.03a32.023 32.023 0 0 0 19.98 7.02c24.92 0 32-22.78 32-32V295.13C563.05 284.04 576 263.63 576 240zm-96 141.42l-33.05-26.44C392.95 311.78 325.12 288 256 288v-96c69.12 0 136.95-23.78 190.95-66.98L480 98.58v282.84z"></path></svg>';
bootMessage += '<span>'+translations.Publish+'</span>';bootMessage += '</li>';bootMessage += '</ul>';bootMessage += '</div>';bootMessage += '<div class="message">';bootMessage += '<iframe style="display: block;color:white;width:100%;height:100%;" type="text/html" src="' + '/include/globalVideoPlayerInterface.php?url=' + encodeURIComponent(video) +'&poster=' + encodeURIComponent(imagePreview) + '&autoplay=true" frameborder="0" allowfullscreen=""></iframe>';bootMessage += '</div>';bootMessage += '</div>';var $bootMessage = $(bootMessage);var $iframe = $bootMessage.find('iframe');setActiveTab(title);$bootMessage.find('.side-tabs li').on('click.change_video', function( event ) {event.preventDefault();var $this = $(this);$iframe.attr('src','/include/globalVideoPlayerInterface.php?url=' + encodeURIComponent($this.data('video')) +'&poster=' + encodeURIComponent($this.data('image-preview')) + '&autoplay=false');$iframe.one('load', function() {$bootMessage.find('.message').fadeIn(200);});$bootMessage.find('.message').fadeOut(200,function() {setActiveTab($this.data('title'));});$('.singleVideoExplain .modal-header h4').html($(this).data('title'));});bootbox.dialog({title: title,message: $bootMessage,backdrop: true,closeButton: true,onEscape: true,blurBackground: '.popover.tour.tour3',size: 'x-large',className: 'bootbox_promoteModal singleVideoExplain tutorial'});$(document).trigger('user_action_update_flag',[{name: 'flag_OpenTutorialVideo', triggerName: false}]);function setActiveTab( title ) {$bootMessage.find('.side-tabs > li').removeClass('active');$bootMessage.find('.side-tabs li[data-title="'+title+'"]').addClass('active');}}
function ShowTourWelcomeVideoExplain( title, video, imagePreview, className ) {var bootMessage = '<div class="message">';bootMessage += '<video style="width: 100%;height:auto;" controls autoplay poster="'+imagePreview+'"><source src="'+video+'" type="video/mp4"></video>';bootMessage += '</div>';bootbox.dialog({title: title,message: bootMessage,backdrop: true,closeButton: true,onEscape: true,blurBackground: '.main-container',size: 'x-large',className: 'bootbox_promoteModal singleVideoExplain ' + className});}
function WizardLoadError() {bootbox.alert({title: translations.Warning,message: 'The wizard does not load properly, please try to load it again'});}
function MakeSureWizardReadyToGo() {if ($('input#home_start_image').length>0) {wizardReadyToGo = true;}}
function GetActivePlugins() {var request = $.post('/versions/2/wizard/plugins/activePluginsAjex_v2.php', {w : websiteID,}).done(function( data ) {if ( data.length != 0) {$('#activePluginList').html(data);} else {$('#activePluginList').empty();}});}
function GetActiveLanguages() {if ($('#activeLanguagesList').length>0) {var request = $.post('/versions/2/wizard/languagesManager/activeLanguagesAjax.php', {w : websiteID,}).done(function( data ) {if ( data.length != 0) {$('#activeLanguagesList').html(data);ManageLanguageButtonActiveEvent();$('#language').parents('.form-group').addClass('disableBox');$('#language').parents('.col-xs-12').attr('data-rel', 'tooltip');$('#language').parents('.col-xs-12').attr('title',translations.languageRegionDisable);$('#language').parents('.col-xs-12').tooltip({placement: "bottom"});$('#countryFlagCode_box').show();} else {$('#activeLanguagesList').empty();$('#language').parents('.form-group').removeClass('disableBox');$('#language').parents('.col-xs-12').removeAttr('title');$('#language').parents('.col-xs-12').removeAttr('data-rel');$('#language').parents('.col-xs-12').tooltip('disable');$('#countryFlagCode_box').hide();}});}}
function IsSinglePage() {return $('input[name=onepage]:checked').val() == '1';}
function IsLandingPage() {return $('input[name=onepage]:checked').val() == '2';}
function IsNotInHomepageAndNotOnMenu() {return $('#pagesTab').attr('data-pages-n-i-m-o-h-tab') == 'showOthersTab';}
function IsPreviewAtHomepage() {if ( !Wizard.Preview.ready ) return false;return Wizard.Preview.$('html.home_page:not(.rich_page)').length === 1;}
function IsPreviewAtRichPage( moduleID ) {if ( !Wizard.Preview.ready ) return false;return Wizard.Preview.$('html.rich_page #section-' + moduleID).length === 1;}
function IsPreviewAtAnyRichPage() {if ( !Wizard.Preview.ready ) return false;return Wizard.Preview.$('html.rich_page').length === 1;}
function OpenModuleManagmentWizardFromPreview( moduleID, moduleTypeNUM, itemUniqueID, isHomepage, action ) {OpenModuleWindow(moduleID,moduleTypeNUM,itemUniqueID,false,action);$('#moduleWindow').data('opened-from-preview',!isHomepage);$('#moduleWindow').data('close-on-save',action == 'editItem');$('#moduleWindow').modal('show');SetEnlargeWindow(moduleTypeNUM,false);}
var previewLoadingMessage = new function() {var container = $('#previewBox');var template = '<div id="previewLoadingMessage"><i class="ace-icon fal fa-spinner fa-solid fa-spin white fa-5x"></i></div>';var exist = $('#websitePreviewIframe').length !== 0;this.show = function( structuresHandler ) {if ( !exist ) return;if ( !this.loading ) this.loading = $(template).appendTo(container);if ( structuresHandler ) this.loading.addClass('structuresHandler');};this.hide = function() {if ( !exist ) return;if ( !this.loading ) return;var that = this;if ( that.loading.hasClass('structuresHandler') ) {setTimeout(function() {if ( !that.loading ) return;that.loading.remove();that.loading = false;if ( $('.chooseUniqueStyle').data('template-change-in-progress') ) {$('.chooseUniqueStyle').trigger('style_change',false);}},2000);} else {that.loading.remove();that.loading = false;}};};function SendUserToDashboard(url) {disableLeavePopup = true;location.href = url;}
function WebsiteBackgroundImageHandler() {$('#website_background_color_image').on('change',function( event, s3Obj ) {if ( $(this).val() !== '' ) {if ( !s3Obj ) return;if ( !$.isNumeric(s3Obj.w) ) return;if ( parseInt(s3Obj.w) >= 1920 ) {$('#website_background_type').val('cover');} else {$('#website_background_type').val('repeat');}
$('#website_background_color').spectrum('set','#fff');}});}
function SetHomepageGoal_SoundPlayerSettings() {if ( $('#homepage_goal_type').val() !== 'sound' ) return;if ( !Wizard.Preview.ready ) return;if ( Wizard.Preview.$('#homepage_player').length === 0 ) return;var $homepage_sound_color_select = $('#homepage_sound_color_select');var $homepage_sound_theme_select = $('#homepage_sound_theme_select');var $global_main_color = $('#global_main_color');var homepage_player_url = Wizard.Preview.$('#homepage_player').attr('src');homepage_player_url = replaceUrlParam(homepage_player_url,'playerColor',encodeURIComponent($homepage_sound_color_select.val()));homepage_player_url = replaceUrlParam(homepage_player_url,'mainColor',encodeURIComponent($global_main_color.val()));homepage_player_url = replaceUrlParam(homepage_player_url,'playerTheme',encodeURIComponent($homepage_sound_theme_select.val()));Wizard.Preview.$('#homepage_player').attr('src',homepage_player_url);}
var Wizard = function() {var Wizard = {};Wizard.init = function() {Wizard.Tabs.init();Wizard.Pages.init();Wizard.Tips.init();Wizard.bootstrapMultiModalHandler();Wizard.userActions.init({userActions: userActions});Wizard.footerHandler.init();Wizard.loader.init();Wizard.tabEffectHandler.init();Wizard.inputTextEditButtonsHandler.init();Wizard.readyTextLayoutsHandler.init();Wizard.websiteToggleOptionsHandler.init(false);Wizard.NavBar.init();Wizard.websiteLogoMakerTool.init();if ( abTestTXT != 'siteEditor_b' && $('html').data('device') !== 'mobile' ) {Wizard.inlineIllustrations = new InlineIllustrations({'container': $('.inline-illustration-images'),'uploadInput': 'home_custom_image','tool': 'homepage','websiteID': $('#id').val()});HomepageTemplates.init({isMobile: false, // we don't want to add "load more button"
$container: $('.chooseUniqueStyle'),page: 1});PrintHomepagePopularGoals();}
Wizard.promoFonts.init();Wizard.websiteHeaders.init();Wizard.headerHandler.init();Wizard.Ecommerce.init();Wizard.WebsiteTypeVideoPopup.init();};Wizard.refresh = function() {Wizard.Pages.refresh();Wizard.Preview.refresh();}
Wizard.bootstrapMultiModalHandler = function() {$(document).on('shown.bs.modal', function ( event ) {var $modal = $(event.target);$('.modal-backdrop.in:not([id])').attr('id',$modal.get(0).id+'_backdrop');$modal.trigger('bootstrapMultiModalHandler.id.added');});}
Wizard.Save = {$el: $('#savedStatus'),inProgress: function() {var loadingIcon = '<div class="loading-icon" style="width: 100%;">';loadingIcon += '<i class="ace-icon fal fa-spinner fa-solid fa-spin fa-2x"></i>';loadingIcon += '</div>';this.$el.html(loadingIcon).show();},success: function() {this.$el.html(translations.Saved).show();},error: function() {this.$el.html(translations.InternetNetworkError).show();}};Wizard.UpdateModuleItemSettings = function( moduleID, moduleTypeNUM, settingsObj ) {var itemsModuleID = Wizard.Pages.getPage(moduleID).data('items-module-id');return new Promise(function(resolve, reject) {Wizard.Save.inProgress();$.ajax({type: "POST",url: "/versions/2/wizard/modules/updateItemMultipleSettings.php",data: {w: websiteID,moduleID: itemsModuleID.length > 0 ? itemsModuleID : moduleID,moduleTypeNUM: moduleTypeNUM,settingsObj: JSON.stringify(settingsObj)},success: function( data ) {data = tryParseJSON(data);if ( data.success ) {var $iframe = $('.inline-wizard-iframe:is([data-moduletypenum="1000"],[data-moduletypenum="169"],[data-moduletypenum="167"])');if ( $iframe.length > 0 && $iframe.get(0).contentWindow.updateItemSetting ) {$.each(settingsObj, function(key, value) {$iframe.get(0).contentWindow.updateItemSetting(key,value);});}
if ( moduleTypeNUM == '167' ) {if ( itemsModuleID.length > 0 ) {var $itemsModules = Wizard.Pages.list.filter('[data-items-module-id="'+itemsModuleID+'"]:not(#card_'+moduleID+'),#card_'+itemsModuleID);} else {var $itemsModules = Wizard.Pages.list.filter('[data-items-module-id="'+moduleID+'"]');}
if ( $itemsModules.length > 0 ) {var selectors = [];$itemsModules.each(function() {selectors.push('#section-'+$(this).data('moduleid'));});UpdatePreviewAreaByAjax(selectors,false,false,'');}}
Wizard.Save.success();resolve(data);} else {Wizard.Save.error();}},error: function() {Wizard.Save.error();resolve(false);}});});};Wizard.getUndoFields = function() {var more_settings_arr = ['wizardUndoRefreshHelper','websiteStructureNUM','header_width','header_size','header_logo_back_color','header_font_style','menu_pages_style','menu_font_size','menu_pages_space','menu_pages_side_padding','menu_pages_letter_spacing','menu_pages_word_spacing','footer_layout','page_header_style','home_opacity','homepageFilterImage','header_opacity','header_style','home_third_background_color','homepageGradientsColors','home_start_image','homepage_goal','template','home_text_size','home_text_size_2','slogan_text_size','home_text_size_weight','home_text_italic','home_text_size_2_weight','home_text_2_italic','slogan_text_size_weight','slogan_text_italic','home_text_shadow_1','home_text_shadow_2','home_text_shadow_3','home_text_background_1','home_text_background_2','home_text_background_3','home_text_letter_spacing_1','home_text_letter_spacing_2','home_text_letter_spacing_3','home_text_word_spacing_1','home_text_word_spacing_2','home_text_word_spacing_3','home_text_rotate_1','home_text_rotate_2','home_text_rotate_3','home_text_line_height_1','home_text_line_height_2','home_text_line_height_3','home_text_top_space_1','home_text_bottom_space_1','home_text_top_space_2','home_text_bottom_space_2','home_text_top_space_3','home_text_bottom_space_3','homepage_style','home_background_color','home_text_color','home_text_animation_1','home_text_animation_2','home_text_animation_3','home_siteSlogan','home_siteSlogan_2','home_SecondSiteSlogan','font_slogan','font_slogan_2','font_second_slogan','home_buttonText','home_buttonText_style','home_buttonText_type','home_scrollSection','home_buttonText_icon','home_buttonText_1','home_buttonText_1_style','home_buttonText_1_type','home_scrollSection_1','home_buttonText_1_icon','videoType','home_video','home_custom_video','homepageTextCustomBoxStyle','global_main_color','menu_color','menu_text_color','menu_text_hover_color','menu_thin_border','module_separate_border_color','modules_color','modules_color_text','modules_color_box','modules_color_text_box','modules_color_second','modules_color_text_second','modules_color_second_box','modules_color_text_second_box','footer_back','footer_text','buttons_radius','all_fonts','homepageShapeDivider','homepageShapeDividerList_Color1','homepageShapeDividerList_Size','homepageShapeDividerList_Mobile','name','logo_font_size','logo_size','siteLogo_preview','siteLogo','siteLogoStyle','home_slider_image_1','home_slider_image_1_settings','home_slider_image_2','home_slider_image_2_settings','home_slider_image_3','home_slider_image_3_settings','home_slider_image_4','home_slider_image_4_settings','home_slider_image_5','home_slider_image_5_settings','home_slider_chaning_speed','home_start_image_settings','parallax_homepage_image','typographySize','website_background_color_image','website_background_type','website_background_color','customTemplate','homepageStructure','home_video_background','logo_img_size','siteLogoImageStyle','logo_text_letter_spacing','logo_text_word_spacing','logo_text_size_weight','logo_icon_text_spacing','logo_text_italic','homepage_layout_kind','layout_text_align','layout_text_position','layout_homepage_full_width','layout_text_box_width','layout_left_side_width','layout_bottom_spacing','homepage_goal_space','homepage_second_goal_space','homepage_layout_height','homepage_goal_type','homepage_goal_place','homepage_goal_position','homepage_second_goal_type','homepage_second_goal_place','home_custom_image','home_custom_image_size','home_custom_image_width','home_upload_sound','video_popup_icon_style','home_embed_sound_cloud','embed_url_width_sound_cloud','embed_url_height_sound_cloud','home_embed_facebook_like_box','embed_url_width_facebook','embed_url_height_facebook','home_embed_twitter','embed_url_width_twitter','embed_url_height_twitter','home_embed_pinterest','embed_url_width_pinterest','embed_url_height_pinterest','homepage_video_width','homepage_form_style','homepage_custom_html','home_secondary_background_color','home_youtube_background','home_buttonRedirect','home_buttonRedirect_1','homepage_form_style_max_width','homepage_email_collector','homepage_email_notification','homepage_conv_code','activeReplyMessageHomepage','reply_subject_message_homepage','reply_message_homepage','activeHomepageCustomForm','HomepageCustomFormButtonText','HomepageCustomFormNextButtonText','HomepageCustomFormPrevButtonText','HomepageCustomFormType','HomepageCustomFormData','HomepageHorizontalCustomFormData','homepage_mailing_placeholder','homepage_mailing_button_text','homepage_search_placeholder','homepage_search_button_text','homepage_icons_style_select','homepage_icons_size_select','homepage_countdown_type_select','homepage_countdown_datetime','homepage_countdown_message','homepageHorizontalFlip','active_illustration','homepage_sound_color_select','homepage_sound_theme_select','home_buttonPhoneNumber','home_buttonEmail','home_buttonText_file','home_buttonPhoneNumber_1','home_buttonEmail_1','home_buttonText_file_1','home_button_spacing','home_button_size','homepage_form_horizontal_style','homepage_form_button_click_action','homepage_form_button_link','hasNoBgLogo','logoIconStyle','siteFavicon','onepage','onepage_popup_links','analytics_code','google_webmaster_tool_code','bing_webmaster_tool_code','yandex_webmaster_tool_code','google_remarketing_tag','facebook_pixel_code','ad_manager_code','ad_manger_active','ad_manager_level','country','timeZone','dateFormat','timeFormat','language','countryFlagCode','mobileAppBgColorType','mobileAppSplashScreenLogo','mobileAppBgColor','mobileAppMsg','homepage_padding_type','homepage_padding_top','homepage_padding_bottom','homepage_main_goal_margin_top','homepage_main_goal_margin_bottom','homepage_second_goal_margin_top','homepage_second_goal_margin_bottom','global_main_color_btn_text_color','inside_modules_color','inside_modules_color_text','inside_modules_color_box','inside_modules_color_text_box','font_logo','font_menu','font_modules_header','global_font','showHeaderPhone','headerPhoneNumber_style','showHeaderEmail','headerEmail_style','showHeaderAddress','showHeaderSocial','showHeaderCart','showHeaderClientZone','showHeaderSearch','showActionsButtons','topAction_buttonText_1','topAction_buttonText_1_type','topAction_buttonText_1_scrollSection','topAction_buttonRedirect_1','topAction_buttonPhoneNumber_1','topAction_buttonEmail_1','topAction_file_1','topAction_buttonText_1_style','topAction_buttonText_1_icon','topAction_buttonText_2','topAction_buttonText_2_type','topAction_buttonText_2_scrollSection','topAction_buttonRedirect_2','topAction_buttonPhoneNumber_2','topAction_buttonEmail_2','topAction_file_2','topAction_buttonText_2_style','topAction_buttonText_2_icon','magicButtonSettings','showMagicButton','shareMagicButtonSettings','showShareMagicButton','showSocial','showMailing','showTerms','showPrivacy','showCookieConsent','showExpertTag','hideMenuSeperator','stickyMenu','button_font_style','headerTransform','sectionsPadding','mobileMenuColor','mobileMenuTextAlign','mobileMenuType','mobileMenuFontSize','mobileMenuPagesSpace','mainNavMobileHeight','tools_manage','homepage_show_in_menu','homepage_show_in_footer','modules_color_section_main','modules_color_section_btn_text','modules_color_second_section_main','modules_color_second_section_btn_text','inside_modules_color_section_box_main','inside_modules_color_section_btn_text','line_height_modules_header','global_line_height',];return tryParseJSON(BuildJsonStringWizard(more_settings_arr));};Wizard.WebsiteTypeVideoPopup = function() {var _ = {$modal: null};_.init = function() {$('.w-v-p').on('click', function( event ) {event.preventDefault();show($(this));});};_.hide = function() {_.$modal.modal('hide');};function show( $controller ) {_.$modal = $(renderModal($controller));_.$modal.one('hidden.bs.modal', function( event ) {_.$modal.remove();});_.$modal.one('shown.bs.modal', function( event ) {_.$modal.find('.website-type-video').get(0).play();});_.$modal.modal('show');};function renderModal( $controller ) {var html = '';html +='<div class="modal s123-modal fade" id="videoTypeModal" tabindex="-1" role="dialog" aria-labelledby="videoTypeModal">';html +='<div class="modal-dialog" role="document">';html +='<div class="modal-content">';html +='<div class="modal-header">';html +='<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>';html +='<h4 class="modal-title">' + escapeHtml($controller.attr('data-popup-title')) + '</h4>';html +='</div>';html +='<div class="modal-body">';html +='<div class="widget-main" style="padding: 12px;">';html += '<video class="website-type-video" data-video-num="1" style="border: 1px solid #808080;width: 100%;height: auto;" controls muted>';html += '<source src="' + $controller.attr('href') + '" type="video/mp4">';html += '</video>'
html +='</div>';html +='</div>';html +='</div>';html +='</div>';html +='</div>';return html;}
return _;}();Wizard.InlineModuleEditor = function() {var _ = {modulesWithBackButton: [167,169]};_.im_init = function() {}();_.im_show = function( moduleID, moduleTypeNUM, openTool, loadedCallback = null ) {if ( moduleTypeNUM == '167' || moduleTypeNUM == '169' ) {topWindow.$('body').trigger('mousedown.preview.headersFontSettings');$('body').trigger('mousedown.preview.headersFontSettings');}
var $wizardPage = topWindow.Wizard.Pages.getPage(moduleID);$wizardPage.data('open-tool',openTool);OpenWizardTab('pagesTab',true);OpenPromoInlineEdit($wizardPage,moduleTypeNUM,loadedCallback);if ( RichPage.isChild($wizardPage) ) {Wizard.Pages.modeManager.set('richPage',RichPage.getParent($wizardPage).data('moduleid'),false);}
$wizardPage.data('prevent-module-scroll',true);if ( !_.modulesWithBackButton.includes(moduleTypeNUM) ) {$('.inline-wizard-iframe').addClass('hide-pages-link');$('.inline-module').addClass('no-header');$(document).one('animation_manager.hide', function() {$('.inline-module').removeClass('no-header');$wizardPage.data('prevent-module-scroll',false);$('.inline-wizard-iframe').removeClass('hide-pages-link');});}};_.im_reload = function( moduleID, moduleTypeNUM ) {const $module = Wizard.Pages.getPage(moduleID);$module.data('isModuleChanged',true);OpenPromoInlineEdit($module,moduleTypeNUM,false);};return _;}();return Wizard;}();Wizard.Tabs = function() {var Tabs = {};Tabs.logo = {};Tabs.home = {};Tabs.pages = {};Tabs.design = {};Tabs.settings = {};Tabs.domain = {};Tabs.structure = {};Tabs.init = function() {Tabs.logo.t = $('#wizardTab0button');Tabs.home.t = $('#wizardTab2button');Tabs.pages.t = $('#wizardTab4button');Tabs.pages.addNewPageModule = $('#addNewPageModule');Tabs.design.t = $('#wizardTab6button');Tabs.settings.t = $('#wizardTab8button');Tabs.domain.t = $('#wizardTab9button');Tabs.structure.t = $('#wizardTab10button');Tabs.events.init();};Tabs.events = {init : function() {Tabs.pages.t.on('click.Wizard.Tabs', function( event ) {Tabs.pages.setAddNewPagePosition();FitWizardTextToBox();PagesRecycle.displayPages();PagesNotInMenuOrHomepageTabs_init();$('#pagesTab').removeClass('inline-module-active');$('#pagesTab fieldset.inline-module').hide();Wizard.Pages.modeManager.set('pages','',false);});$(window).resize(function() {Tabs.pages.setAddNewPagePosition();});PagesNotInMenuOrHomepageTabs_init();}};Tabs.pages.setAddNewPagePosition = function() {if ( trialBOO ) {var top = $('#trialWebsiteAlert').outerHeight();if ( $('.tabbable > .top-nav').length !== 0 ) {top += $('.tabbable > .top-nav').outerHeight();}
Tabs.pages.addNewPageModule.attr('style','top:'+top+'px !important;');}
if ( $('html[dir=rtl]').length !== 0 ) {Tabs.pages.addNewPageModule.css({width : $('#wizardBox').width() - 26,	// #wizardBox > .tab-content (padding + border - 26)
right : 13 								// #wizardBox > .tab-content (padding + border / 2)
});} else {Tabs.pages.addNewPageModule.css({width : $('#wizardBox').width() - 26,	// #wizardBox > .tab-content (padding + border - 26)
left : 13 								// #wizardBox > .tab-content (padding + border / 2)
});}};Tabs.pages.displayHideOthersPagesTabs = function() {if ( $('#pagesTab').data('pages-n-i-m-o-h-tab') && $('#pagesTab').data('pages-n-i-m-o-h-tab') != '' ) return;$('#pagesTab').attr('data-pages-n-i-m-o-h-tab','');if ( IsSinglePage() || IsLandingPage() ) return;$('#pagesTab #sortable li').each(function() {var $this = $(this);if ( $this.data('module-mp-show-in-menu') == '0' && $this.data('module-show-in-footer') == '0' && $this.data('module-mp-show-in-home') == '0' ) {$('#pagesTab').attr('data-pages-n-i-m-o-h-tab','showPagesTab');return;}});};Tabs.highlightElement = function( $el ) {$el.addClass('highlight-element');setTimeout(function() {$el.removeClass('highlight-element');},500);};return Tabs;}();Wizard.Pages = function() {var Pages = {};Pages.init = function() {Pages.homepage.init();Pages.listParent = $('#sortable');Pages.list = $('#sortable li');Pages.events.init();Pages.modeManager.init();};Pages.events = function() {var E = {};E.init = function() {Pages.homepage.$card.off('click.wizardPages').on('click.wizardPages', function( event ) {Pages.highlight.on(Pages.homepage.$card);Wizard.Preview.closePopups();if ( !IsPreviewAtHomepage() ) {isPreviewReload = true;RefreshPreview();} else {window.scrollPreview = abTestTXT == 'siteEditor_b' ? '#section-169' : '#top-section';scrollToPointInPreview();}});Pages.list.each(function( index ) {var $page = $(this);$page.find('.boxClick, .pages_dragButton').off('click.wizardPages').on('click.wizardPages', function( event ) {var moduleID = $page.data('moduleid');event.stopPropagation();Wizard.Pages.highlight.on($page);Wizard.Preview.closePopups();ReloadPreviewAndGoToModule(moduleID,false);});});}
return E;}();Pages.highlight = function() {var H = {$page: null};H.on = function( $page ) {H.off();$page.addClass('p-active');H.$page = $page;$(document).trigger('wizard_pages_highlight.on',[$page]);};H.off = function() {if ( !Pages.list || Pages.list.length === 0 ) return;H.$page = null;Pages.list.filter('.p-active').removeClass('p-active');Pages.homepage.$card.removeClass('p-active');};return H;}();Pages.scrollTo = function( $page ) {var $scrollParent = $page.scrollParent();var offset = -180;$scrollParent.scrollTop($page.position().top - $("#sortable").offset().top + offset);};Pages.getPage = function( id ) {return $('#card_'+id);};Pages.getPagesByModuleTypeNUM = function( moduleTypeNUM ) {return Pages.list.filter('[data-moduletypenum="'+moduleTypeNUM+'"]');};Pages.hasPage = function( moduleTypeNUM ) {return Pages.list.filter('[data-moduletypenum="'+moduleTypeNUM+'"]').length !== 0;};Pages.refresh = function() {Pages.init();};Pages.homepage = function() {var hm = {};hm.init = function() {hm.$card = $('#card_homepage');hm.$edit = hm.$card.find('#homepageAlternativeName_edit');hm.$settings = hm.$card.find('#homepageSettings_edit');hm.$seoPopup = $('#homepageSeoSettings');hm.$layouts = hm.$card.find('#homepageDesingBtn');addBtnsEvents();addSeoPopupEvents();hm.popover.init();};hm.refreshOnSave = function() {$("#wizardForm").one('ajaxSuccess.homepage_settings', function() {UpdatePreviewAreaByAjax(['#top-menu-mobile','#mainNav ul.navPages','footer.global_footer ul.navPages','#header #top-menu .navPages'],false,false,'');});};function addBtnsEvents() {hm.$edit.off('click.card_homepage').on('click.card_homepage', function() {if ( abTestTXT == 'siteEditor_b' ) {$(this).tooltip('hide');if ( $('html').data('device') === 'mobile' ) return;Wizard.InlineModuleEditor.im_show(169,169,'');} else {if ( $('html').data('device') === 'mobile' ) Wizard.Tabs.home.t.trigger('click');if ( Wizard.Preview.ready ) Wizard.Preview.$homepage.data('section-highlight-handled',false);$(this).tooltip('destroy');}});hm.$settings.off('click').click(function() {hm.$settings.tooltip('destroy');hm.$settings.popover('show');});hm.$layouts.off('click').click(function() {hm.$card.find('li#card_169 a.designModuleButton').trigger('click');hm.$layouts.tooltip('destroy');});}
function addSeoPopupEvents() {hm.$seoPopup.off('show.bs.modal').on('show.bs.modal', function() {var $modal = $(this);var url = hm.$settings.data('url');var title = escapeHtml(hm.$settings.data('title'));$modal.find('.modal-title').html(title);$modal.find('.modal-body').html('<iframe id="homepageSeoSettingsIframe" src="' + url + '" style="width: 100%;height:500px;margin: 0;padding: 0;border: none;"></iframe>');})
.off('hidden.bs.modal').on('hidden.bs.modal', function() {$(this).find('.modal-body').empty();});}
hm.popover = {init: function() {hm.popover.$btn = hm.$settings;hm.popover.$btn.popover({container: 'body',content: hm.popover.getPopoverContent(),html: true,trigger: 'manual',template: '<div class="popover homepage-settings" data-module-id="homepage" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',placement: window['isTouchSupported'] ? 'auto' : intrface_align_reverse});hm.popover.$btn.off('shown.bs.popover').on('shown.bs.popover', function () {$('.popover.homepage-settings [data-rel=tooltip]').tooltip({container: 'body',placement: 'auto'});$(document).off('mousedown.homepageSettings').on('mousedown.homepageSettings', function ( event ) {if ( $(event.target).closest(hm.popover.$btn).length !== 0 ) return;if ( $(event.target).closest('.popover.homepage-settings').length === 0 ) {hm.popover.hide();}});$(window).one('blur.homepageSettings', function( event ) {hm.popover.hide();});hm.popover.$btn.closest('.tab-content').one('scroll.homepageSettings', function( event ) {hm.popover.hide();});}).
off('inserted.bs.popover').on('inserted.bs.popover', function () {$('.popover.homepage-settings [data-id="homepage_show_in_menu"]').prop('checked',$('#homepage_show_in_menu').val() == '1');$('.popover.homepage-settings [data-id="homepage_show_in_footer"]').prop('checked',$('#homepage_show_in_footer').val() == '1');if ( Wizard.footerHandler.isDisabled ) {$('.popover.homepage-settings').find('[data-id="homepage_show_in_footer"]').closest('.checkbox').hide();} else {$('.popover.homepage-settings').find('[data-id="homepage_show_in_footer"]').closest('.checkbox').show();}
if ( IsLandingPage() ) {$('.popover.homepage-settings').find('input[data-id="homepage_show_in_menu"]').closest('.checkbox').css('display','none');}});hm.popover.$btn.off('click').on('click', function( event ) {if ( hm.popover.$btn.data('p-o-open') ) {hm.popover.hide();return;}
hm.popover.$btn.tooltip('destroy');hm.popover.show();});},show: function() {hm.popover.$btn.data('p-o-open',true);hm.popover.$btn.popover('show');},hide: function() {hm.popover.$btn.data('p-o-open',false);hm.popover.$btn.popover('hide');$(document).off('mousedown.homepageSettings');$(window).off('blur.homepageSettings');$(window).off('scroll.homepageSettings');},getPopoverContent: function() {var html = '';html += '<div class="p-m-s-container">';html += '<div class="checkbox"><label class="block"><input data-id="homepage_show_in_menu" type="checkbox" class="page-navigation-checkbox ace input-lg"><span class="lbl fullColor">'+escapeHtml(translations.showOnMenu)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover"  title="'+escapeHtml(translations.shownOnSeperatedPage)+'"><i class="fal fa-question"></i></a></label></div>';html += '<div class="checkbox"><label class="block"><input data-id="homepage_show_in_footer" type="checkbox" class="page-navigation-checkbox ace input-lg"><span class="lbl fullColor">'+escapeHtml(translations.showOnFooter)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.showOnFooterExp)+'"><i class="fal fa-question"></i></a></label></div>';html += '<hr class="p-m-s-separator">';html += '<a id="home_seo" class="btn btn-link" data-toggle="modal" data-target="#homepageSeoSettings"><label class="block"><i class="ace-icon fal fa-search"></i><span class="p-m-s-link-text">'+escapeHtml(translations.seo)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.pageSeoTool)+'"><i class="fal fa-question"></i></a></label></a>';html += '<a class="p-m-s-mobile-back-btn blue"><i class="fal fa-arrow-left" aria-hidden="true"></i></a>';html += '</div>';var $html = $(html);$html.find('#home_seo').off('click').on('click', function() {hm.popover.hide();});$html.find('.p-m-s-mobile-back-btn').click( function( event ) {hm.popover.hide();});$html.find('input').change( function() {var $this = $(this);switch($this.data('id')) {case 'homepage_show_in_menu':$('#'+$this.data('id')).val(($this.prop('checked') ? '1' : '0'));hm.$card.attr('data-show-in-menu',($this.prop('checked') ? '1' : '0'));break;case 'homepage_show_in_footer':$('#'+$this.data('id')).val(($this.prop('checked') ? '1' : '0'));hm.$card.attr('data-show-in-footer',($this.prop('checked') ? '1' : '0'));break;}
hm.refreshOnSave();AutoSaveWizard(false,true);});return $html;}};return hm;}();Pages.modeManager = function() {var _ = {initialized: false};_.init = function() {_.$addNewPageModule = Wizard.Tabs.pages.addNewPageModule;$('input[name=onepage]').off('change.modeManager').on('change.modeManager', function() {var isSinglePage = IsSinglePage();var isLandingPage = IsLandingPage();$('#pagesTab').attr('data-singe-page',isSinglePage);$('#pagesTab').attr('data-landing-page',isLandingPage);if ( $('#collapseFour').data('previous-onepage') == '0' && Pages.list.filter('[data-moduletypenum="128"]').length > 0 ) {bootbox.alert({title: translations.richPage.warningMessageTitle,message: translations.richPage.warningMessage});}
if ( isLandingPage ) {LandingPage_HideNotInUseInputs();} else {$('.return-to-mobile-settings-btn').fadeIn();$('.not-in-use-in-landing-page').removeClass('not-in-use-in-landing-page');}});$('#pagesTab').attr('data-singe-page',IsSinglePage());$('#pagesTab').attr('data-landing-page',IsLandingPage());_.initialized = true;};_.set = function( mode, moduleID, reloadPreview ) {if ( !_.initialized ) return;if ( alreadySet(mode) ) return;$('#pagesTab').attr('data-rich-page-mode',mode == 'richPage');$('#pagesTab').hide();if ( mode == 'richPage' ) {var $module = Pages.getPage(moduleID);if ( !RichPage.isRichPage($module.data('moduletypenum')) ) {RichPage.convert({$selectedModule: $module,callback: function( $richPage ) {$richPage.addClass('r-p-active');if ( $richPage.data('parentId') != '' ) {Pages.list.filter('[data-moduleid="'+$richPage.data('parentId')+'"]').addClass('r-p-active');}}});} else {RichPage.show({$selectedModule: $module,callback: function( $richPage ) {if ( $richPage.data('module-show-in-footer') == '0' && $richPage.data('module-mp-show-in-menu') == '0' ) {if ( $('#pagesTab').attr('data-pages-n-i-m-o-h-tab') == 'showPagesTab' ) {$('#pagesTab').attr('data-pages-n-i-m-o-h-tab','showOthersTab');$('#pagesTab #showPagesTab').removeClass('active');$('#pagesTab #showOthersTab').addClass('active');}} else {if ( $('#pagesTab').attr('data-pages-n-i-m-o-h-tab') == 'showOthersTab' ) {$('#pagesTab').attr('data-pages-n-i-m-o-h-tab','showPagesTab');$('#pagesTab #showOthersTab').removeClass('active');$('#pagesTab #showPagesTab').addClass('active');}}
$richPage.addClass('r-p-active');if ( $richPage.data('parentId') != '' ) {Pages.list.filter('[data-moduleid="'+$richPage.data('parentId')+'"]').addClass('r-p-active');}
if ( reloadPreview ) {ReloadPreviewAndGoToModule($richPage.data('moduleid'),false);}}});}
if ( $module.data('parentId') != '' ) {Pages.list.filter('[data-moduleid="'+$module.data('parentId')+'"]').addClass('r-p-active');}} else {RichPage.reset();Pages.list.removeClass('r-p-active');if ( reloadPreview ) {isPreviewReload = true;RefreshPreview();}}
setTimeout(function() {$('#pagesTab').show();});};_.isRichPageOrHomepageMode = function() {return $('#pagesTab').attr('data-rich-page-mode') == 'true';};function addNewModuleBtnHandler( moduleID ) {if ( RichPage.isActive ) {_.$addNewPageModule.find('[data-target="#AddModuleWin"]').data('moduleid',moduleID);_.$addNewPageModule.find('[data-target="#AddModuleWin"] span').html(translations.richPage.addNewSection);_.$addNewPageModule.find('button[data-toggle="dropdown"]').hide();} else {_.$addNewPageModule.find('[data-target="#AddModuleWin"]').data('moduleid',moduleID);_.$addNewPageModule.find('[data-target="#AddModuleWin"] span').html(translations.addNewPage);_.$addNewPageModule.find('button[data-toggle="dropdown"]').show();}}
function alreadySet( mode ) {if ( mode == 'richPage' && $('#pagesTab').attr('data-rich-page-mode') == 'true' ) return true;if ( mode == 'pages' && $('#pagesTab').attr('data-rich-page-mode') == 'false' ) return true;return false;}
return _;}();Pages.getTextTrasform = function( pageName ) {if ( $('#headerTransform').val() != 'capitalize' ) return pageName;return pageName.toLowerCase();};Pages.sortable = {init: function( $el, maxLevels ) {var _ = this;if ( !topWindow.sortableList ) topWindow.sortableList = new Array();initializeSortable($el.get(0));$el.find('ul').each(function( index, ul ) {initializeSortable(ul);});function initializeSortable( el ) {var uniqid = _.uniqid('p-s-l-');$(el).attr('data-sortable-id',uniqid);topWindow.sortableList[uniqid] = new Sortable(el,{group: 'nested',sort: true,delay: 0,animation: 0,delayOnTouchOnly: false,touchStartThreshold: 0,direction: 'vertical',animation: 150,fallbackOnBody: true,swapThreshold: 0.45,emptyInsertThreshold: 5,handle: window['isTouchSupported'] ? '.draggingModuleButton' : false,dragClass: 'sortable-drag',ghostClass: 'sortable-ghost',onChoose: function ( e ) {$(e.item).find('.draggingModuleButton').tooltip('hide');e.item.placeholder = document.createComment('sort-placeholder')
e.item.after(e.item.placeholder)},onEnd: function ( e ) {$('ul#sortable.list-group').css('padding-bottom','unset');if( e.item.placeholder ) {if ( e.item.classList.contains('sort-not-allowed') ) {e.item.placeholder.replaceWith(e.item);e.item.classList.remove('sort-not-allowed');e.item.removeAttribute('data-not-allowed-msg');}
delete e.item.placeholder;}
var $item = $(e.item);$(document).trigger('s123.pages.nestedSortable.update',[$item]);if ( !RichPage.isActive ) {_.serializeAllModulesParentId();}
BuildToolJSON();var module = {mp_showInHome: GetModuleSetting($item.data('moduleid'),'mp_showInHome'),id: $item.data('moduleid')};if ( IsSinglePage() || IsLandingPage()
|| (IsPreviewAtHomepage() && (module.mp_showInHome == '1' || $item.data('moduletypenum') == '78'))
|| $item.data('moduletypenum') == '108' || (RichPage.isActive && IsPreviewAtRichPage(RichPage.moduleID)) ) {SortPreviewModules(true);window.scrollPreview = '#section-' + module.id;scrollToPointInPreview();AutoSaveWizard(false,true);} else {if ( module.mp_showInHome == '1' ) {window.scrollPreview = '#section-' + module.id;}
AutoSaveWizard(true,true);}},onMove: function ( e ) {if ( $('#pagesTab').attr('data-rich-page-mode') == 'false' ) {$('ul#sortable.list-group').css('padding-bottom','60px');}
var $draggdModule = $(e.dragged);if ( $(e.to).attr('id') == 'sortable' ) {if ( e.dragged.classList.contains('sort-not-allowed') ) {e.dragged.classList.remove('sort-not-allowed');e.dragged.removeAttribute('data-not-allowed-msg');}
return true;}
if ( RichPage.isActive && $draggdModule.data('moduletypenum') == '1000') {if ( e.dragged.classList.contains('sort-not-allowed') ) {e.dragged.classList.remove('sort-not-allowed');e.dragged.removeAttribute('data-not-allowed-msg');}
if ( RichPage.isFirstChild($(e.related)) && !RichPage.isFirstChild($draggdModule) ) {e.dragged.classList.add('sort-not-allowed');e.dragged.setAttribute('data-not-allowed-msg',escapeHtml(translations.richPage.promoFistChildError));}} else if ( modulesArr[Number($draggdModule.data('moduletypenum'))]['module_kind'] == '3'
|| $draggdModule.data('moduletypenum') == '78') {e.dragged.classList.add('sort-not-allowed');e.dragged.setAttribute('data-not-allowed-msg',escapeHtml(translations.pagesDragToCatError));}
return true;},});}},destroy: function( $el ) {var uniqid = $el.attr('data-sortable-id');if ( topWindow.sortableList[uniqid] ) {topWindow.sortableList[uniqid].destroy();delete topWindow.sortableList[uniqid];$el.removeAttr('data-sortable-id');if ( $el.attr('id') == 'sortable') {$el.find('ul').each(function( index, ul ) {Pages.sortable.destroy($(ul));});}}},serializeAllModulesParentId: function () {function toHierarchy( element ) {const hierarchy = [];Array.from(element.children).forEach((child, index) => {const $child = $(child);const item = $child.data();item.id = $child.data('moduleid');item.order = index;item.children = [];const subList = child.querySelector('ul');if (subList) {item.children = toHierarchy(subList);}
hierarchy.push(item);});return hierarchy;}
const hierarchy = toHierarchy($('#sortable').get(0));hierarchy.forEach( function( module ) {$('#card_'+module.id).data('parent-id','');if ( !module.children ) return;module.children.forEach( function( children ) {$('#card_'+children.id).data('parent-id', module.id);});});},uniqid: function(prefix, more_entropy) {if (typeof prefix === 'undefined') prefix = '';var retId;var formatSeed = function(seed, reqWidth) {seed = parseInt(seed, 10).toString(16);if (reqWidth < seed.length) {return seed.slice(seed.length - reqWidth);}
if (reqWidth > seed.length) {return Array(1 + (reqWidth - seed.length)).join('0') + seed;}
return seed;};if (!this.php_js) {this.php_js = {};}
if (!this.php_js.uniqidSeed) {this.php_js.uniqidSeed = Math.floor(Math.random() * 0x75bcd15);}
this.php_js.uniqidSeed++;retId = prefix;retId += formatSeed(parseInt(new Date().getTime() / 1000, 10), 8);retId += formatSeed(this.php_js.uniqidSeed, 5);if (more_entropy) {retId += (Math.random() * 10).toFixed(8).toString();}
return retId;},};return Pages;}();Wizard.Preview = function() {var Preview = {};Preview.init = function() {Preview.iframe = $('#websitePreviewIframe');if ( Preview.iframe.length === 0 ) return;Preview.window = Preview.iframe.get(0).contentWindow;Preview.$ = Preview.window.$;if ( !Preview.$ ) return;Preview.$window = Preview.$(Preview.window);Preview.$document = Preview.$(Preview.window.document);Preview.iframe.contents = Preview.iframe.contents();Preview.$homepage = Preview.$('#top-section');Preview.$modules = Preview.$('section.s123-module, section.s123-page-data');Preview.setReady();};Preview.setReady = function() {Preview.ready = true;Preview.$window.off('unload.wizardPreview');Preview.$window.on('unload.wizardPreview', function( event ) {Preview.ready = false;});Preview.$window.trigger('preview.loaded');};Preview.buttonsHighlight = function() {highlight(Preview.$homepage);Preview.$modules.each(function( index ) {highlight(Preview.$(this));});function highlight( $module ) {if ( $module.length === 0 ) return;$module.off('click.wizardPreview');$module.on('click.wizardPreview', function( event ) {var $btn = $module.find('.previewManageButton:not(.p-s-m)');var $a = $btn.find('> a');var pageId = $module.get(0).id;if ( $module.get(0).id === 'top-section' ) {pageId = 'homepage';} else {pageId = $module.get(0).id.replace('section-','');}
var $page = Wizard.Pages.getPage(pageId);if ( $page.length === 0 ) return;Wizard.Pages.scrollTo($page);Wizard.Pages.highlight.on($page);if ( $a.hasClass('p-m-b-flash') ) return;if ( $btn.find(event.target).length !== 0 ) return;$a.addClass('p-m-b-flash');$(document).trigger('s123.wizardTips.previewManageButtonFlash',[$btn]);});}}
Preview.highlightSection = function( id ) {if ( !Wizard.Preview.ready ) return;var $section = id == '#top-section' ? Preview.$homepage : Preview.getModule(id);if ( $section.data('section-highlight-handled') ) return;$section.addClass('section-highlight');$section.one('animationend', function() {$section.removeClass('section-highlight');$section.data('section-highlight-handled',true);});};Preview.getModule = function( id ) {return Preview.$modules.filter('#section-'+id);};Preview.getModulesByTypeNum = function( moduleTypeNUM ) {return Preview.$modules.filter('[data-module-type-num="'+moduleTypeNUM+'"]');};Preview.closePopups = function() {if ( !Wizard.Preview.ready ) return;Preview.window.buildPopup_CloseAllPopupsInPage();if ( Preview.window.$.magnificPopup ) {Preview.window.$.magnificPopup.close();}};Preview.refresh = function() {Preview.init();}
Preview.Redirect = function() {var R = {};R.toItem = function( websiteID, moduleID, moduleTypeNUM, itemID ) {if ( !Preview.ready ) return;if ( !itemID ) itemID = 'first_item';Preview.window.location = '/versions/2/wizard/modules/wizard.preview.redirect.php?' + jQuery.param( { websiteID: websiteID, moduleID: moduleID, moduleTypeNUM: moduleTypeNUM, itemID: itemID } );};return R;}();Preview.Scale = function() {var S = {};S.initialized = false;S.init = function() {S.$wizardTopToolbar = $('#wizardTopToolbar');S.$previewBox = $('#previewBox');S.$iframe = $('#websitePreviewIframe');S.mode = 'computer';S.addPreviewSpacing = true; // window.screen.availWidth >= 1440;
if ( S.$iframe.length === 0 ) return;if ( S.initialized ) S.destroy();S.$previewBox.addClass('no-transition');if ( S.addPreviewSpacing ) {S.$previewBox.addClass('add-preview-spacing');}
S.addDevicesButtons();S.$dButtons.$desktop.trigger('click',['scale_init']);S.$wizardTopToolbar.find('.w-t-t-box-2').prepend(S.$dButtons.$container);S.$dButtons.$dropdown.closest('#preview-devices-buttons').addClass('hidden');S.initialized = true;};S.reset = function() {S.$previewBox = $('#previewBox');S.$iframe = $('#websitePreviewIframe');S.addDevicesButtons();};S.addDevicesButtons = function() {S.$dButtons = {};S.$dButtons.$container = $('#previewScaleDevices');S.$dButtons.$dropdown = $('#previewButtons');S.$dButtons.$app = S.$dButtons.$container.find('.p-d-btn-app');S.$dButtons.$mobile = S.$dButtons.$container.find('.p-d-btn-mobile');S.$dButtons.$tablet = S.$dButtons.$container.find('.p-d-btn-tablet');S.$dButtons.$desktop = S.$dButtons.$container.find('.p-d-btn-desktop');if ( S.$dButtons.$container.length === 0
|| S.$dButtons.$dropdown.length === 0
|| S.$dButtons.$app.length === 0
|| S.$dButtons.$mobile.length === 0
|| S.$dButtons.$tablet.length === 0
|| S.$dButtons.$desktop.length === 0 ) {throw 'Preview.Scale - Missing settings on initialize!';}
S.$dButtons.$container.find('.p-d-btn').off('click').click(function() {var $btn = $(this);S.deviceButtonsClick($btn);});S.$dButtons.$container.show();};S.deviceButtonsClick = function( $btn ) {let previousDeviceType = '';if ( S.$dButtons.$dropdown.data('active-btn') ) {previousDeviceType = S.$dButtons.$dropdown.data('active-btn');}
S.$dButtons.$dropdown.find('i').attr('class',$btn.find('i').attr('class'));S.$dButtons.$dropdown.attr('data-prev-active',$btn.data('device-width'));if ( $btn.hasClass('p-d-btn-desktop') ) {S.$dButtons.$dropdown.data('active-btn','desktop');} else if ( $btn.hasClass('p-d-btn-tablet') ) {S.$dButtons.$dropdown.data('active-btn','tablet');} else if ( $btn.hasClass('p-d-btn-mobile') ) {S.$dButtons.$dropdown.data('active-btn','mobile');} else if ( $btn.hasClass('p-d-btn-app') ) {S.$dButtons.$dropdown.data('active-btn','app');}
S.$dButtons.$container.find('.p-d-btn').removeClass('active');$btn.addClass('active');S.$dButtons.$container.find('.current-device').html($btn.find('.device-type').clone());S.mode = $btn.data('device-type');S.set($btn.data('device-width'),$btn.data('device-type'));if ( Wizard.Preview.ready ) {if ( $btn.hasClass('p-d-btn-app') ) {if ( $('#mobileAppHomepageType').val() == '' ) {S.headerModulesHeandler($btn.data('device-type'),previousDeviceType);} else {ReloadPreviewIframe('/?w='+$('#id').val()+'&app=1&disableCache='+getRandomInt(0,9999999));}} else {Preview.$document.trigger('wizard.preview.device.changed',[$btn.data('device-type')]);$(document).trigger('wizard.preview.device.changed',[$btn.data('device-type')]);if ( $btn.hasClass('p-d-btn-tablet') || $btn.hasClass('p-d-btn-mobile') ) {Wizard.Preview.window.Parallax_active(false);} else {Wizard.Preview.window.Parallax_active(true);}
S.headerModulesHeandler($btn.data('device-type'),previousDeviceType);}}
S.returnToEditModeBtnHandler($btn.data('device-type'));S.returnToMobileSettingsBtnHandler($btn.data('device-type'));S.returnToAPPSettingsBtnHandler($btn.data('device-type'));}
S.set = function( deviceWidth, deviceType ) {S.$iframe.attr('data-device-type',deviceType);var border_spacing = 0;var horizontal_spacing_offset = S.addPreviewSpacing ? 100 : 0;var top_spacing_offset = S.addPreviewSpacing ? 20 : 0;;var bottom_spacing_offset = S.addPreviewSpacing ? 10 : 0;var iframe_width = null;var iframe_height = null;S.rate = S.$previewBox.width() / deviceWidth;if ( S.rate > 1.0 ) {if ( S.$dButtons.$desktop.hasClass('active') ) {iframe_width = 'calc(100% - '+horizontal_spacing_offset+'px)';} else {iframe_width = deviceWidth + border_spacing;}
iframe_height = S.$previewBox.height() - top_spacing_offset - bottom_spacing_offset;S.$iframe.css({width: iframe_width,height: iframe_height,marginTop: top_spacing_offset,display: 'block',transform: '',top: '',left: '',position: 'static',});if ( Wizard.Preview.ready ) {Wizard.Preview.window.ResetMoreButton();Wizard.Preview.window.previewScaleDeviceTypeChange(deviceType);}
return;}
iframe_width = deviceWidth - horizontal_spacing_offset + border_spacing;iframe_height = (S.$previewBox.height() - top_spacing_offset - bottom_spacing_offset) * ( 1 / S.rate );if ( iframe_height * 1.30 >= iframe_width ) {iframe_height = iframe_width - (iframe_width * 0.30);}
S.$iframe.css({width: iframe_width,height: iframe_height,marginTop: top_spacing_offset,transform: 'scale('+S.rate+')',transformOrigin: 'top',position: 'static'});if ( Wizard.Preview.ready ) {Wizard.Preview.window.ResetMoreButton();Wizard.Preview.window.previewScaleDeviceTypeChange(deviceType);}};S.getBorderWidth = function( $element ) {return Wizard.Preview.Scale.$iframe.outerWidth() - Wizard.Preview.Scale.$iframe.innerWidth();};S.refresh = function() {if ( !S.initialized ) return;S.set(S.$dButtons.$container.find('.p-d-btn.active').data('device-width'));};S.destroy = function() {S.$dButtons.$container.hide();S.$iframe.css({width: '',height: '',margin: '',display: '',top: '',left: '',transform: '',position: '',});S.initialized = false;};S.returnToEditModeBtnHandler = function( deviceType ) {var $returnToEditBtn = S.$previewBox.find('.return-to-edit-btn');var rtl = $('html[dir=rtl]').length !== 0;if ( deviceType === 'tablet' || deviceType === 'mobile' || deviceType === 'app' ) {if ( $returnToEditBtn.length !== 0 ) {setButtonWidth();return;}
$returnToEditBtn = $('<div class="return-to-edit-btn" title="'+escapeHtml(translations.returnToEditMode)+'"><a class="btn btn-primary" style="display: flex;align-items: center;"><i class="fal fa-desktop device-type"></i><span>&nbsp;'+escapeHtml(translations.returnToEditMode)+'</span></a></div>');$returnToEditBtn.css({position: 'absolute',top: 20,left: rtl ? 'auto' : 20,right: rtl ? 20 : 'auto'});$returnToEditBtn.tooltip({container: 'body',placement: 'auto'});$returnToEditBtn.click(function( event ) {S.$dButtons.$desktop.trigger('click');$returnToEditBtn.tooltip('destroy');$returnToEditBtn.remove();closeMobileMenuDropdown();});S.$previewBox.append($returnToEditBtn);setButtonWidth();$(document).off('wizard_tabs_opened.returnToEditModeBtnHandler')
.on('wizard_tabs_opened.returnToEditModeBtnHandler',function( event ) {setButtonWidth();});$(document).off('wizard_tabs_closed.returnToEditModeBtnHandler')
.on('wizard_tabs_closed.returnToEditModeBtnHandler',function( event ) {setButtonWidth();});} else {$returnToEditBtn.tooltip('destroy');$returnToEditBtn.remove();$(document).off('wizard_tabs_opened.returnToEditModeBtnHandler');$(document).off('wizard_tabs_closed.returnToEditModeBtnHandler');}
function setButtonWidth() {var available_space = ((S.$previewBox.width() - S.$iframe.width()) / 2);$returnToEditBtn.show();$returnToEditBtn.find('span').show();if ( ($returnToEditBtn.width() + 40) > available_space ) {$returnToEditBtn.find('span').hide();if ( ($returnToEditBtn.width() + 40) > available_space ) {$returnToEditBtn.hide();}} else {$returnToEditBtn.find('span').show();}}};S.returnToMobileSettingsBtnHandler = function( deviceType ) {var $returnMobileSettingsBtn = S.$previewBox.find('.return-to-mobile-settings-btn');var rtl = $('html[dir=rtl]').length !== 0;if ( deviceType === 'mobile' ) {if ( $returnMobileSettingsBtn.length !== 0 ) {setButtonWidth();return;}
$returnMobileSettingsBtn = $('<div class="return-to-mobile-settings-btn" title="'+escapeHtml(translations.returnToMobileSettingsMode)+'"><a class="btn btn-primary-grey" style="display: flex;align-items: center;"><i class="fal fa-mobile device-type"></i><span>&nbsp;'+escapeHtml(translations.returnToMobileSettingsMode)+'</span></a></div>');$returnMobileSettingsBtn.css({position: 'absolute',top: 70,left: rtl ? 'auto' : 20,right: rtl ? 20 : 'auto'});$returnMobileSettingsBtn.tooltip({container: 'body',placement: 'auto'});if ( IsLandingPage() ) {$returnMobileSettingsBtn.fadeOut();}
$returnMobileSettingsBtn.click(function( event ) {S.expandWizardTabs('designTab','#moreDesignOptions2','WebsiteThemeAdvancedOptionsBOX','s123-mobile-settings');});S.$previewBox.append($returnMobileSettingsBtn);setButtonWidth();$(document).off('wizard_tabs_opened.returnMobileSettingsBtnHandler')
.on('wizard_tabs_opened.returnMobileSettingsBtnHandler',function( event ) {setButtonWidth();});$(document).off('wizard_tabs_closed.returnMobileSettingsBtnHandler')
.on('wizard_tabs_closed.returnMobileSettingsBtnHandler',function( event ) {setButtonWidth();});} else {$returnMobileSettingsBtn.tooltip('destroy');$returnMobileSettingsBtn.remove();$(document).off('wizard_tabs_opened.returnMobileSettingsBtnHandler');$(document).off('wizard_tabs_closed.returnMobileSettingsBtnHandler');}
function setButtonWidth() {var available_space = ((S.$previewBox.width() - S.$iframe.width()) / 2);$returnMobileSettingsBtn.show();$returnMobileSettingsBtn.find('span').show();if ( ($returnMobileSettingsBtn.width() + 40) > available_space ) {$returnMobileSettingsBtn.find('span').hide();if ( ($returnMobileSettingsBtn.width() + 40) > available_space ) {$returnMobileSettingsBtn.hide();}} else {$returnMobileSettingsBtn.find('span').show();}}};S.returnToAPPSettingsBtnHandler = function( deviceType ) {var $returnAPPSettingsBtn = S.$previewBox.find('.return-to-app-settings-btn');var rtl = $('html[dir=rtl]').length !== 0;if ( deviceType === 'app' ) {if ( $returnAPPSettingsBtn.length !== 0 ) {setButtonWidth();return;}
$returnAPPSettingsBtn = $('<div class="return-to-app-settings-btn" title="'+escapeHtml(translations.returnToAPPSettingsMode)+'"><a class="btn btn-primary-grey" style="display: flex;align-items: center;"><i class="fal fa-mobile device-type"></i><span>&nbsp;'+escapeHtml(translations.returnToAPPSettingsMode)+'</span></a></div>');$returnAPPSettingsBtn.css({position: 'absolute',top: 70,left: rtl ? 'auto' : 20,right: rtl ? 20 : 'auto'});$returnAPPSettingsBtn.tooltip({container: 'body',placement: 'auto'});if ( IsLandingPage() ) {$returnAPPSettingsBtn.fadeOut();}
$returnAPPSettingsBtn.click(function( event ) {S.expandWizardTabs('settingsTab','#collapsePwa','','');});S.$previewBox.append($returnAPPSettingsBtn);setButtonWidth();$(document).off('wizard_tabs_opened.returnAPPSettingsBtnHandler')
.on('wizard_tabs_opened.returnAPPSettingsBtnHandler',function( event ) {setButtonWidth();});$(document).off('wizard_tabs_closed.returnAPPSettingsBtnHandler')
.on('wizard_tabs_closed.returnAPPSettingsBtnHandler',function( event ) {setButtonWidth();});} else {$returnAPPSettingsBtn.tooltip('destroy');$returnAPPSettingsBtn.remove();$(document).off('wizard_tabs_opened.returnAPPSettingsBtnHandler');$(document).off('wizard_tabs_closed.returnAPPSettingsBtnHandler');}
function setButtonWidth() {var available_space = ((S.$previewBox.width() - S.$iframe.width()) / 2);$returnAPPSettingsBtn.show();$returnAPPSettingsBtn.find('span').show();if ( ($returnAPPSettingsBtn.width() + 40) > available_space ) {$returnAPPSettingsBtn.find('span').hide();if ( ($returnAPPSettingsBtn.width() + 40) > available_space ) {$returnAPPSettingsBtn.hide();}} else {$returnAPPSettingsBtn.find('span').show();}}};S.expandWizardTabs = function( tab, accordionID, innerTabID, innerTabAccordion ) {let $accordion = topWindow.$(accordionID);let $innerTab = innerTabID.length > 0 ? $(`#websiteStructureTabs [data-tab="${innerTabID}"]`) : null;let $innerTabAccordion = innerTabAccordion.length > 0 ? $(`.s123-collapse-settings:not(.static) .title.${innerTabAccordion}`) : null;topWindow.Wizard.modals.hideAll();topWindow.OpenWizardTab(tab,true);if ( $accordion.hasClass('in') ) {$accordion.closest('.panel').addClass('p-m-b-wizard-accordion-flash');setTimeout(function() {$accordion.closest('.panel').removeClass('p-m-b-wizard-accordion-flash');},500);return;}
topWindow.$('#'+tab).one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd", function() {$(document).trigger('wizard.accordion_animation_ended');});var animationManager = topWindow.Wizard.tabEffectHandler.AnimationManager[tab];animationManager.show(animationManager.$tabLinks.find('a[href="'+accordionID+'"]'));if ( $innerTab && !$innerTab.hasClass('active') ) {$innerTab.trigger('click');}
if ( $innerTabAccordion && !$innerTabAccordion.parent().hasClass('open') ) {$innerTabAccordion.trigger('click');}}
S.headerModulesHeandler = function( deviceType, previousDeviceType ) {if ( !Wizard.Preview.ready ) return;if ( $.inArray(deviceType,['mobile','app']) !='-1' && $.inArray(previousDeviceType,['mobile','app']) !='-1' ) return;if ( $.inArray(deviceType,['tablet']) !='-1' && $.inArray(previousDeviceType,['tablet']) !='-1' ) return;if ( $.inArray(deviceType,['computer','desktop']) !='-1' && $.inArray(previousDeviceType,['computer','desktop']) !='-1' ) return;let selectors = [];Wizard.Preview.$('section.s123-module-headers').each(function() {let $this = $(this);if ( $this.data('mobile-tool-style') && $this.data('mobile-tool-style') != '' ) {selectors.push('#'+$this.attr('id'));}});if ( selectors.length == 0 ) return;let device = '';if ( deviceType == 'mobile' || deviceType == 'app' ) {device = 'mobile';} if ( deviceType == 'tablet' ) {device = 'tablet';}
UpdatePreviewAreaByAjax(selectors.toString(),false,false,'',device);}
return S;}();Preview.loseMenuTransparency = function() {if ( !Preview.ready ) return;if ( IsLandingPage() ) return;if ( isUserAlreadyScrolled() ) return;if ( Preview.$('html').hasClass('inside_page') ) return;if ( Preview.$('html').hasClass('rich_page') ) return;if ( ['3','4','13'].indexOf($('#template').val()) != -1 ) return;if ( $('#header_opacity').val() === 'full' ) {var scrollTop = 100;if ( $('#customTemplate').val() == '15' ) {scrollTop = Preview.$('#mainNav').offset().top + Preview.$('#mainNav').height();}
Preview.$window.scrollTop(scrollTop);}};function isUserAlreadyScrolled() {if ( $('#customTemplate').val() == '15' ) {return Wizard.Preview.$window.scrollTop() > Wizard.Preview.$('#top-section').outerHeight();} else {return Wizard.Preview.$window.scrollTop() > 0 ;}}
return Preview;}();Wizard.modals = function() {var that = {};that.hideAll = function() {$('.modal.in').modal('hide');};return that;}();Wizard.Tips = function() {var Tips = {};Tips.init = function() {Tips.user_tips = user_tips;Tips.list.dragPages();Tips.list.previewManageButtons();};Tips.Show = {popover: function( opt ) {var $window = opt.$window ? opt.$window : $(window);var $document = opt.$document ? opt.$document : $(document);var $tip = opt.$tip;var $target_element = opt.$target_element;var placement = opt.placement ? opt.placement : intrface_align_reverse;if ( $tip.length === 0 || $target_element.length === 0 ) return;$target_element.popover({container: 'body',content: $tip,html: true,trigger: 'manual',template: '<div class="popover user-tips-popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',placement: placement});$target_element.popover('show');$target_element.on('shown.bs.popover', function ( event ) {$tip.find('[data-tip-dismiss="popover"]').click(function( event ) {destroy();});$document.on('mousedown.destroyPopover', function ( event ) {if ( $(event.target).closest('.user-tips-popover').length === 0 ) {destroy();}});});function destroy() {Tips.setAsRead($tip);$target_element.popover('destroy');$document.off('mousedown.destroyPopover');$window.off('blur.destroyPopover');$window.off('scroll.destroyPopover');}}};Tips.setAsRead = function( $tip ) {if ( $tip.length === 0 ) return;$.post( '/manager/user_tips/update_tip.php', {tip_type: $tip.data('tip-type')});};Tips.isReaded = function( $tip_type ) {return Tips.user_tips[$tip_type] ? true : false;};Tips.list = {dragPages: function() {var tip_type = 'dragPages';if ( Tips.isReaded(tip_type) ) return;$(document).on('s123.wizardPageAdded.Wizard.Tips',function( event ) {if ( !Wizard.Pages.listParent.is(':visible') ) return;var tip_html = '';tip_html += '<div data-toggle="s123_user_tips" data-tip-type="'+tip_type+'" class="alert alert-block alert-warning">';tip_html += '<p>';tip_html += '<span>'+translations.tips_PagesTabDrag+'</span>';tip_html += '</p>';tip_html += '<p>';tip_html += '<button type="button" class="btn btn-sm btn-warning" data-tip-dismiss="popover">'+translations.tips_UnderstandBtn+'</button>';tip_html += '</p>';tip_html += '</div>';setTimeout(function() {Tips.Show.popover({$tip: $(tip_html),$target_element: Wizard.Pages.list.last().find('.pages_dragButton')});$(document).off('s123.wizardPageAdded.Wizard.Tips');},3000);});},previewManageButtons: function() {var tip_type = 'previewManageButtons';if ( Tips.isReaded(tip_type) ) return;$(document).on('s123.wizardTips.previewManageButtonFlash',function( event, $previewManageButton ) {if ( Wizard.Preview.$window.scrollTop() > $previewManageButton.offset().top ) return;var tip_html = '';tip_html += '<div data-toggle="s123_user_tips" data-tip-type="'+tip_type+'" class="alert alert-block alert-warning">';tip_html += '<p>';tip_html += '<span>'+translations.tips_PreviewManageButtons+'</span>';tip_html += '</p>';tip_html += '<p>';tip_html += '<button type="button" class="btn btn-sm btn-warning" data-tip-dismiss="popover">'+translations.tips_UnderstandBtn+'</button>';tip_html += '</p>';tip_html += '</div>';Tips.Show.popover({$window: Wizard.Preview.$window,$document: Wizard.Preview.$document,$tip: Wizard.Preview.$(tip_html),$target_element: $previewManageButton,placement: Wizard.Preview.$('html').attr('dir') === 'ltr' ? 'left' : 'right'});$(document).off('s123.wizardTips.previewManageButtonFlash');});}};return Tips;}();Wizard.homePageBgOptions = new function() {var that = this;that.init = function( settings ) {if ( !settings ) return;that.$container = settings.$container;that.$popUpContainer = settings.$popUpContainer;that.$popUpContainer.append(generatePopUpHTML());that.popUp = that.$popUpContainer.find('.r-i-modal');that.backDrop = that.$popUpContainer.find('.r-i-back-drop');that.q = '';libraryCategoriesOutput(that.popUp.find('.rcContainer'),libraryHomepageArr[0].items);addPluginAbilities();$(document).trigger('wizard_h_p_b_o.loaded');ColorPickerInitialize();InitializeToolTips();$(document).on('wizard_mobile_hendlar.accordion.show', function( event, accordionID ) {if ( accordionID != 'backgroundOptionsTab' ) return;initFavorites(false);});$(document).on('animation_manager.show', function( event, tabID ) {if ( tabID != '#backgroundOptionsTab' ) return;initFavorites(false);});$('#backgroundOptionsTab [data-tab="backgroundColorOptionsTab"]').off('click.hmBgColors').on('click.hmBgColors', function() {that.type = 'colors';if ( $('#boxContentGradientsColorsList .colorsContainer').length == 0 ) {var html = '';html += '<div class="colorsContainer">';html += '<div id="ActiveHomepageColor">';html += '<div class="customColorBOX s123-collapse-settings open">';html += '<div class="content">';html += '<div class="gradientsPalette" id="homepageGradientsColors" data-text="'+escapeHtml(translations.homepageChangingImages.gradients)+'" data-tooltip="'+escapeHtml(translations.homePageBgOptions.backgroundGradientsTooltip)+'" data-value="'+$('#homepageGradientsColors').val()+'" data-allow-empty="true" data-custom-class="homepage-gradients-palette"></div>';html += '<div class="colorPalette" id="home_background_color" data-text="'+escapeHtml(translations.homePageBgOptions.solidColor)+'" data-tooltip="'+escapeHtml(translations.homePageBgOptions.backgroundColorTooltip)+'" data-value="'+$('#home_background_color').val()+'" data-allow-empty="true" data-use-original="true"></div>';html += '<div class="colorPalette" id="home_text_color" data-required="true" data-text="'+escapeHtml(translations.homePageBgOptions.textColorText)+'" data-tooltip="'+escapeHtml(translations.homePageBgOptions.textColorTooltip)+'" data-value="'+$('#home_text_color').val()+'" data-use-original="true"></div>';html += '<div class="colorPalette" id="homepageShapeDividerList_Color1" data-required="true" data-text="'+escapeHtml(translations.homePageBgOptions.shapesColorText)+'" data-value="'+$('#homepageShapeDividerList_Color1').val()+'" data-tooltip="'+escapeHtml(translations.homePageBgOptions.shapesColorTooltip)+'" data-use-original="true"></div>';html += '</div>';html += '</div>';html += '</div>';if ( $('html').data('device') !== 'mobile' ) {html += '<div id="homepageGradientsColorsList" class="s123-collapse-settings open fancy-scrollbar"></div>';}
html += '</div>';var $html = $(html);imageHomepageLiveEleID = Wizard.homePageChangingImages.fistInputID;var listHtml = '<div class="gradients-colors-tabs-continer">';listHtml += '<div class="gradients-colors-tabs">';listHtml += '<div class="gradients-colors-tab active" data-tab="gradients-list">';listHtml += translations.homepageChangingImages.gradients;listHtml += '</div>';listHtml += '<div class="gradients-colors-tab" data-tab="colors-list">';listHtml += translations.homepageChangingImages.colors;listHtml += '</div>';listHtml += '</div>';listHtml += '<div data-tab-related="gradients-list">';listHtml += '<div class="content gradients-list fancy-scrollbar"></div>';listHtml += '</div>';listHtml += '<div data-tab-related="colors-list">';listHtml += '<div class="content colors-list fancy-scrollbar"></div>';listHtml += '</div>';listHtml += '</div>';var $listHtml = $(listHtml);$listHtml.find('[data-tab-related="colors-list"]').hide();$listHtml.find('.gradients-colors-tab').off('click').on('click',function(){var $this = $(this);var tab = $this.data('tab');$this.siblings().removeClass('active');$this.addClass('active');$listHtml.find('[data-tab-related]').hide();$listHtml.find('[data-tab-related="' + tab + '"]').show();});$html.find('#homepageGradientsColorsList').append($listHtml);$html.find('#homepageGradientsColorsList').hide();addColorsList($html.find('#homepageGradientsColorsList .colors-list'),false);addColorsList($html.find('#homepageGradientsColorsList .gradients-list'),true);$('#boxContentGradientsColorsList').html($html);ColorPickerInitialize();}
$(document).trigger('homepage_bg_options.opened');});};that.inlineLibrary = function() {var il = {initialized: false};il.init = function( settings ) {if ( il.initialized ) return;if ( !settings ) return;il.$container = settings.$container;il.$html = $(generateHtml());il.$container.append(il.$html);il.lastImagesPage = 1;libraryCategoriesOutput(il.$html,libraryHomepageArr[0].items);addControllersEvents();$(document).on('wizard_mobile_hendlar.accordion.show', function( event, accordionID ) {if ( accordionID === 'backgroundOptionsTab' ) {var newHeight = $('#wizardBox .bottom-nav').offset().top - il.$html.find('.rcContainer .boxContent').offset().top;il.$html.find('.rcContainer .boxContent').css({maxHeight: newHeight});}});$(document).on('homepageTabHandler.innerTabsHanler.open', function( event, tabID ) {if ( tabID === 'backgroundMideaOptionsTab' ) {resize();}});$(document).on('inline_gallery_resize', function( event ) {resize();});$(document).on('animation_manager.show', function( event, tabID ) {if ( tabID === '#backgroundOptionsTab' ) {resize();}});$(document).on('changing_images_refresh', function( event ) {resize();});initFavorites(true);il.initialized = true;};il.showResults = function( value ) {imageHomepageLiveEleID = Wizard.homePageChangingImages.fistInputID;that.q = '';var favoritesOnly = il.$html.find('.searchIconFavorite').hasClass('active');if ( value.length == 0 ) value = 'all';that.q = value.toLowerCase();if ( value.toLowerCase() == 'all' && !favoritesOnly ) {il.reset();} else {il.$html.find('.search').parent().addClass('multi-filters');il.$html.find('.searchStylesIconRemove').show();il.$html.find('.rcContainer').hide();il.$html.find('.RecommendedImagesContainer').show();searchImagesByQuery(il.$html.find('.RecommendedImagesContainer'));}};il.destroy = function() {if ( !il.initialized ) return;il.$html.remove();il.initialized = false;};il.reset = function() {if ( !il.initialized ) return;il.$html.find('.searchStylesIconRemove').hide();il.$html.find('.rcContainer').show();il.$html.find('.RecommendedImagesContainer').hide();il.$html.find('.RecommendedImagesContainer .RecommendedImages').empty();il.$html.find('.search').parent().removeClass('multi-filters');FavoriteImages.resetFilter(il.$html.find('.searchIconFavorite'));};il.reinitPageInation = function() {if ( !il.initialized ) return;that.q = il.$html.find('.search-query').val();that.type = 'imagesItems';recommendedImagesPage = that.inlineLibrary.lastImagesPage;RecommendedImagesPagInation.destroy();RecommendedImagesPagInation.init({isMobile: false, // we don't want to add "load more button"
$recommendedImagesContainer: il.$html.find('.RecommendedImagesContainer'),$recommendedImages: il.$html.find('.RecommendedImagesContainer .RecommendedImages'),recommendedImagesPage: recommendedImagesPage});};function addControllersEvents() {il.$html.find('.cat').on('click', function() {that.type = 'imagesItems';that.q = $(this).data('search');il.$html.find('.search').val(that.q);il.showResults(that.q);});il.$html.find('.search')
.on('keydown', function( event ) {var $this = $(this);var eventKey = event.which;FavoriteImages.resetFilter(il.$html.find('.searchIconFavorite'));clearTimeout(this.searchLibraryInputFinished);if ( eventKey == 13 ) {il.showResults($this.val());} else {this.searchLibraryInputFinished = setTimeout( function() {il.showResults($this.val());},1000);}});il.$html.find('.searchStylesIconRemove').on('click', function() {il.$html.find('.search').val('');FavoriteImages.resetFilter(il.$html.find('.searchIconFavorite'));il.showResults('');});}
function generateHtml() {var html = '';html += '<div class="r-i-modal" data-type="inline">';html += generatePopUpContentHTML(['search','imagesLibrary','recommendedCategories','saveAndClose']);html += '</div>';return html;}
function resize() {var newHeight = $(window).height() - il.$html.find('.rcContainer .boxContent').offset().top;il.$html.find('.rcContainer .boxContent').css({maxHeight: newHeight});}
return il;}();that.customizeHandler = function() {var self = {};self.init = function( settings ) {if ( !settings ) return;self.$container = settings.$container;self.imagesAmout = settings.imagesAmout;self.isHalf = settings.isHalf;self.fistInputID = settings.fistInputID;self.$customize = $(gnerateHtml());self.$container.append(self.$customize);addControllersEvents();self.initialized = true;};self.destroy = function() {if ( !self.initialized ) return;self.$customize.remove();if ( self.$header ) {self.$originalHeader.show();self.$header.remove();self.initialized = false;}};self.reset = function() {self.$container.closest('.panel-body').attr('data-is-visible','true');$('#hmBgSettings').attr('data-is-visible','false');$('#wizardImageTabColorsRecommended').attr('data-is-visible','false');if ( self.$header ) {self.$originalHeader.show();self.$header.remove();}};function addControllersEvents() {self.$customize.find('[data-related-id]').on('click', function( event ) {event.preventDefault();self.$container.closest('.panel-body').attr('data-is-visible','false');$('#'+$(this).data('related-id')).attr('data-is-visible','true');addHeader($(this).data('title'));handleTabBoxes();});self.$customize.find('#customizeHandlerBtn:not([data-toggle="dropdown"])').on('click', function( event ) {event.preventDefault();self.$customize.find('[data-related-id="hmBgSettings"]').trigger('click');});$(document).on('animation_manager.hide', function() {self.reset();});}
function gnerateHtml() {var html = '';html += '<div class="customize-container hidden">';html += '{{button}}';html += '<ul class="dropdown-menu">';html += '<li>';html += '<a href="#" data-related-id="wizardImageTabColorsRecommended" data-title="'+translations.homePageBgOptions.customizeHandler.color+'">';html += '<i class="fal fa-paint-brush"></i>&nbsp;'+translations.homePageBgOptions.customizeHandler.color;html += '</a>';html += '</li>';html += '<li>';html += '<a href="#" data-related-id="hmBgSettings" data-title="'+translations.homePageBgOptions.customizeHandler.moreOptions+'">';html += '<i class="fal fa-cog" aria-hidden="true"></i>&nbsp;'+translations.homePageBgOptions.customizeHandler.moreOptions;html += '</a>';html += '</li>';html += '</ul>';html += '</div>';var button = '';if ( self.imagesAmout === 1 && self.isHalf ) {button = '<button type="button" id="customizeHandlerBtn" class="btn btn btn-transparent btn-sm" data-toggle="dropdown" aria-expanded="false">';button += translations.homePageBgOptions.customizeHandler.customize+' <span class="ace-icon fal fa-caret-down icon-on-right">';button += '</button>';} else {button = '<button type="button" id="customizeHandlerBtn" class="btn btn btn-transparent btn-sm" aria-expanded="false">';button += translations.homePageBgOptions.customizeHandler.customize;button += '</button>';}
html = html.replace('{{button}}',button);return html;}
function addHeader( text ) {if ( $('html').data('device') === 'mobile' ) {self.$originalHeader = $('.top-nav');self.$header = self.$originalHeader.clone();self.$header.find('.current-page .top-nav-link').text(text);self.$header.insertBefore(self.$originalHeader);self.$originalHeader.hide();} else {self.$originalHeader = Wizard.tabEffectHandler.AnimationManager.homepageTab.$header;self.$header = self.$originalHeader.clone();self.$header.find('.t-e-h-back-title').text(text);self.$header.insertBefore(self.$originalHeader);self.$originalHeader.hide();}
self.$header.on('click.customizeHandler', function( event ) {event.preventDefault();self.reset();});}
function handleTabBoxes() {var $filterBoxes = $('#hmBgSettings #hmBgFilters');var $shapesBox = $('#hmBgSettings #homepageShapeDividers');$shapesBox.removeClass('full-size');if ( self.imagesAmout == 1 && getUploadFileObjectByID(self.fistInputID).input.val().length === 0 ) {$shapesBox.addClass('full-size');if ( !$shapesBox.hasClass('open') ) {$shapesBox.find('.title').trigger('click');}
$(document).trigger('s123_collapse_settings.open',[$shapesBox]);} else {if ( !$filterBoxes.hasClass('open') ) {$filterBoxes.find('.title').trigger('click');}
$(document).trigger('s123_collapse_settings.open',[$filterBoxes]);}
$(document).off('animation_manager.hide.s123_collapse_settings');}
return self;}();that.showPoUp = function( type ) {that.type = type;that.popUp.off('show.bs.modal').on('show.bs.modal', function() {that.backDrop.show();hidePopUpTools();if ( type == 'all' ) {showPopUpTools(['.search-container','.rcContainer']);that.popUp.find('.modal-title').text(translations.homepageRI.typeCategoriesTitle);FavoriteImages.resetFilter(that.popUp.find('.searchIconFavorite'));} else if ( type == 'patterns' ) {showPopUpTools(['.RecommendedImagesContainer','.searchStylesIconRemove']);that.popUp.find('.modal-title').text(translations.homepageRI.typePatternsTitle);searchImagesByQuery(that.popUp.find('.RecommendedImagesContainer'));} else {showPopUpTools(['.search-container','.RecommendedImagesContainer','.searchStylesIconRemove']);that.popUp.find('.modal-title').text(translations.homepageRI.typeImagesTitle);searchImagesByQuery(that.popUp.find('.RecommendedImagesContainer'));}}).off('shown.bs.modal').on('shown.bs.modal', function() {resizeElment(that.popUp.find('.rcContainer .boxContent'));}).off('hide.bs.modal').on('hide.bs.modal', function() {that.popUp.find('.search').val('');that.backDrop.hide();}).off('hidden.bs.modal').on('hidden.bs.modal', function() {that.popUp.find('.RecommendedImagesContainer').hide();that.popUp.find('.colorsContainer').hide();that.popUp.find('.rcContainer').hide();if ( that.popUp.find('#ActiveHomepageColor').hasClass('active') ) {that.popUp.find('.customColorHeader').trigger('click');}
that.inlineLibrary.reinitPageInation();});that.popUp.modal('show');};that.getRecommendedImages = function( $RecommendedImagesContainer, pageNUM ) {var favoritesOnly = $RecommendedImagesContainer.parent().find('.searchIconFavorite').hasClass('active');if ( that.q == '' && !favoritesOnly ) return;var limit = 15;$RecommendedImagesContainer.attr('data-type',that.type);var $itemsContainer = $RecommendedImagesContainer.find('.RecommendedImages');if ( pageNUM == 1 ) {recommendedImagesLoading_start = false;$itemsContainer.html('');$itemsContainer.height(50);}
if ( recommendedImagesLoading_start == false ) {recommendedImagesLoading_start = true;if ( that.type != 'patterns' ) {var template = '<div class="r-i-fake recommendedImagesItem" data-type="'+that.type+'">';template += '<div class="r-i-fake-item"></div>';template += '</div>';if ( pageNUM == 1) {$itemsContainer.append('<div class="recommendedImagesItem-sizer"></div>');masonryHandler('init',$itemsContainer,{settings: {itemSelector: '.recommendedImagesItem',percentPosition: true,columnWidth: '.recommendedImagesItem-sizer',transitionDuration: 0}});}
for ( var i = 0; i < limit; i++ ) {var $template = $(template);$itemsContainer.append($template);masonryHandler('appended',$itemsContainer,{item: $template});masonryHandler('layout',$itemsContainer,{});}} else {var template = '<div class="r-i-fake recommendedImagesItem" data-type="'+that.type+'">';template += '<div class="r-i-fake-item r-i-image-wrapper"></div>';template += '<div class="styles"></div>';template += '</div>';for ( var i = 0; i < limit; i++ ) {$itemsContainer.append(template);}}
if ( RecommendedImagesPagInation.$loadMore ) RecommendedImagesPagInation.$loadMore.hide();var orientation = $('#homepage_layout_kind').val() == '2' || $('#homepage_layout_kind').val() == '3' ? '' : 'horizontal';that.request = $.ajax({type: "POST",url: "/versions/2/wizard/recommendedMediaV_beta_V4.php",data: 'w='+$('#id').val()+'&q='+encodeURIComponent(that.q)+'&p='+pageNUM+'&m=1&imgT='+that.type+'&orientation='+orientation+'&l='+limit+'&favoritesOnly='+encodeURIComponent(favoritesOnly)+'&returnFavoritesArray='+FavoriteImages.isReturnFavoritesArray(),success: function( data ) {if ( RecommendedImagesPagInation.$loadMore ) RecommendedImagesPagInation.$loadMore.show();var json = $.parseJSON(data);var $fakeSkeletons = $itemsContainer.find('.r-i-fake');if ( json.results.length == 0 ) {$fakeSkeletons.remove();if ( pageNUM == 1 ) {if ( $itemsContainer.find('.RecommendedImagesNoResult').length == 0 ) {$itemsContainer.append('<div class="RecommendedImagesNoResult" style="width: 100%;padding: 20px;text-align: center;font-size: 1.2em;">'+translations.homepageRI.noResultsFound+'</div>');}}
return;} else {if ( json.favoritesArray ) {FavoriteImages.items = json.favoritesArray;}
if ( json.output == 'library' ) {if ( json.results.length < limit ) {$fakeSkeletons.remove();}
$(json.results).each(function( index, styleSettings ) {if ( favoritesOnly ) {styleSettings = FavoriteImages.getSettingsObject(styleSettings.allSettings);}
if ( styleSettings['id'] == '' ) {return true;}
if ( styleSettings['mediaKind'] == 'video' ) {styleSettings['previewURL'] = styleSettings['previewImage'];}
styleSettings['previewURL'] = setImagesCDN(styleSettings['previewURL']);styleSettings['webformatURL'] = setImagesCDN(styleSettings['webformatURL']);var recImage = '<div data-id="'+styleSettings['id']+'" class="recommendedImagesItem '+ FavoriteImages.getActiveClass(styleSettings['id']) +'" data-type="'+that.type+'" data-index="'+index+'">';if ( that.type === 'patterns' ) {recImage += '<div class="r-i-image-wrapper">';recImage += '<img src="'+styleSettings['previewURL']+'">';recImage += '</div>';} else {recImage += '<img src="'+styleSettings['previewURL']+'">';}
if ( styleSettings['mediaKind'] == 'video' ) {recImage += '<div class="mediaKind_play"><i class="fal fa-play fa-2x"></i></div>';}
if ( styleSettings['provider'] == 'pixabay' ) {recImage += '<div class="credits">';recImage += '<a data-href="https://www.pixabay.com">';
if ( $('html').data('device') !== 'mobile' ) {recImage += 'Pixabay';} else {recImage += '<i class="fal fa-eye" aria-hidden="true"></i>';}
recImage += '</a>';recImage += '</div>';}
if ( styleSettings['provider'] == 'unsplash' ) {recImage += '<div class="credits">';recImage += '<a data-href="' + styleSettings['photographerURL'] + '">';if ( $('html').data('device') !== 'mobile' ) {recImage += styleSettings['photographerName'];} else {recImage += '<i class="fal fa-info-circle" aria-hidden="true"></i>';}
recImage += '</a>';recImage += '</div>';}
recImage += '<div class="styles"></div>';recImage += '<i class="ace-icon fal fa-check-circle"></i>';recImage += '<div class="saved-label-container">';recImage += '<div class="saved-label">'+translations.homepageRI.savedLabel+'</div>';recImage += '<div class="saved-label-cover"></div>';recImage += '</div>';recImage += '</div>';var $recImage = $(recImage);var $credits = $recImage.find('.credits');$recImage.data('settings',styleSettings);$itemsContainer.append($recImage);if ( that.type != 'patterns' ) {masonryHandler('appended',$itemsContainer,{item: $recImage});$recImage.imagesLoaded( function( o ) {var r = o.images[0];$fakeSkeletons.eq($(r.img).closest('.recommendedImagesItem').data('index')).remove();masonryHandler('layout',$itemsContainer,{});$(r.img).css({ visibility: 'visible' });$(r.img).parent().addClass('r-c-i-loaded');if ( $('html').data('device') === 'mobile' ) {$credits.css({ visibility: 'visible' });}});} else {$fakeSkeletons.eq($recImage.data('index')).remove();}
if ( $recImage.closest('.r-i-modal').data('type') === 'inline' ) {that.inlineLibrary.lastImagesPage = pageNUM;}
$recImage.find('img').click(function() {var $thisParentRecommendedImagesItem = $(this).closest('.recommendedImagesItem');var settings = $thisParentRecommendedImagesItem.data('settings');var $thisParent = $thisParentRecommendedImagesItem.find('.styles');var imageURL = settings['webformatURL'];var previewURL = settings['previewURL'];$thisParentRecommendedImagesItem.siblings().removeClass('active');$thisParentRecommendedImagesItem.addClass('active');if ( $(this).closest('.r-i-modal').data('type') === 'inline' ) {imageHomepageLiveEleID = Wizard.homePageChangingImages.fistInputID;}
homepage_PickNewObjectToHomepageBackground(true,$thisParentRecommendedImagesItem,previewURL,imageURL,$thisParent,that.type);if ( that.type == 'imagesItems' ) {WizardAddImagesToHistory.add(previewURL,imageURL);$(document).trigger('user_action_update_flag',[{name: 'flag_HomepageChooseGalleryImage', triggerName: false}]);}
if ( that.type != 'patterns' && !$recImage.hasClass('is-favorite') ) {FavoriteImages.add($recImage);}});$credits.on('click.show_credits', function () {if ( $('.popover.r-i-popover-credits').data('image-id') == styleSettings['id'] ) return false;$credits.addClass('active');var popoverContent = '';popoverContent += '<div class="form-group" style="margin-bottom:5px">';popoverContent += '<div class="popover-custom-title">';popoverContent += '<a class="popover-close">';popoverContent += '<i class="fal fa-times" aria-hidden="true"></i>';popoverContent += '</a>';popoverContent += '</div>';if ( styleSettings['provider'] == 'pixabay' ) {popoverContent += '<div>';popoverContent += '<div><b>' + translations.homepageRI.creditsProvider + '</b> ';popoverContent += '<a target="_blank" href="' + $credits.find('a').data('href') + '">' + styleSettings['provider'] + '</a>';popoverContent += '</div>';popoverContent += '<div>';popoverContent += '<a target="_blank" href="' + $credits.find('a').data('href') + '">' + translations.homepageRI.creditsSeeMoreDetails + '</a>';popoverContent += '</div>';} else {popoverContent += '<div><b>' + translations.homepageRI.creditsPhotographerName + '</b> ' + styleSettings['photographerName'] + '</div>';popoverContent += '<div><b>' + translations.homepageRI.creditsProvider + '</b> ' + styleSettings['provider'];popoverContent += '<div>';popoverContent += '<a target="_blank" href="' + $credits.find('a').data('href') + '">' + translations.homepageRI.creditsSeeMoreDetails + '</a>';popoverContent += '</div>';}
popoverContent += '</div>';var $popoverContent = $(popoverContent);var $popover = $('html').data('device') !== 'mobile' ?  $credits : $credits.find('a');$popoverContent.find('.popover-close').on('click.close_credits', function() {destroyPopover();});$popover.popover({container: 'body',content: $popoverContent,html: true,trigger: 'manual',template: '<div class="popover r-i-popover-credits" role="tooltip" data-image-id="'+styleSettings['id']+'"><div class="arrow"></div><div class="popover-content"></div></div>',placement: window['isTouchSupported'] ? 'auto' : intrface_align_reverse}).on('shown.bs.popover', function () {$(document).on('mousedown.credits_destroy_popover', function ( event ) {if ( $(event.target).closest('.popover.r-i-popover-credits').length === 0 ) {destroyPopover();}});$(window).one('blur.credits_destroy_popover', function( event ) {destroyPopover();});$RecommendedImagesContainer.one('scroll.credits_destroy_popover', function( event ) {destroyPopover();});})
.popover('show');function destroyPopover() {$popover.removeClass('active');$popover.popover('destroy');$(document).off('mousedown.credits_destroy_popover');$(window).off('blur.credits_destroy_popover');$(window).off('scroll.credits_destroy_popover');}});});if ( that.type != 'patterns' ) {FavoriteImages.addIcons($itemsContainer.find('.recommendedImagesItem:not(.favorite-added)'));}}}
recommendedImagesLoading_start = false;if ( !json.hasNextPage ) {RecommendedImagesPagInation.destroy();} else if ( $RecommendedImagesContainer.is(':visible') ) {setTimeout( function() {if ( !($RecommendedImagesContainer.get(0).scrollHeight > $RecommendedImagesContainer.height()) ) {RecommendedImagesPage++;that.getRecommendedImages($RecommendedImagesContainer,RecommendedImagesPage);}},200);}}});}};function masonryHandler( action, $el, data ) {if ( !$.contains(document, $el[0]) ) return;switch ( action ) {case 'init':$el.masonry(data.settings);break;case 'layout':$el.masonry('layout');break;case 'appended':$el.masonry('appended',data.item);break;}}
that.showHideBackgroundOptions = function() {var homepage_style = that.$container.find('#homepage_style').val();that.$container.find('#home_opacity_container').addClass('hidden');WizardAddImagesToHistory.$container.addClass('hidden');WizardAddImagesToHistory.disabled = true;that.isHmImgTypeSupported = false;that.customizeHandler.destroy();switch ( homepage_style ) {case '3':if ( Wizard.homePageChangingImages.getItemsAmont() == 1 ) {that.isHmImgTypeSupported = true;WizardAddImagesToHistory.disabled = false;that.inlineLibrary.init({$container: $('#backgroundOptionsTab .panel-body #backgroundMideaOptionsTab')});} else {that.inlineLibrary.destroy();}
that.customizeHandler.init({$container: Wizard.homePageChangingImages.$container.parent(),imagesAmout: Wizard.homePageChangingImages.getItemsAmont(),fistInputID: Wizard.homePageChangingImages.fistInputID,isHalf: $('#homepage_layout_kind').val() == '2' || $('#homepage_layout_kind').val() == '3'});that.$container.find('#home_opacity_container').removeClass('hidden');break;default:that.$container.find('#homepageFilterDesign').removeClass('hidden');that.$container.find('#parallax_homepage_container').removeClass('hidden');that.$container.find('#home_opacity_container').removeClass('hidden');break;}};that.updateHomepageImageType = function( type ) {var uploadFile = topWindow.uploadFiles[imageHomepageLiveEleID];uploadFile.settings.set('type',type);uploadFile.input.trigger('change.w_h_p_c_i');};that.showSavedLabel = function() {if ( that.type == 'imagesItems' || that.type == 'patterns' ) {that.popUp.find('.saved-label-container').hide();that.popUp.find('.recommendedImagesItem.active .saved-label-container').fadeIn(500,function() {$(this).fadeOut(500);});that.popUp.find('.RecommendedImagesContainer').css('height',that.popUp.find('.RecommendedImagesContainer').parent().height()-that.popUp.find('#saveAndClose').height());}
that.popUp.find('#saveAndClose').show();};function showPopUpTools( selectors ) {for (var i = 0; i < selectors.length; i++) {that.popUp.find(selectors[i]).show();}}
function hidePopUpTools() {that.popUp.find('.colorsContainer').hide();that.popUp.find('.RecommendedImagesContainer').hide();that.popUp.find('.rcContainer').hide();that.popUp.find('.search-container').hide();that.popUp.find('#ActiveHomepageColor').hide();that.popUp.find('#saveAndClose').hide();that.popUp.find('.searchStylesIconRemove').hide();that.popUp.find('.RecommendedImagesContainer').css('height','');}
function generatePopUpHTML() {var html = '';html += '<div class="modal r-i-modal s123-modal fade" role="dialog" data-action="false" data-backdrop="false">';html += '<div class="modal-dialog" role="document">';html += '<div class="modal-content">';html += '<div class="modal-header">';html += '<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>';html += '<h4 class="modal-title"></h4>';html += '</div>';html += '<div class="modal-body">';html += generatePopUpContentHTML(['search','imagesLibrary','recommendedCategories','saveAndClose']);html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '<div class="r-i-back-drop"></div>';return html;}
function generatePopUpContentHTML( tools ) {var html = '';if ( tools.indexOf('search') != -1 ) {html += '<div class="input-group search-container" style="display: flex; width: 100%;">';html += '<div style="position: relative; width: 100%;">';html += '<input type="text" maxlength="50" class="search form-control search-query data-hj-whitelist" placeholder="'+escapeHtml(translations.homepageRI.placeholder)+'" data-rule-flickr-pattern="true" data-msg-flickr-pattern="'+escapeHtml(translations.homepageRI.patterns)+'" style="height: 100%; width: 100%;">';html += '<span class="fal fa-search form-control-feedback searchStylesIconDemo"></span>';html += '<span class="fal fa-arrow-'+t_align+' searchStylesIconRemove"></span>';html += '<span class="fal fa-star-o searchIconFavorite" data-rel="tooltip" title="' + escapeHtml(translations.FavoriteImages.onlyFavoritsTooltip) + '"></span>';html += '</div>';html += '</div>';}
if ( tools.indexOf('imagesLibrary') != -1 ) {html += '<div class="RecommendedImagesContainer fancy-scrollbar">';html += '<div class="RecommendedImages"></div>';html += '</div>';}
if ( tools.indexOf('recommendedCategories') != -1 ) {html += '<div class="rcContainer">';html += '<div class="boxContent fancy-scrollbar"></div>';html += '</div>';}
if ( tools.indexOf('saveAndClose') != -1 ) {html += '<div id="saveAndClose">';html += '<a class="btn btn-success no-radius">'+escapeHtml(translations.homepageRI.saveAndClose)+'</a>';html += '</div>';}
return html;}
function resizeElment( $el ) {var newHeight = that.popUp.find('.modal-body').height();$el.siblings().each(function( index, element ) {newHeight -= $(element).outerHeight();});if ( that.popUp.find('.search-container').is(':visible') ) {newHeight = newHeight - that.popUp.find('.search-container').outerHeight();}
$el.css({maxHeight: newHeight});}
that.addLibraryAbility = function() {if ( !that.$container ) return;that.$container.find('.image-homepage-live')
.off('click').on('click', function() {var $this = $(this);var tags = $this.data('search');showResults(tags,false);if ( $this.hasClass('image-homepage-live') ) imageHomepageLiveEleID = $this.data('id');});};that.shapesHandler = function() {var svh = {};svh.init = function() {svh.$shapeOptions = $('#shape_options');svh.$homepageShapeDivider = svh.$shapeOptions.find('#homepageShapeDivider');svh.activeShapeID = getActiveShapeID();svh.$shapesContainer = svh.$shapeOptions.find('.shapes-design-styles');svh.$homepageShapeDividerList_Size = svh.$shapeOptions.find('#homepageShapeDividerList_Size');svh.$homepageShapeDivider.off('change.shapesHandler').on('change.shapesHandler',function() {svh.activeShapeID = getActiveShapeID();$('.homepage-shapes-button-container .shapes-design-button').removeClass('active');$('.homepage-shapes-button-container[data-id="' + svh.activeShapeID + '"] .shapes-design-button').addClass('active');svh.showHideOptions();});$(document).on('ready_template.changed.shapes', function( event ) {svh.activeShapeID = getActiveShapeID();svh.showHideOptions();});$(document).on('s123_collapse_settings.open.shapes', function( event, $s123CollapseSettings ) {if ( !svh.$shapeOptions.closest('.s123-collapse-settings').is($s123CollapseSettings) ) return;svh.showHideOptions();svh.$shapesContainer.empty();var scroll = new s123InfiniteScroll({isMobile: false, // we don't want to add "load more button" but we have other tools that do need that feature
$container: $('#homepageShapeDividerList'),loader: {$container: svh.$shapesContainer,template: '<div style="order:1;" data-id="1" data-default-size="" class="homepage-shapes-button-container"><div class="shapes-design-button "><i class="ace-icon fal fa-check-circle"></i></div><div class="shapes-design-button-image" style="z-index:1;opacity: 1;"></div></div>'},ajax: {type: 'POST',url: '/versions/2/wizard/modules/wizardInfiniteScroll_v4.php',data: {w: $('#id').val(),type: 'shapeDividers',limit: 500,},buildItemCallback: function( index, shape ) {if ( shape.disable && svh.activeShapeID != shape.id ) return;var html = '';html += '<div style="order:' + shape.order + ';" data-id="' + shape.id + '" data-default-size="' + shape.defaultSize + '" class="homepage-shapes-button-container">';html += '<div class="shapes-design-button ' + ( svh.activeShapeID == shape.id ? 'active' : '') + '">';html += '<i class="ace-icon fal fa-check-circle"></i>';html += '</div>';html += '<img class="shapes-design-button-image" src="https://cdn-cms-localhost.f-static.com/ready_uploads/shapeLayout/v28/400_'+shape.id+'_shapeLayout.jpg?v=' + $GLOBALS['v-cache-long'] +'" style="z-index:1;opacity: 1;">';
html += '</div>';var $shape = $(html);$shape.click( function( event ) {var $this = $(this);var id = $this.data('id');var defaultSize = $this.data('default-size');svh.activeShapeID = id;holdWizardSave = true;svh.$homepageShapeDividerList_Size.val(defaultSize).trigger('change');holdWizardSave = false;svh.$homepageShapeDivider.val(id).trigger('change');});svh.$shapesContainer.append($shape);}}});$(document).off('s123_collapse_settings.open.shapes');});$(document).on('homepage_bg_options.opened.shapes', function( event ) {svh.$shapeColors = $('.color-palette[data-rel="homepageShapeDividerList_Color1"]');svh.showHideOptions();});};svh.showHideOptions = function() {if ( getActiveShapeID() == 1 ) {hide();} else {show();}};function getActiveShapeID() {return svh.$homepageShapeDivider.val().length > 0 ? svh.$homepageShapeDivider.val() : 1;}
function hide() {svh.$shapeOptions.find('#shapeSize').addClass('hidden');svh.$shapeOptions.find('#shapeOnMobile').addClass('hidden');if ( svh.$shapeColors ) svh.$shapeColors.addClass('hidden');}
function show() {svh.$shapeOptions.find('#shapeSize').removeClass('hidden');svh.$shapeOptions.find('#shapeOnMobile').removeClass('hidden');if ( svh.$shapeColors ) svh.$shapeColors.removeClass('hidden');}
return svh;}();function addPluginAbilities() {var $popupSearch = that.popUp.find('.search');that.shapesHandler.init();that.backDrop.on('click', function() {that.popUp.modal('hide');});that.popUp.find('#saveAndClose').on('click', function() {that.popUp.modal('hide');});$popupSearch
.on('keydown', function( event ) {var $this = $(this);var eventKey = event.which;FavoriteImages.resetFilter(that.popUp.find('.searchIconFavorite'));clearTimeout(this.searchLibraryInputFinished);if ( eventKey == 13 ) {showResults($this.val(),true);} else {this.searchLibraryInputFinished = setTimeout( function() {showResults($this.val(),true);},1000);}});that.addLibraryAbility();that.$container.find('.cat')
.on('click', function() {var $this = $(this);var tags = $this.data('search');showResults(tags,false);imageHomepageLiveEleID = Wizard.homePageChangingImages.fistInputID;});that.popUp.find('.cat')
.on('click', function() {var $this = $(this);var tags = $this.data('search');showResults(tags,false);});that.$container.find('#homepage_style')
.on('change.set_homepage_style',function() {that.showHideBackgroundOptions();$('.homepage_style_option').hide();$('#homepage_style_option_'+$(this).val()).show();that.$container.find('#imagesLibraryForm').hide();if ( $(this).val() == '2' ) {that.$container.find('#imagesLibraryForm').show();}
if ( $(this).val() == '5' ) {if ( $('#home_youtube_background').val().length === 0 ) {$('#home_youtube_background').val('https://www.youtube.com/watch?v=9E4J7EoUPS0');}}
filterHomepageOptionsList();SettingsBox.hide();if ( $(this).val() != '3' ) {that.isHmImgTypeSupported = false;} else {that.isHmImgTypeSupported = true;}})
.trigger('change.set_homepage_style');that.$container.find('.lastImages').on('click.reset_homepagem_img_type','.recommendedImagesItem', function() {imageHomepageLiveEleID = Wizard.homePageChangingImages.fistInputID;that.updateHomepageImageType('images');});that.popUp.find('.searchStylesIconRemove').on('click', function() {$popupSearch.val('');FavoriteImages.resetFilter(that.popUp.find('.searchIconFavorite'));showResults('',false);});}
function showResults( value, searchInput ) {var $popupSearch = that.popUp.find('.search');that.q = '';if ( value == 'patterns' ) {FavoriteImages.resetFilter(that.popUp.find('.searchIconFavorite'));}
var favoritesOnly = that.popUp.find('.searchIconFavorite').hasClass('active');if ( value.length == 0 ) value = 'all';if ( favoritesOnly ) {$popupSearch.parent().addClass('multi-filters');that.showPoUp('');} else if ( value.toLowerCase() == 'all' ) {$popupSearch.parent().removeClass('multi-filters');that.showPoUp('all');} else {that.q = value.toLowerCase();if ( !searchInput && value.toLowerCase() == 'patterns' ) {that.showPoUp('patterns');} else {$popupSearch.parent().addClass('multi-filters');that.showPoUp('imagesItems');}
$popupSearch.val(value);}}
function searchImagesByQuery( $recommendedImagesContainer ) {RecommendedImagesPagInation.destroy();RecommendedImagesPagInation.init({isMobile: false, // we don't want to add "load more button"
$recommendedImagesContainer: $recommendedImagesContainer,$recommendedImages: $recommendedImagesContainer.find('.RecommendedImages'),recommendedImagesPage: RecommendedImagesPage});RecommendedImagesPage = 1;that.getRecommendedImages($recommendedImagesContainer,RecommendedImagesPage);}
function addColorsList( $container, isGradients ) {$container.show();var scroll = new s123InfiniteScroll({isMobile: false, // we don't want to add "load more button" but we have other tools that do need that feature
$container: $container,ajax: {type: 'POST',url: '/versions/2/wizard/modules/wizardInfiniteScroll_v4.php',data: {w: $('#id').val(),type: (isGradients ? 'gradients' :'colors' ),limit: 100,},buildItemCallback: function( index, color ) {var gradient    = color[0];var $html = $('<div class="gradientsList" '+(isGradients ? 'data-type="gradients"' : '' )+' style="background:'+(gradient)+';" data-gradient="'+(gradient)+'" data-type="'+that.type+'"></div>');$html.click(function() {var $this       = $(this);var gradient    = $this.data('gradient');var textColor = getOppositeColor(gradient,isGradients);holdWizardSave = true;that.updateHomepageImageType(that.type);wizard_ClearAllColorsRecommended();$('#home_text_color').val(textColor).trigger('change');Wizard.render.init('home_text_color');if ( gradient.indexOf('gradient') !== -1 ) {$('#homepageGradientsColors').val(gradient).trigger('change');var settings = LinearGradientParser(gradient);$('#homepageGradientsSettings').val(JSON.stringify(settings)).trigger('change');$(document).trigger('gradients_palette_change',settings);} else {$('#home_background_color').val(gradient).trigger('change');}
filterHomepageOptionsList();holdWizardSave = false;$('#homepage_style').val('3').trigger('change.set_homepage_style');that.showSavedLabel();});$container.append($html);}}});}
function getOppositeColor( color, isGradients ) {var tmpColor = color;if ( isGradients ) {tmpColor = tmpColor.replace(/ /g,'').split(',')[1];tmpColor = tmpColor.substr(0,7);}
return invertColor(tmpColor,true);}
function libraryCategoriesOutput( $container, items ) {var html = '';for ( var i = 0; i < items.length; i++ ) {var module = items[i];if ( module.type == 'color' ) {html += '<div id="libraryHomepageColorsCat" class="cat" data-search="'+escapeHtml(module.keyword)+'">';html += '<div class="images">';html += '<div class="libraryHomepageColorsCat"></div>';html += '<div class="catName">'+escapeHtml(module.name)+'</div>';html += '</div>';html += '</div>';} else if ( module.type == 'gradients' ) {html += '<div id="libraryHomepageGradientsCat" class="cat" data-search="'+escapeHtml(module.keyword)+'">';html += '<div class="images">';html += '<div class="libraryHomepageColorsCat"></div>';html += '<div class="catName">'+escapeHtml(module.name)+'</div>';html += '</div>';html += '</div>';} else if ( module.type == 'pattern' ) {html += '<div id="libraryHomepagePatternsCat" class="cat" data-search="'+escapeHtml(module.keyword)+'">';html += '<div class="images">';html += '<img src="'+module.image1+'">';html += '<div class="catName">'+escapeHtml(module.name)+'</div>';html += '</div>';html += '</div>';} else {html += '<div class="cat" data-search="'+escapeHtml(module.keyword)+'">';html += '<div class="images">';html += '<img src="'+module.image1+'">';html += '<div class="catName">'+escapeHtml(module.name)+'</div>';html += '</div>';html += '</div>';}}
$container.find('.boxContent').append(html);}
function initFavorites( forceInit ) {if ( forceInit ) FavoriteImages.initialized = false;FavoriteImages.init({websiteID: $('#id').val(),$filterController: $('.searchIconFavorite'),mediaKind: 'image',onFilterChange: function( $filter ) {if ( $filter.closest('.r-i-modal[data-type="inline"]').length > 0 ) {handleSearch($filter,that.inlineLibrary.$html.find('.search'),'inline');} else {handleSearch($filter,that.popUp.find('.search'),'popup');}
function handleSearch( $filter, $search, galleryType ) {if ( $filter.hasClass('active') ) {if ( that.request ) {that.request.abort();}
$filter.data('query',(that.q != 'all'? that.q : ''));that.q = '';$search.val(that.q);} else {that.q = $filter.data('query');$search.val(that.q);}
if ( galleryType == 'inline' ) {that.inlineLibrary.showResults(that.q);} else {showResults(that.q);}}}});}
return that;}();Wizard.readyTextLayoutsHandler = function() {var that = {};that.textLayoutsFonts = [];that.init = function() {if ( $('html').data('device') === 'mobile' ) {$('#readyTextLayoutsTabs').hide();return;}
that.innerTabsHanler = new innerTabsHanler({$container: $('#readyTextLayoutsTabs')});that.textPositions.init();that.textAnimations.init();$('#home_siteSlogan, #home_siteSlogan_2, #home_SecondSiteSlogan').off('input.ready_text change.ready_text').on('input.ready_text change.ready_text',function( event, flagType ) {var $this = $(this);if ( flagType == 'readyTextLayouts' || flagType == 'UndoRedoChange' ) return;clearTimeout(that.readyTextLayouts_finishedTyping);that.readyTextLayouts_finishedTyping = setTimeout( function() {that.printTextLayouts();that.printSingleTextLayouts($this.get(0).id);},doneTypingInterval);});$('#home_text_size, #home_text_size_2, #slogan_text_size').off('input.ready_text change.ready_text').on('input.ready_text change.ready_text',function( event, flagType ) {if ( flagType == 'UndoRedoChange' ) return;var $this = $(this);var title = 'home_siteSlogan';if ( $this.get(0).id == 'home_text_size_2' ) {title = 'home_siteSlogan_2';} else if ( $this.get(0).id == 'slogan_text_size' ) {title = 'home_SecondSiteSlogan';}
clearTimeout(that.readyTextLayouts_finishedTyping);that.readyTextLayouts_finishedTyping = setTimeout( function() {that.printTextLayouts();that.printSingleTextLayouts(title);},doneTypingInterval);});$(document).off('homepage_text_settings_box.hide').on('homepage_text_settings_box.hide', function(event) {that.printTextLayouts();});that.initialized = true;};that.printTextLayouts = function() {if ( !that.initialized ) return;var home_siteSlogan = $('#home_siteSlogan').val();var home_siteSlogan_2 = $('#home_siteSlogan_2').val();var home_SecondSiteSlogan = $('#home_SecondSiteSlogan').val();var width = $(Wizard.Preview.iframe).contents().find('#top-section .boxBorder').width();var $chooseTextLayout = $('.chooseTextLayout');var globalMainColor = $('#global_main_color').val();var layout_text_align = $('#layout_text_align').val();var homepageTextCustomBoxStyle = $('#homepageTextCustomBoxStyle').val();that.loadTextLayoutsFonts();var textModulesArr = {};$chooseTextLayout.html('<div><div id="top-section" class="text-design-styles"></div></div>');if ( window.readyTextInfinityScroll ) {window.readyTextInfinityScroll.destroy();}
$(':root').get(0).style.setProperty('--global_main_color',globalMainColor);$(':root').get(0).style.setProperty('--layout_text_align',layout_text_align);if ( layout_text_align.trim() == 'left' ) {$(':root').get(0).style.setProperty('--layout_text_align_rtl','right');} else if ( layout_text_align.trim() == 'right' ) {$(':root').get(0).style.setProperty('--layout_text_align_rtl','left');} else {$(':root').get(0).style.setProperty('--layout_text_align_rtl','center');}
window.readyTextInfinityScroll = new s123InfiniteScroll({isMobile: false, // we don't want to add "load more button" but we have other tools that do need that feature
$container: $chooseTextLayout,ajax: {type: 'POST',url: '/versions/2/wizard/getHomepageTextLayoutAjax.php',data: {w: $('#id').val(),homeSiteSlogan: home_siteSlogan,homeSiteSlogan2: home_siteSlogan_2,homeSecondSiteSlogan: home_SecondSiteSlogan,width: width,textAlign: layout_text_align,limit: 12,homepageTextCustomBoxStyle: homepageTextCustomBoxStyle},success: function( data ) {$.each(data.items, function( index, module ) {var id = module.id;delete module.more_settings.home_text_size;delete module.more_settings.home_text_letter_spacing_1;delete module.more_settings.home_text_line_height_1;delete module.more_settings.home_text_word_spacing_1;delete module.more_settings.home_text_size_2;delete module.more_settings.home_text_letter_spacing_2;delete module.more_settings.home_text_line_height_2;delete module.more_settings.home_text_word_spacing_2;delete module.more_settings.slogan_text_size;delete module.more_settings.home_text_letter_spacing_3;delete module.more_settings.home_text_line_height_3;delete module.more_settings.home_text_word_spacing_3;textModulesArr[id] = {more_settings: JSON.stringify(module.more_settings)};var $style = $(module.html);$style.click( function( event ) {var id = $(this).data('id');var more_settings = textModulesArr[id].more_settings;holdWizardSave = true;if ( more_settings !== 'undefined' && more_settings != '' ) {var more_settings = jQuery.parseJSON(more_settings);$.each(more_settings, function( key, value ) {if ( key != 'home_siteSlogan' && key != 'home_siteSlogan_2' && key != 'home_SecondSiteSlogan' && key != 'home_buttonText' && key != 'home_buttonText_1' ) {$('#'+key).val(value).trigger('change',['readyTextLayouts']);} else {if ( key == 'home_siteSlogan' ) {if ( value.length > 0 && existingTitle1.length > 0 ) {$('#'+key).val(existingTitle1).trigger('change',['readyTextLayouts']);} else {$('#'+key).val(value).trigger('change',['readyTextLayouts']);}}
if ( key == 'home_siteSlogan_2' ) {if ( value.length > 0  && existingTitle2.length > 0 ) {$('#'+key).val(existingTitle2).trigger('change',['readyTextLayouts']);} else {$('#'+key).val(value).trigger('change',['readyTextLayouts']);}}
if ( key == 'home_SecondSiteSlogan' ) {if ( value.length > 0 && existingTitle3.length > 0 ) {$('#'+key).val(existingTitle3).trigger('change',['readyTextLayouts']);} else {$('#'+key).val(value).trigger('change',['readyTextLayouts']);}}
if ( key == 'home_buttonText' ) {if ( value.length > 0 && existingHomeButton1.length > 0 ) {$('#'+key).val(existingHomeButton1).trigger('change',['readyTextLayouts']);} else {$('#'+key).val(value).trigger('change',['readyTextLayouts']);}}
if ( key == 'home_buttonText_1' ) {if ( value.length > 0 && existingHomeButton2.length > 0 ) {$('#'+key).val(existingHomeButton2).trigger('change',['readyTextLayouts']);} else {$('#'+key).val(value).trigger('change',['readyTextLayouts']);}}}});}
ChangePreviewLive('home_text_size');$('#homepageTextCustomBoxStyle').val(module.customClass).trigger('change');holdWizardSave = false;$('#wizardUndoRefreshHelper').val('wizard_ReloadHomepageCss');AutoSaveWizard(false,true);ShowHideTextLayoutElementsIfUnused();$(this).siblings().removeClass('active');$(this).addClass('active');});$style.find('h1.background4').css('background-color',hexToRGB(globalMainColor,0.7));that.applyFontsStyle($style,'[data-id="home_siteSlogan"]','[data-id="home_siteSlogan_2"]','[data-id="home_SecondSiteSlogan"]');$chooseTextLayout.find('.text-design-styles').append($style);updateLayoutText('home_siteSlogan');updateLayoutText('home_siteSlogan_2');updateLayoutText('home_SecondSiteSlogan');});if ( width > 1140 ) {$('.chooseTextLayout .text-design-styles .text-design-button-container .t-d-s-scaled-preview')
.css('width',width)
.css('height', width * 0.5625)
.css('transform','scale('+ 260 / width +')');}}}});function updateLayoutText( id ) {$chooseTextLayout.find('.text-design-button-container [data-id="'+id+'"]').html(HomepageTextFormat($('#'+id).val()));}};that.printSingleTextLayouts = function( homepageTextID ) {if ( !Wizard.Preview.ready ) return;var width = Wizard.Preview.$('#top-section .boxBorder').width();var $chooseTextLayout = $('.chooseSingleTextLayout');var globalMainColor = $('#global_main_color').val();var layout_text_align = $('#layout_text_align').val();var $textStyleAndBackground = $('#home_text_background_1 option');if ( homepageTextID == 'home_siteSlogan' ) {var $homeTextBackground = $('#home_text_background_1');var textStructure = '<h1 id="home_siteSlogan">' + $('#home_siteSlogan').val() + '</h1>';var fontSize = $('#home_text_size').val();} else if ( homepageTextID == 'home_siteSlogan_2' ) {var $homeTextBackground = $('#home_text_background_2');var textStructure = '<h2 id="home_siteSlogan_2">' + $('#home_siteSlogan_2').val() + '</h2>';var fontSize = $('#home_text_size_2').val();} else if ( homepageTextID == 'home_SecondSiteSlogan' ) {var $homeTextBackground = $('#home_text_background_3');var textStructure = '<p id="home_SecondSiteSlogan">' + $('#home_SecondSiteSlogan').val() + '</p>';var fontSize = $('#slogan_text_size').val();}
that.loadTextLayoutsFonts();$chooseTextLayout.html('<div><div id="top-section" class="text-design-styles"></div></div>');$(':root').get(0).style.setProperty('--global_main_color',globalMainColor);$(':root').get(0).style.setProperty('--layout_text_align',layout_text_align);if ( layout_text_align.trim() == 'left' ) {$(':root').get(0).style.setProperty('--layout_text_align_rtl','right');} else if ( layout_text_align.trim() == 'right' ) {$(':root').get(0).style.setProperty('--layout_text_align_rtl','left');} else {$(':root').get(0).style.setProperty('--layout_text_align_rtl','center');}
$textStyleAndBackground.each(function( index, style ) {$style = $(style);var html = '<div class="text-design-button-container magic_homepage" data-style="' + $style.val() + '">';html += '<div class="t-d-s-scaled-preview">';html += '<div class="home_main_wrapper" style="max-width: 100%;width: 100%;">';html += '<div class="box_container">';html += '<div class="boxBorder">';html += textStructure;html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';var $html = $(html);$html.find('h1, h2, p').addClass($style.val()).css('font-size',fontSize+'px');that.applyFontsStyle($html,'#home_siteSlogan',false,false);$html.off('click').on('click',function(){$homeTextBackground.val($html.data('style')).trigger('change');});$chooseTextLayout.find('.text-design-styles').append($html);});if ( width > 1140 ) {$('.chooseSingleTextLayout .text-design-styles .text-design-button-container .t-d-s-scaled-preview')
.css('width',width)
.css('height', width * 0.5625)
.css('transform','scale('+ 260 / width +')');}};that.applyFontsStyle = function ( $container, home_siteSlogan, home_siteSlogan_2, home_SecondSiteSlogan ) {if ( home_siteSlogan ) {$container.find(home_siteSlogan)
.css('font-family',$('#font_slogan').val())
.css('font-size',$('#home_text_size').val() + 'px')
.css('letter-spacing',$('#home_text_letter_spacing_1').val() + 'px')
.css('line-height',$('#home_text_line_height_1').val())
.css('word-spacing','calc('+$('#home_text_word_spacing_1').val() + '* (100vw / 768)');}
if ( home_siteSlogan_2 ) {$container.find(home_siteSlogan_2)
.css('font-family',$('#font_slogan_2').val())
.css('font-size',$('#home_text_size_2').val() + 'px')
.css('letter-spacing',$('#home_text_letter_spacing_2').val() + 'px')
.css('line-height',$('#home_text_line_height_2').val())
.css('word-spacing','calc('+$('#home_text_word_spacing_2').val() + '* (100vw / 768)');}
if ( home_SecondSiteSlogan ) {$container.find(home_SecondSiteSlogan)
.css('font-family',$('#font_second_slogan').val())
.css('font-size',$('#slogan_text_size').val() + 'px')
.css('letter-spacing',$('#home_text_letter_spacing_3').val() + 'px')
.css('line-height',$('#home_text_line_height_3').val())
.css('word-spacing','calc('+$('#home_text_word_spacing_3').val() + '* (100vw / 768)');}};that.loadTextLayoutsFonts = function () {var initTextLayoutsFonts = [];['font_slogan','font_slogan_2','font_second_slogan'].forEach( function(text) {var $this = $('#'+text);if ( $this.length > 0 && $this.val().length > 0 ) {if ( $.inArray($this.val(),that.textLayoutsFonts) !== -1 ) return;that.textLayoutsFonts.push($this.val());initTextLayoutsFonts.push($this.val());}});var link = '<link class="g-f-loaded" href="//fonts.googleapis.com/css?family={{fontsList}}&display=swap" rel="stylesheet" type="text/css">';
var i = 0;var fontsList = [''];if ( initTextLayoutsFonts.length > 0 ) {initTextLayoutsFonts.forEach( function( font ) {fontsList[i] += font + ':400' + '|';if ( fontsList[i].length  > 1500 ) fontsList[++i] = '';});for ( var i = 0 ; i < fontsList.length ; i++ ) {$('head').append(link.replace("{{fontsList}}", fontsList[i]));}}};that.textPositions  = function() {var self = {interface_rtl: ($('html[dir=rtl]').length !== 0 ? true : false),website_rtl: IsRTL($('#language').val()),$container: $('#textPositionsContainer'),template: '<div class="text-positions-box"><span><i class="fa" aria-hidden="true"></i></span></div>',positions: ['top_left','top_center','top_right','center_left','center_center','center_right','bottom_left','bottom_center','bottom_right'],icons: ['fa-long-arrow-left rotate45','fa-long-arrow-up','fa-long-arrow-up rotate45','fa-long-arrow-left','fa-dot-circle-o','fa-long-arrow-right','fa-long-arrow-down rotate45','fa-long-arrow-down','fa-long-arrow-right rotate45']};var isRTL = self.$container.data('is-rtl');self.init = function() {$.each(self.positions, function( index, layout_text_position ) {var $box = $(self.template);var place = layout_text_position.split('_');var layout_text_align;if ( place[1] === 'left' ) {layout_text_align = isRTL ? 'right' : 'left';} else if ( place[1] === 'right' ) {layout_text_align = isRTL ? 'left' : 'right';} else {layout_text_align = 'center';}
$box.find('i').addClass(self.icons[index]);$box.off('click.textPositions').on('click.textPositions', function( event ) {$('#layout_text_position').val(layout_text_position);$('#layout_text_align').val(layout_text_align).trigger('change');$box.siblings().removeClass('active');$box.addClass('active');$('#readyTextLayoutsTabs [data-tab="textLayoutTab"]')
.off('click.printTextLayouts')
.one('click.printTextLayouts', function() {that.printTextLayouts();});});self.$container.append($box);});};return self;}();that.textAnimations  = function() {var self = {interface_rtl: ($('html[dir=rtl]').length !== 0 ? true : false),website_rtl: IsRTL($('#language').val()),$container: $('#textAnimationsContainer'),template: '<div class="text-animations-box"><span class="animation-name"></span><span class="animation-active"><i class="ace-icon fal fa-check-circle"></i></span></div>',$inputs: [$('#home_text_animation_1'),$('#home_text_animation_2'),$('#home_text_animation_3')]};self.init = function() {self.animations = self.getAnimationsList();$.each(self.animations, function( index, animation ) {var $box = $(self.template);$box.find('span.animation-name').html(animation.name);$box.attr('data-animation-value',animation.value);$box.hover(function( event ) {self.$container.find('span.animation-name').attr('class','animation-name');$box.find('span.animation-name').addClass('animated').addClass(animation.value);});$box.mouseout(function( event ) {self.$container.find('span.animation-name').attr('class','animation-name');});$box.off('click').on('click',function( event ) {$.each(self.$inputs,function(index, el) {$(this).val(animation.value);});window.scrollPreview = $('#top-section');scrollToPointInPreview();AutoSaveWizard(false,true);self.updatePreview();});self.$container.append($box);});self.setActiveClass();};self.updatePreview = function() {self.setActiveClass();$("#wizardForm").one('ajaxSuccess.homepage_textAnimations', function() {UpdatePreviewAreaByAjax(['#top-section'],false,false,'');});};self.setActiveClass = function() {self.$container.find('.text-animations-box').removeClass('active');self.$container.find('.text-animations-box[data-animation-value="'+self.$inputs[0].val()+'"]').addClass('active');};self.getAnimationsList = function() {return [{value: '', name: translations.textAnimations.none},{value: 'fadeIn', name: translations.textAnimations.fadeIn},{value: 'fadeInDown', name: translations.textAnimations.fadeInDown},{value: 'fadeInUp', name: translations.textAnimations.fadeInUp},{value: 'zoomIn', name: translations.textAnimations.zoomIn},{value: 'zoomInUp', name: translations.textAnimations.zoomInUp},{value: 'slideInDown', name: translations.textAnimations.slideInDown},{value: 'slideInUp', name: translations.textAnimations.slideInUp},{value: 'jackInTheBox', name: translations.textAnimations.jackInTheBox},{value: 'bounce', name: translations.textAnimations.bounce},{value: 'bounceIn', name: translations.textAnimations.bounceIn},{value: 'bounceInDown', name: translations.textAnimations.bounceInDown},{value: 'bounceInUp', name: translations.textAnimations.bounceInUp},{value: 'flipInX', name: translations.textAnimations.flipInX},{value: 'flipInY', name: translations.textAnimations.flipInY},{value: 'lightSpeedIn', name: translations.textAnimations.lightSpeedIn},{value: 'pulse', name: translations.textAnimations.pulse},{value: 'rubberBand', name: translations.textAnimations.rubberBand},{value: 'shake', name: translations.textAnimations.shake},{value: 'headShake', name: translations.textAnimations.headShake},{value: 'swing', name: translations.textAnimations.swing},{value: 'tada', name: translations.textAnimations.tada},{value: 'wobble', name: translations.textAnimations.wobble},{value: 'jello', name: translations.textAnimations.jello},{value: 'heartBeat', name: translations.textAnimations.heartBeat},];};return self;}();function innerTabsHanler( settings ) {var that = {};that.$container = settings.$container;that.$linkContainer = that.$container.find('.i-t-header');that.$tabsContent = that.$container.find('.tabContent');that.$linkContainer.find('[data-tab]').on('click.inner_tabs_hanler', function() {that.$tabsContent.siblings().removeClass('active');that.$tabsContent.filter('#'+$(this).data('tab')).addClass('active');$(this).siblings().removeClass('active');$(this).addClass('active');});that.$linkContainer.find('[data-tab]').first().trigger('click');return that;}
return that;}();Wizard.websiteToggleOptionsHandler = function() {var _ = {};_.init = function( onload ) {_.$onload = onload;Wizard.Pages.list.each(function( index, page ) {_.toggleHeaderOptionsByModule($(this).data('moduletypenum'),1);});$(document).on('s123.wizardPageAdded',function(event,module) {_.$onload = true;_.toggleHeaderOptionsByModule(module.data('moduletypenum'),1);});$(document).on('removeModule.optionToggle',function(event,module) {_.$onload = true;_.toggleHeaderOptionsByModule(module.data('moduletypenum'),2);});if ( websiteMembersNUM == 3 || websiteMembersNUM == 4 ) {_.websiteAccessClientZone();}};_.getModuleLists = function( listType ) {if ( listType == 1 ) {return [2,10,15,37,96,208,123,142,52,204,Wizard.Ecommerce.moduleTypeNUM,...Wizard.Ecommerce.highLights];} else if ( listType == 2 ) {return [37,Wizard.Ecommerce.moduleTypeNUM,...Wizard.Ecommerce.highLights];}};_.isHeaderOptionModulesExists = function( moduleTypeNUM, option ) {var modulesList = _.getModuleLists( option );var moduleExists = false;$('.pages #sortable li').each( function( index, page ) {if ( $.inArray($(page).data('moduletypenum'),modulesList) != -1 && $(page).data('moduletypenum') != moduleTypeNUM ) {moduleExists = true;return false;}});return moduleExists;};_.toggleHeaderOptionsByModule = function( moduleTypeNUM, action ) {if ( $.inArray(moduleTypeNUM,_.getModuleLists(1)) != -1 ) {if ( action == 1 ) {if ( _.$onload && !$('#showHeaderClientZone').is(':checked') ) $('#showHeaderClientZone').prop('checked',true).trigger('change');$('#showHeaderClientZone').closest('.checkboxSingleSetting').removeClass('disableToggle');$('#showHeaderClientZone').closest('.disableToggleContainer').attr('data-original-title',null);} else if ( action == 2 && !_.isHeaderOptionModulesExists(moduleTypeNUM,1) ) {$('#showHeaderClientZone').closest('.checkboxSingleSetting').addClass('disableToggle');$('#showHeaderClientZone').closest('.disableToggleContainer').attr('data-original-title',translations.clientZoneToggleDisabledMsg);}}
if ( $.inArray(moduleTypeNUM,_.getModuleLists(2)) != -1 ) {if ( action == 1 ) {$('#showHeaderCart').closest('.checkboxSingleSetting').removeClass('disableToggle');$('#showHeaderCart').closest('.disableToggleContainer').attr('data-original-title',null);} else if ( action == 2 && !_.isHeaderOptionModulesExists(moduleTypeNUM,2) ) {$('#showHeaderCart').closest('.checkboxSingleSetting').addClass('disableToggle');$('#showHeaderCart').closest('.disableToggleContainer').attr('data-original-title',translations.ShoppingCartToggleDisabledMsg);}}};_.websiteAccessClientZone = function() {$('#showHeaderClientZone').closest('.checkboxSingleSetting').removeClass('disableToggle');$('#showHeaderClientZone').closest('.disableToggleContainer').attr('data-original-title',null);};return _;}();Wizard.homePageChangingImages = function() {var that = {namesapace: 'u-f-tmp'};that.init = function() {that.$container = $('#homepage_style_option_3 #changinImagesContiner');that.$originalInputs = $('.ch-images-val');that.maxAmount = that.$originalInputs.length;that.speedView.init({defaultValue: 4,$container: $('#home_slider_chaning_speed_view').closest('.s123-slider'),$slider: $('#home_slider_chaning_speed_slider'),$input: $('#home_slider_chaning_speed_view .slider-input-value')});addUploadFiles();that.$originalInputs.on('change.rebuildUploadFiles', function() {that.$fileUploadBoxes.remove();addUploadFiles();Wizard.homePageBgOptions.addLibraryAbility();});that.$container.sortable({revert: false,forceHelperSize: true,tolerance: 'pointer',handle: '.sortable-icon', // drag handler
appendTo: that.$container, // sortable container
containment: 'parent', // limit the dragging inside of the parent
scroll: false,update: function() {save();that.$fileUploadBoxes = that.$container.find('.fileUploadBox');that.fistInputID = that.$fileUploadBoxes.first().find('.file-upload-input-field').get(0).id;resetControllersVisiblilty();$('#changing_images_helper').trigger('change');resetController();}});$(document).trigger('wizard_h_p_c_i.loaded');};that.removeMedia = function() {that.$originalInputs.val('').trigger('change.rebuildUploadFiles');};that.getItemsAmont = function() {return that.$fileUploadBoxes.length;};that.getInputIndex = function( uploadFileInputId ) {var inputIndex = 1;$.each(that.$fileUploadBoxes.find('.file-upload-input-field'), function( index, input ) {if ( input.id === uploadFileInputId ) {inputIndex = index+1;return false;}});return inputIndex;};that.addMoreLibraryOptions = function() {that.$fileUploadBoxes.find('[data-type="patterns"], [data-type="separator"], .divider').remove();if ( that.getItemsAmont() > 1 ) return;var id = that.fistInputID;var $videoLibrary = that.$fileUploadBoxes.first().find('.dropdown-menu #'+id+'_video_library').parent();var html = '';html += '<li class="divider"></li>';html += '<li data-type="patterns">';html += '<a id="'+id+'_patterns_library" class="image-homepage-live" data-search="patterns" data-id="'+id+'"><i class="fal fa-image"></i> '+translations.homepageChangingImages.patterns+'</a>';html += '</li>';var $html = $(html);$html.insertBefore($videoLibrary);Wizard.homePageBgOptions.addLibraryAbility();};function addUploadFiles() {var html = '';$.each(that.$originalInputs, function( index, input ) {var $this = $(this);if ( index > 0 && $this.val().length === 0 ) return;html += generateFileUploadHtml(websiteID,{id: $this.get(0).id,value: $this.val(),settings: that.$container.find($this.data('settings-selector')).val()});});that.$container.append(html);refresh();}
function refresh() {UploadSingleFilesInitialize('');that.$fileUploadBoxes = that.$container.find('.fileUploadBox');that.fistInputID = that.$fileUploadBoxes.first().find('.file-upload-input-field').get(0).id;var addSortableIcon = that.$fileUploadBoxes.length > 1;$.each(that.$fileUploadBoxes, function( index, fileUploadBox ) {var $this = $(this);var $hiddenInput = $this.find('.file-upload-input-field');var id = $hiddenInput.get(0).id;var uploadFile = topWindow.uploadFiles[id];$this.find('.sortable-icon').remove();if ( addSortableIcon ) $this.append('<div class="sortable-icon"><i class="fal fa-solid fa-arrows" aria-hidden="true"></i></div>');uploadFile.input.off('change.w_h_p_c_i').on('change.w_h_p_c_i', function( event, flag ) {var image = $('#'+id).val();var tiny_image = getImageWRV1(100,image);if ( image.indexOf('unsplash.com') !== -1 ) {tiny_image = image.replace("&w=2500", "&w=100");}
if ( UploadFile_GetFileType(image) === 'video' ) {uploadFile.btns.imageFocusPoint.attr('data-original-title',translations.videoFocusPoint);} else {uploadFile.btns.imageFocusPoint.attr('data-original-title',translations.imageFocusPoint);}
UpdateImagePreview(id, { normal: image, tiny: tiny_image, patterns: uploadFile.settings.get().type == 'patterns' });UploadLibraryImageToUserWebsite(id);save();that.$fileUploadBoxes = that.$container.find('.fileUploadBox');Wizard.homePageBgOptions.showHideBackgroundOptions();resetControllersVisiblilty();if ( UploadLibraryImageToUserWebsite_currentRequest !== null ) {UploadLibraryImageToUserWebsite_currentRequest.abort();}
var thisIndex = that.$fileUploadBoxes.find('.file-upload-input-field').index(uploadFile.input);$(that.$originalInputs[thisIndex]).trigger('change.user_action',[flag]);});uploadFile.settings.obj.off('input.w_h_p_c_i').on('input.w_h_p_c_i', function() {save();});addRemoveAbility(uploadFile);});$('.tooltip.in').remove();resetController();InitializeToolTips();ColorboxInitial('#homepage_style_option_3 #changinImagesContiner [data-rel="colorbox"]');resetControllersVisiblilty();that.addMoreLibraryOptions();$(document).trigger('changing_images_refresh');}
function resetController() {if ( that.$controller ) {that.$controller.tooltip('destroy');that.$controller.remove();}
var $first = that.$fileUploadBoxes.first();that.$controller = $('<a id="changingImagesAdd" tabIndex="-1" style="font-size: 15px;" href="#"><i class="fal fa-solid fa-plus" aria-hidden="true"></i></a>');$first.find('.file-options-container').append(that.$controller);that.$controller.off('click.add_new').on('click.add_new', function() {if ( $(this).hasClass('disabled') ) return false;that.$container.append(generateFileUploadHtml(websiteID,{value:'',settings:JSON.stringify({})}));refresh();var $newfileUploadBox = that.$fileUploadBoxes.last();var id = $newfileUploadBox.find('.file-upload-input-field').get(0).id;var uploadFile = topWindow.uploadFiles[id];addRemoveAbility(uploadFile);Wizard.homePageBgOptions.showHideBackgroundOptions();Wizard.homePageBgOptions.addLibraryAbility();});var tooTipText = '';if ( that.getItemsAmont() < that.maxAmount ) {that.$controller.removeClass('disabled');tooTipText = translations.homepageChangingImages.enabled;} else {that.$controller.addClass('disabled');tooTipText = translations.homepageChangingImages.disabled.replace('{{maxAmount}}',that.maxAmount);}
that.$controller.attr('data-original-title',tooTipText);that.$controller.tooltip({delay: {show: 500,hide: 0},container: 'body',placement: 'auto'});}
function addRemoveAbility( uploadFile ) {uploadFile.btns.remove.on('click.changing_images', function( event ) {var id = uploadFile.input.get(0).id;uploadFile.settings.obj.remove();uploadFile.el.remove();save();refresh();Wizard.homePageBgOptions.showHideBackgroundOptions();delete topWindow.uploadFiles[id];});}
function save() {that.$originalInputs.val('');that.$fileUploadBoxes = that.$fileUploadBoxes.filter(function( index, uploadBox ) {return $(this).find('.file-upload-input-field').val().length > 0;});$.each(that.$fileUploadBoxes.find('.file-upload-input-field'), function( index, input ) {var id = $(this).get(0).id;var uploadFile = topWindow.uploadFiles[id];var $original = $(that.$originalInputs[index]);if ( $original.length === 0 ) return;$original.val(uploadFile.input.val());uploadFile.input.trigger('input_change');$('#'+$original.get(0).id+'_settings').val(uploadFile.settings.obj.val());});filterHomepageOptionsList();}
function generateFileUploadHtml( websiteID, obj ) {var html = '';var id = uniqid(that.namesapace);html += '<div class="input-file-upload" id="home_slider_image_'+id+'" data-website-id="'+websiteID+'" data-mb="30" data-file-kind="5" data-value="'+escapeHtml(obj.value)+'" data-library="imageHomepageLive & videoLive" data-min-height="300" data-min-width="300" data-min-library-width="1200" data-scroll-preview="#page-top" data-crop="disable" data-image-focus-point="true" data-image-focus-point-preview="true" data-group-edit-tools="true"></div>';html += '<textarea id="home_slider_image_'+id+'_settings" name="home_slider_image_'+id+'_settings" class="hidden">'+escapeHtml(obj.settings)+'</textarea>';return html;}
function resetControllersVisiblilty() {$.each(that.$fileUploadBoxes, function( index, fileUploadBox ) {var $this = $(this);var $hiddenInput = $this.find('.file-upload-input-field');if ( index === 0 ) {$this.find('#'+$hiddenInput.get(0).id+'_removeBtn').hide();} else {$this.find('#'+$hiddenInput.get(0).id+'_removeBtn').show();}});if ( that.getItemsAmont() == 1 ) {that.speedView.hide();that.speedView.reset();} else if ( that.getItemsAmont() < that.maxAmount ) {that.speedView.show();}}
that.speedView = function() {var sv = {};sv.init = function( settings ) {if ( !settings ) return;sv.defaultValue = settings.defaultValue;sv.$container = settings.$container;sv.$slider = settings.$slider;sv.$input = settings.$input;sv.ready = true;};sv.reset = function() {if ( !sv.ready ) return;sv.$slider.slider('value',sv.defaultValue);sv.$input.val(sv.defaultValue);};sv.show = function() {if ( !sv.ready ) return;sv.$container.show();};sv.hide = function() {if ( !sv.ready ) return;sv.$container.hide();};return sv;}();return that;}();Wizard.progressiveWebApp = new function() {var that = this;that.init = function( settings ) {if ( !settings ) return;that.$container = settings.$container;that.$videoExamples = that.$container.find('.pwa-example');that.$videoExamples.on('click', function() {ShowTourWelcomeVideoExplain($(this).data('title'),$(this).data('video'),'','pwa');});that.$container.find('#mobileAppBgColorType').on('change.show_upload_file', function() {switch ( $(this).val() ) {case '0':that.$container.find('#mobileAppSplashScreenLogo').closest('.pwa-logo-parent').fadeOut();break;case '1':that.$container.find('#mobileAppSplashScreenLogo').closest('.pwa-logo-parent').fadeIn();break;}})
.trigger('change.show_upload_file');if ( ProFeature_isLimit({'websiteID': websiteID,'packageNUM': OpenPremiumFeatures(packageNUM),'limitedToPackageNUM' : 3,'toolType': 'advancedMobileDesign','upgradeReason': 'advancedMobileDesign'}) ) {that.$container.find('.pwa-logo-parent').hide();$.each(['mobileAppBgColorType','mobileAppBgColor','mobileAppMsg'], function(index, id) {const currentVal = that.$container.find(`#${id}`).val();ProFeature_addLabel({'websiteID': websiteID,'packageNUM': OpenPremiumFeatures(packageNUM),'limitedToPackageNUM' : 3,'toolType': 'advancedMobileDesign','upgradeReason': 'advancedMobileDesign','clickable': true,'text': translations.pro,'$element': $(`#pwaContainer [for="${id}"]`),});that.$container.find(`#${id}`).off('change').on('change.ProFeature_limit', function() {ProFeature_limit({'websiteID': websiteID,'packageNUM': OpenPremiumFeatures(packageNUM),'limitedToPackageNUM' : 3,'toolType': 'advancedMobileDesign','upgradeReason': 'advancedMobileDesign','modalParent': true});$(this).val(currentVal);});});}};return that;}();Wizard.loader = function() {var wl = {};wl.init = function() {wl.$wizardLoader = $('#wizardLoader');wl.$websitePreviewIframe = $('#websitePreviewIframe');waitUntillAssetsLoaded();};wl.destroy = function() {wl.$wizardLoader.remove();};function waitUntillAssetsLoaded() {if ( wl.$websitePreviewIframe.length > 0 ) {wl.$websitePreviewIframe.on('load.remove_wizard_loader', function() {wl.$wizardLoader.addClass('hide-loader',function() {setTimeout(function() {wl.destroy();},500);$(document).trigger('assets_loaded.wizard_loader');});});} else {wl.$wizardLoader.addClass('hide-loader',function() {setTimeout(function() {wl.destroy();},500);$(document).trigger('assets_loaded.wizard_loader');});}}
return wl;}();Wizard.headerHandler = function() {var hh = {};hh.init = function() {hh.$container = $('#collapseHeaderOptions');hh.headerCustomText();}
hh.headerCustomText = function() {hh.headerCutomText = {'clientZone': {'title': '',},'search': {'placeHolder': '',}}
if ( hh.$container.find('#headerCustomTextJson').val() ) {var headerCustomTextJson = tryParseJSON(hh.$container.find('#headerCustomTextJson').val());hh.headerCutomText.clientZone = headerCustomTextJson['clientZone'];hh.headerCutomText.search = headerCustomTextJson['search'];}
hh.$headerClientZone = hh.generateHtml(function(){return headerCustomTextHtml('clientZone');},function(){save('clientZone');},function(){hide('clientZone');},translations.headerCustomTextTool.clientZone.modalTitle);hh.$headerSearchTool = hh.generateHtml(function(){return headerCustomTextHtml('search');},function(){save('search');},function(){hide('search');},translations.headerCustomTextTool.search.modalTitle);$('.headerCustomTextEditBtn').on('click', function (event) {show($(this).data('tool'));});function headerCustomTextHtml( tool ) {var html = '<div class="headerCustomSettings">';if ( tool == 'clientZone' ) {html += '<div class="row">';html += '<div class="col-xs-12">';html += '<div class="form-group">';html += '<label for="clientZoneInputText">'+escapeHtml(translations.headerCustomTextTool.clientZone.label)+'</label>';html += '<input type="text" class="form-control" id="clientZoneInputText" value="'+hh.headerCutomText.clientZone.title+'">';html += '</div>';html += '</div>';html += '</div>';}
if ( tool == 'search' ) {html += '<div class="row">';html += '<div class="col-xs-12">';html += '<div class="form-group">';html += '<label for="searchText">'+escapeHtml(translations.headerCustomTextTool.search.label)+'</label>';html += '<input type="text" class="form-control" id="searchText" value="'+hh.headerCutomText.search.placeHolder+'">';html += '</div>';html += '</div>';html += '</div>';}
html += '</div>';return html;}
function save( tool ) {if ( tool == 'clientZone' ) {hh.headerCutomText.clientZone.title = hh.$headerClientZone.find('#clientZoneInputText').val()}
if ( tool == 'search' ) {hh.headerCutomText.search.placeHolder = hh.$headerSearchTool.find('#searchText').val()}
hh.$container.find('#headerCustomTextJson').val(JSON.stringify(hh.headerCutomText));AutoSaveWizard(false,true);$("#wizardForm").one('ajaxSuccess', function( event ) {});hide(tool);}
function show( tool ) {if ( tool == 'clientZone' ) {hh.$headerClientZone.modal('show');}
if ( tool == 'search' ) {hh.$headerSearchTool.modal('show');}};function hide( tool ) {if ( tool == 'clientZone' ) {hh.$headerClientZone.modal('hide');}
if ( tool == 'search' ) {hh.$headerSearchTool.modal('hide');}};}
hh.generateHtml = function( content, saveMethod, closeMethod , title ) {var heighestHeightNUM = $(window).outerHeight(true) < 900 ? $(window).outerHeight(true) - 170 : 530;var html = '<div id="s123CustomHeader" class="modal s123-modal fade bs-example-modal-lg" tabindex="-1" role="dialog">';html += '<div class="modal-dialog" role="document">';html += '<div class="modal-content">';html += '<div class="modal-header">';html += '<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>';html += '<h4 class="modal-title">' + escapeHtml(title) + '</h4>';html += '</div>';html += '<div class="modal-body" style="height:'+heighestHeightNUM+'px;">';html += content();html += '</div>';html += '<div class="SubmitButtonsArea form-actions">';html += '<button id="saveHeaderModal" type="submit" class="btn btn-success">'+escapeHtml(translations.Save)+'</button>';html += '<a id="closeHeaderModal" class="btn btn-link">'+escapeHtml(translations.Cancel)+'</a>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';var $html = $(html);$html.find('#saveHeaderModal').on('click',saveMethod);$html.find('#closeHeaderModal').on('click',closeMethod);return $html;}
return hh;}();Wizard.footerHandler = function() {var fh = {};fh.init = function() {fh.defaultValue = '1';fh.$container = $('#collapseFooterLayout');fh.$el = fh.$container.find('#footer_layout');fh.$relatedSettings = fh.$container.find('[data-is-footer-setting="true"]');fh.isDisabled = false;$('#footer_layout').on('change.footer_handler', function() {disableEnableFooter();});disableEnableFooter();fh.footerCustomText();};fh.footerCustomText = function() {fh.footerCustomText = {'mailingList': {'placeHolder': '','button': '',},'cookieConsent': {'text': '','button': '','requireAction': false,'isCountriesActive': false,'countries': [],'position': 'bottom',}}
if ( fh.$container.find('#footerCustomTextJson').val() ) {var footerCustomTextJson = tryParseJSON(fh.$container.find('#footerCustomTextJson').val());fh.footerCustomText.mailingList = footerCustomTextJson['mailingList'];fh.footerCustomText.cookieConsent = footerCustomTextJson['cookieConsent'];fh.footerCustomText.terms = footerCustomTextJson['terms'];fh.footerCustomText.privacy = footerCustomTextJson['privacy'];fh.footerCustomText.accessability = footerCustomTextJson['accessability'];}
fh.$footerMailingList = fh.generateHtml(function(){return footerCustomTextHtml('mailingList');},function(){save('mailingList');},function(){hide('mailingList');},translations.footerCustomTextTool.mailingList.modalTitle);fh.$footercookieConsent = fh.generateHtml(function(){return footerCustomTextHtml('cookieConsent');},function(){save('cookieConsent');},function(){hide('cookieConsent');},translations.footerCustomTextTool.cookieConsent.modalTitle);fh.$footercookieConsent.on('shown.bs.modal', function () {$.ajax({url: '/versions/2/wizard/include/getCountriesList.php',type: 'POST',data: {w: $('#id').val(),},success: function( data ) {data = tryParseJSON(data);if ( data.status == 'success' ) {let $countries = $('#cookieConsentCountries');$.each(data.countries, function( code, country ) {let $option = $('<option></option>').attr('value', code).text(country.name);if ( fh.footerCustomText.cookieConsent.countries ) {if ( fh.footerCustomText.cookieConsent.countries.includes(code) ) {$option.attr('selected','selected');}}
$countries.append($option);});$countries.multiselect({numberDisplayed: 0,enableFiltering: true,selected: escapeHtml(translations.footerCustomTextTool.cookieConsent.selected),enableCaseInsensitiveFiltering: true,nonSelectedText: escapeHtml(translations.footerCustomTextTool.cookieConsent.nonSelectedText),allSelectedText: escapeHtml(translations.footerCustomTextTool.cookieConsent.allSelectedText),filterPlaceholder: escapeHtml(translations.footerCustomTextTool.cookieConsent.filterPlaceholder),maxHeight: 200,templates: uiMultipleSelectOBJ.getTemplates(),onDropdownShow: function( event ) {if ( $('html[data-device="mobile"]').length > 0 ) {$(event.target).find('.dropdown-backdrop').remove();}},buttonText: function( options, select ) {return  `${options.length} ${escapeHtml(translations.footerCustomTextTool.cookieConsent.selected)}`;}});$('.cookie-consent-loading').hide();$countries.closest('.form-group').show();}}});UiRichSelect_Constructor();ProFeature_addLabel({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '5','toolType': 'cookieConsentFeatures','$element': fh.$footercookieConsent.find('#cookieConsentBox .widget-header'),'clickable': true,'upgradeReason': 'cookieConsentFeatures'});ProFeature_addLabel({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '5','toolType': 'cookieConsentFeatures','$element': fh.$footercookieConsent.find('#cookieConsentPosition').closest('.form-group').find('label'),'clickable': true,'upgradeReason': 'cookieConsentFeatures'});if ( ProFeature_isLimit({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': 'cookieConsentFeatures','openPremiumFeatures': openPremiumFeatures})) {let $cookieConsentBox = fh.$footercookieConsent.find('#cookieConsentBox');$cookieConsentBox.find('#isCookieCountriesActive').off('change').on('change', function() {$(this).prop('checked',false);ProFeature_limit({'websiteID': websiteID,'packageNUM': packageNUM,'limitedToPackageNUM': '1','toolType': 'cookieConsentFeatures','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'cookieConsentFeatures'});});let $cookieConsentPosition = fh.$footercookieConsent.find('#cookieConsentPosition');$cookieConsentPosition.val('bottom');$cookieConsentPosition.find('option[value="center"],option[value="top"]').attr('disabled','disabled');$cookieConsentPosition.off('click').on('click', function() {ProFeature_limit({'websiteID': websiteID,'packageNUM': packageNUM,'toolType': 'cookieConsentFeatures','limitedToPackageNUM': '1','openPremiumFeatures': openPremiumFeatures,'modalParent': true,'featureID': 'cookieConsentFeatures'});});} else {$('#isCookieCountriesActive').off('change').on('change', function() {if ($(this).is(':checked')) {$('#cookieConsentBox').find('.widget-body').slideDown(400);} else {$('#cookieConsentBox').find('.widget-body').slideUp(400);}});}
InitializeToolTips();});$('.footerCustomTextEditBtn').on('click', function (event) {show($(this).data('tool'));});function footerCustomTextHtml( tool ) {var html = '<div class="footerCustomSettings">';if ( tool == 'mailingList' ) {html += '<div class="row">';html += '<div class="col-xs-12">';html += '<div class="form-group">';html += '<label for="mailingInputText">'+escapeHtml(translations.footerCustomTextTool.mailingList.placeHolder)+'</label>';html += '<input type="text" class="form-control" id="mailingInputText" value="'+fh.footerCustomText.mailingList.placeHolder+'">';html += '</div>';html += '<div class="form-group">';html += '<label for="mailingButtonText">'+escapeHtml(translations.footerCustomTextTool.mailingList.button)+'</label>'
html += '<input type="text" class="form-control" id="mailingButtonText" value="'+fh.footerCustomText.mailingList.button+'">';html += '</div>';html += '</div>';html += '</div>';}
if ( tool == 'cookieConsent' ) {if ( !fh.footerCustomText.cookieConsent.hasOwnProperty('requireAction') ) {fh.footerCustomText.cookieConsent.requireAction = false;}
if ( !fh.footerCustomText.cookieConsent.hasOwnProperty('isCountriesActive') ) {fh.footerCustomText.cookieConsent.isCountriesActive = false;}
if ( !fh.footerCustomText.cookieConsent.hasOwnProperty('countries') ) {fh.footerCustomText.cookieConsent.countries = [];}
if ( !fh.footerCustomText.cookieConsent.hasOwnProperty('position') ) {fh.footerCustomText.cookieConsent.position = '';}
if ( !fh.footerCustomText.cookieConsent.hasOwnProperty('disallowed') ) {fh.footerCustomText.cookieConsent.disallowed = false;}
html += '<div class="row">';html += '<div class="col-xs-12">';html += '<div class="widget-box">';html += '<div class="widget-header">';html += '<h5 class="widget-title">'+escapeHtml(translations.footerCustomTextTool.cookieConsent.customLabels)+'</h5>';html += '</div>';html += '<div class="widget-body">';html += '<div class="widget-main">';html += '<div class="form-group">';html += '<label for="cookieConsentText">'+escapeHtml(translations.footerCustomTextTool.cookieConsent.text)+'</label>';html += '<input type="text" class="form-control" id="cookieConsentText" value="'+fh.footerCustomText.cookieConsent.text+'">';html += '</div>';html += '<div class="form-group">';html += '<label for="cookieConsentButtonText">'+escapeHtml(translations.footerCustomTextTool.cookieConsent.button)+'</label>'
html += '<input type="text" class="form-control" id="cookieConsentButtonText" value="'+fh.footerCustomText.cookieConsent.button+'">';html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '<div class="row cookie-consent-countries">';html += '<div class="col-xs-12">';html += '<div id="cookieConsentBox" class="in-box-widget">';html += '<div class="widget-box">';html += '<div class="widget-header">';html += '<h5 class="widget-title">'+escapeHtml(translations.footerCustomTextTool.cookieConsent.countrySpecificTitle)+'&nbsp;<a href="#" onclick="return false;" data-rel="tooltip" data-html="true" data-trigger="hover" tabindex="-1" title="" data-original-title="'+escapeHtml(translations.footerCustomTextTool.cookieConsent.countrySpecificTooltip)+'"><i class="fal fa-solid fa-question-circle"></i></a></h5>';html += '&nbsp;<label class="cookie-consent-countries-switch"><input type="checkbox" id="isCookieCountriesActive" class="ace ace-switch"'+(fh.footerCustomText.cookieConsent.isCountriesActive ? ' checked="true"' : '')+'><span class="lbl middle"></span></label>';html += '</div>';html += '<div class="widget-body" style="display: '+(fh.footerCustomText.cookieConsent.isCountriesActive ? 'block' : 'none')+';">';html += '<div class="widget-main">';html += '<div class="cookie-consent-loading text-center" style="width: 100%;"><i class="ace-icon fal fa-spinner fa-solid fa-spin blue fa-2x"></i></div>';html += '<div class="form-group uiMultipleSelectContainer" style="display: none;">';html += '<label for="cookieConsentCountries">'+escapeHtml(translations.footerCustomTextTool.cookieConsent.chooseCountries)+'</label><br/>';html += '<select id="cookieConsentCountries" name="countries[]" class="uiMultipleSelect" multiple="multiple"></select>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '<div class="row">';html += '<div class="col-xs-12">';html += '<div class="widget-box">';html += '<div class="widget-header">';html += '<h5 class="widget-title">'+escapeHtml(translations.footerCustomTextTool.cookieConsent.general)+'</h5>';html += '</div>';html += '<div class="widget-body">';html += '<div class="widget-main">';html += '<div class="form-group">';html += '<label for="cookieConsentPosition">'+escapeHtml(translations.footerCustomTextTool.cookieConsent.position)+'&nbsp;<a href="#" onclick="return false;" data-rel="tooltip" data-html="true" data-trigger="hover" tabindex="-1" title="" data-original-title="'+escapeHtml(translations.footerCustomTextTool.cookieConsent.positionTooltip)+'"><i class="fal fa-solid fa-question-circle"></i></a></label><br/>';html += '<select id="cookieConsentPosition" class="form-control uiRichSelect">';html += '<option value="bottom">'+escapeHtml(translations.footerCustomTextTool.cookieConsent.bottom)+'</option>';html += '<option value="top"'+(fh.footerCustomText.cookieConsent.position == 'top' ? ' selected' : '' )+'>'+escapeHtml(translations.footerCustomTextTool.cookieConsent.top)+'</option>';html += '<option value="center"'+(fh.footerCustomText.cookieConsent.position == 'center' ? ' selected' : '' )+'>'+escapeHtml(translations.footerCustomTextTool.cookieConsent.center)+'</option>';html += '</select>';html += '</div>';html += '<div class="form-group">';html += '<label for="requireActionCookieConsent" class="inline">';html += '<input type="checkbox" id="requireActionCookieConsent" class="ace ace-switch" '+(fh.footerCustomText.cookieConsent.requireAction ? ' checked' : '')+'>';html += '<span class="lbl middle"></span>'+escapeHtml(translations.footerCustomTextTool.cookieConsent.requireAction)+'&nbsp;<a href="#" onclick="return false;" data-rel="tooltip" data-html="true" data-trigger="hover" tabindex="-1" title="" data-original-title="'+escapeHtml(translations.footerCustomTextTool.cookieConsent.requireActionTooltip)+'"><i class="fal fa-solid fa-question-circle"></i></a></label>';html += '</div>';html += '<div class="form-group">';html += '<label for="isCookieDisallowedActive" class="inline">';html += '<input type="checkbox" id="isCookieDisallowedActive" class="ace ace-switch" '+(fh.footerCustomText.cookieConsent.disallowed ? ' checked' : '')+'>';html += '<span class="lbl middle"></span>'+escapeHtml(translations.footerCustomTextTool.cookieConsent.disallowed)+'&nbsp;<a href="#" onclick="return false;" data-rel="tooltip" data-html="true" data-trigger="hover" tabindex="-1" title="" data-original-title="'+escapeHtml(translations.footerCustomTextTool.cookieConsent.disallowedTooltip)+'"><i class="fal fa-solid fa-question-circle"></i></a></label>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';}
html += '</div>';return html;}
function save( tool ) {if ( tool == 'mailingList' ) {fh.footerCustomText.mailingList.placeHolder = fh.$footerMailingList.find('#mailingInputText').val();fh.footerCustomText.mailingList.button = fh.$footerMailingList.find('#mailingButtonText').val();}
if ( tool == 'cookieConsent' ) {fh.footerCustomText.cookieConsent.text = fh.$footercookieConsent.find('#cookieConsentText').val();fh.footerCustomText.cookieConsent.button = fh.$footercookieConsent.find('#cookieConsentButtonText').val();fh.footerCustomText.cookieConsent.requireAction = fh.$footercookieConsent.find('#requireActionCookieConsent').is(':checked');fh.footerCustomText.cookieConsent.isCountriesActive = fh.$footercookieConsent.find('#isCookieCountriesActive').is(':checked');fh.footerCustomText.cookieConsent.countries = fh.$footercookieConsent.find('#cookieConsentCountries').val();fh.footerCustomText.cookieConsent.position = fh.$footercookieConsent.find('#cookieConsentPosition').val();fh.footerCustomText.cookieConsent.disallowed = fh.$footercookieConsent.find('#isCookieDisallowedActive').is(':checked');}
fh.$container.find('#footerCustomTextJson').val(JSON.stringify(fh.footerCustomText));if ( tool ==  'cookieConsent' ) {window.reloadWizardAfterSave = true;window.reloadWizardAfterSaveMessage = translations.wizardCookieReload;}
AutoSaveWizard(false,true);$("#wizardForm").one('ajaxSuccess', function( event ) {UpdatePreviewAreaByAjax('footer.global_footer',false,false,'');});hide(tool);}
fh.addNewCustomText = function( toolName, customText ) {fh.footerCustomText[toolName] = customText;fh.$container.find('#footerCustomTextJson').val(JSON.stringify(fh.footerCustomText));AutoSaveWizard(false,true);$("#wizardForm").one('ajaxSuccess', function( event ) {UpdatePreviewAreaByAjax('footer.global_footer',false,false,'');});}
function show( tool ) {if ( tool == 'mailingList' ) {fh.$footerMailingList.modal('show');}
if ( tool == 'cookieConsent' ) {fh.$footercookieConsent.modal('show');}};function hide( tool ) {if ( tool == 'mailingList' ) {fh.$footerMailingList.modal('hide');}
if ( tool == 'cookieConsent' ) {fh.$footercookieConsent.modal('hide');}};}
fh.generateHtml = function( content, saveMethod, closeMethod , title ) {var heighestHeightNUM = $(window).outerHeight(true) < 900 ? $(window).outerHeight(true) - 100 : 650;var html = '<div id="s123CustomFooter" class="modal s123-modal fade bs-example-modal-lg" tabindex="-1" role="dialog">';html += '<div class="modal-dialog" role="document">';html += '<div class="modal-content">';html += '<div class="modal-header">';html += '<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>';html += '<h4 class="modal-title">' + escapeHtml(title) + '</h4>';html += '</div>';html += '<div class="modal-body" style="height:'+heighestHeightNUM+'px;">';html += content();html += '</div>';html += '<div class="SubmitButtonsArea form-actions">';html += '<button id="saveFooterModal" type="submit" class="btn btn-success">'+escapeHtml(translations.Save)+'</button>';html += '<a id="closeFooterModal" class="btn btn-link">'+escapeHtml(translations.Cancel)+'</a>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';var $html = $(html);$html.find('#saveFooterModal').on('click',saveMethod);$html.find('#closeFooterModal').on('click',closeMethod);return $html;}
fh.disable = function() {fh.$relatedSettings.addClass('disableModule');fh.$relatedSettings.append(getCoverTemplate());fh.isDisabled = true;InitializeToolTips();previewAreaUpdateHandler();};fh.enable = function() {fh.$relatedSettings.removeClass('disableModule');fh.$relatedSettings.find('.f-h-cover').remove();fh.isDisabled = false;previewAreaUpdateHandler();};fh.reset = function() {fh.$el.val(fh.defaultValue).trigger('change');};function disableEnableFooter() {if ( fh.$el.val() == '5' ) {fh.disable();} else {fh.enable();}}
function previewAreaUpdateHandler() {if ( !Wizard.Preview.ready ) return;$("#wizardForm").one('ajaxSuccess.footer_handler', function() {if ( Wizard.Preview.Scale.$iframe.contents().find('footer.global_footer').length === 0 ) {Wizard.Preview.Scale.$iframe.contents().find('#s123PjaxMainContainer').append('<footer class="global_footer"></footer>');}});}
function getCoverTemplate() {return '<div class="f-h-cover" data-rel="tooltip" title="' + translations.wizardFooterHandler.disabledTootip + '" style="position: absolute; top: 0; bottom: -3px; left: 0; right: 0; opacity: 1;"></div>';}
return fh;}();Wizard.tabEffectHandler = function() {var teh = {noAnimationTabs: ['homepageTab','designTab','settingsTab'],noBackBtnTabs: ['designTab','settingsTab'],noHeaderTabs: ['homepageTab']};teh.init = function() {teh.$tabs = $('#wizardBox .tab-pane');teh.$wizardSideTabs = $('#wizardBox .wizardSideTabs');if ( $('html').data('device') === 'mobile' ) {teh.$tabs = teh.$tabs.filter('#designTab');}
$.each(teh.$tabs, function( index, tab ) {var $this = $(this);changeTabStructure($this);addAnimation($this);addCustomBehaving($this);});teh.designTabHandler.init({$tab: teh.$tabs.filter('#designTab')});teh.settingsBoxHandler.init();$(document).one('wizard_h_p_b_o.loaded', function() {teh.homepageTabHandler.init({$tab: teh.$tabs.filter('#homepageTab')});});$(document).on('wizard_tabs_opened wizard_tabs_closed', function( event ) {teh.resetAnimationStatus('');});};teh.resetAnimationStatus = function( tabID ) {if ( !teh.AnimationManager[tabID] ) {$.each(teh.AnimationManager, function( index, slideAnimation ) {slideAnimation.hide();});} else {teh.AnimationManager[tabID].hide();}
SettingsBox.hide();};function changeTabStructure( $tab ) {var $tabContent = $tab.find('.panel-collapse.collapse');var $tabLinks = $tab.find('.panel-heading');var $header = $(generateHeaderHtml($tab.get(0).id));var animationType = 'slide';if ( teh.noAnimationTabs.indexOf($tab.get(0).id) != -1 ) {animationType = 'showHide';}
$tab.find('.wizard-accordion').prepend($header);$tab.addClass('t-e-h');$tab.attr('data-t-e-h-animation',animationType);$tabContent
.removeClass('collapse')
.addClass('t-h-e-tab');$tabLinks.addClass('t-h-e-link');$tabLinks.find('a').attr('data-toggle','');}
function addAnimation( $tab ) {saveAnimationInstance($tab.get(0).id,new Animation({id: $tab.get(0).id,$tab: $tab,$tabLinks: $tab.find('.t-h-e-link'),$tabContent: $tab.find('.t-h-e-tab'),$header: $tab.find('.t-h-e-header'),noBackBtn: teh.noBackBtnTabs.indexOf($tab.get(0).id) != -1}));}
function saveAnimationInstance( id, slideAnimation ) {if ( !teh.AnimationManager ) {teh.AnimationManager = {};}
teh.AnimationManager[id] = slideAnimation;}
teh.getAnimationInstanceByID = function( id ) {return teh.AnimationManager[id];}
function Animation( settings ) {var sa = {};sa.id = settings.id;sa.$tab = settings.$tab;sa.$tabLinks = settings.$tabLinks;sa.$tabContent = settings.$tabContent;sa.$header = settings.$header;sa.currentContent = null;sa.noBackBtn = settings.noBackBtn;settings.$tab.attr('data-open-content','false');settings.$tabLinks.find('a').on('click', function( event ) {event.preventDefault();sa.show($(this));});settings.$header.find('.back-btn').on('click', function( event ) {sa.hide();});sa.show = function( $link ) {sa.currentContentSelector = $link.attr('href');sa.$tab.attr('data-open-content','true');sa.$tabContent.attr('data-visible','false');sa.$tabContent.filter(sa.currentContentSelector).attr('data-visible','true');if ( $('html').data('device') === 'mobile' ) {sa.$tabContent.filter(sa.currentContentSelector).closest('.panel').addClass('active-option');sa.mobileHeader.set($link.text());sa.$header.hide();} else {sa.$header.attr('data-visible','true');setBackButtonTitle($link.text());if ( sa.id == 'designTab' ) {if ( $link.data('back-btn') ) {$('#'+sa.id).find('.t-h-e-header-back-btn').show();$('#'+sa.id+' #accordion_design').addClass('back-btn-h');} else {$('#'+sa.id+' .t-h-e-header-back-btn').hide();$('#'+sa.id+' #accordion_design').removeClass('back-btn-h');}}}
$(document).trigger('animation_manager.show',[sa.currentContentSelector]);};sa.hide = function() {sa.$tab.attr('data-open-content','false');sa.$tabContent.attr('data-visible','false');if ( $('html').data('device') === 'mobile' ) {sa.$tabContent.closest('.panel').removeClass('active-option');sa.mobileHeader.destroy();sa.$header.show();} else {sa.$header.attr('data-visible','false');}
$(document).trigger('animation_manager.hide',[sa.currentContentSelector]);sa.currentContentSelector = null;};sa.mobileHeader = function() {var self = {ready: false};self.set = function( text ) {self.$originalHeader = $('.top-nav');self.$header = self.$originalHeader.clone();self.$header.find('.current-page .top-nav-link').text(text);self.$header.insertBefore(self.$originalHeader);self.$originalHeader.hide();self.$header.on('click.customizeHandler', function( event ) {event.preventDefault();sa.hide();});self.ready = true;};self.destroy = function() {if ( !self.ready ) return;self.$header.remove();self.$originalHeader.show();self.ready = false;};return self;}();function setBackButtonTitle( text ) {if ( sa.noBackBtn ) {sa.$header.find('.t-h-e-tab-title .text-container').text(text);} else {sa.$header.find('.t-e-h-back-title').text(text);}}
return sa;}
function addCustomBehaving( $tab ) {var $tabLinks = $tab.find('.t-h-e-link a');var $tabContent = $tab.find('.t-h-e-tab');var $header = $tab.find('.t-h-e-header');$.each($tabLinks, function( index, link ) {if ( getStaticTabsIDS().indexOf($(link).attr('href')) != -1 ) {$(link).parent().parent().hide();$(link).off('click').on('click', function() {$header.find('.back-btn').trigger('click');});}});$.each($tabContent, function( index, tabContent ) {if ( getStaticTabsIDS().indexOf('#'+$(tabContent).attr('id')) != -1 ) {$(tabContent).attr('data-static','true');}});}
function getStaticTabsIDS() {return [];}
function generateHeaderHtml( tabID ) {var html = '';if ( teh.noHeaderTabs.indexOf(tabID) != -1 ) return html;html += '<div class="t-h-e-header">';if ( teh.noBackBtnTabs.indexOf(tabID) != -1 ) {html += '<div class="t-h-e-tab-title">';html += '<span class="text-container">title</span>';html += '</div>';} else {html += '<a class="back-btn top-nav-link" data-speech="on" data-speech-text="Back">';html += '<span class="back-to"></span>';html += '<span class="t-e-h-back-title">title</span>';html += '</a>';}
html += '</div>';return html;}
teh.homepageTabHandler = function() {var hth = {};hth.init = function( settings ) {hth.innerTabsHanler = new innerTabsHanler({$container: $('#backgroundOptionsTab').find('.i-t-handler')});};function innerTabsHanler( settings ) {var that = {};that.$container = settings.$container;that.$linkContainer = that.$container.find('.i-t-header');that.$tabsContent = that.$container.find('.tabContent');that.$linkContainer.find('[data-tab]').on('click.inner_tabs_hanler', function() {that.$tabsContent.siblings().removeClass('active');that.$tabsContent.filter('#'+$(this).data('tab')).addClass('active');$(this).siblings().removeClass('active');$(this).addClass('active');$(document).trigger('homepageTabHandler.innerTabsHanler.open',[$(this).data('tab')]);});that.$linkContainer.find('[data-tab]').first().trigger('click');return that;}
return hth;}();teh.settingsBoxHandler = function() {var sbh = {};sbh.init = function() {sbh.$allSettingsBoxes = SettingsBox.$box;sbh.$allSettingsBoxesParents = {};sbh.$sbTmpParent = $('#wizardBox .tab-content');$.each(sbh.$allSettingsBoxes, function( index, sb ) {sbh.$allSettingsBoxesParents[$(this).get(0).id] = $(this).parent();});sbh.$allSettingsBoxes.on('settings_box_handler.show.t_e_h', function( event, $btn, $settingBox ) {var scrollTop = $settingBox.scrollParent().scrollTop();var wizardTopToolbarHeight = $('html').data('device') === 'mobile' ? $('#wizardBox .top-nav').outerHeight() : $('#wizardTopToolbar').height();var top_offset = 10;sbh.$sbTmpParent.append($settingBox);if ( !$settingBox.hasClass('s-b-full-size') ) {$settingBox.css({top: $btn.offset().top - sbh.$sbTmpParent.offset().top + $btn.parent().outerHeight() + scrollTop,left: $btn.closest('.form-group').offset().left - sbh.$sbTmpParent.offset().left,width: $btn.closest('.form-group').width()});if ( !isElementVisiblityInViewPort($settingBox) ) {$settingBox.css({top: $settingBox.offset().top - $settingBox.outerHeight() - (sbh.$sbTmpParent.offset().top + $btn.parent().outerHeight()) + scrollTop + wizardTopToolbarHeight});if ( !isElementVisiblityInViewPort($settingBox,wizardTopToolbarHeight) ) {if ( $('html').data('ios-device') && platform.name.toLowerCase() == 'safari' ) {top_offset = $('#wizardBox .top-nav').outerHeight();}
$settingBox.css({ top: scrollTop + top_offset });}}} else {$settingBox.css({top: top_offset});}});sbh.$allSettingsBoxes.on('settings_box_handler.hide.t_e_h', function( event, $settingBox ) {if ( $settingBox.length === 0 ) return;sbh.$allSettingsBoxesParents[$settingBox.get(0).id].append($settingBox);});};return sbh;}();return teh;}();Wizard.inputTextEditButtonsHandler = function() {var that = {};that.init = function() {that.elements = $('.input-text-edit-buttons:not(.i-t-e-b-static)');if ( that.elements.length === 0 ) return;that.events.off();that.elements.each(function() {var $element = $(this);var $input = $($element.data('i-t-e-b-input'));if ( $input.length === 0 ) return;$input.closest('.form-group').addClass('i-t-e-b-handler');that.events.init($input);});};that.events = {init : function( $input ) {$input.on('focus.input_text_edit_buttons', function ( event ) {var $handler = $input.closest('.i-t-e-b-handler');$handler.addClass('i-t-e-b-focused');$(document).on('mousedown.input_text_edit_buttons', function ( event ) {var $target = $(event.target);if ( $target.closest($handler).length === 0 && $target.closest('.buttonSettingBox').length === 0 ) {$input.closest('.i-t-e-b-handler').removeClass('i-t-e-b-focused');$(document).off('mousedown.input_text_edit_buttons');}});});},off : function( element ) {that.elements.off('.input_text_edit_buttons');}};return that;}();Wizard.render = function() {var _ = {fontsToUpdate: {}};_.init = function( settings ) {var allSettings = {};if ( typeof settings == 'string' ) {allSettings[settings] = '';} else {allSettings = settings;}
$.each(allSettings, function( key, value ) {switch( key ) {case 'siteLogoStyle':case 'siteLogoImageStyle':Wizard.websiteLogoMakerTool.resetLogoStyle();Wizard.websiteLogoMakerTool.printStyles(true,true,'');Wizard.websiteLogoMakerTool.refreshWizardPreview();break;case 'all_fonts':case 'font_menu':case 'font_modules_header':case 'global_font':case 'font_slogan':case 'font_slogan_2':case 'font_second_slogan':case 'font_logo':window.fontSelect[key].refresh();if ( websiteFonts[key] ) {var $italicInput = null;switch( key ) {case 'font_slogan':$italicInput = $('#home_text_italic');if ( Wizard.tabEffectHandler.designTabHandler.themes.singleFontThemes ) {Wizard.tabEffectHandler.designTabHandler.themes.singleFontThemes.applyTheme({name: $('#'+key).val()});}
break;case 'font_slogan_2':$italicInput = $('#home_text_2_italic');if ( Wizard.tabEffectHandler.designTabHandler.themes.singleFontThemes ) {Wizard.tabEffectHandler.designTabHandler.themes.singleFontThemes.applyTheme({name: $('#'+key).val()});}
break;case 'font_second_slogan':$italicInput = $('#slogan_text_italic');if ( Wizard.tabEffectHandler.designTabHandler.themes.singleFontThemes ) {Wizard.tabEffectHandler.designTabHandler.themes.singleFontThemes.applyTheme({name: $('#'+key).val()});}
break;}
if ( $italicInput && $italicInput.length > 0 ) {if ( !websiteFonts[key].isItalicSupported ) {$italicInput.val('');ChangePreviewLive($italicInput.get(0));}}}
_.fontsToUpdate[key] = $('#'+key).val();if ( Wizard.Preview.ready ) {clearTimeout(_.fontsReloadDelay);_.fontsReloadDelay = setTimeout(function() {$("#wizardForm").one( 'ajaxSuccess.fontsReloadDelay', function( event ) {$.ajax({type: 'POST',url: '/versions/2/css/cssFontsOnly.php',data: {w: $('#id').val(),},success: function( fonts ) {var id = uniqid('tmpFont-');Wizard.Preview.$('head').append(`<style id="${id}" class="website-fonts-helper">${fonts}</style>`);Wizard.Preview.$(`head .website-fonts-helper:not(#${id})`).remove();$.each(_.fontsToUpdate, function( cssVarName, value ) {Wizard.Preview.$document.trigger('site123.fonts.change',[cssVarName,value]);});_.fontsToUpdate = {};}});});},0);}
break;case 'global_main_color':case 'menu_color':case 'menu_text_color':case 'menu_text_hover_color':case 'menu_thin_border':case 'module_separate_border_color':case 'modules_color':case 'modules_color_text':case 'modules_color_box':case 'modules_color_text_box':case 'modules_color_second':case 'modules_color_text_second':case 'modules_color_second_box':case 'modules_color_text_second_box':case 'inside_modules_color':case 'inside_modules_color_text':case 'inside_modules_color_box':case 'inside_modules_color_text_box':case 'footer_back':case 'footer_text':case 'global_main_color_btn_text_color':case 'homepageShapeDividerList_Color1':case 'home_text_color':case 'home_third_background_color':case 'home_background_color':case 'homepageGradientsColors':case 'modules_color_section_main':case 'modules_color_section_btn_text':case 'modules_color_second_section_main':case 'modules_color_second_section_btn_text':case 'inside_modules_color_section_box_main':case 'inside_modules_color_section_btn_text':case 'global_main_color_copy':var $input = $('#'+key);$input.spectrum('set',$input.val());switch( key ) {case 'global_main_color_copy':case 'global_main_color':document.documentElement.style.setProperty('--global_main_color',$input.val());if ( abTestTXT != 'siteEditor_b' ) {SetHomepageGoal_SoundPlayerSettings();}
actionButtonStlyeHandler();break;case 'home_text_color':document.documentElement.style.setProperty('--home_text_color',$input.val());break;case 'menu_color':document.documentElement.style.setProperty('--menu_color',$input.val());actionButtonStlyeHandler();case 'menu_text_color':document.documentElement.style.setProperty('--menu_text_color',$input.val());break;case 'home_third_background_color':if ( $('#homepage_layout_kind').val() != '2' && $('#homepage_layout_kind').val() != '3' ) return;var backColor = $input.val();var bestTextColorFit = invertColor(backColor,true);$('#home_text_color').spectrum('set',bestTextColorFit);break;case 'footer_back':case 'menu_text_hover_color':if ( Wizard.Preview.ready ) {Wizard.Preview.window.document.documentElement.style.setProperty('--footer_text_hover',$('#global_main_color').val());Wizard.Preview.window.document.documentElement.style.setProperty('--footer_links_color',$('#global_main_color').val());if ( $('#footer_back').val() == $('#global_main_color').val() ) {Wizard.Preview.window.document.documentElement.style.setProperty('--footer_text_hover',$('#menu_text_hover_color').val());Wizard.Preview.window.document.documentElement.style.setProperty('--footer_links_color',$('#menu_text_hover_color').val());}}
break;}
if ( key == 'home_background_color' || key == 'homepageGradientsColors' ) {filterHomepageOptionsList();}
if ( key == 'homepageGradientsColors' ) {if ( $input.val().length > 0 ) {$('.g-p[data-id="'+key+'"] .sp-preview-inner').css('background',$input.val());} else {$('.g-p[data-id="'+key+'"] .sp-preview-inner').removeAttr('style');}}
if ( topWindow.Wizard.Preview.ready ) {topWindow.Wizard.Preview.$document.trigger('site123.colorPicker.change',[key,$input.val()]);if ( key == 'global_main_color' ) {topWindow.Wizard.Preview.$document.trigger('site123.colorPicker.change',['global_main_color_rgba_02',hexToRGB($input.val(),0.2)]);topWindow.Wizard.Preview.$document.trigger('site123.colorPicker.change',['global_main_color_rgba_07',hexToRGB($input.val(),0.7)]);}
if ( key == 'home_text_color' ) {topWindow.Wizard.Preview.$document.trigger('site123.colorPicker.change',['home_text_color_rgba_01',hexToRGB($input.val(),0.1)]);}
if ( key == 'menu_text_color' ) {topWindow.Wizard.Preview.$document.trigger('site123.colorPicker.change',['menu_text_color_rgba_02',hexToRGB($input.val(),0.2)]);}}
break;case 'home_text_animation_1':case 'home_text_animation_2':case 'home_text_animation_3':clearTimeout(_.textAnimationDelay);_.textAnimationDelay = setTimeout(function() {Wizard.readyTextLayoutsHandler.textAnimations.updatePreview();},50);break;case 'home_slider_image_1':case 'home_slider_image_2':case 'home_slider_image_3':case 'home_slider_image_4':case 'home_slider_image_5':if ( key == 'home_slider_image_1' ) GetImageMainColors(getImageWRV1(400,$('#'+key).val()));Wizard.homePageBgOptions.showHideBackgroundOptions();if ( Wizard.Preview.ready && $('#parallax_homepage_image').is(':checked') ) {Wizard.Preview.window.Parallax_active(true);}
break;case 'homepage_layout_kind':var homepage_goal_place = allSettings.homepage_goal_place ? allSettings.homepage_goal_place : '';SetHomepageInlineType_Build_homepage_goal_place('UndoRedoChange',homepage_goal_place);break;case 'homepage_goal_type':if ( $('#homepage_goal_type').val() == 'image' && $('#homepage_goal_type_image').is(':visible') ) {$('#illustrationStylesBox').show();} else {$('#illustrationStylesBox').hide();}
var homepage_second_goal_type = allSettings.homepage_second_goal_type ? allSettings.homepage_second_goal_type : '';SetHomepageInlineType_Build_second_homepage_goal('UndoRedoChange',homepage_second_goal_type);break;case 'homepage_show_in_menu':case 'homepage_show_in_footer':var $input = $('#'+key);$input.val(value);Wizard.Pages.homepage.refreshOnSave();break;case 'countryFlagCode':$('#countryFlagCode').trigger("chosen:updated");break;case 'topAction_buttonText_2_style':case 'topAction_buttonText_1_style':actionButtonStlyeHandler();break;}});};function actionButtonStlyeHandler() {if ( !Wizard.Preview.ready ) return;if ( $('#menu_color').val() == $('#global_main_color').val() ) {Wizard.Preview.window.$('.navbar-default, #header, #mainNavMobile').find('.btn-primary-action-button-6, .header-cart-wrapper, .header-wish-list, .header-client-zone-wrapper').addClass('parent-main-color-handler');} else {Wizard.Preview.window.$('.navbar-default, #header, #mainNavMobile').find('.btn-primary-action-button-6, .header-cart-wrapper, .header-wish-list, .header-client-zone-wrapper').removeClass('parent-main-color-handler');}}
return _;}();Wizard.websiteHeaders = function() {var _ = {styles: {}}
_.init = function() {_.customContainer = $('#moduleHeaderCustom');_.readyStylesContainer = $('#moduleHeaderStyles');_.customContainer.find('#headerType').val(1);_.customContainer.find('#headerTransform').on('change.capitalize_handler', function () {if ( !Wizard.Preview.ready ) return;$(document).one('reloadPreviewCSS.reloaded', function() {Wizard.Preview.window.$('section:not(.s123-page-data) .modulesTitle').each(function( index, moduleTitle ) {var $modulesTitle = $(this);var $title = $modulesTitle.find('.s123-page-header');var pageName = $title.attr('data-original-title');if ( $title.find('span').length > 0 ) {$title.find('span').html(escapeHtml(Wizard.Pages.getTextTrasform(pageName)));} else {$title.html(escapeHtml(Wizard.Pages.getTextTrasform(pageName)));}});});});_.customContainer.on('change input','.header-custom-change', function( event ) {$('#headerCustomSettings').val('custom');});_.readyStylesContainer.find('.pageheaderStylesContainer').on('click','.readyHeaderStyle', function( event ) {_.readyStylesContainer.find('#page_header_style').val($(this).data('style')).trigger('change');$('#headerCustomSettings').val('readyStyle');_.changeStyle($(this).data('style'));$("#wizardForm").one( 'ajaxSuccess', function( event ) {if ( !IsPreviewAtHomepage() ) {isPreviewReload = true;RefreshPreview();} else {UpdatePreviewAreaByAjax('#s123ModulesContainer',false,false,'');window.scrollPreview = '#section-'+_.readyStylesContainer.data('section-id');scrollToPointInPreview();}});AutoSaveWizard(false,true);});$('.headerReloadForChanges').on('change',function(event) {if ( !Wizard.Preview.window.IsHomepage() && !Wizard.Preview.window.IsRichPage() && Wizard.Preview.window.$('section.s123-page-data').length != 0 ) {$("#wizardForm").one( 'ajaxSuccess', function( event ) {Wizard.Preview.window.location.reload();});} else {$("#wizardForm").one( 'ajaxSuccess', function( event ) {UpdatePreviewAreaByAjax(['#s123ModulesContainer',],'',false,GetModuleSetting(_.customContainer.attr('data-module-id'),'url'));});}
AutoSaveWizard(false,true);});_.customContainer.find('#headerType').on('change', function( event ) {if ( $(this).val() ==  1 ) {_.customContainer.find('.pageHeaderSettings').show();_.customContainer.find('.pageSloganSettigns').hide();_.customContainer.find('.innerPageHeaderSettings').hide();_.redirectToHomepage();} else if ( $(this).val() ==  2 ) {_.customContainer.find('.pageHeaderSettings').hide();_.customContainer.find('.innerPageHeaderSettings').hide();_.customContainer.find('.pageSloganSettigns').show();_.redirectToHomepage();} else {_.customContainer.find('.pageHeaderSettings').hide();_.customContainer.find('.pageSloganSettigns').hide();_.customContainer.find('.innerPageHeaderSettings').show();_.redirectToInnerPage();}});_.loadCss('');_.hideHeaderSettings();};_.loadCss = function( gloablVariables ) {$.ajax({type: "POST",url: "/manager/websiteHeaderStyles/getInterfaceCss.php",data: {w: $('#id').val(),gloablVariables: gloablVariables},success: function( html ) {if ( $('style.header-ready-style').length > 0 ) {$('style.header-ready-style').remove();}
$('head').append('<style class="header-ready-style">' + html + '</style>');}});};_.redirectToInnerPage = function() {if ( IsPreviewAtHomepage() ) {var url = '/' + GetModuleSetting(_.customContainer.attr('data-module-id'),'url') + '?w=' + $('#id').val();if ( Wizard.Preview.ready && Wizard.Preview.window.location.href.indexOf(url) !== -1 ) return;ReloadPreviewIframe(url);}};_.redirectToHomepage = function() {if ( !IsPreviewAtHomepage() ) {isPreviewReload = true;RefreshPreview();window.scrollPreview = '#section-'+_.customContainer.attr('data-module-id');scrollToPointInPreview();}};_.hideHeaderSettings = function() {_.customContainer.find('#headerType').parent('.form-group').hide();_.customContainer.find('#page_header_separator_style').parent('.form-group').hide();_.customContainer.find('#innerPage_header_background').parent('.form-group').hide();}
_.changeStyle = function( style ) {holdWizardSave = true;var settings = _.getStyleSettigns(style);_.customContainer.find('#page_header_separator_style').val(settings['header']['separatorStyle']);_.customContainer.find('#innerPage_header_background').val(settings['innerHeader']['background']);holdWizardSave = false;};_.getStyleSettigns = function( style ) {_.styles = {'': {'header': {'fontSize': 2,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 1,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},'2': {'header': {'fontSize': 2,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 1,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'boxColor'},},'5': {'header': {'fontSize': 2,'position': 'left','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 13,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'left','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'boxColor'},},'8': {'header': {'fontSize': 2,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 13,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},'9': {'header': {'fontSize': 3.9,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'bold','separatorStyle': 3,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},'10': {'header': {'fontSize': 3.9,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'bold','separatorStyle': 0,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},'11': {'header': {'fontSize': 2,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 1,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'mainColor'},},'12': {'header': {'fontSize': 2,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'bold','separatorStyle': 1,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'boxColor'},},'13': {'header': {'fontSize': 2,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'bold','separatorStyle': 5,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},'14': {'header': {'fontSize': 2,'position': 'left','letterSpace': 0,'wordSpace': 0,'fontWeight': 'bold','separatorStyle': 6,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'left','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},'15': {'header': {'fontSize': 3.8,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 7,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},'16': {'header': {'fontSize': 3.1,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'bold','separatorStyle': 8,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},'17': {'header': {'fontSize': 2.5,'position': 'center','letterSpace': 2.16,'wordSpace': 0,'fontWeight': 'bold','separatorStyle': 9,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},'18': {'header': {'fontSize': 3.9,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 10,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},'19': {'header': {'fontSize': 2,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 4,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},'20': {'header': {'fontSize': 2,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 11,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},'21': {'header': {'fontSize': 2.8,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'bold','separatorStyle': 12,'opacity': 1},'slogan': {'fontSize': 1.25,'position': 'center','letterSpace': 0,'wordSpace': 0,'fontWeight': 'normal','separatorStyle': 0,'opacity': 1},'innerHeader': {'background': 'noBackground'},},};return _.styles[style];};return _;}();function addDiscountToUpgradeModal( websiteID , data ) {$('#upgradePackage .discount-message').empty();if (data.saleReducedNUM == 0 || data.saleExpiry == '') return;window.saleReducedNUM =  data.saleReducedNUM;window.saleExpiry =  data.saleExpiry;var html = '';html += '<div class="text-center" style="">';html += '<h4 style="font-size: 14px;">'+ translations.limitedTimeOffer +'</h4>';html += '<div style="margin: 9px auto;width: 193px;padding: 11px;border: 3px dotted;text-align:center;background-color: #fff;font-size: 17px;font-weight: bold;">' + translations.DiscountOFF.replace('{{discount_percentage}}',data.saleReducedNUM) + '</div>';html += '<h4 class="saleExpiry" style="color:red;font-size: 14px;">'+data.saleExpiry+'</h4>';html += '</div>';$('#upgradePackage .discount-message').append(html);$("#upgradePackage .saleExpiry").countdown(ConvertUtcToLocalTime($(".saleExpiry").html())).on('update.countdown', function(event) {var format = '%H:%M:%S';if(event.offset.totalDays == 1) {format = '%-d '+translations.day+' ' + format;}
if(event.offset.totalDays > 1) {format = '%-d '+translations.days+' ' + format;}
if(event.offset.weeks == 1) {format = '%-w '+translations.week+' ' + format;}
if(event.offset.weeks > 1) {format = '%-w '+translations.weeks+' ' + format;}
$(this).html(event.strftime(format));});}
function randomNumberFromRange(min,max) {return Math.floor(Math.random()*(max-min+1)+min);}
function latestUpdatedWebsites() {$.post( '/versions/2/wizard/include/getLatestEditedWebsitesAJAX.php', {w: websiteID,agencyID: agencyID}).done( function( latestWebsites ) {latestWebsites = JSON.parse(latestWebsites);if ( latestWebsites.length <= 1 ) return;var html = '<div class="col-xs-12">';html += '<h3 class="header">'+translations.latestEditedWebsites+'</h3>';html += '</div>';$.each(latestWebsites, function( index, website ) {if ( website.id == websiteID ) return true;html += '<div class="col-xs-12">';html += '<a href="/manager/wizard.php?wu='+website_uniqueID+'&v='+versionNUM+'&from=sites&agencyID='+agencyID+'">';html += '<div class="qd-site-preview">';html += '<div class="qd-site-preview-back-image" style="background-image: url('+website.screenshot+'"></div>';html += '<div class="qd-site-name">';html += '<b>'+website.name+'</b>';html += '</div>';html += '</div>';html += '</a>';html += '</div>';});var $html = $(html);$('#quickDashboardLatestWebsites').append($html.hide().fadeIn(600));});}
function LayoutPickupManager() {var template = $('#template').val();var header_width = $('#header_width').val();var header_opacity = $('#header_opacity').val();var header_style = $('#header_style').val();var header_size = $('#header_size').val();var header_logo_back_color = $('#header_logo_back_color').val();var menu_pages_style = $('#menu_pages_style').val();var menu_font_size = $('#menu_font_size').val();var header_font_style = $('#header_font_style').val();var header_width_BOX = $('#header_width').closest('.form-group');var website_background_type = $('#website_background_type').closest('.form-group');var header_opacity_BOX = $('#header_opacity').closest('.form-group');var header_style_BOX = $('#header_style').closest('.form-group');var header_size_BOX = $('#header_size').closest('.form-group');var header_logo_back_color_BOX = $('#header_logo_back_color').closest('.form-group');var menu_pages_style_BOX = $('#menu_pages_style').closest('.form-group');var menu_font_size_BOX = $('#menu_font_size').closest('.form-group');var menu_pages_space_BOX = $('#menu_pages_space').closest('.form-group');var menu_pages_letter_spacing_BOX = $('#menu_pages_letter_spacing').closest('.form-group');var menu_pages_word_spacing_BOX = $('#menu_pages_word_spacing').closest('.form-group');var menu_pages_side_padding_BOX = $('#menu_pages_side_padding').closest('.form-group');var header_font_style_BOX = $('#header_font_style').closest('.form-group');var menu_separate_line_BOX = $('.menu-separate-line');header_width_BOX.hide();website_background_type.hide();header_opacity_BOX.hide();menu_separate_line_BOX.hide();header_style_BOX.hide();header_size_BOX.hide();header_logo_back_color_BOX.hide();menu_pages_style_BOX.show();menu_font_size_BOX.show();menu_pages_space_BOX.show();menu_pages_letter_spacing_BOX.show();menu_pages_word_spacing_BOX.show();menu_pages_side_padding_BOX.show();header_font_style_BOX.show();$('#header_width option[value="box"]').show();$('#header_opacity option[value="full"]').show();$('#header_opacity option[value="slight"]').show();showHideStructuresWithOpacity('hide');var $homepageModule = Wizard.Pages.getPage('169');if ( $homepageModule.length > 0 ) {if ( [169,169030,169025,169024,169023,169038,169042,169026,169029,169036,169037,169043,169048,169049,169050,169055,169056,169051].indexOf(parseInt($homepageModule.data('modules-arr-id'))) != -1 ) {showHideStructuresWithOpacity('show');}}
if (layoutArr[template].menuPlace=='left' || layoutArr[template].menuPlace=='right') {header_style_BOX.show();header_size_BOX.show();}
if (layoutArr[template].menuPlace=='top') {header_width_BOX.show();header_size_BOX.show();if ( abTestTXT != 'siteEditor_b' ) {header_opacity_BOX.show();}
if ( header_opacity == 'full' ) menu_separate_line_BOX.show();if (header_width=='fullbox' || header_width=='flyfullbox') {website_background_type.show();}}
if (layoutArr[template].menuPlace=='bottom') {header_width_BOX.hide();header_size_BOX.show();$('#header_width').val('wide');if (template==20) {header_opacity_BOX.hide();menu_separate_line_BOX.hide();$('#header_opacity').val('no');} else {if ( abTestTXT != 'siteEditor_b' ) {header_opacity_BOX.show();}
if ( header_opacity == 'full' ) menu_separate_line_BOX.show();}}
if (template==13) {header_width_BOX.hide();$('#header_width').val('wide');header_opacity_BOX.hide();menu_separate_line_BOX.hide();$('#header_opacity').val('no');}
if (template==2) {header_opacity_BOX.hide();menu_separate_line_BOX.hide();$('#header_opacity').val('no');header_logo_back_color_BOX.show();$('#header_width option[value="box"]').hide();}
if (template==25) {header_style_BOX.hide();menu_pages_style_BOX.hide();menu_font_size_BOX.hide();menu_pages_space_BOX.hide();menu_pages_letter_spacing_BOX.hide();menu_pages_word_spacing_BOX.hide();menu_pages_side_padding_BOX.hide();header_font_style_BOX.hide();}
if (header_width=='flyfullbox') { //we disable it because of PARALLAX bug
$('#header_opacity').val('no');$('#header_opacity option[value="full"]').hide();$('#header_opacity option[value="slight"]').hide();header_opacity_BOX.hide();menu_separate_line_BOX.hide();}
GetMenuScrollOffset(template);}
function showHideStructuresWithOpacity( option ) {if ( IsLandingPage() || abTestTXT != 'siteEditor_b' ) return;var $websiteTheme = $('#showWebsiteStructuresTab .chooseWebsiteTheme');if ( option == 'hide' ) {$websiteTheme.find('.homepage-design-button-container[data-id="1"]').addClass('hidden');$websiteTheme.find('.homepage-design-button-container[data-id="11835"]').addClass('hidden');$websiteTheme.find('.homepage-design-button-container[data-id="11786"]').addClass('hidden');$websiteTheme.find('.homepage-design-button-container[data-id="1000002"]').addClass('hidden');} else {$websiteTheme.find('.homepage-design-button-container[data-id="1"]').removeClass('hidden');$websiteTheme.find('.homepage-design-button-container[data-id="11835"]').removeClass('hidden');$websiteTheme.find('.homepage-design-button-container[data-id="11786"]').removeClass('hidden');$websiteTheme.find('.homepage-design-button-container[data-id="1000002"]').removeClass('hidden');}}
function PrintStylesLayoutLog() {var homepage_goal = $('#homepage_goal').val();var homepage_structure = 104;var title1 = ($('#home_siteSlogan').val()=='') ? '0' : '1';var title2 = ($('#home_siteSlogan_2').val()=='') ? '0' : '1';var title3 = ($('#home_SecondSiteSlogan').val()=='') ? '0' : '1';var more_settings_arr = ['template','customTemplate','websiteStructureNUM','header_width','header_size','header_logo_back_color','header_font_style','menu_pages_style','menu_font_size','menu_pages_space','menu_pages_side_padding','menu_pages_letter_spacing','menu_pages_word_spacing','footer_layout','home_opacity','homepageFilterImage','header_opacity','header_style','home_third_background_color','homepageGradientsColors','homepage_goal','home_slider_image_1','home_slider_image_1_settings','home_slider_image_2','home_slider_image_2_settings','home_slider_image_3','home_slider_image_3_settings','home_slider_image_4','home_slider_image_4_settings','home_slider_image_5','home_slider_image_5_settings','home_slider_chaning_speed','home_text_size','home_text_size_2','slogan_text_size','home_text_size_weight','home_text_size_2_weight','slogan_text_size_weight','home_text_shadow_1','home_text_shadow_2','home_text_shadow_3','home_text_background_1','home_text_background_2','home_text_background_3','home_text_letter_spacing_1','home_text_letter_spacing_2','home_text_letter_spacing_3','home_text_word_spacing_1','home_text_word_spacing_2','home_text_word_spacing_3','home_text_rotate_1','home_text_rotate_2','home_text_rotate_3','home_text_line_height_1','home_text_line_height_2','home_text_line_height_3','home_text_top_space_1','home_text_bottom_space_1','home_text_top_space_2','home_text_bottom_space_2','home_text_top_space_3','home_text_bottom_space_3','homepage_style','home_background_color','home_text_color','home_text_animation_1','home_text_animation_2','home_text_animation_3','home_siteSlogan','home_siteSlogan_2','home_SecondSiteSlogan','font_menu','font_logo','font_slogan','font_slogan_2','font_second_slogan','font_modules_header','global_font','home_buttonText','home_buttonText_style','home_buttonText_type','home_scrollSection','home_buttonText_icon','home_buttonText_1','home_buttonText_1_style','home_buttonText_1_type','home_scrollSection_1','home_buttonText_1_icon','videoType','home_video','home_custom_video','homepageTextCustomBoxStyle','global_main_color','menu_color','menu_text_color','menu_text_hover_color','menu_thin_border','module_separate_border_color','modules_color','modules_color_text','modules_color_box','modules_color_text_box','modules_color_second','modules_color_text_second','modules_color_second_box','modules_color_text_second_box','inside_modules_color','inside_modules_color_text','inside_modules_color_box','inside_modules_color_text_box','footer_back','footer_text','buttons_radius','homepageShapeDivider','homepageShapeDividerList_Color1','homepageShapeDividerList_Size','homepageShapeDividerList_Mobile','homepage_layout_kind','layout_text_align','layout_text_position','layout_homepage_full_width','layout_text_box_width','layout_left_side_width','layout_bottom_spacing','homepage_main_goal_margin_top','homepage_main_goal_margin_bottom','homepage_second_goal_margin_top','homepage_second_goal_margin_bottom','homepage_layout_height','homepage_goal_type','homepage_goal_place','homepage_goal_position','homepage_second_goal_type','homepage_second_goal_place','home_custom_image','home_custom_image_width','home_upload_sound','video_popup_icon_style','home_embed_sound_cloud','embed_url_width_sound_cloud','embed_url_height_sound_cloud','home_embed_facebook_like_box','embed_url_width_facebook','embed_url_height_facebook','home_embed_twitter','embed_url_width_twitter','embed_url_height_twitter','home_embed_pinterest','embed_url_width_pinterest','embed_url_height_pinterest','homepage_video_width','homepage_form_style','homepage_form_style_max_width','homepage_form_horizontal_style','homepage_mailing_placeholder','homepage_mailing_button_text','homepage_icons_style_select','homepage_padding_type','homepage_padding_top','homepage_padding_bottom','hideMenuSeperator','line_height_modules_header','global_line_height',];console.log('\n' +'$x = xxxxxxxx; \n' +'$stylesModulesArr[$x] = array(); \n' +'$stylesModulesArr[$x][\'id\']               = $x; \n' +'$stylesModulesArr[$x][\'order\']            = $themeIndex; \n' +'$stylesModulesArr[$x][\'categories\']       = \'cat-popular\'; \n' +'$stylesModulesArr[$x][\'more_settings\']      = \''+BuildJsonStringWizard(more_settings_arr)+'\'; \n' +'$themeIndex++; \n' +'');}
function PrintThemesLayoutLog() {var settings_arr = Wizard.tabEffectHandler.designTabHandler.getFieldsByType('readyThemes');console.log('\n' +'$x = $themeIndex; \n' +'$themesModulesArr[$x] = array(); \n' +'$themesModulesArr[$x][\'id\']               = $x; \n' +'$themesModulesArr[$x][\'order\']            = $themeIndex; \n' +'$themesModulesArr[$x][\'categories\']       = \'cat-popular\'; \n' +'$themesModulesArr[$x][\'settings\']      = \''+BuildJsonStringWizard(settings_arr)+'\'; \n' +'$themeIndex++; \n' +'');}
function PrintColorThemesLayoutLog() {var settings_arr = Wizard.tabEffectHandler.designTabHandler.getFieldsByType('colors');console.log('\n' +'$x = $themeIndex; \n' +'$colorThemesModulesArr[$x] = array(); \n' +'$colorThemesModulesArr[$x][\'id\']               = $x; \n' +'$colorThemesModulesArr[$x][\'categories\']       = \'cat-popular\'; \n' +'$colorThemesModulesArr[$x][\'order\']            = $themeIndex; \n' +'$colorThemesModulesArr[$x][\'categories\']       = \'cat-popular\'; \n' +'$colorThemesModulesArr[$x][\'settings\']         = \''+BuildJsonStringWizard(settings_arr)+'\'; \n' +'$colorThemesModulesArr[$x][\'type\']             = \'colorThemes\'; \n' +'$themeIndex++; \n' +'');}
function PrintFontThemesLayoutLog() {var settings_arr = Wizard.tabEffectHandler.designTabHandler.getFieldsByType('fonts');console.log('\n' +'$x = $themeIndex; \n' +'$fontThemesModulesArr[$x] = array(); \n' +'$fontThemesModulesArr[$x][\'id\']               = $x; \n' +'$fontThemesModulesArr[$x][\'categories\']       = \'cat-popular\'; \n' +'$fontThemesModulesArr[$x][\'order\']            = $themeIndex; \n' +'$fontThemesModulesArr[$x][\'title\']            = \''+$('#all_fonts').val()+'\'; \n'+'$fontThemesModulesArr[$x][\'description\']      = \''+$('#font_menu').val()+'\'; \n'+'$fontThemesModulesArr[$x][\'categories\']       = \'cat-popular\'; \n' +'$fontThemesModulesArr[$x][\'settings\']         = \''+BuildJsonStringWizard(settings_arr)+'\'; \n' +'$fontThemesModulesArr[$x][\'type\']            = \'fontThemes\'; \n' +'$themeIndex++; \n' +'');}
function PrintTextLayoutLog() {var homepage_goal = $('#homepage_goal').val();var homepage_structure = 104;var title1 = ($('#home_siteSlogan').val()=='') ? '0' : '1';var title2 = ($('#home_siteSlogan_2').val()=='') ? '0' : '1';var title3 = ($('#home_SecondSiteSlogan').val()=='') ? '0' : '1';var more_settings_arr = ['home_text_size','home_text_size_2','slogan_text_size','home_text_size_weight','home_text_size_2_weight','slogan_text_size_weight','home_text_shadow_1','home_text_shadow_2','home_text_shadow_3','home_text_background_1','home_text_background_2','home_text_background_3','home_text_letter_spacing_1','home_text_letter_spacing_2','home_text_letter_spacing_3','home_text_word_spacing_1','home_text_word_spacing_2','home_text_word_spacing_3','home_text_line_height_1','home_text_line_height_2','home_text_line_height_3','home_text_top_space_1','home_text_bottom_space_1','home_text_top_space_2','home_text_bottom_space_2','home_text_top_space_3','home_text_bottom_space_3','home_text_animation_1','home_text_animation_2','home_text_animation_3','home_text_rotate_1','home_text_rotate_2','home_text_rotate_3','home_siteSlogan','home_siteSlogan_2','home_SecondSiteSlogan','home_buttonText','home_buttonText_style','home_buttonText_1','home_buttonText_1_style','videoType','home_video','home_custom_video','layout_text_box_width'];console.log('\n' +'$x = $themeIndex; \n' +'$textModulesArr[$x] = array(); \n' +'$textModulesArr[$x][\'id\']               = $x; \n' +'$textModulesArr[$x][\'order\']            = $themeIndex; \n' +'$textModulesArr[$x][\'categories\']       = \'cat-popular\'; \n' +'$textModulesArr[$x][\'showTitle1\']       = \''+title1+'\'; \n' +'$textModulesArr[$x][\'showTitle2\']       = \''+title2+'\'; \n' +'$textModulesArr[$x][\'showTitle3\']       = \''+title3+'\'; \n' +'$textModulesArr[$x][\'align\']            = \'center\'; \n' +'$textModulesArr[$x][\'more_settings\']    = \''+BuildJsonStringWizard(more_settings_arr)+'\'; \n' +'$textModulesArr[$x][\'customClass\']    = \''+$('#homepageTextCustomBoxStyle').val()+'\'; \n' +'$themeIndex++; \n' +'');}
var imageFilterArr = [];imageFilterArr.push(["10,#000000,#ffffff,0"]);imageFilterArr.push(["5,#000000,#ffffff,0"]);imageFilterArr.push(["7,#000000,#ffffff,0"]);imageFilterArr.push(["7,#000000,#ffffff,sepia(50%) contrast(80%) brightness(100%) saturate(2)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(110%) brightness(110%) sepia(30%) grayscale(100%)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(85%) brightness(100%) saturate(75%) sepia(22%)"]);imageFilterArr.push(["7,#000000,#ffffff,sepia(30%)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(100%) brightness(70%) saturate(0.5)"]);imageFilterArr.push(["7,#000000,#ffffff,blur(3.0px)"]);imageFilterArr.push(["7,#000000,#ffffff,blur(7.0px)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(100%) brightness(100%) saturate(130%)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(90%) brightness(100%) saturate(85%) hue-rotate(20deg)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(90%) brightness(100%) saturate(100%) hue-rotate(-10deg)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(100%) sepia(50%)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(90%) brightness(110%)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(100%) saturate(125%)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(90%) sepia(20%)"]);imageFilterArr.push(["7,#000000,#ffffff,brightness(100%) hue-rotate(350deg)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(90%) brightness(100%) saturate(110%)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(100%) saturate(110%)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(95%) brightness(95%) saturate(100%) sepia(25%)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(75%) brightness(100%) saturate(85%)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(100%) brightness(90%)"]);imageFilterArr.push(["7,#000000,#ffffff,brightness(100%) saturate(100%) sepia(30%)"]);imageFilterArr.push(["7,#000000,#ffffff,contrast(100%) brightness(100%) sepia(8%)"]);function filterHomepageOptionsList() {var mainImageUrl = '';switch( $('#homepage_style').val() ) {case '2':mainImageUrl = $('#home_start_image').val();BuildFiltersImages(mainImageUrl,imageFilterArr);break;case '3':mainImageUrl = $('#home_slider_image_1').val();if ( UploadFile_GetFileType(mainImageUrl) == 'video' ) {$.ajax({type: "POST",url: "/versions/2/wizard/getVideoThumbeURL.php",data: 'w='+$('#id').val()+'&videoURL='+mainImageUrl,success: function( url ) {mainImageUrl = url;if ( mainImageUrl.toLowerCase().indexOf('video-no-thumbnail.png') !== -1 ) {mainImageUrl = '';}
BuildFiltersImages(mainImageUrl,imageFilterArr);}});} else {BuildFiltersImages(mainImageUrl,imageFilterArr);}
break;case '4':$.ajax({type: "POST",url: "/versions/2/wizard/getVideoThumbeURL.php",data: 'w='+$('#id').val()+'&videoURL='+$('#home_video_background').val()+'',success: function( url ) {mainImageUrl = url;if ( mainImageUrl.toLowerCase().indexOf('video-no-thumbnail.png') !== -1 ) {mainImageUrl = '';}
BuildFiltersImages(mainImageUrl,imageFilterArr);}});break;default:BuildFiltersImages('',imageFilterArr);break;}}
function BuildFiltersImages( mainImageUrl, imageFilterArr ) {$('#hmBgSettings #hmBgFilters').hide();$('#filterHomepageOptions').empty();if ( !mainImageUrl ) return;$(imageFilterArr).each(function() {var html = '';var string = $(this);var stringArr = string[0].split(",");html += '<div data-custom-filter-combination="'+stringArr[0]+stringArr[1]+stringArr[2]+stringArr[3]+'" class="filterEffectClass" data-opacity="'+stringArr[0]+'" data-back="'+stringArr[1]+'" data-text="'+stringArr[2]+'" data-filter="'+stringArr[3]+'"><div><img src="'+getImageWRV1(100,mainImageUrl)+'" class="homepageReadyDesignClass" style="color:'+(stringArr[2])+';opacity:'+(stringArr[0]/10)+';filter:'+stringArr[3]+'">';html += '<div class="filter-button"><i class="ace-icon fal fa-check-circle"></i></div></div>';html += '</div>';$html = $(html);$html.children().first().css({backgroundColor: $('#home_background_color').val()});$('#filterHomepageOptions').append($html);$html.click(function() {var $this       = $(this);var more        = $this.data('more');var opacity     = $this.data('opacity');var back        = $this.data('back');var text        = $this.data('text');var filter      = $this.data('filter')==0 ? '' : $this.data('filter');if ( more == 'yes' ) {$('.hideExtraFilters').fadeToggle();} else {$('#home_opacity').val(opacity).trigger('change');$('#homepageFilterImage').val(filter).trigger('change');}
ActiveTheFilterTheUserPick();});});$('#hmBgSettings #hmBgFilters').show();ActiveTheFilterTheUserPick();$('#homepageFilterImage').off('change.ActiveTheFilterTheUserPick').on('change.ActiveTheFilterTheUserPick', function() {ActiveTheFilterTheUserPick();});}
function ActiveTheFilterTheUserPick() {$('#filterHomepageOptions').find('.filterEffectClass').find('.filter-button.active').removeClass('active');var customFilterCombination = '';if ($('#home_opacity').val().length>0) {customFilterCombination += $('#home_opacity').val();}
if ($('#home_background_color').val().length>0) {customFilterCombination += $('#home_background_color').val();}
if ($('#home_text_color').val().length>0) {customFilterCombination += $('#home_text_color').val();}
if ($('#homepageFilterImage').val().length>0) {customFilterCombination += $('#homepageFilterImage').val();} else {customFilterCombination += '0';}
$('#filterHomepageOptions .filterEffectClass[data-custom-filter-combination="'+customFilterCombination+'"]').find('.filter-button').addClass('active');}
function ResetAllTextSettings() {$('#home_text_animation_1').val('');$('#home_text_animation_2').val('');$('#home_text_animation_3').val('');$('#home_text_size_weight').val('');$('#home_text_size_2_weight').val('');$('#slogan_text_size_weight').val('');$('#home_text_shadow_1').val('');$('#home_text_shadow_2').val('');$('#home_text_shadow_3').val('');$('#home_text_background_1').val('');$('#home_text_background_2').val('');$('#home_text_background_3').val('');$('#home_text_letter_spacing_1').val('');$('#home_text_letter_spacing_2').val('');$('#home_text_letter_spacing_3').val('');$('#home_text_word_spacing_1').val('');$('#home_text_word_spacing_2').val('');$('#home_text_word_spacing_3').val('');$('#home_text_line_height_1').val('');$('#home_text_line_height_2').val('');$('#home_text_line_height_3').val('');$('#home_text_top_space_1').val('');$('#home_text_bottom_space_1').val('');$('#home_text_top_space_2').val('');$('#home_text_bottom_space_2').val('');$('#home_text_top_space_3').val('');$('#home_text_bottom_space_3').val('');}
function userNotConnectedMessage() {if ( $('.login-error-message').length > 0 ) return;bootbox.dialog({title: translations.loginErrorTitle,message: '<div class="login-error-message">' + translations.loginErrorMessage + '<div>',buttons: {confirm: {label: translations.loginBtn,className: 'btn-primary',callback: function (result) {if ( result ) {disableLeavePopup = true;var currentLocation = window.location.href.split('/');window.location = '/manager/login/login.php?p=/' + currentLocation[3] + '/' + currentLocation[4];}}}}});}
function UpdateSubDomainAndUniqueDomainIndifferentPlaceInInterfaceAfterUpdate() {$.post( '/versions/2/wizard/include/getWebsiteDomains.php', {w: $('#id').val()}).done( function( data ) {data = JSON.parse(data);$('#domainTab_subDomain').html(data[0].websiteSubDomain);$('#domainTab_subDomain').attr('href','http://'+data[0].websiteSubDomain);
$(document).trigger('s123.website_domain_update',[data[0].websiteSubDomain]);websiteDomain       = data[0].websiteDomain;unique_domain       = data[0].unique_domain;websiteSubDomain    = data[0].websiteSubDomain;});}
function SendScanSitemapRequest() {if ( window.isScanSitemapSubmitted ) return;$.ajax({type: "POST",url: "/versions/2/wizard/scanSitemapRequest.php",data: 'w='+$('#id').val(),success: function( data ) {if ( data == 'succeed' ) window.isScanSitemapSubmitted = true;}});}
function is_unsave_changes( $modal, $iframe, event ) {if ( $modal.length === 0 || $iframe.length === 0 ) return false;if ( !$iframe.get(0).contentWindow.$ ) return false;var no_unsaved_changes = $iframe.get(0).contentWindow.$('html[data-unsaved-changes="true"]').length === 0;var bootboxSettings = {};function refreshSettings( $html ) {bootboxSettings = {message: $html.data('unsaved-changes-message') ? $html.data('unsaved-changes-message') : translations.PleaseMakeSaveChangeBefore,confirmBtn: $html.data('unsaved-changes-confirm-btn') ? $html.data('unsaved-changes-confirm-btn') : translations.DiscardChanges};}
refreshSettings($iframe.get(0).contentWindow.$('html'));if ( no_unsaved_changes ) {(function () {$($iframe.get(0).contentWindow.$.find('iframe')).each(function ( index, iframe ) {var $iframe = $(iframe);if ( !$iframe.attr('src') ) return;if ( $iframe.attr('src').slice(0,1) === '/' ) {if ( $iframe.contents().find('html[data-unsaved-changes="true"]').length !== 0 ) {refreshSettings($iframe.get(0).contentWindow.$('html'));no_unsaved_changes = false;return;}}});})();}
if ( no_unsaved_changes ) return false;if ( $modal.data('allow-close') == '1' ) {$modal.data('allow-close','0');return false;}
event.preventDefault();bootbox.confirm({title: translations.AreSureCloseWin,message: bootboxSettings.message,className: 's123-unsaved-changes-alert',buttons: {confirm: {label: bootboxSettings.confirmBtn,className: 'btn-danger'},cancel: {label: translations.KeepEditThePage,className: 'btn-default'}},callback: function( discard_changes ) {if ( discard_changes ) {$modal.data('allow-close','1');$modal.modal('hide');}}});return true;}
function homepage_PickNewObjectToHomepageBackground( fromLibraryBOO, $imageParentDiv, previewURL, imageURL, $thisParent, imgBgType ) {wizard_ClearAllColorsRecommended();if ( previewURL.length === 0 ) return;$imageParentDiv.append('<div class="libraryChooseLoading text-center" style="width: 100%;"><i class="ace-icon fal fa-spinner fa-solid fa-spin white fa-2x"></i></div>');if ( imageHomepageLiveEleID == Wizard.homePageChangingImages.fistInputID ) {if ( $('#homepage_layout_kind').val() == '2' || $('#homepage_layout_kind').val() == '3' ) {homepageHalfWidth_PickNewObjectToHomepageBackground(fromLibraryBOO,$imageParentDiv,previewURL,imageURL,$thisParent,imgBgType);} else {homepageFullWidth_PickNewObjectToHomepageBackground(fromLibraryBOO,$imageParentDiv,previewURL,imageURL,$thisParent,imgBgType);}} else {var homepage_style = $('#homepage_style').val();holdWizardSave = true;GetRecommendedImages_updateItem(imageURL,homepage_style);holdWizardSave = false;$('#wizardUndoRefreshHelper').val('wizard_ReloadHomepageCss');wizard_ReloadHomepageCss(false);$imageParentDiv.find('.libraryChooseLoading').remove();Wizard.homePageBgOptions.showSavedLabel();}}
function homepageHalfWidth_PickNewObjectToHomepageBackground( fromLibraryBOO, $imageParentDiv, previewURL, imageURL, $thisParent, imgBgType ) {var homepage_style = $('#homepage_style').val();if ( fromLibraryBOO == true && imgBgType == 'patterns' ) {$.ajax({type: "POST",url: "/versions/2/wizard/getImageDominantColors_beta.php",data: 'w='+$('#id').val()+'&image='+encodeURIComponent(previewURL),success: function( data ) {data = tryParseJSON(data);if ( !data ) return;holdWizardSave = true;GetRecommendedImages_updateItem(imageURL,homepage_style);Wizard.homePageBgOptions.updateHomepageImageType(imgBgType);var imageAttributesResult = GetColorsPaletteArray(data.colors);if ( data.isTrasperant ) {imageAttributesResult.styles[1] = {home_text_color: '#000000',home_background_color: '#ffffff'};}
if ( imageAttributesResult.styles.length > 1 ) {ActiveNewStyleColor(imageAttributesResult.styles[1]);}
holdWizardSave = false;$('#wizardUndoRefreshHelper').val('wizard_ReloadHomepageCss');wizard_ReloadHomepageCss(false);$imageParentDiv.find('.libraryChooseLoading').remove();Wizard.homePageBgOptions.showSavedLabel();}});} else {$.ajax({type: "POST",url: "/versions/2/wizard/getImageDominantColors_beta.php",data: 'w='+$('#id').val()+'&image='+encodeURIComponent(previewURL),success: function( data ) {data = tryParseJSON(data);if ( !data ) return;holdWizardSave = true;GetRecommendedImages_updateItem(imageURL,homepage_style);var imageAttributesResult = GetColorsPaletteArray(data.colors);if ( imageAttributesResult.styles.length > 1 ) {ActiveNewStyleColor(imageAttributesResult.styles[1]);if ( fromLibraryBOO == true ) {PrintImage_colors(imageAttributesResult.styles,$thisParent,6);$thisParent.css('display','flex');}
PrintImage_colors(imageAttributesResult.styles,$('#homepageSimilarColorsList'),24);}
holdWizardSave = false;$('#wizardUndoRefreshHelper').val('wizard_ReloadHomepageCss');wizard_ReloadHomepageCss(false);$imageParentDiv.find('.libraryChooseLoading').remove();Wizard.homePageBgOptions.showSavedLabel();}});}}
function homepageFullWidth_PickNewObjectToHomepageBackground( fromLibraryBOO, $imageParentDiv, previewURL, imageURL, $thisParent, imgBgType ) {var homepage_style = $('#homepage_style').val();if ( fromLibraryBOO == true && imgBgType == 'patterns' ) {$.ajax({type: "POST",url: "/versions/2/wizard/getImageDominantColors_beta.php",data: 'w='+$('#id').val()+'&image='+encodeURIComponent(previewURL),success: function( data ) {data = tryParseJSON(data);if ( !data ) return;holdWizardSave = true;GetRecommendedImages_updateItem(imageURL,homepage_style);Wizard.homePageBgOptions.updateHomepageImageType(imgBgType);var imageAttributesResult = GetColorsPaletteArray(data.colors);if ( data.isTrasperant ) {imageAttributesResult.styles[1] = {home_text_color: '#000000',home_background_color: '#ffffff'};}
if ( imageAttributesResult.styles.length > 1 ) {ActiveNewStyleColor(imageAttributesResult.styles[1]);}
holdWizardSave = false;$('#wizardUndoRefreshHelper').val('wizard_ReloadHomepageCss');wizard_ReloadHomepageCss(false);$imageParentDiv.find('.libraryChooseLoading').remove();Wizard.homePageBgOptions.showSavedLabel();}});} else {holdWizardSave = true;GetRecommendedImages_updateItem(imageURL,homepage_style);ResetImageDesignAfterChooseNewImage();holdWizardSave = false;$('#wizardUndoRefreshHelper').val('wizard_ReloadHomepageCss');wizard_ReloadHomepageCss(false);if ( $thisParent ) PrintImage_quick_filter($thisParent,previewURL);$imageParentDiv.find('.libraryChooseLoading').remove();Wizard.homePageBgOptions.showSavedLabel();}}
function ResetImageDesignAfterChooseNewImage() {$('#home_opacity').val(5).trigger('change');$('#homepageFilterImage').val('').trigger('change');$('#home_background_color').val('#000000').trigger('change',['uploadFileChange']);$('#home_text_color').val('#ffffff').trigger('change');ActiveTheFilterTheUserPick();}
function GetRecommendedImages_updateItem( webformatURL, homepage_style ) {if ( imageHomepageLiveEleID != '' ) {$('#'+imageHomepageLiveEleID).val(webformatURL).trigger('change');filterHomepageOptionsList();if ( homepage_style !=2 && homepage_style != 3 ) {$('#homepage_style').val(2).trigger('change');}} else {if ( homepage_style == 3 ) {$('#home_start_image').val(webformatURL).trigger('change');$('#home_slider_image_1').val(webformatURL).trigger('change');$('#homepage_style').val(3).trigger('change');} else {$('#home_start_image').val(webformatURL).trigger('change');$('#homepage_style').val(2).trigger('change');}}}
function hexToRGB(hex, alpha) {var r = parseInt(hex.slice(1, 3), 16),g = parseInt(hex.slice(3, 5), 16),b = parseInt(hex.slice(5, 7), 16);if (alpha) {return "rgba(" + r + ", " + g + ", " + b + ", " + alpha + ")";} else {return "rgb(" + r + ", " + g + ", " + b + ")";}}
function PrintImage_colors( stylesObj, $eleObj, itemLimit ) {$eleObj.empty();var colorI = 1;$.each(stylesObj, function( index , $colorSettings ) {if ( colorI <= itemLimit ) {var recColor = '<div class="item" data-select-color="' + $colorSettings.home_third_background_color + '">';recColor += '<div class="colorCircle" style="background-color:' + $colorSettings.home_third_background_color + ';"></div>';recColor += '</div>';$recColor = $(recColor);$eleObj.append($recColor);$recColor.click(function() {imageHomepageLiveEleID = Wizard.homePageChangingImages.fistInputID;holdWizardSave = true;ActiveNewStyleColor($colorSettings);holdWizardSave = false;window.reloadPreviewCSS = ReloadPreviewCSS;AutoSaveWizard(false,true);SetActiveStatusOnColorsTheUserSelect($(this).data('select-color'));});}
colorI++;});}
function PrintImage_quick_filter(fastStyleObj,image) {var filterI = 1;$.each(imageFilterArr, function( index , filterValue ){if (filterI<=6) {var filterArr   = filterValue[0].split(",");var opacity     = filterArr[0];var back        = filterArr[1];var text        = filterArr[2];var filter      = filterArr[3]==0 ? '' : filterArr[3];if (opacity>7) {return true;}
var recColor = '<div class="item" data-filter="'+filterValue+'">';recColor += '<div class="colorCircle" style="background-image:url('+image+');background-size: cover;background-position: center center;background-color:'+back+';filter:'+filter+';opacity:'+(opacity/10)+'"></div>';recColor += '</div>';$recColor = $(recColor);fastStyleObj.append($recColor);$recColor.click(function() {var filter = $(this).data('filter');var filterArr = filter.split(",");var opacity     = filterArr[0];var back        = filterArr[1];var text        = filterArr[2];var filter      = filterArr[3]==0 ? '' : filterArr[3];$('#home_opacity').val(opacity).trigger('change');$('#homepageFilterImage').val(filter).trigger('change');});}
filterI++;});fastStyleObj.css('display','flex');}
function SetActiveStatusOnColorsTheUserSelect(selectedColor) {$('.RecommendedImages').find('.styles').find('.item.active').removeClass('active');$('.RecommendedImages').find('.styles').find('.item[data-select-color="'+selectedColor+'"]').addClass('active');$('#homepageSimilarColorsList').find('.item.active').removeClass('active');$('#homepageSimilarColorsList').find('.item[data-select-color="'+selectedColor+'"]').addClass('active');}
function ActiveNewStyleColor( $colorSettings ) {if ( typeof $colorSettings !== 'undefined' && $colorSettings != '' ) {var uploadFile = topWindow.uploadFiles[imageHomepageLiveEleID];if ( uploadFile.settings.get().type == 'patterns' ) {$colorSettings.home_opacity = 10;$colorSettings.homepageFilterImage = '';}
$.each ($colorSettings, function (key, value) {if ( key == 'homepageLayout' ) return true;$('#'+key).val(value).trigger('change',['homepageImageLibraryChange']);});}}
function GetImageAttributes() {var home_start_image = $('#home_slider_image_1').val();GetImageMainColors(getImageWRV1(400,home_start_image));}
function isInt(n) {return n % 1 === 0;}
function componentToHex(c) {var hex = c.toString(16);return hex.length == 1 ? "0" + hex : hex;}
function rgbToHex(r, g, b) {return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);}
function wizard_ReloadHomepageCss( scrollToHomepage ) {BuildToolJSON();if ( IsPreviewAtHomepage() ) {$("#wizardForm").off('ajaxSuccess').one( 'ajaxSuccess', function( event ) {UpdatePreviewAreaByAjax(['#top-section'], function() {if ( scrollToHomepage ) {window.scrollPreview = '#top-section';scrollToPointInPreview();}},false,'');});window.reloadPreviewCSS = ReloadPreviewCSS;AutoSaveWizard(false,true);} else {AutoSaveWizard(true,true);}}
function wizard_ClearAllColorsRecommended() {$('#homepageSimilarColorsList').empty();$('.RecommendedImages').find('.styles').empty().hide();}
function GetImageMainColors( imageURL ) {var imageType = UploadFile_GetFileType(imageURL);wizard_ClearAllColorsRecommended();if ( imageURL.length === 0 ) return;if ( $('#homepage_layout_kind').val() == '2' || $('#homepage_layout_kind').val() == '3' ) {$.ajax({type: "POST",url: "/versions/2/wizard/getImageDominantColors_beta.php",data: 'w='+$('#id').val()+'&image='+encodeURIComponent(imageURL)+'&imageType='+imageType,success: function( data ) {data = tryParseJSON(data);if ( !data ) return;var imageAttributesResult = GetColorsPaletteArray(data.colors);if ( imageAttributesResult.styles.length > 1 ) {PrintImage_colors(imageAttributesResult.styles,$('#homepageSimilarColorsList'),24);$('#homepageSimilarColors').css('margin-bottom','20px');}}});}}
var UploadLibraryImageToUserWebsite_currentRequest = null;var UploadLibraryImageToUserWebsite_userFinishChooseImages;function UploadLibraryImageToUserWebsite( id ) {var eleVal = $('#'+id).val();clearTimeout(UploadLibraryImageToUserWebsite_userFinishChooseImages);if ( eleVal.indexOf('enter-system.com') !== -1 || eleVal.indexOf('unsplash.com') !== -1 || eleVal.indexOf('pixabay.com') !== -1 ) {UploadLibraryImageToUserWebsite_userFinishChooseImages = setTimeout(function() {UploadLibraryImageToUserWebsite_currentRequest = $.ajax({type: "POST",url: "/versions/2/wizard/uploadFileFromURL.php",data: 'w='+$('#id').val()+'&url='+encodeURIComponent(eleVal)+'',beforeSend: function() {if ( UploadLibraryImageToUserWebsite_currentRequest != null ) {UploadLibraryImageToUserWebsite_currentRequest.abort();}},success: function( data ) {var json = $.parseJSON(data);$('#'+id).val(json.n);AutoSaveWizard(false,false);WizardUndoRedoHandler.skipSave = true;}});},5000);} else {if ( UploadLibraryImageToUserWebsite_currentRequest !== null ) {UploadLibraryImageToUserWebsite_currentRequest.abort();}}}
function UploadFileFinishUpload_callback( id ) {if ( id.indexOf('home_slider_image') < 0 ) return;GetImageMainColors(getImageWRV1(400,$('#'+id+'').val()));UploadLibraryImageToUserWebsite(id);holdWizardSave = true;ResetImageDesignAfterChooseNewImage();holdWizardSave = false;filterHomepageOptionsList();if ( UploadFile_GetFileType($('#'+id+'').val()) != 'video' ) {WizardAddImagesToHistory.add(getImageWRV1(400,$('#'+id+'').val()),$('#'+id+'').val());}}
function GetColorsPaletteArray(json) {var imageAttributesResult = [];imageAttributesResult['styles'] = [];$(json).each(function (index, color) {var mainColor = color.hex;var bestTextColorFit = invertColor(mainColor,true);var imageAttributes_builder_styles = [];imageAttributes_builder_styles['home_text_color'] = bestTextColorFit;imageAttributes_builder_styles['home_third_background_color'] = mainColor;imageAttributes_builder_styles['homepageFilterImage'] = "";imageAttributesResult['styles'].push(Object.assign({}, imageAttributes_builder_styles));});return imageAttributesResult;}
function invertColor(hex, bw) {if (hex.indexOf('#') === 0) {hex = hex.slice(1);}
if (hex.length === 3) {hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];}
if (hex.length !== 6) {throw new Error('Invalid HEX color.');}
var r = parseInt(hex.slice(0, 2), 16),g = parseInt(hex.slice(2, 4), 16),b = parseInt(hex.slice(4, 6), 16);if (bw) {return (r * 0.299 + g * 0.587 + b * 0.114) > 186
? '#000000'
: '#FFFFFF';}
r = (255 - r).toString(16);g = (255 - g).toString(16);b = (255 - b).toString(16);return "#" + padZero(r) + padZero(g) + padZero(b);}
function BuildJsonStringWizard( settingsArray ) {var json = {};for ( var i =0 ; i < settingsArray.length ; i++ ) {var id = settingsArray[i];var $input = $('#'+id);if ( $input.length == 0 ) {$input = $('[name="'+id+'"]');}
switch ( $input.prop('type') ) {case 'radio':$input = $('[name="'+$input.attr('name')+'"]:checked');break;}
var $inputVal  = $input.val();if (id=='home_siteSlogan' || id=='home_siteSlogan_2' || id=='home_SecondSiteSlogan') {$inputVal = $inputVal.replace(/\n/ig,"<br>");}
switch ( $input.prop('type') ) {case 'checkbox':json[settingsArray[i]] = $input.prop('checked');break;default:json[settingsArray[i]] = $inputVal;break;}}
return JSON.stringify(json);}
function WizardRefreshHandler( $changedInputs, wizardUndoRefreshHelper ) {var inputChangeReload = [];var refreshByData = [];var inputChangeLive = [];var inputReloadPreviewCSS = [];if ( wizardUndoRefreshHelper === 'wizard_ReloadHomepageCss' ) {wizard_ReloadHomepageCss(true);return;} else if ( wizardUndoRefreshHelper === 'structuresHandler' ) {$("#wizardForm").off('ajaxSuccess.WizardRefreshHandler').one( 'ajaxSuccess.WizardRefreshHandler', function( event ) {UpdatePreviewAreaByAjax('structuresHandler',false,false,'');});AutoSaveWizard(false,true);return;}
if ( $changedInputs.length === 0 ) return;$.each($changedInputs, function( index, $input ) {if ( $input.hasClass('inputChangeLive') ) {inputChangeLive.push($input);} else if ( $input.hasClass('inputChangeReload') ) {inputChangeReload.push($input);} else if ( $input.hasClass('inputReloadPreviewCSS') ) {inputReloadPreviewCSS.push($input);} else if ( $input.hasClass('file-upload-input-field') ) {inputChangeReload.push($input);}
if ( $input.data('update-preview-area') ) {refreshByData.push($input.data('update-preview-area'));}});$("#wizardForm").off('ajaxSuccess.WizardRefreshHandler').one( 'ajaxSuccess.WizardRefreshHandler', function( event ) {if ( inputChangeReload.length > 0 ) {isPreviewReload = true;RefreshPreview();return;}
if ( refreshByData.length > 0 ) {if ( refreshByData.indexOf('structuresHandler') != -1 ) {UpdatePreviewAreaByAjax('structuresHandler',false,false,'');} else {refreshByData = refreshByData.filter(function(item, pos) {return refreshByData.indexOf(item) == pos;});UpdatePreviewAreaByAjax(refreshByData,false,false,'');}}});if ( inputReloadPreviewCSS.length > 0 ) {window.reloadPreviewCSS = ReloadPreviewCSS;}
AutoSaveWizard(false,true);for ( i=0; i < inputChangeLive.length ; i++ ) {window.scrollPreview = inputChangeLive[i].data('scroll-preview');ChangePreviewLive(inputChangeLive[i].get(0));}}
var customFontsHandler = function() {var that = {};that.init = function() {that.$container = $('#customFontsContainer');if ( that.$container.length === 0 ) return;that.$input = that.$container.find('#customFontInput');that.$customFontsList = that.$container.find('#customFontsList');that.fontsList = tryParseJSON(that.$customFontsList.val());if ( !that.fontsList ) that.fontsList = [];renderFontsList();that.$input.off('change.customFontsHandler').on('change.customFontsHandler',function( event, s3Obj ) {addFont({id: that.fontsList.length + 1,name: getFontName(s3Obj.n),src: s3Obj.n});});};that.getPath = function( fontName ) {var src = false;$.each(that.fontsList, function( index, font ) {if ( fontName == font.name ) {src = font.src;return false;}});return src;}
that.isCustomFont = function( fontName ) {var isCustomFont = false;$.each(that.fontsList, function( index, font ) {if ( fontName == font.name ) {isCustomFont = true;return false;}});return isCustomFont;}
function renderFontsList( data ) {var html = '';var $fontsListBox = that.$container.find('.c-f-fonts-list-box');$fontsListBox.empty();$.each(that.fontsList, function( index, font ) {html += '<div class="c-f-font" data-id="'+index+'">';html += '<span class="c-f-font-name">'+font.name+'</span>';html += '<a data-toggle="c-f-delete-confirmation" class="c-f-font-delete-btn"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="trash" class="svg-inline--fal fa-regular fa-trash-can fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"></path></svg></a>';
html += '</div>';});$fontsListBox.html(html);that.$container.find('[data-toggle="c-f-delete-confirmation"]').confirmation({placement: window['isTouchSupported'] ? intrface_align : intrface_align_reverse,title: translations.areYouSure,btnOkLabel: '<i class="icon-ok-sign icon-white"></i> '+translations.yes+'',btnCancelLabel: '<i class="icon-remove-sign"></i> '+translations.no+'',popout: true,singleton: true,container: 'body',btnOkClass: 'btn-danger btn-sm spacing-confirmation-btn',btnCancelClass: 'btn-default btn-sm spacing-confirmation-btn',delay: 0,onConfirm: function() {var $this = $(this);var id = $this.closest('.c-f-font').data('id');$this.confirmation('destroy');removeFont(id);}});};function addFont( data ) {var font = new fontObject(data);that.fontsList.push(font);renderFontsList();save();};function removeFont( id ) {if ( isFontUsed(id) ) {bootbox.alert({message: translations.customFontsHandler.removeUsedFontAlert});return;}
that.fontsList.splice(id,1);renderFontsList();save();};function isFontUsed( id ) {var used = false;var fontsInputs = ['all_fonts','font_menu','font_modules_header','global_font','font_slogan','font_slogan_2','font_second_slogan','font_logo'];fontsInputs.forEach(function ( item, index ) {if ( $('#'+item).val() === that.fontsList[id].name ) {used = true;}});return used;};function fontObject( data ) {function defStructure() {return {id: null,name: '',src: ''};}
var def = new defStructure();if ( data ) {data = objectAssign(new defStructure(),data); // (objectAssign overwrite objects)
} else {data = def;}
return data;};function save() {that.$customFontsList.html(JSON.stringify(that.fontsList));$(document).trigger('customFontsHandler.change');if ( isWizardPage() ) {AutoSaveWizard(false,true);}};function objectAssign(target, sources) {if ( Object.assign ) {sources = Object.assign(target,sources);} else {for (var prop in target)
if (!sources.hasOwnProperty(prop)) sources[prop] = target[prop];}
return sources;}
function getFontName( font_src ) {var filename = font_src.replace(/^.*[\\\/]/,'');var fontFileName = filename.match(/normal_([^_]+)_.*/)[1];return fontFileName;}
return that;}();var HomepageTemplates = new function() {var that = this;that.init = function( settings ) {if ( !settings ) return;that.isMobile = settings.isMobile;that.$container = settings.$container;that.page = settings.page;that.inProgress = false;that.limit = 15;that.skeletonesAmount = that.limit;$(document).on('wizard_tabs_opened.HomepageTemplates',function( event, tabID ) {if ( tabID != 'homepageTab' ) return;if ( that.page == 1 ) {addPluginHtml();getStyles();}
$('#homepageFiltersButtons > select').off('change.filter_ready_template').on('change.filter_ready_template', function() {var $this = $(this);that.filter = $this.find('option:selected').data('filter');that.filterType = $this.find('option:selected').data('filter-type');that.$container.find('.unique-styles-container .unique-styles').empty();that.$container.scrollTop(0);that.page = 1;that.skeletonesAmount = that.limit;getStyles();that.addLoadNextPageAbility();});});};that.addLoadNextPageAbility = function() {changeStatus(false);if ( that.$loadMore ) {that.$loadMore.on('click.styles_layouts_pag_ination', function() {if ( that.inProgress ) return;getStyles();});} else {that.$container.on('scroll.styles_layouts_pag_ination', function( e ) {var $this = $(this);var st = $this.scrollTop();if ( st > ( (that.$container[0].scrollHeight - that.$container[0].offsetHeight) * 0.80 ) ) {if ( that.inProgress ) return;getStyles();}});}};that.destroy = function() {if ( that.isMobile ) {that.$loadMore.off('click.styles_layouts_pag_ination');that.$loadMore.hide();} else {that.$container.off('scroll.styles_layouts_pag_ination');}};function getStyles() {if ( that.inProgress ) return;changeStatus(true);if ( that.skeletonesAmount > 0 ) {var template = '<div class="skeleton unique-styles-button-container">';template += '<div class="skeleton-item"></div>';template += '</div>';for ( var i = 0; i < that.skeletonesAmount ; i++ ) {that.$container.find('.unique-styles-container .unique-styles').append(template);}}
$.ajax({type: "POST",url: "/versions/2/wizard/modules/stylesLayoutArrayGetNextPage_v4.php",data: {w: websiteID,limit: that.limit,page: that.page,filter: that.filter,filterType: that.filterType},success: function( data ) {data = tryParseJSON(data);if ( !data ) {changeStatus(false);that.$container.find('.skeleton').remove();return;}
if ( data.noResults ) {changeStatus(false);that.destroy();that.$container.find('.skeleton').remove();} else {PrintUniqueStylesLayouts(data.styles,that.$container.find('.unique-styles-container'));that.page++;that.skeletonesAmount = data.nextPageAmount;if ( that.$container.is(':visible') && data.nextPageAmount > 0 ) {setTimeout( function() {if ( !(that.$container.get(0).scrollHeight > that.$container.height()) ) {getStyles();}},200);}}
$(document).one('ready_template.loaded.pagInation', function( event, images ) {for (var i = 0; i < images.length ; i++) {$(images[i].img).parent().css({ visibility: 'visible', position: 'relative' });}
that.$container.find('.skeleton').remove();changeStatus(false);if ( data.nextPageAmount === 0 ) {that.destroy();}});}});}
function changeStatus( inProgress ) {if ( inProgress ) {that.inProgress = true;if ( that.isMobile ) that.$loadMore.hide();} else {that.inProgress = false;if ( that.isMobile ) that.$loadMore.show();}}
function addPluginHtml() {that.$container.append($('<div class="unique-styles-container"><div class="unique-styles"></div></div>'));if ( that.isMobile ) {if ( $('#loadMore').length !== 0 ) $('#loadMore').remove();that.$loadMore = $('<div class="load-more-container text-center"><a id="loadMoreStyles" class="btn btn-primary">'+translations.loadmore+'</a></div>');that.$container.append(that.$loadMore);}
that.addLoadNextPageAbility();}
return that;}();function logoFontStyleHandler() {$('#siteLogoStyle').on('change.style_change',function() {ShowIconStyle();});$('#siteLogoImageStyle').on('change',function() {ShowIconStyle();});}
function homepageFontsWeightHandler() {var $homePageFontWeightHandler = $('.h-f-w-handler');if ( $homePageFontWeightHandler.length === 0 ) return;$.each($homePageFontWeightHandler, function( index, handler ) {var $handler = $(handler);var $originalEl = $($handler.data('original-el-id'));$originalEl.parent().addClass('hidden');$handler.on('click', function() {if ( $handler.hasClass('active') ) {$originalEl.val($originalEl.children('[data-is-bold="false"]').val());} else {$originalEl.val($originalEl.children('[data-is-bold="true"]').val());}
$originalEl.trigger('change');});$originalEl.on('change.font_weight', function() {if ( $originalEl.children(':selected').data('is-bold') ) {$handler.addClass('active');} else {$handler.removeClass('active');}});$originalEl.trigger('change.font_weight');});}
function addShowHideFontFamilySettingBox() {$('.font-family-demo-container').on('click.show_setting_box', function() {var $this = $(this);var $el = $this.find('.ff-demo');$el.blur();SettingsBoxHandler($el,$($el.data('s-b-id')));$this.find('i').removeClass('fa-caret-down').addClass('fa-caret-up');$($el.data('s-b-id')).one('settings_box_handler.hide', function() {$this.find('i').removeClass('fa-caret-up').addClass('fa-caret-down');});});}
function FitWizardTextToBox() {return;if ($('html').data('device') !== 'mobile') {setTimeout(function() {fitty('.wizardSideTabs > li > a > div > span', {minSize: 4,maxSize: 9});fitty('#sortable .manageWin span, #homepageAlternativeName_edit span', {minSize: 5,maxSize: 10});fitty('#savedStatus', {minSize: 5,maxSize: 10});},100);}}
function showHideStickyMenuSetting() {if ( $('#customTemplate').val() != '3' && $('#customTemplate').val() != '4' ) {$('.sticky-menu').fadeIn();} else {$('.sticky-menu').fadeOut();}}
function hexToRGB(hex, alpha) {var r = parseInt(hex.slice(1, 3), 16),g = parseInt(hex.slice(3, 5), 16),b = parseInt(hex.slice(5, 7), 16);if (alpha) {return "rgba(" + r + ", " + g + ", " + b + ", " + alpha + ")";} else {return "rgb(" + r + ", " + g + ", " + b + ")";}}
function updateUserText() {existingTitle1 = $('#home_siteSlogan').val();existingTitle2 = $('#home_siteSlogan_2').val();existingTitle3 = $('#home_SecondSiteSlogan').val();existingHomeButton1 = $('#home_buttonText').val();existingHomeButton2 = $('#home_buttonText_1').val();}
function FontsSelectInitialize() {window.fontSelect = {};$('.fontSelectNew').each(function(){var $this       = $(this);var id          = $this.attr('id');var value       = $this.data('value');var text        = $this.data('text');var tooltip     = $this.data('tooltip');var italicElID  = $this.data('italic-el-id');var demoSelector= $this.data('demo-selector');window.fontSelect[id] = new s123fontsSelect({$container: $(this).parent(),$originalEl: $(this),id: id,value: value,italicElID: italicElID,demoSelector: demoSelector,translations: {text: text,freeFontsList: translations.freeFontsList,tooltip: tooltip,moreFontsUpgradeMsg: translations.moreFontsUpgradeMsg,fontsSearchNoResult: translations.fontsSearchNoResult,fontsSearchPlaceHolder: translations.fontsSearchPlaceHolder}});});$(document).on('customFontsHandler.change.FontsSelectInitialize', function( event ) {$.each(window.fontSelect, function( index, fontSelect ) {fontSelect.reset();});});customFontsHandler.init();}
function s123fontsSelect( settings ) {var that = this;if ( !settings ) return;that.$container = settings.$container;that.id = settings.id;that.value = settings.value ? settings.value : '';that.italicElID = settings.italicElID;that.translations = settings.translations;that.$originalEl = settings.$originalEl;that.demoSelector = settings.demoSelector;that.websiteFonts = getWebsiteFonts();that.$html = $(generateHtml());that.$searchInput = that.$html.find('#searchInput_'+that.id);that.$hiddenInput = that.$html.find('#'+that.id);that.$fontsList = that.$html.find('.fonts-list');that.$fontGroup = that.$html.find('.font-group');that.$noResult = that.$html.find('.no-result');that.$originalEl.replaceWith(that.$html);that.$demoEl = $(that.demoSelector);that.$container.find('label[for="'+that.id+'"]').addClass('selected-font-label');$('<label class="selected-font-text">: <span>'+that.value+'</span></label>').insertBefore(that.$html);that.$fontsList.find('.items').on('click','.fonts-item', function() {var $this = $(this);that.$hiddenInput.val($this.data('value')).trigger('change');AutoSaveWizard(false,true);Wizard.render.init({[that.$hiddenInput.get(0).id]: $this.data('value')});});addPluginAbilities();searchHandler();that.refresh = function() {that.$fontsList.find('.fonts-item').removeClass('active');that.$fontsList.find('[data-value="'+that.$hiddenInput.val()+'"]').addClass('active');that.$container.find('.selected-font-text').html(': <span>'+that.$hiddenInput.val()+'</span>');that.$hiddenInput.trigger('change.demo_element_update');var $element = that.$fontsList.find('.active');var fontGroup = $element.parent().data('value');var family = $element.data('value');var isItalic = 0;if ( !that.websiteFonts[fontGroup] ) return;$.each(that.websiteFonts[fontGroup], function( index, font ) {if ( family == font.name ) {isItalic = font.italic;return false;}});if ( websiteFonts[that.$hiddenInput.get(0).id] ) {websiteFonts[that.$hiddenInput.get(0).id].isItalicSupported = isItalic;}};that.reset = function() {if ( that.infiniteScroll ) {that.infiniteScroll.destroy();that.infiniteScroll = null;}
that.websiteFonts = getWebsiteFonts();that.$fontGroup.children('.fonts-item').remove();resetFontGroupVisbilty();};function getWebsiteFonts() {var website_language = $('#language').val();if ( website_language === 'he' ) {return {"Custom Fonts": Array(),"Hebrew": Array(),"Latin": Array(),"Cyrillic": Array(),"Arabic": Array(),"Tamil": Array(),"Global": Array(),};} else if ( website_language === 'ar' || website_language.substring(0,3)  === 'ar-' ) {return {"Custom Fonts": Array(),"Arabic": Array(),"Latin": Array(),"Cyrillic": Array(),"Tamil": Array(),"Hebrew": Array(),"Global": Array(),};} else {return {"Custom Fonts": Array(),"Latin": Array(),"Cyrillic": Array(),"Arabic": Array(),"Tamil": Array(),"Hebrew": Array(),"Global": Array(),};}}
function addPluginAbilities() {that.$hiddenInput.on('change.font_changed', function() {that.refresh();});that.$hiddenInput.on('change.demo_element_update', function() {that.$demoEl.val($(this).val());$(document).trigger('s123.fonts.selected');});that.$demoEl.on('click.fonts_infinite_scroll', function() {if ( !that.infiniteScroll ) {resetSearchHandler();addInfiniteScroll();}});}
function generateHtml() {var html = '';html += '<div class="s123-fonts">';html += '<div class="input-group search-fonts-container">';html += '<input id="searchInput_'+that.id+'" type="text" class="form-control search-query" placeholder="'+that.translations.fontsSearchPlaceHolder+'">';html += '<span id="searchFontsIcon_'+that.id+'" class="fal fa-search form-control-feedback search-fonts-icon"></span>';html += '</div>';if ( that.translations.tooltip ) html += '&nbsp;<a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+that.translations.tooltip+'"><i class="fal fa-question-circle"></i></a>';html += '<div class="fonts-list fancy-scrollbar">';html += '<div class="items">';for ( fontGroup in that.websiteFonts ) {html += '<div class="font-group" data-value="'+fontGroup+'">';html += '<label class="font-group-text">'+fontGroup+'</label>';html += '</div>';}
html += '</div>';html += '<label class="no-result">'+that.translations.fontsSearchNoResult+'</label>';html += '</div>';html += '<input type="hidden" name="'+that.id+'" id="'+that.id+'" class="s123-fonts-hidden-input" value="'+that.value+'">';html += '</div>';return html;}
function generateFontItemHtml( font ) {var html = '';html = '<div class="fonts-item '+(that.value === font.name ? 'active' : '')+'" data-value="'+font.name+'">';if ( !font.isCustomFont ) {var fontImage = $GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/fontsImages/v5/normal_'+encodeURIComponent(font.name.replace(/ /ig,"_"))+'_f_black.png?v=3';html += '<div class="fonts-item-preview-image" style="background-image:url('+fontImage+');"></div>';} else {html += '<div class="fonts-item-preview-image">';html += '<span>'+escapeHtml(font.name)+'</span>';html += '</div>';}
html += '<div class="fonts-item-selected"><i class="ace-icon fal fa-check-circle green"></i></div>';html += '</div>';return html;}
function resetFontGroupVisbilty() {$.each(that.$fontGroup, function( index, group ) {if ( $(this).find('.fonts-item').length > 0 ) {$(this).removeClass('hidden');} else {$(this).addClass('hidden');}});}
function addInfiniteScroll() {that.reset();that.infiniteScroll = new s123InfiniteScroll({isMobile: false, // we don't want to add "load more button" but we have other tools that do need that feature
$container: that.$html.find('.fonts-list'),ajax: {type: 'POST',url: '/versions/2/wizard/modules/wizardInfiniteScroll_v4.php',data: {w: $('#id').val(),website_language: $('#language').val(),type: 's123Fonts',limit: 50,},success: function( data ) {$.each(data.items, function(index, font) {that.websiteFonts[font.subset].push(font);if ( font.oldCustomersSupport && that.value !== font.name ) return;that.$fontGroup.filter('[data-value="'+font.subset+'"]').append(generateFontItemHtml(font));});resetFontGroupVisbilty();}}});}
function searchHandler() {var $searchLoading = $('<div class="search-loading text-center" style="width: 100%; padding: 10px; display: none;"><div class="loading-icon" style="width: 100%;"><i class="ace-icon fal fa-spinner fa-solid fa-spin fa-2x"></i></div></div>');that.$fontsList.append($searchLoading);that.$searchInput.onEnterKey( function( event ) {resetOrSearch(this,0);});that.$searchInput.on('input', function( event ) {resetOrSearch(this,doneTypingInterval_Short);});function resetOrSearch( input, interval ) {clearTimeout(input.finishedTyping);input.finishedTyping = setTimeout( function() {if ( that.$searchInput.val().length === 0 ) {resetSearchHandler();resetFontGroupVisbilty();addInfiniteScroll();} else {that.reset();search(that.$searchInput.val());}},interval);}
function search( fontName ) {that.$noResult.hide();$searchLoading.show();$.ajax({type: 'POST',url: '/versions/2/wizard/s123Fonts/searchFonts.php',data: {w: websiteID,fontName: fontName},success: function( data ) {data = tryParseJSON(data);if ( !data ) return;if ( data.items.length > 0 ) {that.$noResult.hide();$.each(data.items, function(index, font) {that.websiteFonts[font.subset].push(font);if ( font.oldCustomersSupport && that.value !== font.name ) return;that.$fontGroup.filter('[data-value="'+font.subset+'"]').append(generateFontItemHtml(font));});} else {that.$noResult.show();}
$searchLoading.hide();resetFontGroupVisbilty();that.$searchInput.focus();}});}}
function resetSearchHandler() {that.$fontGroup.find('.font-item').remove();that.$searchInput.val('');that.$noResult.hide();}
return that;}
function showWebsiteTypeVideo( videoNum ) {var video1 = $('.website-type-video[data-video-num="1"]');var video2 = $('.website-type-video[data-video-num="2"]');if ( videoNum == 1 ) {video1.removeClass('hideVideoType');video2.addClass('hideVideoType');} else {video1.addClass('hideVideoType');video2.removeClass('hideVideoType');}}
function wizardPublish() {SaveWizard();if( isWizardChange == false ) {SystemModals.sm_render({id: 'publishSiteModal',disposable: false,$parent: $('body'),sizeClasses: 'size-s2',headerSettings: {title: translations.Publish,},bodySettings: { // body settings
content: '<iframe id="PublishSiteMethod" src="/versions/2/wizard/publishSite.php?w='+$('#id').val()+'&id='+$('#id').val()+'&theme='+$('#enable_as_theme').val()+'&language='+$('#language').val()+'&wesiteNameChange='+$('#wesiteNameChange').val()+'" style="height: 280px;"></iframe>',},footerSettings: { // footer settings
isActive: false,buttons: []},hideCallback: function ( event, modal ) {}});var $publishSiteModal = SystemModals.sm_get('publishSiteModal');$publishSiteModal.$html.find('.modal-body').css('background-color','transparent');$publishSiteModal.show();}}
function isLastAndCurrentChangesEquel( currentChange ) {if( tools_manage_is_change == true ) return false;if( window.wizardLastChanges != currentChange ) return false;return true;}
Wizard.NavBar = function() {var _ = {$menus: null};_.init = function() {temporarySettingsTabHandler();temporaryDesignTabHandler();_.$menus = $('.wizard-design-tab, .wizard-settings-tab');_.$menus.each(function(index, el) {var $this = $(this);var $controller = $this.find('[data-s123-drop-down-role="controller"]');$controller.on('mouseenter.NavBar', function( event ) {$controller.addClass('disable-open-wizard-tab');$(document).trigger('wizardNavbar.mouseenter',[$controller.data('tab-id')]);});$controller.on('mouseleave.NavBar', function( event ) {$controller.removeClass('disable-open-wizard-tab');});$this.find('[data-s123-drop-down-role="dropdown"] a').on('click.NavBar', function( event ) {var $parent = $(this).closest('li');$parent.siblings().removeClass('active');$parent.addClass('active');});$(document).on('wizard_tabs_opened.Wizard.NavBar wizard_tabs_closed.Wizard.NavBar',function() {_.removeActiveLink();});});};_.removeActiveLink = function( tabID ) {_.$menus.find('[data-s123-drop-down-role="dropdown"] li').removeClass('active');};function temporaryDesignTabHandler() {$('.wizard-design-tab .wizard-design-nav a').on('click', function( event ) {event.preventDefault();Wizard.tabEffectHandler.AnimationManager.designTab.hide();Wizard.tabEffectHandler.AnimationManager.designTab.$tab.find('.t-h-e-manual-static').attr('data-visible','false');OpenWizardTab('designTab',true);if ( $(this).data('open-design-tab') == 'colors' && $('#isCustomColorsBOO').val() == 1 ) {Wizard.tabEffectHandler.designTabHandler.showCustom($('#showColors'));} else {Wizard.tabEffectHandler.AnimationManager.designTab.$tab.find('.t-h-e-header-back-btn').hide();Wizard.tabEffectHandler.AnimationManager.designTab.$tab.find('#accordion_design').removeClass('back-btn-h');}
switch( $(this).data('open-design-tab') ) {case 'colors':Wizard.tabEffectHandler.AnimationManager.designTab.$tab.find('.t-h-e-manual-static').attr('data-visible','true');Wizard.tabEffectHandler.AnimationManager.designTab.$tab.find('.t-h-e-manual-static .text-container').text($(this).data('static-tab-title-text'));Wizard.tabEffectHandler.designTabHandler.innerTabsHanler.$linkContainer.find('[data-tab="colorThemes"]').trigger('click');break;case 'fonts':Wizard.tabEffectHandler.AnimationManager.designTab.$tab.find('.t-h-e-manual-static').attr('data-visible','true');Wizard.tabEffectHandler.AnimationManager.designTab.$tab.find('.t-h-e-manual-static .text-container').text($(this).data('static-tab-title-text'));Wizard.tabEffectHandler.designTabHandler.innerTabsHanler.$linkContainer.find('[data-tab="fontThemes"]').trigger('click');break;case 'header':Wizard.tabEffectHandler.designTabHandler.innerTabsHanler.$linkContainer.find('[data-tab="more"] #showMenuOptions').trigger('click');break;case 'footer':Wizard.tabEffectHandler.designTabHandler.innerTabsHanler.$linkContainer.find('[data-tab="more"] #showFooterOptions').trigger('click');break;case 'mobile':Wizard.tabEffectHandler.designTabHandler.innerTabsHanler.$linkContainer.find('[data-tab="more"] #showMobile').trigger('click');Wizard.Preview.Scale.deviceButtonsClick($('#previewScaleDevices').find('li[data-device-type="mobile"]'));$('#websitePreviewIframe').attr('data-design-mobile-preview',true);break;case 'websiteBackground':Wizard.tabEffectHandler.designTabHandler.innerTabsHanler.$linkContainer.find('[data-tab="more"] #showWebsiteBackground').trigger('click');break;case 'websiteSructure':Wizard.tabEffectHandler.designTabHandler.innerTabsHanler.$linkContainer.find('[data-tab="more"] #showAdvancedStructure').trigger('click');if ( abTestTXT == 'siteEditor_b' ) {var modules = tryParseJSON(topWindow.tools_manage);if ( modules ) {var modulesArrID = '';$.each(modules, function(index, module) {if ( module.moduleTypeNUM != 169 ) return;modulesArrID = module.modulesArrID;});if ( modulesArrID != '' ) {if ( [169,169030,169025,169024,169023,169038,169042,169026,169029,169036,169037,169043,169048,169049,169050,169055,169056,169051].indexOf(parseInt(modulesArrID)) != -1 ) {showHideStructuresWithOpacity('show');} else {showHideStructuresWithOpacity('hide');}}}}
break;}});showHideWebsiteBGOptionsLink();$('#template').off('change.setUserTheme').on('change.setUserTheme', function() {showHideWebsiteBGOptionsLink();});function showHideWebsiteBGOptionsLink() {var header_width = $('#header_width').val();if ( header_width == 'fullbox' || header_width == 'flyfullbox') {Wizard.tabEffectHandler.designTabHandler.$themsContainer.find('#showWebsiteBackground').show();$('.wizard-design-tab [data-open-design-tab="websiteBackground"]').parent().show();} else {Wizard.tabEffectHandler.designTabHandler.$themsContainer.find('#showWebsiteBackground').hide();$('.wizard-design-tab [data-open-design-tab="websiteBackground"]').parent().hide();}}}
function temporarySettingsTabHandler() {$('.wizardSideTabs .wizard-settings-nav a').on('click', function( event ) {event.preventDefault();if ( !$('#settingsTab').is(':visible') ) {OpenWizardTab('settingsTab',false);}
Wizard.tabEffectHandler.AnimationManager.settingsTab.$tabLinks.find('[href="#'+$(this).data('open-accordion')+'"]').trigger('click');if ( $(this).data('open-accordion') == 'collapsePwa' ) {Wizard.Preview.Scale.deviceButtonsClick($('#previewScaleDevices').find('li[data-device-type="app"]'));$('#websitePreviewIframe').attr('data-settings-app-preview',true);}});}
return _;}();function LinearGradientParser( gradient ) {gradient = gradient.replace('linear-gradient(', '');gradient = gradient.replace(')', '');var obj = {linearAngle: 0,stops: []}
var arr = gradient.split(',');if (arr.length < 3) return obj;var num = ( 1 / (arr.length - 2) );var location = 0;$.each(arr, function(index,value){if ( index == 0 ) {obj.linearAngle = value.replace('deg','');} else {obj.stops.push({color: value.replace(' ',''),location: location});location += num;}});return obj;}
function ChangeWizardTheme() {var $site123Logo = $('#wizardTab0button img.site123Test');light_mode = 0;if ( light_mode == 1 ) {$('body').addClass('wizard-theme-light');$site123Logo.data('dark-logo',$site123Logo.attr('src'));$site123Logo.attr('src',$site123Logo.data('ligth-logo'));} else {$('body').removeClass('wizard-theme-light');if ( $site123Logo.data('dark-logo') ) {$site123Logo.attr('src',$site123Logo.data('dark-logo'));}}}
Wizard.promoFonts = function() {var _ = {$json: $('#promoFonts')};_.init = function() {var promoFonts = tryParseJSON(_.$json.val());if ( !promoFonts ) {promoFonts = {};}
websiteFonts.promoFonts = promoFonts;};_.save = function( moduleID, settingName, newTheme, isPreviewReloadStatus = true ) {var fontObj = new FontObject({name: newTheme.name,isItalicSupported: newTheme.italic});if ( !websiteFonts.promoFonts[moduleID] ) websiteFonts.promoFonts[moduleID] = {};websiteFonts.promoFonts[moduleID][settingName] = fontObj;_.$json.val(JSON.stringify(websiteFonts.promoFonts));window.reloadPreviewCSS = ReloadPreviewCSS;AutoSaveWizard(isPreviewReloadStatus,true);};_.getfontName = function( settingName, moduleID ) {return getfontObj(settingName,moduleID).name;};_.isItalicSupported = function( settingName, moduleID ) {return getfontObj(settingName,moduleID).isItalicSupported;};function getfontObj( settingName, moduleID ) {var defaultFontObj = new FontObject({name: $('#global_font').val(),isItalicSupported: websiteFonts.global_font});if ( !websiteFonts.promoFonts[moduleID] ) return defaultFontObj;if ( !websiteFonts.promoFonts[moduleID][settingName] ) return defaultFontObj;return websiteFonts.promoFonts[moduleID][settingName];}
function FontObject( data ) {var def = {name: $('#global_font').val(),isItalicSupported: websiteFonts.global_font};if ( data ) {data = objectAssign(def,data); // (objectAssign overwrite objects)
} else {data = def;}
return data;}
return _;}();function smartMobileMenuManager() {if ( $('html[data-device="mobile"]').length > 0 ) return;let isMenuOpen = false;$(document).on('wizard.preview.device.changed', function( event, deviceType ) {if ( !Wizard.Preview.ready ) return;if ( isMenuOpen && deviceType == 'computer' ) {Wizard.Preview.closePopups();}});$('#websitePreviewIframe').on('load.mobileMenuType', function() {if ( !Wizard.Preview.ready ) return;isMenuOpen = false;Wizard.Preview.$(Wizard.Preview.window.document).on('build_popup.open', function( event ) {isMenuOpen = Wizard.Preview.$('#popupFloatDivMenu.is-mobile').length > 0;if ( isMenuOpen ) {Wizard.Preview.$(Wizard.Preview.window.document).one('build_popup.close', function( event ) {isMenuOpen = false;});}});});$('#mobileMenuType').on('change', function( event ) {$('#websitePreviewIframe').one('load.mobileMenuType', function() {if ( !Wizard.Preview.ready ) return;if ( Wizard.Preview.Scale.mode != 'mobile' ) return;if ( !isMenuOpen ) {Wizard.Preview.$('.header-menu-wrapper .mobile-menu-btn').trigger('click');}});});$('#mobileMenuColor,#mobileMenuTextAlign').on('change', function( event ) {if ( !Wizard.Preview.ready ) return;if ( Wizard.Preview.Scale.mode != 'mobile' ) return;if ( !isMenuOpen ) {Wizard.Preview.$('.header-menu-wrapper .mobile-menu-btn').trigger('click');}});$('#mobileMenuFontSize,#mobileMenuPagesSpace').on('input change', function( event ) {if ( !Wizard.Preview.ready ) return;if ( Wizard.Preview.Scale.mode != 'mobile' ) return;if ( !isMenuOpen ) {Wizard.Preview.$('.header-menu-wrapper .mobile-menu-btn').trigger('click');}});$('#mainNavMobileHeight').on('input change', function( event ) {if ( !Wizard.Preview.ready ) return;if ( isMenuOpen ) {Wizard.Preview.closePopups();}});}
function ArrangeCallToActionsButtons() {var isActive = {address: $('#showHeaderAddress:checked').val() == 'on',social: $('#showHeaderSocial:checked').val() == 'on',search: ($('#showHeaderSearch:checked').val() == 'on' && OpenPremiumFeatures(packageNUM) > '1'),cart: ($('#showHeaderCart:checked').val() == 'on' && !$('#showHeaderCart:checked').closest('.checkboxSingleSetting').hasClass('disableToggle')),email: $('#showHeaderEmail:checked').val() == 'on',phone: $('#showHeaderPhone:checked').val() == 'on',clientZone: ($('#showHeaderClientZone:checked').val() == 'on'&& !$('#showHeaderClientZone:checked').closest('.checkboxSingleSetting').hasClass('disableToggle')),};var $box = $('#headerCallToActionsButtonsBox');var $container = $box.find('.headerCallToActionsButtons');var $input = $box.find('#headerCallToActionsButtons');var $loading = '<div class="loadingMessage"><i class="ace-icon fal fa-spinner fa-solid fa-spin"></i></div>';var actionsButtonsList = {};var html = '';var icons = {phone: 'phone',email: 'envelope',address: 'location-arrow',social: 'share-alt',cart: 'shopping-cart',clientZone: 'user',search: 'search',}
$container.html('').append($loading);if ( $input.val().length > '0' ) {actionsButtonsList = tryParseJSON($input.val());if ( actionsButtonsList == false ) {actionsButtonsList = {};}}
$('.update-actions-buttons-position').one('change',function() {if ( $box.hasClass('open') ) {$box.find('.content').slideToggle();$box.removeClass('open');}});$.each(isActive, function( button, isActive ) {if ( !isActive && actionsButtonsList.hasOwnProperty(button) ) {delete actionsButtonsList[button];} else if ( !isActive || actionsButtonsList.hasOwnProperty(button) ) {return;} else {actionsButtonsList[button] = '';}});if ( Object.keys(actionsButtonsList).length > 0 ) {html = '<ul>';$.each(actionsButtonsList, function( button ) {html += '<li class="ui-state-default" data-btn="'+button+'">'
html += '<span class="ui-icon ui-icon-arrowthick-2-n-s"></span>';if ( icons[button] && icons[button].length > 0 ) {html += '<span class="arrange-action-btn-icon"><i class="fa fa-'+icons[button]+'"></i></span>';}
html += translations[button];html += '</li>';});html += '</ul>';} else {html = '<span>' + translations.missingHeaderCallToActionButtons + '</span>';}
var $html = $(html);$html.sortable({update: function( event, ui ) {var buttons = {};$html.find('li').each(function() {buttons[$(this).data('btn')] = '';});$input.val(JSON.stringify(buttons)).trigger('change');}});$container.html('').append($html);}
function LandingPage_HideNotInUseInputs() {$('.return-to-mobile-settings-btn').fadeOut();$('.s123-mobile-settings').closest('.s123-collapse-settings').addClass('not-in-use-in-landing-page');$('.sticky-menu').addClass('not-in-use-in-landing-page');$('#menu_pages_space').closest('.form-group').addClass('not-in-use-in-landing-page');$('#menu_pages_side_padding').closest('.form-group').addClass('not-in-use-in-landing-page');$('#menu_pages_letter_spacing').closest('.form-group').addClass('not-in-use-in-landing-page');$('#menu_pages_word_spacing').closest('.form-group').addClass('not-in-use-in-landing-page');$('#hideMenuSeperator').closest('.menu-separate-line').addClass('not-in-use-in-landing-page');$('#header_font_style').closest('.form-group').addClass('not-in-use-in-landing-page');$('#menu_pages_style').closest('.form-group').addClass('not-in-use-in-landing-page');if ( abTestTXT != 'siteEditor_b' ) {$('#header_opacity').closest('.form-group').addClass('not-in-use-in-landing-page');}}
Wizard.websiteLogoMakerTool = function() {var _ = {s123InfiniteScroll: {icons: null,fonts: null,styles: null},iconQuery: '',fontQuery: '',iconFilter: '',noTextStyles: ['logoStyle_12','logoStyle_13','logoStyle_14','logoStyle_6','logoStyle_7','logoStyle_8','logoStyle_5'],saveLogoObj: {style: '',font: '',icon: '',textSettingsChange: false,textWeight: $('#logo_text_size_weight').val()},notSupportStylesArray: ['logoStyle_43','logoStyle_44','logoStyle_12','logoStyle_13','logoStyle_14','logoStyle_6','logoStyle_7','logoStyle_8','logoStyle_5','default','logoStyle_19','logoStyle_20','logoStyle_21','logoStyle_22','logoStyle_23','logoStyle_24'],isLoadCss: true,};_.init = function() {addLogoChangeListener();_.activeTab   = 'icons';loadCategories();_.$container          = $(generateHtml());_.$logoStyles         = _.$container.find('#logoStyles');_.$logoIcons          = _.$container.find('#logoIcons');_.$logoFonts          = _.$container.find('#logoFonts');_.$logoText           = _.$container.find('#logoText');_.$siteLogoStyle      = $('#siteLogoStyle');_.$siteLogoImageStyle = $('#siteLogoImageStyle');_.logo = topWindow.uploadFiles.siteLogo.input.val();_.logoID = '';_.$container.one('shown.bs.modal', function (e) {_.loadCss();});_.$container.on('shown.bs.modal', function (e) {if ( _.$logoFonts.find('.l-f-items .l-f-box').length > 0 && $('#defaultWebsiteFont').val() == '2' ) {_.updateFontsPreview('');}});_.$container.find('#logoStyleTabs').on('click','.logo-tab',function(event) {$(this).addClass('active');$(this).siblings().removeClass('active');_.activeTab = $(this).data('tab');_.ShowTabContainer(_.activeTab);if ( _.activeTab == 'fonts' ) {_.printFonts(_.activeTab,'',false);} else if ( _.activeTab == 'icons' ) {_.$logoIcons.find('#logoIconSearch_input').val('');_.$logoIcons.find('.s123-logo-maker-icon-categories').removeClass('hide-container');_.$logoIcons.find('.logoLogoInlineLibrary').addClass('hide-container');_.$logoIcons.find('.l-i-items').html('');if ( _.s123InfiniteScroll['icons'] ) {_.s123InfiniteScroll['icons'].destroy();}
_.$logoIcons.find('.logoLogoFilter').addClass('hide-container');_.iconFilter = '';}});initializeIconsTab();_.$logoFonts.find('#logoFontSearch_input').on('keydown', function( event ) {var $this = $(this);var eventKey = event.which;if ( _.fontQuery == $this.val() ) return;clearTimeout(this.searchLibraryInputFinished);if ( eventKey == 13 ) {_.printFonts(_.activeTab,$this.val(),true);} else {this.searchLibraryInputFinished = setTimeout( function() {_.printFonts(_.activeTab,$this.val(),true);},1000);}});initializeTextTab();_.$container.find('.SubmitButtonsArea .logoMakerClose').on('click',function(){_.hide();});_.$container.find('.SubmitButtonsArea .logoMakerSave').on('click',function(){_.save();});supportIconTextSpacing(getLogoType(_.logo) == 'img' ? $('#siteLogoImageStyle').val() : $('#siteLogoStyle').val(),false);showLogoSizeSlider(_.logo);$('#logoMakerPromoteBox').on('click',function(){$('#siteLogo_iconMaker').trigger('click');});if ( packageNUM == 1 ) {$('#siteFavicon_preview').hide();$('#siteFavicon_removeBtn').hide();}};function showLogoSizeSlider( logo ) {if ( getLogoType(logo) == 'img' ) {_.$logoText.find('#logoMaker_logo_size_slider').closest('.s123-slider').hide();} else {_.$logoText.find('#logoMaker_logo_size_slider').closest('.s123-slider').show();}}
function addLogoChangeListener() {var uploadFile = getUploadFileObjectByID('siteLogo');var uploadFile_favicon = getUploadFileObjectByID('siteFavicon');uploadFile.input.on('change', function( event, s3Obj, flagStatus ) {if ( $(this).val() == '' ) {_.resetLogoStyle();_.printStyles(true,true,'');}
if ( s3Obj && getLogoType($(this).val()) != 'svg' ) {$('#siteLogoImageStyle').val('default');_.printStyles(true,true,'');} else if ( s3Obj ) {$('#siteLogoStyle').val('logoStyle_1');$('#logoIconStyle').val('colored');_.printStyles(true,true,'');}
if ( flagStatus == 'UndoRedoChange' ) {_.printStyles(true,true,'');}
if ( flagStatus == 'UndoRedoChange' ) return;if ( !s3Obj ) {$('#hasNoBgLogo').val('');} else if ( !s3Obj.isSupportNoBG ) {$('#hasNoBgLogo').val('');} else {$('#hasNoBgLogo').val('1');}
$('#newBoBG').val('1');});uploadFile_favicon.input.on('change',function() {if ( packageNUM == 1 ) {$('#siteFavicon_preview').hide();$('#siteFavicon_removeBtn').hide();}});}
_.show = function( inputID, library ) {if ( !topWindow.uploadFiles[inputID] ) return;_.saveLogoObj.textWeight = $('#logo_text_size_weight').val();_.$container.modal('show');_.updatePreviewCss(!_.isLoadCss);};_.hide = function() {_.$container.modal('hide');_.resetLogoStyle();_.printStyles(true,true,'');_.saveLogoObj =  {style: '',font: '',icon: ''};};_.resetLogoStyle = function() {_.logo = topWindow.uploadFiles.siteLogo.input.val();var logo_type = getLogoType(_.logo);if ( logo_type == 'img' ) {_.logoID =  $('#siteLogoImageStyle').val();} else {_.logoID = $('#siteLogoStyle').val();}}
_.updatePreviewCss = function( loadCss ) {if ( !loadCss ) {return;}
_.resetLogoStyle();var marginType = $('html[dir=rtl]').length !== 0 ? 'margin-left' : 'margin-right';_.$container.find('#logoMakerPreview .logo_name div:not(.logoLayout):not(.svg-m),#logoMakerPreview .img-responsive,#logoMakerPreview .logoLayout_text').css(marginType,Number($('#logo_icon_text_spacing').val()));if ($('#logo_font_size').val() != _.$logoText.find('#logoMaker_logo_font_size').val() ) {_.$logoText.find('#logoMaker_logo_font_size_view').find('.slider-input-value').val($('#logo_font_size').val()).trigger('input');}
if ($('#logo_size').val() != _.$logoText.find('#logoMaker_logo_size').val() ) {_.$logoText.find('#logoMaker_logo_size_view').find('.slider-input-value').val($('#logo_size').val()).trigger('input');}
if ($('#logo_text_letter_spacing').val() != _.$logoText.find('#logoMaker_logo_text_letter_spacing').val() ) {_.$logoText.find('#logoMaker_logo_text_letter_spacing_view').find('.slider-input-value').val($('#logo_text_letter_spacing').val()).trigger('input');}
if ($('#logo_text_word_spacing').val() != _.$logoText.find('#logoMaker_logo_text_word_spacing').val() ) {_.$logoText.find('#logoMaker_logo_text_word_spacing_view').find('.slider-input-value').val($('#logo_text_word_spacing').val()).trigger('input');}
if ($('#logo_icon_text_spacing').val() != _.$logoText.find('#logoMaker_logo_icon_text_spacing').val() ) {_.$logoText.find('#logoMaker_logo_icon_text_spacing_view').find('.slider-input-value').val($('#logo_icon_text_spacing').val()).trigger('input');}
loadFont($('#font_logo_demo').val());_.$logoStyles.css('font-family','"'+$('#font_logo_demo').val()+'",sans-serif');_.$container.find('.l-m-preview').css('font-family','"'+$('#font_logo_demo').val()+'",sans-serif');_.$container.find('#logoMakerPreview .l-m-preview').css({fontWeight: $('#logo_text_size_weight').val() == 'weight700' ? '700' : 'normal'});_.$logoStyles.css({fontWeight: $('#logo_text_size_weight').val() == 'weight700' ? '700' : 'normal'});if ($('#logo_text_size_weight').val() == 'weight700' ) {_.$logoText.find('.logo-bold-setting .btnSettings').addClass('active');} else {_.$logoText.find('.logo-bold-setting .btnSettings').removeClass('active');}
_.$logoText.find('#logoMaker_name').val($('#name').val());_.$logoText.find('#logoMaker_name').trigger('keydown');supportIconTextSpacing(getLogoType(_.logo) == 'img' ? $('#siteLogoImageStyle').val() : $('#siteLogoStyle').val(),true);showLogoSizeSlider(_.logo);}
_.save = function() {var uploadFile = getUploadFileObjectByID('siteLogo');var uploadFileFav = getUploadFileObjectByID('siteFavicon');var isUsingNoBgLogo = uploadFile.input.val().indexOf(getNoBgNameSpace()+'_') != -1;var imageNormal = uploadFile.input.val().replace(getNoBgNameSpace()+'_','');var type = _.saveLogoObj.icon ? getLogoType(_.saveLogoObj.icon) : getLogoType(_.logo);if (_.saveLogoObj.style) {if ( type == 'img' ) {_.$siteLogoImageStyle.val(_.saveLogoObj.style).trigger('change');} else if ( ['icon','svg','noLogo'].indexOf(type) != -1 ) {_.$siteLogoStyle.val(_.saveLogoObj.style).trigger('change');$('#wesiteNameChange').val('changed');}
if ( type == 'img' ) {if ( _.$container.find('.l-s-items .l-s-box.active').data('is-no-bg') ) {uploadFile.input.val(getImageWRV1('normal_'+getNoBgNameSpace(),imageNormal));} else {uploadFile.input.val(imageNormal);}
UpdateImagePreview('siteLogo',{normal: uploadFile.input.val(),tiny: getImageWRV1(100,uploadFile.input.val())});}
if ( _.notSupportStylesArray.indexOf(_.saveLogoObj.style) != -1  ) {$('#logo_icon_text_spacing_slider').closest('.s123-slider').hide();} else {$('#logo_icon_text_spacing_slider').closest('.s123-slider').show();}}
if (_.saveLogoObj.font) {var font = _.saveLogoObj.font;$('#font_logo').val(_.saveLogoObj.font).trigger('change');$(document).one('UpdatePreviewAreaByAjax.success',function() {if ( topWindow.Wizard.Preview.ready ) topWindow.Wizard.Preview.$document.trigger('site123.fonts.change',['font_logo',font]);});}
if (_.saveLogoObj.icon) {$('#logoIconStyle').val(_.saveLogoObj.icon_style);UpdateImagePreview('siteLogo',{normal: _.saveLogoObj.icon,tiny: _.saveLogoObj.icon});uploadFile.input.val(_.saveLogoObj.icon).trigger('change');UpdateImagePreview('siteFavicon',{normal: _.saveLogoObj.icon,tiny: _.saveLogoObj.icon});uploadFileFav.input.val(_.saveLogoObj.icon).trigger('change');}
updateLogoTextSettings();if ( !checkChanges(_.saveLogoObj) ) {window.reloadPreviewCSS = ReloadPreviewCSS;if ( getLogoType(_.logo) == 'img') {AutoSaveWizard(true,true);} else {AutoSaveWizard(false,true);_.refreshWizardPreview();}
_.saveLogoObj =  {style: '',font: '',icon: ''}}
_.$container.modal('hide');}
_.refreshWizardPreview = function() {$("#wizardForm").one('ajaxSuccess', function( event ) {if ( abTestTXT != 'siteEditor_b' ) {UpdatePreviewAreaByAjax(['#header .s123-site-logo','#header .logo_name','#websiteHeader','#mainNavMobile .s123-w-l-s',],false,false,'');} else {UpdatePreviewAreaByAjax(['#header .s123-site-logo','#header .logo_name','#mainNav .s123-site-logo','#mainNavMobile .s123-w-l-s',],false,false,'');}});if ( abTestTXT != 'siteEditor_b' ) {Wizard.Preview.loseMenuTransparency();}};function loadFont( fontName ) {if ( $('head .g-f-loaded[data-font-name="'+fontName+'"]').length > 0 ) return;if ( customFontsHandler.isCustomFont(fontName) ) {var path = customFontsHandler.getPath(fontName);var extention = customFontsHandler.getPath(fontName).split('.').pop();var style = '';style += '<style class="g-f-loaded" data-font-name="'+escapeHtml(fontName)+'">';style += '@font-face {';style += 'font-family: '+escapeHtml(fontName)+';'
style += 'src: url('+path+'); format('+(extention == 'woff2' ? 'woff2' : 'woff')+');';style += '}';style += '</style>';$('head').append(style);} else {$('head').append('<link class="g-f-loaded" data-font-name="'+escapeHtml(fontName)+'" href="//fonts.googleapis.com/css?family='+escapeHtml(fontName)+':400&amp;display=swap" rel="stylesheet" type="text/css">');}}
function generateHtml() {var heighestHeightNUM = $(window).outerHeight(true) < 900 ? $(window).outerHeight(true) - 170 : 530;var html = '';html += '<div id="s123LogoMaker" class="modal s123-modal fade bs-example-modal-lg" tabindex="-1" role="dialog">';html += '<div class="modal-dialog modal-lg" role="document">';html += '<div class="modal-content">';html += '<div class="modal-header">';html += '<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>';html += '<h4 class="modal-title">' + escapeHtml(translations.s123LogoMaker.modalTitle) + '</h4>';html += '</div>';html += '<div class="modal-body" style="height:'+heighestHeightNUM+'px;">';html += '<div id="logoStyleTabs">';html += '<div class="logo-tab active" data-tab="icons">'+escapeHtml(translations.s123LogoMaker.tabs.icons)+'</div>';html += '<div class="logo-tab" data-tab="fonts">'+escapeHtml(translations.s123LogoMaker.tabs.fonts)+'</div>';html += '<div class="logo-tab" data-tab="styles">'+escapeHtml(translations.s123LogoMaker.tabs.layouts)+'</div>';html += '<div class="logo-tab" data-tab="text">'+escapeHtml(translations.s123LogoMaker.tabs.text)+'</div>';html += '</div>';html += '<div id="logoStylesBox">';html += '<div id="logoStyles" class="logo-option-tab tab-item-hidden fancy-scrollbar">';html += '<div class="l-s-items"></div>';html += '</div>';html += '<div id="logoIcons" class="logo-option-tab fancy-scrollbar">';html += '<div id="logoIconSearch">';html += '<input  id="logoIconSearch_input" type="text" maxlength="50" class="search form-control search-query input-transparent" placeholder="'+escapeHtml(translations.s123LogoMaker.searchIcons)+'">';html += '<span class="fal fa-search form-control-feedback logoIconSearch_icon"></span>';html += '<span class="fal fa-home searchStylesIconRemove" style="display: none;"></span>';html += '</div>';html += '<div class="logoLogoFilter hide-container">';html += '<div class="logo-icons-filter" data-filter="">'+escapeHtml(translations.s123LogoMaker.filter.all)+'</div>';html += '<div class="logo-icons-filter" data-filter="outline">'+escapeHtml(translations.s123LogoMaker.filter.outline)+'</div>';html += '<div class="logo-icons-filter" data-filter="glyph">'+escapeHtml(translations.s123LogoMaker.filter.glyph)+'</div>';html += '<div class="logo-icons-filter" data-filter="colored">'+escapeHtml(translations.s123LogoMaker.filter.colored)+'</div>';html += '</div>';html += '<div class="s123-logo-maker-icon-categories fancy-scrollbar">';for (var i = 0; i < _.categories.length; i++) {html += '<div class="s123-logo-maker-item" data-query="' + escapeHtml(_.categories[i].query) + '">';html += '<div class="s123-logo-maker-item-icon">';html += '<img src="'+escapeHtml(_.categories[i].src)+'">';html += '</div>';html += '<span class="s123-logo-maker-item-title">' + escapeHtml(_.categories[i].title) + '</span>';html += '</div>';}
html += '</div>';html += '<div class="logoLogoInlineLibrary fancy-scrollbar hide-container">';html += '<div class="l-i-items"></div>';html += '</div>';html += '</div>';html += '<div id="logoFonts" class="logo-option-tab tab-item-hidden fancy-scrollbar">';html += '<div id="logoFontSearch">';html += '<input  id="logoFontSearch_input" type="text" maxlength="50" class="search form-control search-query input-transparent" placeholder="'+escapeHtml(translations.s123LogoMaker.searchFonts)+'">';html += '<span class="fal fa-search form-control-feedback logoFontSearch_icon"></span>';html += '</div>';html += '<div class="logoFontInlineLibrary fancy-scrollbar">';html += '<div class="logoFontInlineLibrary-preview"></div>';html += '<div class="l-f-items"></div>';html += '</div>';html += '</div>';html += '<div id="logoText" class="logo-option-tab tab-item-hidden fancy-scrollbar">';html += '<div class="form-group">'
html += '<div class="fieldHeaders">';html += '<label for="name">'+escapeHtml(translations.s123LogoMaker.logoNameLabel)+'</label>';html += '<div class="input-group logo-bold-setting">';html += '<a tabIndex="-1" class="btn-mini btnSettings" href="#" data-rel="tooltip" title="'+escapeHtml(translations.s123LogoMaker.bold)+'" data-delay={"show":"500", "hide":"0"}><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="bold" class="svg-inline--fal fa-bold fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M314.52 238.78A119.76 119.76 0 0 0 232 32H48a16 16 0 0 0-16 16v16a16 16 0 0 0 16 16h16v352H48a16 16 0 0 0-16 16v16a16 16 0 0 0 16 16h208a128 128 0 0 0 128-128c0-49.49-28.38-91.92-69.48-113.22zM128 80h88a72 72 0 0 1 0 144h-88zm112 352H128V272h112a80 80 0 0 1 0 160z"></path></svg></a>';
html += '</div>';html += '</div>';html += '<input type="text" class="form-control empty-input-handler" id="logoMaker_name" name="logoMaker_name" value="'+$('#name').val()+'" required data-msg-required="This field is required." maxlength="50" data-scroll-preview="#page-top">';html += '</div>';html += '<div class="sliderInput" id="logoMaker_logo_font_size" data-text="'+translations.s123LogoMaker.sliderFontSize+'" data-value="'+$('#logo_font_size').val()+'" data-max="50" data-min="20" data-tooltip="" data-number-kind="1" data-design="twoLines"></div>';html += '<div class="sliderInput" id="logoMaker_logo_size" data-text="'+translations.s123LogoMaker.sliderLogoSize+'" data-value="'+$('#logo_size').val()+'" data-max="50" data-min="20" data-tooltip="" data-number-kind="1" data-design="twoLines"></div>';html += '<div class="sliderInput" id="logoMaker_logo_text_letter_spacing" data-text="'+translations.s123LogoMaker.sliderLetterSpace+'" data-value="'+$('#logo_text_letter_spacing').val()+'" data-max="10" data-min="-10" data-tooltip="" data-number-kind="1" data-design="twoLines"></div>';html += '<div class="sliderInput" id="logoMaker_logo_text_word_spacing" data-text="'+translations.s123LogoMaker.sliderWordSpace+'" data-value="'+$('#logo_text_word_spacing').val()+'" data-max="10" data-min="-10" data-tooltip="" data-number-kind="1" data-design="twoLines"></div>';html += '<div class="sliderInput" id="logoMaker_logo_icon_text_spacing" data-text="'+translations.s123LogoMaker.sliderIconTextSpace+'" data-value="'+$('#logo_icon_text_spacing').val()+'" data-max="20" data-min="0" data-tooltip="" data-number-kind="1" data-design="twoLines"></div>';html += '</div>';html += '</div>';html += '<div id="logoMakerPreview">';html += '<div class="l-m-preview">';html += '</div>';html += '</div>';html += '</div>';html += '<div class="SubmitButtonsArea form-actions">';html += '<button type="submit" class="logoMakerSave btn btn-success">'+escapeHtml(translations.Save)+'</button>';html += '<a class="logoMakerClose btn btn-link">'+escapeHtml(translations.Cancel)+'</a>';html += '</div>';html += '</div>';html += '</div>';html += '</div>';return html;}
_.ShowTabContainer = function( tab ) {if ( tab == 'icons' ) {_.$logoIcons.show();_.$logoStyles.hide();_.$logoFonts.hide();_.$logoText.hide();} else if ( tab == 'fonts' ) {_.$logoFonts.show();_.$logoStyles.hide();_.$logoIcons.hide();_.$logoText.hide();} else if ( tab == 'text' ) {_.$logoText.show();_.$logoStyles.hide();_.$logoIcons.hide();_.$logoFonts.hide();} else {_.$logoStyles.show();_.$logoIcons.hide();_.$logoFonts.hide();_.$logoText.hide();}}
_.itemsExists = function( tab ) {if ( tab == 'icons' ) {return _.$container.find('.l-i-items .l-i-box').length > 0;} else if ( tab == 'fonts' ) {return _.$container.find('.l-f-items .l-f-box').length > 0;} else {return _.$container.find('.l-s-items .l-s-box').length > 0;}}
_.printStyles = function( reload, updateLogoPreview , iconChange ) {if ( _.itemsExists(_.activeTab) && !reload ) return;_.$logoStyles.find('.l-s-items').empty();if ( _.s123InfiniteScroll[_.activeTab] ) {_.s123InfiniteScroll[_.activeTab].destroy();}
if ( _.$logoText.find('#logoMaker_name').val().length == 0 ) return;_.logo = topWindow.uploadFiles.siteLogo.input.val();var type = getLogoType(_.logo);var icon_style = $('#logoIconStyle').val();var siteLogo = _.logo;if ( iconChange && updateLogoPreview ) {type = getLogoType(iconChange.link);icon_style = iconChange.style;siteLogo = iconChange.link;}
var $previewHtml = '';_.s123InfiniteScroll[_.activeTab] = new s123InfiniteScroll({isMobile: false, // we don't want to add "load more button" but we have other tools that do need that feature
$container: _.$logoStyles,ajax: {type: 'POST',url: '/manager/logoMaker/getLogosStylesAjax.php',data: {w: $('#id').val(),websiteName:  _.$logoText.find('#logoMaker_name').val(),siteLogo: siteLogo,logoID: _.logoID,limit: 12},success: function( data ) {var uploadFile = getUploadFileObjectByID('siteLogo');var isUsingNoBgLogo = uploadFile.input.val().indexOf(getNoBgNameSpace()+'_') != -1;if ( isUsingNoBgLogo ) {addItems(data.items,true,data.currentLogo);} else {addItems(data.items,false,data.currentLogo);}
if ( data.currentLogo ) {_.$container.find('.l-m-preview').html(generateItemHTML(data.currentLogo,true));}
function addItems( items, showNoBgLogo, currentLogo ) {var uploadFile = getUploadFileObjectByID('siteLogo');var isUsingNoBgLogo = uploadFile.input.val().indexOf(getNoBgNameSpace()+'_') != -1;var imageNormal = uploadFile.input.val().replace(getNoBgNameSpace()+'_','');$.each(items, function( index, item ) {var $html = $(generateItemHTML(item,false));if ( type == 'img' ) {if ( showNoBgLogo ) {$html.find('img').attr('src',getImageWRV1('400_'+getNoBgNameSpace(),imageNormal));$html.data('is-no-bg',true);} else {$html.find('img').attr('src',getImageWRV1('400',imageNormal));$html.data('is-no-bg',false);}
if ( _.$siteLogoImageStyle.val() == $html.data('id') && isUsingNoBgLogo == $html.data('is-no-bg') ) {$html.addClass('active');}} else if ( currentLogo.siteLogoStyle == $html.data('id') ) {$html.addClass('active');}
$html.on('click', function() {var $this = $(this);_.$container.find('.l-m-preview').empty();$this.clone().appendTo(_.$container.find('.l-m-preview'));$this.addClass('active');$this.siblings().removeClass('active');_.$container.find('.l-m-preview i').remove();_.logoID = $this.data('id');_.saveLogoObj.style = $this.data('id');supportIconTextSpacing($this.data('id'),false);setLogoMakerPreviewCSS();});$html.find('a').on('click',function( event ) {event.preventDefault();});$html.find('.logo_name .website-name').html(_.$logoText.find('#logoMaker_name').val());_.$container.find('.l-s-items').append($html);});}
function generateItemHTML( item , preview ) {var html = '';html = '<div data-id="' + item.siteLogoStyle + '" class="l-s-box">';if ( type == 'svg' || type == 'icon' ) {html += icon_style == 'colored' ? item.html['colored'] : item.html[type];} else {html += item.html;}
if ( !preview ) {html += '<i class="ace-icon fal fa-check-circle"></i>';}
html += '</div>';return html;}
_.updatePreviewCss(_.isLoadCss);_.isLoadCss = false;setLogoMakerPreviewCSS();}}});};_.loadCss = function() {var websiteStyles = {mainColor: $('#global_main_color').val(),home_text_color: $('#home_text_color').val(),menu_text_color: $('#menu_text_color').val(),menu_color: $('#menu_color').val()};$.ajax({type: "POST",url: "/manager/logoMaker/getInterfaceCss.php",data: {w: $('#id').val(),websiteStyles: JSON.stringify(websiteStyles)},success: function( html ) {$('head').append('<style class="simple-logo-system">' + html + '</style>');_.resetLogoStyle();_.printStyles(true,false,'');}});};_.printIcons = function( tab , filter, search, reload ) {if ( _.itemsExists(tab) && !reload ) return;_.$logoIcons.find('.l-i-items').html('');if ( _.s123InfiniteScroll[tab] ) {_.s123InfiniteScroll[tab].destroy();}
_.$logoIcons.find('.logoLogoInlineLibrary').scrollTop(0);_.s123InfiniteScroll[tab] = new s123InfiniteScroll({isMobile: false, // we don't want to add "load more button" but we have other tools that do need that feature
$container: _.$logoIcons.find('.logoLogoInlineLibrary'),ajax: {type: "POST",url: "/files/vendor/s123IconsPopup/getIcons.php",data: {w: topWindow.websiteID,q: search,limit: 24,type: 's123Logo',siteLogo: true,filter: filter},success: function( data ) {addItems(data.items);function addItems( items ) {var uploadFile = getUploadFileObjectByID('siteLogo');var uploadFileFav = getUploadFileObjectByID('siteFavicon');$.each(items, function( index, item ) {var $html = $(generateItemHTML(item));$html.on('click', function() {if ( (getLogoType(_.logo) == 'img' && !_.saveLogoObj.icon) || ( _.logo == '' && !_.saveLogoObj.icon ) ) {_.logoID = 'logoStyle_1';}
_.printStyles(true,true,{'link': $(this).data('link'),'style': $(this).data('style')});if ( _.logo == '' && !_.saveLogoObj.icon ) {supportIconTextSpacing('logoStyle_1',false);}
showLogoSizeSlider($(this).data('link'));_.saveLogoObj.icon = $(this).data('link');_.saveLogoObj.icon_style = $(this).data('style');setLogoMakerPreviewCSS();});_.$logoIcons.find('.l-i-items').append($html);});function generateItemHTML( item ) {var html = '';html = '<div data-id="' + item.uniqueID + '" data-link="'+item.icon_link+'" data-style="' + item.style + '" class="l-i-box">';html += '<img src="' + item.icon_link + '?v=' + $GLOBALS['v-cache-long'] + '">';html += '</div>';return html;}}}}});};_.updateFontsPreview = function( fontName ) {const logoFontName = fontName ? fontName :$('#font_logo').val();const previewText = $('#defaultWebsiteFont').val() == '2' ? `Default - Website Font (${logoFontName})` : logoFontName;_.$logoFonts.find('.logoFontInlineLibrary-preview').html('');_.$logoFonts.find('.logoFontInlineLibrary-preview').append(`<div>${previewText}</div>`);}
_.printFonts = function( tab ,search, reload ) {var isFontModulesHeaderChanged = _.$logoFonts.find('.l-f-items .l-f-box').length > 1 && _.$logoFonts.find('.l-f-items .l-f-box:nth-child(2)').data('name') != $('#font_modules_header').val();if ( !isFontModulesHeaderChanged && (_.itemsExists(tab) && !reload) ) return;_.$logoFonts.find('.l-f-items').html('');if ( _.s123InfiniteScroll[tab] ) {_.s123InfiniteScroll[tab].destroy();}
var ajax_url = '/versions/2/wizard/modules/wizardInfiniteScroll_v4.php';var ajax_data = {w: $('#id').val(),website_language: $('#language').val(),type: 's123Fonts',limit: 12,websiteLogoPath: '',imageLogoInfo: '',search: ''}
var $font_logo = $('#font_logo');if ( search.length > 0 ) {ajax_url = '/versions/2/wizard/s123Fonts/searchFonts.php';ajax_data = {w: $('#id').val(),fontName: search}}
_.s123InfiniteScroll[tab] = new s123InfiniteScroll({isMobile: false, // we don't want to add "load more button" but we have other tools that do need that feature
$container: _.$logoFonts.find('.logoFontInlineLibrary'),ajax: {type: 'POST',url: ajax_url,data: ajax_data,success: function( data ) {addItems(data.items);function addItems( items ) {$.each(items, function( index, item ) {if ( item.oldCustomersSupport && $font_logo.val() !== item.name ) return;var $html = $(generateItemHTML(item));_.$logoFonts.find('.l-f-items').append(click($html));});function generateItemHTML( item ) {var html = '';html += '<div data-name="'+ item.name +'" class="l-f-box wizard-card wizard-theme ActiveScale design-themes" data-type="fontThemes">';if ( !item.isCustomFont ) {html += '<h2 class="themes-fonts-preview-image-all" style="background-image:url('+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/fontsImages/v5/normal_'+encodeURIComponent(item.name.replace(/ /ig,"_"))+'_f_black.png?v='+$GLOBALS['v-cache-long']+');">&nbsp;</h2>';} else {html += '<h2 class="themes-fonts-preview-image-all">'+escapeHtml(item.name)+'</h2>';}
html += '</div>';return html;}}}}});function click( $html ) {$html.on('click', function() {var $this = $(this);var fontName = $this.data('name');$('#defaultWebsiteFont').val('1');if ( fontName == 'default') {fontName = $('#font_modules_header').val();$('#defaultWebsiteFont').val('2');}
loadFont(fontName);_.$logoStyles.css('font-family','"'+fontName+'",sans-serif');_.$container.find('.l-m-preview').css('font-family','"'+fontName+'",sans-serif');_.saveLogoObj.font = fontName;_.updateFontsPreview(fontName);});return $html;}
_.$logoFonts.find('.l-f-items').prepend(click($(`
<div id="logoMakerDefualtFont" data-name="default" class="l-f-box wizard-card wizard-theme ActiveScale design-themes" data-type="fontThemes">
<h2 class="themes-fonts-preview-image-all themes-fonts-default">Default - Website Font</h2>
</div>
`)));_.updateFontsPreview('');};function setLogoMakerPreviewCSS() {_.$container.find('#logoMakerPreview .l-m-preview .website-name').css('font-size',Number(_.$logoText.find('#logoMaker_logo_font_size').val()));_.$container.find('#logoMakerPreview .l-m-preview .s123-w-l-s div').css('font-size',Number(_.$logoText.find('#logoMaker_logo_size').val()));_.$container.find('#logoMakerPreview .l-m-preview').css('letter-spacing',Number(_.$logoText.find('#logoMaker_logo_text_letter_spacing').val()));_.$container.find('#logoMakerPreview .l-m-preview').css('word-spacing',Number(_.$logoText.find('#logoMaker_logo_text_word_spacing').val()));}
function loadCategories() {_.categories = [{title: translations.s123LogoMaker.categories.men,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/men_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Men'},{title: translations.s123LogoMaker.categories.women,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/women_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Women'},{title: translations.s123LogoMaker.categories.cities,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/cities_color.svg?v='+$GLOBALS['v-cache-long'],query: 'City'},{title: translations.s123LogoMaker.categories.music,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/music_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Music'},{title: translations.s123LogoMaker.categories.foodAndDrink,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/foodAndDrink_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Food'},{title: translations.s123LogoMaker.categories.business,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/business_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Business'},{title: translations.s123LogoMaker.categories.sports,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/sports_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Sport'},{title: translations.s123LogoMaker.categories.animals,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/animals_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Animal'},{title: translations.s123LogoMaker.categories.nature,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/nature_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Nature'},{title: translations.s123LogoMaker.categories.architecture,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/architecture_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Architecture'},{title: translations.s123LogoMaker.categories.party,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/party_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Party'},{title: translations.s123LogoMaker.categories.artsAndCulture,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/artsAndCulture_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Art'},{title: translations.s123LogoMaker.categories.building,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/building_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Building'},{title: translations.s123LogoMaker.categories.health,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/health_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Health'},{title: translations.s123LogoMaker.categories.people,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/people_color.svg?v='+$GLOBALS['v-cache-long'],query: 'People'},{title: translations.s123LogoMaker.categories.shopping,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/shopping_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Shopping'},{title: translations.s123LogoMaker.categories.travel,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/travel_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Travel'},{title: translations.s123LogoMaker.categories.wallpapers,src: $GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/wallpapers_color.svg?v='+$GLOBALS['v-cache-long'],query: 'Picture'}];}
function getLogoType( logo ) {var type = 'noLogo';if ( logo.indexOf('site123-image-icon') != -1 ) {type = 'icon';} else if ( logo.indexOf('.svg') != -1 ) {type = 'svg';} else if ( logo.length > 0 ) {type = 'img';}
return type;}
function initializeIconsTab() {_.$logoIcons.find('.s123-logo-maker-icon-categories').on('click','.s123-logo-maker-item',function(event) {_.$logoIcons.find('.s123-logo-maker-icon-categories').addClass('hide-container');_.$logoIcons.find('.logoLogoInlineLibrary').removeClass('hide-container');_.printIcons(_.activeTab,'',$(this).data('query'),true);_.$logoIcons.find('#logoIconSearch_input').val($(this).data('query'));_.$logoIcons.find('.searchStylesIconRemove').show();_.$logoIcons.find('.logoLogoFilter').removeClass('hide-container');_.$logoIcons.find('.logoLogoFilter').children().removeClass('active');_.$logoIcons.find('.logoLogoFilter .logo-icons-filter').first().addClass('active');});_.$logoIcons.find('.searchStylesIconRemove').on('click',function(event) {$(this).hide();_.$logoIcons.find('#logoIconSearch_input').val('');_.$logoIcons.find('.s123-logo-maker-icon-categories').removeClass('hide-container');_.$logoIcons.find('.logoLogoInlineLibrary').addClass('hide-container');_.$logoIcons.find('.l-i-items').html('');if ( _.s123InfiniteScroll['icons'] ) {_.s123InfiniteScroll['icons'].destroy();}
_.$logoIcons.find('.logoLogoFilter').addClass('hide-container');_.iconFilter = '';});_.$logoIcons.find('.logoLogoFilter').on('click','.logo-icons-filter',function(event) {$(this).addClass('active');$(this).siblings().removeClass('active');_.iconFilter = $(this).data('filter');_.printIcons(_.activeTab,$(this).data('filter'),_.$logoIcons.find('#logoIconSearch_input').val(),true);});_.$logoIcons.find('#logoIconSearch_input').on('keydown', function( event ) {_.$logoIcons.find('.s123-logo-maker-icon-categories').addClass('hide-container');_.$logoIcons.find('.logoLogoFilter').removeClass('hide-container');_.$logoIcons.find('.logoLogoInlineLibrary').removeClass('hide-container');_.$logoIcons.find('.searchStylesIconRemove').show();var $this = $(this);var eventKey = event.which;if ( _.iconQuery == $this.val() ) return;clearTimeout(this.searchLibraryInputFinished);if ( eventKey == 13 ) {_.printIcons(_.activeTab,_.iconFilter != '' ? _.iconFilter : '',$this.val(),true);} else {this.searchLibraryInputFinished = setTimeout( function() {_.printIcons(_.activeTab,_.iconFilter != '' ? _.iconFilter : '',$this.val(),true);},1000);}});}
function initializeTextTab() {var marginType = $('html[dir=rtl]').length !== 0 ? 'margin-left' : 'margin-right';_.$logoText.find('#logoMaker_name').on('keydown', function( event ) {var $this = $(this);var eventKey = event.which;clearTimeout(this.logoMakerNameInputFinished);this.logoMakerNameInputFinished = setTimeout( function() {_.$container.find('#logoMakerPreview .website-name').html($this.val());_.$logoStyles.find('.website-name').html($this.val());},200);});_.$logoText.find('.empty-input-handler').off('focus').on('focus', function() {$(this).data('name',$(this).val());});_.$logoText.find('.empty-input-handler').off('blur').on('blur', function() {var $this = $(this);if ( $this.val().length == 0 || $this.val().trim().length == 0 ) {$this.val($this.data('name')).trigger('input');_.$container.find('#logoMakerPreview .website-name').html($this.data('name'));}});if ($('#logo_text_size_weight').val() == 'weight700' ) {_.$logoText.find('.logo-bold-setting .btnSettings').addClass('active');} else {_.$logoText.find('.logo-bold-setting .btnSettings').removeClass('active');}
_.$logoText.find('.logo-bold-setting .btnSettings').on('click',function() {$(this).toggleClass('active');_.$container.find('#logoMakerPreview .l-m-preview').css({fontWeight: $(this).hasClass('active') ? '700' : 'normal'});_.$logoStyles.css({fontWeight: $(this).hasClass('active') ? '700' : 'normal'});_.saveLogoObj.textWeight = $(this).hasClass('active') ? 'weight700' : 'weight400';});_.$logoText.find('.sliderInput').each(function() {SliderInputInitialize($(this));});_.$logoText.find('#logoMaker_logo_font_size_slider').on('slide',function() {_.$container.find('#logoMakerPreview .l-m-preview .website-name').css('font-size',Number(_.$logoText.find('#logoMaker_logo_font_size').val()));});_.$logoText.find('#logoMaker_logo_size_slider').on('slide',function() {_.$container.find('#logoMakerPreview .l-m-preview .s123-w-l-s div').css('font-size',Number(_.$logoText.find('#logoMaker_logo_size').val()));});_.$logoText.find('#logoMaker_logo_text_letter_spacing_slider').on('slide',function() {_.$container.find('#logoMakerPreview .l-m-preview').css('letter-spacing',Number(_.$logoText.find('#logoMaker_logo_text_letter_spacing').val()));});_.$logoText.find('#logoMaker_logo_text_word_spacing_slider').on('slide',function() {_.$container.find('#logoMakerPreview .l-m-preview').css('word-spacing',Number(_.$logoText.find('#logoMaker_logo_text_word_spacing').val()));});_.$logoText.find('#logoMaker_logo_icon_text_spacing_slider').on('slide',function() {_.$container.find('#logoMakerPreview .logo_name div:not(.logoLayout):not(.svg-m),#logoMakerPreview .img-responsive,#logoMakerPreview .logoLayout_text').css(marginType,Number(_.$logoText.find('#logoMaker_logo_icon_text_spacing').val()));});_.$logoText.find('logoMaker_logo_font_size').removeClass('.inputChangeLive');_.$logoText.find('logoMaker_logo_size').removeClass('.inputChangeLive');_.$logoText.find('logoMaker_logo_text_letter_spacing').removeClass('.inputChangeLive');_.$logoText.find('logoMaker_logo_text_word_spacing').removeClass('.inputChangeLive');_.$logoText.find('logoMaker_logo_icon_text_spacing').removeClass('.inputChangeLive');}
function updateLogoTextSettings() {$frame = $('#websitePreviewIframe').contents();if ($('#logo_font_size').val() != _.$logoText.find('#logoMaker_logo_font_size').val() ) {$('#logo_font_size').val(_.$logoText.find('#logoMaker_logo_font_size').val());$('#logo_font_size_view').find('.slider-input-value').val(_.$logoText.find('#logoMaker_logo_font_size').val()).trigger('input');_.saveLogoObj.textSettingsChange = true;}
if ($('#logo_size').val() != _.$logoText.find('#logoMaker_logo_size').val() ) {$('#logo_size').val(_.$logoText.find('#logoMaker_logo_size').val());$('#logo_size_view').find('.slider-input-value').val(_.$logoText.find('#logoMaker_logo_size').val()).trigger('input');_.saveLogoObj.textSettingsChange = true;}
if ($('#logo_text_letter_spacing').val() != _.$logoText.find('#logoMaker_logo_text_letter_spacing').val() ) {$('#logo_text_letter_spacing').val(_.$logoText.find('#logoMaker_logo_text_letter_spacing').val());$('#logo_text_letter_spacing_view').find('.slider-input-value').val(_.$logoText.find('#logoMaker_logo_text_letter_spacing').val()).trigger('input');_.saveLogoObj.textSettingsChange = true;}
if ($('#logo_text_word_spacing').val() != _.$logoText.find('#logoMaker_logo_text_word_spacing').val() ) {$('#logo_text_word_spacing').val(_.$logoText.find('#logoMaker_logo_text_word_spacing').val());$('#logo_text_word_spacing_view').find('.slider-input-value').val(_.$logoText.find('#logoMaker_logo_text_word_spacing').val()).trigger('input');_.saveLogoObj.textSettingsChange = true;}
if ($('#logo_icon_text_spacing').val() != _.$logoText.find('#logoMaker_logo_icon_text_spacing').val() ) {$('#logo_icon_text_spacing').val(_.$logoText.find('#logoMaker_logo_icon_text_spacing').val());$('#logo_icon_text_spacing_view').find('.slider-input-value').val(_.$logoText.find('#logoMaker_logo_icon_text_spacing').val()).trigger('input');_.saveLogoObj.textSettingsChange = true;}
if ( _.saveLogoObj.textWeight != $('#logo_text_size_weight').val() ) {$('#logo_text_size_weight').val(_.saveLogoObj.textWeight);$('.logo-bold-btn').toggleClass('active');_.saveLogoObj.textSettingsChange = true;}
if ( _.$logoText.find('#logoMaker_name').val() != $('#name').val() ) {$('#name').val( _.$logoText.find('#logoMaker_name').val());$('.breadcrumb').find('.active').html(escapeHtml($('#name').val()));$('.page-header').find('h1').html(escapeHtml($('#name').val()));$frame.find('.logo_name .website-name,.website-name.website-name-preview-helper,.footer_2 .website-name-preview-helper').html(escapeHtml($('#name').val()));document.title = escapeHtml($('#name').val() + window.wizardTitleSuffix);$frame.find('.footer_name').html(escapeHtml($('#name').val()));$('#wesiteNameChange').val('changed');_.saveLogoObj.textSettingsChange = true;}}
function getNoBgNameSpace() {return $('#newBoBG').val() == '1' ? 'filter_nobg' : 'no_bg';}
function checkChanges(obj) {for (var key in obj) {if (obj[key] !== null && obj[key] != "")
return false;}
return true;}
function supportIconTextSpacing( style, toolOpen ) {var marginType = $('html[dir=rtl]').length !== 0 ? 'margin-left' : 'margin-right';var uploadFile = getUploadFileObjectByID('siteLogo');if ( _.notSupportStylesArray.indexOf(style) != -1 || ( uploadFile.input.val() == '' && toolOpen ) ) {_.$logoText.find('#logoMaker_logo_icon_text_spacing_slider').closest('.s123-slider').hide();_.$logoText.find('#logoMaker_logo_icon_text_spacing_view .slider-input-value').val('5').trigger('input');} else {_.$container.find('#logoMakerPreview .logo_name div:not(.logoLayout):not(.svg-m),#logoMakerPreview .img-responsive,#logoMakerPreview .logoLayout_text').css(marginType,Number(_.$logoText.find('#logoMaker_logo_icon_text_spacing').val()));_.$logoText.find('#logoMaker_logo_icon_text_spacing_slider').closest('.s123-slider').show();}}
return _;}();
Wizard.Ecommerce = function() {var _ = {moduleID: 112,moduleTypeNUM: 112,highLights: [157,158]};_.init = function () {showHideStoreBTN();$('#eCommerceTab').on('click',function( event ) {event.preventDefault();var $this = $(this);Wizard.Ecommerce.openManage($this);});$(document).on('s123.wizardPageAdded.eCommerce',function( event, $module ) {showHideStoreBTN();});$(document).on('removeModule.success',function ( event, moduleID, $module) {showHideStoreBTN();if ( moduleID != _.moduleID ) return;if ( !Wizard.Preview.ready ) return;$("#wizardForm").one( 'ajaxSuccess.ecomemrce_removed', function( event ) {UpdatePreviewAreaByAjax(['#s123ModulesContainer .s123-module-eCommerce[data-module-type-num="157"]','#s123ModulesContainer .s123-module-eCommerce[data-module-type-num="158"]',],false,false,RichPage.isActive ? RichPage.pageURL : '');});});};_.openManage = function ( $btn ) {OpenModuleWindow(_.moduleTypeNUM,_.moduleTypeNUM,'',$btn,'items');g_ManageModuleID = _.moduleID;SystemModals.sm_get('moduleWindow').show();SetEnlargeWindow(_.moduleTypeNUM,$btn);};_.getSetting = function( settingName ) {switch( settingName ) {case 'menuStyle':var settings = GetModuleSetting(_.moduleID,'settings');settings = tryParseJSON(settings);return settings[settingName];break;default:return GetModuleSetting(_.moduleID,settingName);break;}};_.updateSetting = function( settingName, newValue ) {switch( settingName ) {case 'menuStyle':var settings = GetModuleSetting(_.moduleID,'settings');settings = tryParseJSON(settings);settings[settingName] = newValue;EditModuleSetting(_.moduleID,'settings',JSON.stringify(settings));break;default:EditModuleSetting(_.moduleID,settingName,newValue);break;}};_.isEcommerceHighlight = function( moduleTypeNUM ) {return _.highLights.indexOf(parseInt(moduleTypeNUM)) != -1;};_.getPreviewSelectors = function() {if ( !Wizard.Preview.ready ) return '';var selectors = [];$.each(_.highLights, function(index, highLight) {Wizard.Preview.$('section:is(.s123-module,.s123-page-data)[data-module-type-num="'+highLight+'"]').each(function( index, module ) {var $this = $(this);selectors.push('#'+$this.get(0).id);});});var $eCommerce = Wizard.Preview.$('section.s123-module[data-module-id="'+_.moduleID+'"]');if ( $eCommerce.length > 0 ) {selectors.push('#'+$eCommerce.get(0).id);}
return selectors;};_.getHighlightType = function( moduleTypeNUM ) {if ( !_.highLights.includes(moduleTypeNUM) ) return false;if ( moduleTypeNUM == 157 ) {return 'product';} else {return 'collection';}};function showHideStoreBTN() {if ( Wizard.Pages.getPage(112).length > 0 ) {$('#eCommerceTab').parents('.ecommerce-btn-container').removeClass('hidden');} else {$('#eCommerceTab').parents('.ecommerce-btn-container').addClass('hidden');}}
return _;}();
var tabletWidth = 768;var mobileWidth = 375;var extraSpace = 0;var windowHeight;var wizardTopToolbarHeight;var tabsButtonWidth;var wizardSideMenuTopOffset = 0;var $previewBox;$(function() {if ( $('html').data('device') !== 'mobile' ) {wizardSideMenuTopOffset = parseInt(getComputedStyle(document.documentElement)
.getPropertyValue('--wizard-side-menu-top-offset'));}
$previewBox = $('#previewBox');if ($previewBox.length>0) {Wizard.Preview.Scale.init();wizard_ResizeScreen();$('#website_desktop_fit_view').click(function() {if ( previewFreeSpace() >= mobileWidth ) ShowWizard();$previewBox
.show()
.css(intrface_align,navTabsPosLeft()+$('#wizardBox').width())
.css({width: preview_SetWidth(previewFreeSpace())});ChangePreviewLive();preview_ActiveMenu('desktop_fit');});$('#website_tablet_view').click(function() {if ( previewFreeSpace() >= mobileWidth ) ShowWizard();$previewBox
.show()
.css(intrface_align,navTabsPosLeft()+$('#wizardBox').width())
.css({width: preview_SetWidth(tabletWidth)});ChangePreviewLive();preview_ActiveMenu('tablet');});$('#website_mobile_view').click(function() {if ( previewFreeSpace() >= mobileWidth) ShowWizard();$previewBox
.show()
.css(intrface_align,navTabsPosLeft()+$('#wizardBox').width())
.css({width: mobileWidth});ChangePreviewLive();preview_ActiveMenu('mobile');});$(window).resize(function() {clearTimeout(window.resizedFinished);window.resizedFinished = setTimeout( function() {wizard_ResizeScreen();if( !window['isTouchSupported'] ) {$('#dropdown_preview_button li.active a').trigger('click');}
Wizard.Preview.Scale.refresh();}, 500);});if ( window['isTouchSupported'] && $('#websitePreviewIframe').length === 0 ) {if ( $('html').data('device') !== 'mobile' ) {$('#wizardTab2button').trigger('click');}}}});function wizard_ResizeScreen() {windowHeight = $(window).outerHeight(true);wizardTopToolbarHeight = $('#wizardTopToolbar').outerHeight(true);tabsButtonWidth = $('#wizardBox .wizardSideTabs').width();var left = navTabsPosLeft();if ( $('#wizardBox .tab-content').is(":visible") ) {left += $('#wizardBox').width();} else {left += tabsButtonWidth;}
$previewBox.height(windowHeight - wizardTopToolbarHeight);$('#wizardBox .wizardSideTabs').height(windowHeight);$previewBox
.width(preview_SetWidth(9999))
.css(intrface_align,left)
.show();$('#main-container').height(windowHeight);if ( $.isNumeric(wizardSideMenuTopOffset) ) {windowHeight -= wizardSideMenuTopOffset;}
$('#wizardBox .tab-content').outerHeight(windowHeight);Wizard.Preview.Scale.refresh();}
function website_desktop_view() {HideWizard();$previewBox
.show()
.css({width: $('html').width()-tabsButtonWidth})
.css(intrface_align,navTabsPosLeft()+tabsButtonWidth+extraSpace);preview_ActiveMenu('desktop');Wizard.Preview.Scale.refresh();}
function preview_ActiveMenu(tab) {$('#dropdown_preview_button li').removeClass('active');$('#website_'+tab+'_view').parent('li').addClass('active');$previewBox.attr('data-preview-screen',tab);setTimeout(function() {if ( Wizard.Preview.ready ) {Wizard.Preview.window.ResetMoreButton();}},1000);}
function preview_SetWidth(limit) {if ($('#wizardBox .tab-content').is(":visible")==true) {var freeSpace = previewFreeSpace();} else {var freeSpace = previewFreeSpaceNoWizard();}
if (freeSpace>limit) {return limit;} else {return freeSpace;}}
function previewFreeSpace() {return $('body').width()-$('#wizardBox').outerWidth(true)-extraSpace;}
function previewFreeSpaceNoWizard() {return $('body').width()-$('#wizardBox .wizardSideTabs').outerWidth(true)-extraSpace;}
function ShowWizard() {$( "#previewBox" ).stop( true, true );$('#wizardBox .tab-content').show();if (previewFreeSpace()<mobileWidth) {$previewBox.hide();} else {if ($previewBox.attr('data-preview-screen')=='desktop_fit' || $previewBox.attr('data-preview-screen')=='desktop') {$previewBox.show().width(preview_SetWidth(previewFreeSpace()));preview_ActiveMenu('desktop_fit');$previewBox.css(intrface_align,navTabsPosLeft()+$('#wizardBox').width());}}
if ($('.wizardSideTabs > li.active').length==0) {$('.wizardSideTabs [data-toggle=mytabs]').first().parent('li').addClass('active');$('#homepageTab').addClass('active').show();}
Wizard.Preview.Scale.refresh();}
function HideWizard() {$('.tab-pane').hide();$('.wizardSideTabs > li.active').removeClass('active');$('#wizardBox .tab-content').hide();Wizard.Preview.Scale.refresh();}
function navTabsPosLeft() {if ( $('#wizardBox .wizardSideTabs').length == 0 ) return 0;if ( intrface_align == 'left' ) {return $('#wizardBox .wizardSideTabs').offset().left;} else {return $(window).width() - $('#wizardBox .wizardSideTabs').offset().left - $('#wizardBox .wizardSideTabs').outerWidth();}}
//Use us to save the moduleTypeNUM we're manage right now
var g_ManageModuleID;var g_ManageAddModuleData = null;var promoFirstLoadCount = 1;var preventScrollOnModalClose = false;window['isTouchSupported'] = ('ontouchstart' in window);function LoadModuleFunctions() {$('#wizardBox').mousedown(function() {g_ManageModuleID = '';g_ManageAddModuleData = null;});$('#mailingWindow').on('show.bs.modal', function (event) {var modal = $(this);modal.find('.modal-body').html('<iframe id="mailingIframe" src="/versions/2/wizard/customers/index.php?w='+$('#id').val()+'" style="width:100%;height:500px;margin: 0;padding: 0;border: none;"></iframe>');});$('#AddModuleWin').on('show.bs.modal', function ( event ) {var modal = $(this);var button = $(event.relatedTarget); // Button that triggered the modal
var moduleID = button.data('moduleid');var moduleTypeNUM = button.data('moduletypenum');var addToCategory = moduleTypeNUM == '78';var addToRichPage = RichPage.isActive;var addToInsidePage = button.closest('html.inside_page').length > 0;var addToNotInMenuOrHomepage = false;if ( button.closest('#pagesTab').length > 0 && button.closest('#pagesTab').attr('data-pages-n-i-m-o-h-tab')
&& button.closest('#pagesTab').attr('data-pages-n-i-m-o-h-tab') == 'showOthersTab' ) {addToNotInMenuOrHomepage = true;}
topWindow.addNewModule_parentId = (addToCategory || addToRichPage) ? moduleID : '';if ( g_ManageAddModuleData ) {topWindow.addNewModule_parentId = g_ManageAddModuleData.parentID;addToRichPage = g_ManageAddModuleData.isRichPage;}
if ( addToInsidePage ) {topWindow.addNewModule_parentId = button.closest('section').data('module-id');}
modal.data('loaded',isSameDestination(addToCategory,addToRichPage,addToInsidePage,addToNotInMenuOrHomepage,modal));$(topWindow.document).trigger('s123.addModuleWinShown');if ( modal.data('loaded') ) return;modal.data('addToCategory',addToCategory);modal.data('addToRichPage',addToRichPage);modal.data('addToInsidePage',addToInsidePage);modal.data('addToNotInMenuOrHomepage',addToNotInMenuOrHomepage);modal.data('loaded',true);modal.find('.modal-body').html('<iframe id="addNewModuleIframe" name="pluginsIframe" src="/versions/2/wizard/modules/modulesList.php?w='+websiteID+'&addToCategory='+addToCategory+'&addToRichPage='+addToRichPage+'&addToInsidePage='+addToInsidePage+'&addToNotInMenuOrHomepage='+addToNotInMenuOrHomepage+'" class="modal-xlg-height" style="width:100%;margin:0;padding:0;border:0;"></iframe>');});}
function isSameDestination( addToCategory, addToRichPage, addToInsidePage, addToNotInMenuOrHomepage, modal ) {if ( typeof modal.data('addToCategory') == 'undefined' && typeof modal.data('addToRichPage') == 'undefined' && typeof modal.data('addToInsidePage') == 'undefined' ) return false;if ( addToCategory && modal.data('addToCategory') ) {return true;} else if ( addToRichPage && modal.data('addToRichPage') ) {return true;} else if ( addToInsidePage && modal.data('addToInsidePage') ) {return true;} else if ( addToNotInMenuOrHomepage && modal.data('addToNotInMenuOrHomepage') ) {return true;} else if ( !addToCategory && !addToRichPage && !addToInsidePage && !addToNotInMenuOrHomepage && !modal.data('addToCategory') && !modal.data('addToRichPage')  && !modal.data('addToInsidePage') && !modal.data('addToNotInMenuOrHomepage') ) {return true;}
return false;}
function SetEnlargeWindow(moduleTypeNUM, $button ) {var modalWidth = 'large';if ( moduleTypeNUM == 1000 ) {$('.tabbable.tabs-left').addClass('highOpacity');setTimeout(function() {$('.modal-backdrop.in').css('opacity','0');},100);return;}
switch (moduleTypeNUM) {case 7:case 24:case 115:case 64:case 176:modalWidth = 'small';break;case 3:case 4:case 5:case 9:case 11:case 12:case 13:case 16:case 20:case 41:case 42:case 43:case 76:case 106:case 107:case 110:case 114:case 127:case 138:case 147:case 167:case 169:modalWidth = 'medium';break;case 112:if ( $button && $button.data('hide-side-menu') ) {modalWidth = 'medium';} else {modalWidth = 'large';}
break;default:modalWidth = 'large';break;}
setTimeout(function() {$('.modal-backdrop.in').css('opacity','0.7');},100);var modal = SystemModals.sm_get('moduleWindow');switch( modalWidth ) {case 'small':modal.setWidth('s1');break;case 'medium':modal.setWidth('m1');break;case 'large':modal.setWidth('l1');break;}
return modalWidth;}
function ModuleSideMenuClickEvent( iframeID ,mobile, html, modal, src, heighestHeightNUM ) {html += '<iframe id="'+iframeID+'" class="module-side-menu" src="'+src+'" style="width:calc(100% - 190px);height:'+heighestHeightNUM+'px;margin: 0;padding: 0;border: none;"></iframe>';modal.find('.modal-body').html(html);switch ( mobile ) {case false:$('#moduleSideMenu a').click(function() {var $this = $(this);if ($this.data('href') != '#' && $this.data('href') != '' && $this.attr('target') !== '_blank' && $('#'+iframeID)[0].contentWindow.$ && $('#'+iframeID)[0].contentWindow.$('html[data-unsaved-changes="true"]').length>0) {bootbox.confirm({title: translations.SureDiscardChanges,message: translations.PleaseMakeSaveChangeBeforeLeave,className: 's123-unsaved-changes-alert',buttons: {confirm: {label: translations.DiscardChanges,className: 'btn-danger'},cancel: {label: translations.KeepEditThePage,className: 'btn-default'}},callback: function( result ) {if (result) {moduleSideMenu_action(iframeID,$this);} else {}}});return;}
moduleSideMenu_action(iframeID,$this);});$('#moduleSideMenu a.dropdown-toggle').on('click',function() {let $this = $(this);let $li = $this.closest('li');$('#moduleSideMenu a.dropdown-toggle').each(function() {$(this).closest('li').find('ul.submenu').slideUp(300,function(){$(this).closest('li').removeClass('open');});});if ( $li.hasClass('open') ) {$li.find('ul.submenu').slideUp(300,function(){$this.closest('li').removeClass('open');});} else {$li.find('ul.submenu').slideDown(300,function(){$this.closest('li').addClass('open');});}});break;case true:$('#moduleMobileBottomMenu .sub-tabs').hide();$('#moduleMobileBottomMenu a').click(function(event) {var $this = $(this);if ($this.data('href') != '#' && $this.data('href') != '' && $('#'+iframeID)[0].contentWindow.$ && $('#'+iframeID)[0].contentWindow.$('html[data-unsaved-changes="true"]').length>0) {bootbox.confirm({title: translations.SureDiscardChanges,message: translations.PleaseMakeSaveChangeBeforeLeave,buttons: {confirm: {label: translations.DiscardChanges,className: 'btn-danger'},cancel: {label: translations.KeepEditThePage,className: 'btn-default'}},callback: function( result ) {if (result) {moduleMobileBottomMenu_action($this);} else {}}});return;}
moduleMobileBottomMenu_action($this);});break;}}
function moduleSideMenu_action( iframeID, $this ) {if ( $this.data('href') != '#' && $this.data('href') != '' ) {if ( $this.hasClass('open-new-tab') ) {window.open($this.data('href'), '_blank');return;} else {$this.closest('.modal').find('#'+iframeID).attr('src',$this.data('href'));}}
if ( $this.closest('.submenu').length === 0 &&  $this.parent().children('.submenu').length === 0 ) {$('#moduleSideMenu .open .submenu.nav-show').addClass('nav-hide').removeClass('nav-show').hide();$('#moduleSideMenu .open').removeClass('open');}
$('#moduleSideMenu li').removeClass('active');$this.parent('li').addClass('active');if ( $this.parents('ul').hasClass('submenu') ) {$this.parents('li').addClass('active');}}
function moduleMobileBottomMenu_action( $this ) {var $subTabs = $this.next();if ( $this.data('href') != '#' && $this.data('href') != '' ) {var moduleItemsIframe = document.getElementById('moduleItemsIframe');if ( moduleItemsIframe == null ) {moduleItemsIframe = document.getElementById('pluginsManagerIframe');}
moduleItemsIframe.contentWindow.location.replace($this.data('href'));}
if ( $subTabs.hasClass('sub-tabs') && !$subTabs.is(':visible') ) {$subTabs.fadeIn();} else if ( $this.next().hasClass('sub-tabs') && $this.next().is(':visible') ) {$subTabs.fadeOut();} else {$subTabs.find('.sub-tabs').fadeOut();}
$('#moduleMobileBottomMenu a').removeClass('custom-active');$this.addClass('custom-active');}
function OpenModuleWindow( moduleID, moduleTypeNUM, itemUniqueID, $button, action ) {g_ManageModuleID = moduleID;var $wizardPage = Wizard.Pages.getPage(moduleID);if ( $wizardPage.data('items-module-id') && $wizardPage.data('items-module-id').length > 0 ) {moduleID = $wizardPage.data('items-module-id');}
var title = '';if ( Wizard.Ecommerce.isEcommerceHighlight(moduleTypeNUM) ) {title = GetModuleSetting(Wizard.Ecommerce.moduleID,'title');} else if ( moduleTypeNUM != 1000 ) {title = GetModuleSetting(moduleID,'title');} else {title = translations.Promo;}
var activeTab = '/'+modulesArr[moduleTypeNUM]['folder']+'/';if ( moduleTypeNUM == '112' && $button && !$button.data('active-tab') ) {activeTab = '/eCommerceCollections/';}
var modal = SystemModals.sm_get('moduleWindow');if ( $button && $button.data('active-tab') ) {activeTab += $button.data('active-tab');src = '/versions/2/wizard/modules/'+modulesArr[moduleTypeNUM]['folder']+'/'+$button.data('active-tab')+'?w='+$('#id').val();} else {activeTab += 'items.php';if ( action == 'editItem' ) {var src = '/versions/2/wizard/modules/addItemCrossroads.php?w='+$('#id').val()+'&moduleID='+moduleID+'&moduleTypeNUM='+moduleTypeNUM+'&uniqueID='+itemUniqueID;var srcMain = '/versions/2/wizard/modules/'+modulesArr[moduleTypeNUM]['folder']+'/items.php?w='+$('#id').val()+'&moduleID='+moduleID} else if ( action == 'contentGeneratorPage' ) {var src = `/manager/contentGenerator/crossroads.php?w=${$('#id').val()}&moduleID=${moduleID}&moduleTypeNUM=${moduleTypeNUM}`;} else {if ( moduleTypeNUM == '112' ) {var src = '/versions/2/wizard/modules/eCommerceCollections/items.php?id=homepageItems&w='+$('#id').val()+'&moduleID='+moduleID+'&moduleTypeNUM=113';} else if ( moduleTypeNUM == '169' ) {var src = '/versions/2/wizard/modules/'+modulesArr[moduleTypeNUM]['folder']+'/items.php?w='+$('#id').val()+'&moduleID='+moduleID+'&moduleTypeNUM='+moduleTypeNUM;} else {var src = '/versions/2/wizard/modules/'+modulesArr[moduleTypeNUM]['folder']+'/items.php?w='+$('#id').val()+'&moduleID='+moduleID+'';}}}
if ( $button && $button.data('active-inner-tab') ) {src += '&activeTab='+$button.data('active-inner-tab');}
if ( modulesArr[moduleTypeNUM]['one_item_module'] == '1' ) {if ( Wizard.Ecommerce.isEcommerceHighlight(moduleTypeNUM) ) {modal.updateHTML('title',LinkModuleTitleToPage(moduleTypeNUM,escapeHtml(title),src));} else {modal.updateHTML('title',escapeHtml(title));}} else {if ( action == 'editItem' ) {modal.updateHTML('title',LinkModuleTitleToPage(moduleTypeNUM,escapeHtml(title),srcMain));} else {modal.updateHTML('title',LinkModuleTitleToPage(moduleTypeNUM,escapeHtml(title),src));}}
var heighestHeightNUM = $(window).outerHeight(true)-85;if ( $button && $.isNumeric($button.data('modal-height-limit')) ) {if ( heighestHeightNUM > $button.data('modal-height-limit') ) {heighestHeightNUM = $button.data('modal-height-limit');}}
moduleTypeNUM = moduleTypeNUM == 113 || Wizard.Ecommerce.isEcommerceHighlight(moduleTypeNUM) ? 112 : moduleTypeNUM;const hideSideMenu = hideSideMenuByModule(moduleTypeNUM,moduleID,$button);if ( modulesArr[moduleTypeNUM]['module_side_menu'] && !hideSideMenu ) {sideMenu = jQuery.parseJSON(modulesArr[moduleTypeNUM]['module_side_menu']);if ( $('html').data('device') !== 'mobile' ) {html = BuildModuleSideMenu(moduleID,heighestHeightNUM,sideMenu,activeTab);ModuleSideMenuClickEvent('moduleItemsIframe',false,html,modal.$html,src,heighestHeightNUM);} else {html = BuildMobileModuleSideMenu(moduleID,heighestHeightNUM,sideMenu,activeTab);ModuleSideMenuClickEvent('moduleItemsIframe',true,html,modal.$html,src,heighestHeightNUM);}} else if ( modulesArr[moduleTypeNUM]['module_side_menu'] == '' || moduleTypeNUM == 9 ) {if ( $('html').data('device') == 'mobile' ) {heighestHeightNUM = $(window).outerHeight(true) - 55;}
modal.updateHTML('body','<iframe id="moduleItemsIframe" src="'+src+'" style="width:100%;height:'+heighestHeightNUM+'px;margin: 0;padding: 0;border: none;"></iframe>');} else {if ( $button.data('params') ) {src += $button.data('params');}
if ( $('html').data('device') == 'mobile' ) {heighestHeightNUM = $(window).outerHeight(true) - 55;}
modal.updateHTML('body','<iframe id="moduleItemsIframe" src="'+src+'" style="width:100%;height:'+heighestHeightNUM+'px;margin: 0;padding: 0;border: none;"></iframe>');}}
function OpenFastPromoModule(moduleID,moduleTypeNUM,itemID) {g_ManageModuleID = moduleID;if (itemID!='') {var src = '/versions/2/wizard/modules/'+modulesArr[moduleTypeNUM]['folder']+'/addItem.php?w='+$('#id').val()+'&moduleID='+moduleID+'&id='+itemID+'';var srcMain = '/versions/2/wizard/modules/'+modulesArr[moduleTypeNUM]['folder']+'/items.php?w='+$('#id').val()+'&moduleID='+moduleID+'';} else {var src = '/versions/2/wizard/modules/'+modulesArr[moduleTypeNUM]['folder']+'/items.php?w='+$('#id').val()+'&moduleID='+moduleID+'';}
var heighestHeightNUM = $(window).outerHeight(true)-170;return '<iframe id="moduleItemsIframe" src="'+src+'" style="width:100%;height:'+heighestHeightNUM+'px;margin: 0;padding: 0;border: none;max-height:400px;"></iframe>';}
function LinkModuleTitleToPage(moduleTypeNUM,windowName,iframeURL) {var breadcrumb = '';breadcrumb += '<div class="breadcrumb-wrap">';breadcrumb += '<ol class="breadcrumb container breadcrumb-custom">';breadcrumb += '<li>';breadcrumb += '<i class="'+modulesArr[moduleTypeNUM]['icon']+'"></i>&nbsp;';breadcrumb += '<a style="cursor:pointer;" class="moduleBredHome" onclick="redirectModule(\''+iframeURL+'\');">' + windowName+'</a>';breadcrumb += '</li>';breadcrumb += '</ol>';breadcrumb += '</div>';return breadcrumb;}
function AddActionInModuleWindow(moduleTypeNUM,moduleID) {var insideURL;insideURL = '/versions/2/wizard/modules/'+modulesArr[moduleTypeNUM]['folder']+'/'+modulesArr[moduleTypeNUM]['main_add_item']+'?w='+$('#id').val()+'&moduleID='+moduleID+'';return '<a class="btn btn-primary" onclick="redirectModule(\''+insideURL+'\');">'+translations.add+'</a>';}
function redirectModule(insideURL) {$('#moduleItemsIframe').attr('src',insideURL);}
function LoadModulesLists() {if ( tools_manage.length === 0 || tools_manage == '' ) return;var obj = jQuery.parseJSON(tools_manage);var zIndex = obj.length;$('#sortable [data-rel="tooltip-desk"],#sortable [data-rel="tooltip"]').tooltip('destroy');$(document).trigger('LoadModulesLists.start');$('#sortable').empty();$.each(obj, function( index, value ) {var settings 		= (value.settings!='') ? jQuery.parseJSON(value.settings) : ''; //Not all modules have settings
var moduleID 		= value.moduleID;var moduleTypeNUM 	= value.moduleTypeNUM;var title 			= value.title;var style			= value.style;var modulesArrID	= value.modulesArrID ? value.modulesArrID : '';var styleContent	= getObjectSettingByKey(settings,'styleContent');var showInMenu		= value.showInMenu;var showInFooter	= value.showInFooter;var hideFrontModule = getObjectSettingByKey(settings,'hideFrontModule');var mp_showInMenu	= value.mp_showInMenu;var mp_showInHome	= value.mp_showInHome;var parentId 		= value.parentId ? value.parentId : '';var hideFromMobile  = getObjectSettingByKey(settings,'hideFromMobile');var itemsModuleID 	= value.appModuleID !== null ? value.appModuleID : '';if ( $.trim(title).length == 0 ) {title = translations.defaultModuleName + ' ' + (index +1);}
AddModule(moduleID,itemsModuleID,moduleTypeNUM,title,true,style,styleContent,showInMenu,showInFooter,hideFrontModule,mp_showInMenu,mp_showInHome,parentId,zIndex,modulesArrID,hideFromMobile);zIndex--;});function getObjectSettingByKey( settings, key ) {if ( !settings ) return '';if ( settings.length === 0 ) return '';if ( settings[key] ) return settings[key];return '';}
$(document).trigger('LoadModulesLists.done');}
function DisableAddModules( disable ) {if ( disable ) {$('.moduleButton').addClass('disableModule');} else {$('.moduleButton').removeClass('disableModule');}}
function AddNewModuleCategory() {if ( PagesLimitations() ) return;window.addNewModule_parentId = '';bootbox.dialog({title: translations.addNewCategory,message: '<form id="addNewCategoryForm" class="bootbox-form"><div class="form-group"><input id="addNewCategory" autocomplete="off" type="text" class="bootbox-input bootbox-input-text form-control" required data-msg-required="'+translations.fieldRequired+'"></div></form>',className: 'wizard-add-new-category',closeButton: true,backdrop: true,onEscape: function() {},buttons: {cancel: {label: translations.Cancel,className: 'btn-default'},confirm: {label: translations.Save,className: 'btn-primary btn-success add-new-category-btn',callback: function() {var $form = this.find('.bootbox-form');var $name = $form.find('#addNewCategory');$name.val($name.val().trim());if ( !$form.valid() || $name.val().length === 0 ) {$name.focus();return false;}
AddNewModule('78',$name.val(),false,'1','1','1','1','0','1','0','','78');}}},}).on('shown.bs.modal', function() {var $addNewCategoryBtn = $(this).find('.add-new-category-btn');$(this).find('#addNewCategory').focus();$(this).find('#addNewCategory').onEnterKey(function ( event ) {event.preventDefault();$addNewCategoryBtn.trigger('click');});});}
function InsidePage_AddNewModule( moduleID, newModule ) {$(document).one('richPageConverted',function( event, $richpage ) {AddNewModule(newModule.moduleTypeNUM,newModule.name,newModule.firstLoad,newModule.style,newModule.styleContent,newModule.showInMenu,newModule.showInFooter,newModule.hideFrontModule,newModule.mp_showInMenu,newModule.mp_showInHome,$richpage.data('moduleid'),newModule.modulesArrID);});Wizard.Pages.modeManager.set('richPage',moduleID,true);}
function AddNewModule( moduleTypeNUM, name, firstLoad, style, styleContent, showInMenu, showInFooter, hideFrontModule, mp_showInMenu, mp_showInHome, parentId, modulesArrID, toolChildID = '' ) {DisableAddModules(true);var moduleID = uniqid();if (modulesArr[moduleTypeNUM]['staticModuleID']) {moduleID = modulesArr[moduleTypeNUM]['staticModuleID'];}
if ( window.addNewModule_parentId ) {parentId = window.addNewModule_parentId;window.addNewModule_parentId = '';}
AddModule(moduleID,'',moduleTypeNUM,name,firstLoad,style,styleContent,showInMenu,showInFooter, hideFrontModule,mp_showInMenu,mp_showInHome,parentId,-1,modulesArrID,false,toolChildID);return moduleID;}
function AddModule( moduleID, itemsModuleID, moduleTypeNUM, name, firstLoad, style, styleContent, showInMenu, showInFooter, hideFrontModule, mp_showInMenu, mp_showInHome, parentId, zIndex, modulesArrID, hideFromMobile, toolChildID = '' ) {if ( firstLoad == false ) {$.ajax({type: "POST",url: "/versions/2/wizard/modules/addNewModule.php",data: {w: $('#id').val(),moduleID: moduleID,parentId: parentId,title: name,moduleTypeNUM: moduleTypeNUM,style: style,modulesArrID: modulesArrID,styleContent: styleContent,showInMenu: showInMenu,showInFooter: showInFooter,hideFrontModule: hideFrontModule,mp_showInMenu: mp_showInMenu,mp_showInHome: mp_showInHome,slogan: '',modulesArrID: modulesArrID,language: $('#language').val(),toolChildID: toolChildID,},success: function(data) {var data = jQuery.parseJSON(data);if ( data.error && data.error == '181218103935123' ) {bootbox.alert({title: translations.pagesLimitHeader,message: translations.pagesLimitMessage.replace('{{limited_pages_number}}',data.limited_pages_number)});return;}
AddModuleHTML(moduleID,itemsModuleID,moduleTypeNUM,name,firstLoad,style,modulesArrID,styleContent,showInMenu,showInFooter,hideFrontModule,mp_showInMenu,mp_showInHome,data.url,parentId,zIndex,hideFromMobile,false);if ( data.settings ) {EditModuleSetting(moduleID,'settings',data.settings);}}});} else {AddModuleHTML(moduleID,itemsModuleID,moduleTypeNUM,name,firstLoad,style,modulesArrID,styleContent,showInMenu,showInFooter,hideFrontModule,mp_showInMenu, mp_showInHome,'',parentId,zIndex,hideFromMobile,false);}}
function AddModuleHTML( moduleID, itemsModuleID, moduleTypeNUM, name, firstLoad, style, modulesArrID, styleContent, showInMenu, showInFooter, hideFrontModule, mp_showInMenu, mp_showInHome, url, parentId, zIndex, hideFromMobile, setSettings ) {var html = '';var settings = GetModuleSetting(moduleID,'settings');settings = tryParseJSON(settings);if ( modulesArr[Number(moduleTypeNUM)]['styleContentDefualtStyle'] && !firstLoad ) {styleContent = modulesArr[Number(moduleTypeNUM)]['styleContentDefualtStyle'];}
html += '<li id="card_'+moduleID+'" data-moduletypenum="'+escapeHtml(moduleTypeNUM)+'" data-moduleid="'+escapeHtml(moduleID)+'" data-module-show-in-menu="'+escapeHtml(showInMenu)+'" data-module-show-in-footer="'+escapeHtml(showInFooter)+'" data-module-hide-front-module="'+escapeHtml(hideFrontModule)+'" data-module-mp-show-in-menu="'+escapeHtml(mp_showInMenu)+'" data-module-mp-show-in-home="'+escapeHtml(mp_showInHome)+'" data-module-style="'+escapeHtml(style)+'" data-modules-arr-id="'+escapeHtml(modulesArrID)+'" data-module-style-content="'+escapeHtml(styleContent)+'" href="#" class="moduleSortList list-group-item well" data-url="'+url+'" data-parent-id="'+parentId+'" style="z-index:'+zIndex+'" data-module-hide-from-mobile="'+escapeHtml(hideFromMobile)+'" data-sync-titles="true" data-items-module-id="'+itemsModuleID+'">';html += '<div class="boxClick"></div>';html += '<div class="pages_PageBox">';if( 1 ) {html += '<div class="pages_dragButton">';html += '<a class="draggingModuleButton" data-module-id="'+escapeHtml(moduleID)+'" data-parent-module="'+escapeHtml(moduleTypeNUM)+'" data-rel="tooltip" title="'+escapeHtml(translations.DragThePageToAnotherPage)+'" data-delay=\'{"show":"1000", "hide":"0"}\'><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="grip-vertical" class="svg-inline--fa fa-grip-vertical fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M96 32H32C14.33 32 0 46.33 0 64v64c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32V64c0-17.67-14.33-32-32-32zm0 160H32c-17.67 0-32 14.33-32 32v64c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32v-64c0-17.67-14.33-32-32-32zm0 160H32c-17.67 0-32 14.33-32 32v64c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32v-64c0-17.67-14.33-32-32-32zM288 32h-64c-17.67 0-32 14.33-32 32v64c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32V64c0-17.67-14.33-32-32-32zm0 160h-64c-17.67 0-32 14.33-32 32v64c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32v-64c0-17.67-14.33-32-32-32zm0 160h-64c-17.67 0-32 14.33-32 32v64c0 17.67 14.33 32 32 32h64c17.67 0 32-14.33 32-32v-64c0-17.67-14.33-32-32-32z"></path></svg></a>';
html += '</div>';}
html += '<div class="pages_buttonsBox">';html += '<div class="input-group">';if ( moduleTypeNUM == 1000 ) {html += '<div class="btn-group"><input type="text" class="form-control input-sm ignore promoModuleInput" value="'+translations.Promo + ' ' + promoFirstLoadCount+'" readonly data-rel="tooltip" title="'+escapeHtml(translations.PromoPageNameCannotChange)+'" data-delay=\'{"show":"500", "hide":"0"}\'><input type="text" class="form-control input-sm no-radius module_name data-hj-whitelist ignore hidden" placeholder="'+escapeHtml(translations.title)+'" data-moduleid="'+escapeHtml(moduleID)+'" maxlength="100" aria-label="Module Name"></div>';promoFirstLoadCount++;} else {html += '<div class="btn-group"><input type="text" class="form-control input-sm no-radius module_name data-hj-whitelist ignore" placeholder="'+escapeHtml(translations.title)+'" data-moduleid="'+escapeHtml(moduleID)+'" maxlength="100" aria-label="Module Name"></div>';}
if ( moduleTypeNUM == '78' ) {html += '<div class="btn-group"><a class="btn btn-sm btn-primary no-radius manageWin" data-toggle="modal" data-target="#AddModuleWin" data-moduletypenum="'+escapeHtml(moduleTypeNUM)+'" data-moduleid="'+escapeHtml(moduleID)+'" data-name="'+escapeHtml(name)+'" data-rel="tooltip-desk" title="'+escapeHtml(translations.addNewPage)+'" data-delay=\'{"show":"1000", "hide":"0"}\'><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="plus" class="svg-inline--fa fa-plus fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"></path></svg></a></div>';} else {if ( moduleTypeNUM == 1000 && false ) {html += '<div class="btn-group"><a class="btn btn-sm btn-primary no-radius modulesEditButton sm-controller promoEditWin" data-sm-manual-render="true" data-moduleid="'+escapeHtml(moduleID)+'" data-parent-module="'+escapeHtml(moduleTypeNUM)+'" data-rel="tooltip-desk" title="'+escapeHtml(translations.UpdateManageContent)+'" data-delay=\'{"show":"1000", "hide":"0"}\'>'+translations.edit+'</a></div>';} else if ( RichPage.isRichPage(moduleTypeNUM) ) {html += '<div class="btn-group"><a class="btn btn-sm btn-primary no-radius enter-rich-page manageWin" data-moduletypenum="'+escapeHtml(moduleTypeNUM)+'" data-moduleid="'+escapeHtml(moduleID)+'" data-name="'+escapeHtml(name)+'" data-rel="tooltip-desk" title="'+escapeHtml(translations.UpdateManageContent)+'" data-delay=\'{"show":"1000", "hide":"0"}\'><div><span>'+translations.richPage.editBtnTitle+'</span></div></a></div>';} else {if ( moduleTypeNUM == 167 ) {if ( $('html[data-device="mobile"]').length == 0 ) {html += '<div class="btn-group"><a class="btn btn-sm btn-primary no-radius modulesEditButton manageWin" href="javascript: Wizard.InlineModuleEditor.im_show(\''+escapeHtml(moduleID)+'\','+escapeHtml(moduleTypeNUM)+',\'\');" data-moduletypenum="'+escapeHtml(moduleTypeNUM)+'" data-moduleid="'+escapeHtml(moduleID)+'" data-name="'+escapeHtml(name)+'" data-rel="tooltip-desk" title="'+escapeHtml(translations.UpdateManageContent)+'" data-delay=\'{"show":"1000", "hide":"0"}\'><div><span>'+translations.edit+'</span></div></a></div>';} else {html += '<div class="btn-group"><a class="btn btn-sm btn-primary no-radius modulesEditButton sm-controller manageWin" data-sm-manual-render="true" data-toggle="modal" data-target="#moduleWindow" data-moduletypenum="'+escapeHtml(moduleTypeNUM)+'" data-moduleid="'+escapeHtml(moduleID)+'" data-name="'+escapeHtml(name)+'" data-rel="tooltip-desk" title="'+escapeHtml(translations.UpdateManageContent)+'" data-delay=\'{"show":"1000", "hide":"0"}\'><div><span>'+translations.edit+'</span></div></a></div>';}} else {html += '<div class="btn-group"><a class="btn btn-sm btn-primary no-radius modulesEditButton sm-controller manageWin" data-sm-manual-render="true" data-toggle="modal" data-target="#moduleWindow" data-moduletypenum="'+escapeHtml(moduleTypeNUM)+'" data-moduleid="'+escapeHtml(moduleID)+'" data-name="'+escapeHtml(name)+'" data-rel="tooltip-desk" title="'+escapeHtml(translations.UpdateManageContent)+'" data-delay=\'{"show":"1000", "hide":"0"}\'><div><span>'+translations.edit+'</span></div></a></div>';}}
if ( modulesArr[moduleTypeNUM]['custom_design'] ) {html += '<div class="btn-group">';html += '<a class="btn btn-sm btn-primary no-radius customDesignModuleButton manageWin" data-toggle="modal" data-target="#moduleWindow" data-moduletypenum="'+escapeHtml(moduleTypeNUM)+'" data-module-id="'+escapeHtml(moduleID)+'" data-name="'+escapeHtml(name)+'" data-active-tab="'+modulesArr[moduleTypeNUM]['custom_design']+'" data-rel="tooltip-desk" title="'+escapeHtml(translations.ChangeLayoutDesignOfPage)+'" data-delay=\'{"show":"1000", "hide":"0"}\'>';html += '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="palette" class="svg-inline--fa fa-palette fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"></path></svg>';
html += '</a>';html += '</div>';} else if ( !(moduleTypeNUM==36 && style==1) && !(moduleTypeNUM==80) && !RichPage.isRichPage(moduleTypeNUM) ) {html += '<div class="btn-group"><a class="btn btn-sm btn-primary no-radius designModuleButton manageWin" data-module-id="'+escapeHtml(moduleID)+'" data-parent-module="'+escapeHtml(moduleTypeNUM)+'" data-rel="tooltip-desk" title="'+escapeHtml(translations.ChangeLayoutDesignOfPage)+'" data-delay=\'{"show":"1000", "hide":"0"}\'><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="palette" class="svg-inline--fa fa-palette fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"></path></svg></a></div>';}}
html += '<div class="btn-group"><a class="btn btn-sm btn-primary no-radius manageWin module-settings-button-container" data-rel="tooltip-desk" title="'+escapeHtml(translations.ChooseWhereLocate)+'" data-delay=\'{"show":"1000", "hide":"0"}\'><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="cog" class="svg-inline--fa fa-cog fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"></path></svg></a></div>';
html += '</div>';html += '</div>';html += '<div class="pages_RemoveButtons smallManageIcons">';html += '<div class="pages-labels-icons-box">';html += '<span class="pages-hide-page-icon fa fa-eye-slash" data-rel="tooltip" title="'+escapeHtml(translations.Your_page_is_hide_from_users)+'" data-delay=\'{"show":"1000", "hide":"0"}\'></span>';html += '</div>';html += '<div class="pages-side-icons-box">';if ( moduleTypeNUM == '78' ) {html += '<span class="pages-category-icon" data-rel="tooltip" title="'+escapeHtml(translations.pagesCategoryIcon)+'" data-delay=\'{"show":"1000", "hide":"0"}\'><i class="fal fa-list-tree"></i></span>';} else if ( moduleTypeNUM == '128' ) {html += '<span class="pages-richpage-icon" data-rel="tooltip" title="'+escapeHtml(translations.pagesRichpageIcon)+'" data-delay=\'{"show":"1000", "hide":"0"}\'><i class="fa-light fa-memo"></i></span>';} else {html += '<span class="pages-on-homepage-only-icon" data-rel="tooltip" title="'+(RichPage.isRichPage(moduleTypeNUM) ? escapeHtml(translations.richPage.showOnHomepageDisabled) : escapeHtml(translations.Your_page_is_hide_from_homepage))+'" data-delay=\'{"show":"1000", "hide":"0"}\'><i class="fa fa-info"></i></span>';}
html += '<a data-rel="tooltip-desk" title="'+(moduleTypeNUM == '78' ? escapeHtml(translations.removeCategory) : escapeHtml(translations.removePage))+'" data-delay=\'{"show":"1000", "hide":"0"}\' data-toggle="confirmation-delete-module" class="cards_buttons delete" data-moduleid="'+escapeHtml(moduleID)+'"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="trash" class="svg-inline--fa fa-trash fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"></path></svg></a>';
html += '</div>';html += '</div>';html += '</div>';if ( moduleTypeNUM == '108' ) {html += '<div class="external-link-module-msg">';html += '<span>'+translations.externalLinkModuleMsg+'</span>';html += '</div>';}
html += '</li>';var $list = $('#sortable');if ( parentId.length !== 0 ) {var $parent = $list.find('#card_'+parentId);if ( $parent.length !== 0 ) {$list = $parent.children('ul');if ( $list.length === 0 ) $list = $('<ul></ul>').appendTo($parent);} else {html = html.replace('data-parent-id="'+parentId+'"','data-parent-id=""');}}
var $module = $(html);if ( moduleTypeNUM == '78' && $module.find('ul').length == 0 ) {var $sortableList = $('<ul></ul>');$sortableList.appendTo($module);if ( !firstLoad ) Wizard.Pages.sortable.init($sortableList,1);}
if ( setSettings ) {$module.data('set-settings',setSettings);}
if ( settings && settings.pageHeaderSettings ) {$module.data('is-new-title-flow',true);$module.data('sync-titles',settings.pageHeaderSettings.pageTitle == name);}
if ( moduleTypeNUM == '169' ) {$module.addClass('hidden');$('#card_homepage').find('#card_169').remove();$('#card_homepage').append($module);} else if ( g_ManageAddModuleData && $list.children().length > 0 ) {if ( g_ManageAddModuleData.action == 'before' ) {$module.insertBefore(g_ManageAddModuleData.$module);} else if ( g_ManageAddModuleData.action == 'after' ) {$module.insertAfter(g_ManageAddModuleData.$module);}} else {$list.append($module);}
FitWizardTextToBox();Wizard.Pages.refresh();if ( moduleTypeNUM != '78' ) {$module.addClass('mjs-nestedSortable-no-nesting');}
if ( !window['isTouchSupported'] ) {$('.moduleSortList [data-rel=tooltip], [data-rel=tooltip-desk]').tooltip({container: 'body'});}
var $moduleName = $module.find('.module_name');$module.data('moduleid',moduleID);$moduleName.val(name);if ( moduleTypeNUM != 1000 && !Wizard.Ecommerce.isEcommerceHighlight(moduleTypeNUM) && moduleTypeNUM != 167 && modulesArr[Number(moduleTypeNUM)] && modulesArr[Number(moduleTypeNUM)]['module_kind']=='3' ) {$module.find('.module-settings-button-container').remove();}
if (modulesArr[Number(moduleTypeNUM)] && modulesArr[Number(moduleTypeNUM)]['module_kind']=='5') {$module.find('.designModuleButton').remove();}
if ( Number(moduleTypeNUM) == 1000 ) {$module.find('.designModuleButton').addClass('hidden');}
$module.find('[data-toggle="confirmation-delete-module"]').confirmation({placement: window['isTouchSupported'] ? intrface_align : intrface_align_reverse,title: (moduleTypeNUM != '78' ? translations.areYouSure : translations.areYouSureCat),btnOkLabel: '<i class="icon-ok-sign icon-white"></i> '+translations.yes+'',btnCancelLabel: '<i class="icon-remove-sign"></i> '+translations.no+'',popout: true,singleton: true,container: 'body',btnOkClass: 'btn-danger btn-sm spacing-confirmation-btn',btnCancelClass: 'btn-default btn-sm spacing-confirmation-btn',delay: 0,onConfirm: function() {RemoveModule($(this));}});$module.find('[data-toggle="confirmation-delete-module"]').one('shown.bs.confirmation', function () {$(this).addClass('del-btn-clicked');$('.popover.confirmation.in').off('click').click(function(event) {event.preventDefault();event.stopPropagation();});});$module.find('[data-toggle="confirmation-delete-module"]').on('show.bs.confirmation', function () {$(this).addClass('del-btn-clicked');});$module.find('[data-toggle="confirmation-delete-module"]').on('hide.bs.confirmation', function() {$(this).removeClass('del-btn-clicked');});$moduleName.keydown( function( event ) {if ( event.which === 13 ) return false;if ( $module.data('is-new-title-flow') ) {settings = GetModuleSetting(moduleID,'settings');settings = tryParseJSON(settings);$module.data('sync-titles',settings.pageHeaderSettings.pageTitle == $moduleName.val());}});$moduleName.off('focus').on('focus', function() {$(this).data('name',$(this).val());});$moduleName.off('blur').on('blur', function() {var $this = $(this);if ( $this.val().length == 0 ) {$this.val($this.data('name')).trigger('input');}});$moduleName.on('input', function( event, skipPreviewSectionTitleUpdate ) {if ( Wizard.Preview.ready ) {if ( moduleID != 112 ) {if ( $module.data('sync-titles') && !skipPreviewSectionTitleUpdate ) {if ( Wizard.Preview.$('#section-'+moduleID+'-title span').length > 0 ) {Wizard.Preview.$('#section-'+moduleID+'-title span').html(escapeHtml(Wizard.Pages.getTextTrasform($moduleName.val())));} else {Wizard.Preview.$('#section-'+moduleID+'-title').html(escapeHtml(Wizard.Pages.getTextTrasform($moduleName.val())));}}
if ( $module.data('is-new-title-flow') && $module.data('sync-titles') ) {settings.pageHeaderSettings.pageTitle = $moduleName.val();EditModuleSetting(moduleID,'settings',JSON.stringify(settings));}
updateModuleNameInBreadCrumbs(moduleID);}
updateModuleNameInMenu(moduleID);}
clearTimeout($moduleName.inputFinished);$moduleName.inputFinished = setTimeout( function() {$(document).trigger('s123.pageName.changed',[$module]);$.ajax({type: "POST",url: "/versions/2/wizard/convertTextToUrl.php",data: 'text='+encodeURIComponent($moduleName.val())+'', // serializes the form's elements.
success: function( pageURL ) {var prevURL = GetModuleSetting(moduleID,'url');if ( pageURL.length === 0 ) pageURL = moduleID;pageURL = CheckPageURLinsideJSON(moduleID,pageURL);if ( Wizard.Preview.ready ) {Wizard.Preview.$('a[href*="'+prevURL+'"]').each(function() {if ( !this.href ) return;if ( this.href.indexOf('/'+prevURL+'/') !== -1 ) {this.href = this.href.replace('/'+prevURL+'/','/'+pageURL+'/');return;}
if ( this.href.indexOf('/'+prevURL+'?') !== -1 ) {this.href = this.href.replace('/'+prevURL+'?','/'+pageURL+'?');return;}});}
BuildToolJSON();isWizardChange = true;isPreviewReload = false;}});},800);});$module.find('.module-settings-button-container').click( function( event ) {var $settingButton = $(this);var moduleTypeNUM = $module.data('moduletypenum');Wizard.Pages.highlight.on($module);if ( moduleTypeNUM != '128' ) {ReloadPreviewAndGoToModule(moduleID,false);}
var $popoverContent = $('<div class="p-m-s-container"></div>');if ( $('.popover.modules-setting').data('module-id') == $module.data('moduleid') ) return false;if ( moduleTypeNUM != '1000' && !Wizard.Ecommerce.isEcommerceHighlight(moduleTypeNUM) ) {if ( IsSinglePage() || IsLandingPage() ) {if ( $module.data('parent-id').length === 0 ) {$popoverContent.append('<div class="checkbox"><label class="block"><input id="page_showInMenu" type="checkbox" class="ace input-lg"><span class="lbl fullColor">'+escapeHtml(translations.showOnMenu)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.showOnPagesMenu)+'"><i class="fa fa-question"></i></a></label></div><div class="checkbox"><label class="block"><input disabled type="checkbox" class="ace input-lg" checked><span class="lbl fullColor" style="opacity:0.5;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.shownOnHomepageSinglePage)+'">'+escapeHtml(translations.showOnHomepage)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.shownOnHomepageSinglePage)+'"><i class="fa fa-question"></i></a></label></div>');$popoverContent.find('#page_showInMenu').prop('checked',$module.data('module-show-in-menu') == '1');if ( IsLandingPage() ) {$popoverContent.find('#page_showInMenu').prop('disabled',true);var $showInMenuCheckbox = $popoverContent.find('#page_showInMenu').closest('.checkbox');$showInMenuCheckbox.find('span.fullColor').css('opacity','0.5');$showInMenuCheckbox.find('span.fullColor').attr('data-rel','tooltip');$showInMenuCheckbox.find('span.fullColor').attr('data-trigger','hover');$showInMenuCheckbox.find('span.fullColor').attr('title',escapeHtml(translations.shownOnHeaderLandingPage));$showInMenuCheckbox.find('a').attr('title',escapeHtml(translations.shownOnHeaderLandingPage));}}} else {if ( $module.data('parent-id').length === 0 && !Wizard.Pages.modeManager.isRichPageOrHomepageMode() ) {$popoverContent.append('<div class="checkbox"><label class="block"><input id="page_mp_showInMenu" type="checkbox" class="page-navigation-checkbox ace input-lg"><span class="lbl fullColor">'+escapeHtml(translations.showOnMenu)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.shownOnSeperatedPage)+'"><i class="fa fa-question"></i></a></label></div>');$popoverContent.find('#page_mp_showInMenu').prop('checked',$module.data('module-mp-show-in-menu') == '1');}
if ( moduleTypeNUM != '78' ) {if ( moduleTypeNUM == '108' ) {$popoverContent.append('<div class="checkbox" style="color:#ddd"><label class="block"><input id="page_mp_showInHome" type="checkbox" class="page-navigation-checkbox ace input-lg" disabled><span class="lbl fullColor">'+escapeHtml(translations.showOnHomepage)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.shownOnHomepage)+'"><i class="fa fa-question"></i></a></label></div>');} else if ( RichPage.isRichPage(moduleTypeNUM) ) {$popoverContent.append('<div data-rel="tooltip" title="'+escapeHtml(translations.richPage.showOnHomepageDisabled)+'" class="checkbox" style="color:#ddd"><label class="block"><input id="page_mp_showInHome" type="checkbox" class="page-navigation-checkbox ace input-lg" disabled><span class="lbl fullColor">&nbsp;'+escapeHtml(translations.showOnHomepage)+'</span>&nbsp;<a href="#" onclick="return false;" data-rel="tooltip"><i class="fa fa-question"></i></a></label></div>');} else if ( !RichPage.isChild($module) ) {$popoverContent.append('<div class="checkbox"><label class="block"><input id="page_mp_showInHome" type="checkbox" class="page-navigation-checkbox ace input-lg"><span class="lbl fullColor">'+escapeHtml(translations.showOnHomepage)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.shownOnHomepage)+'"><i class="fa fa-question"></i></a></label></div>');}
$popoverContent.find('#page_mp_showInHome').prop('checked',$module.data('module-mp-show-in-home') == '1');}}}
if ( $module.data('parent-id').length === 0 && !Wizard.Pages.modeManager.isRichPageOrHomepageMode() && !Wizard.footerHandler.isDisabled && moduleTypeNUM != '1000' && !Wizard.Ecommerce.isEcommerceHighlight(moduleTypeNUM) ) {$popoverContent.append('<div class="checkbox"><label class="block"><input id="page_showInFooter" type="checkbox" class="page-navigation-checkbox ace input-lg"><span class="lbl fullColor">'+escapeHtml(translations.showOnFooter)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.showOnFooterExp)+'"><i class="fa fa-question"></i></a></label></div>');$popoverContent.find('#page_showInFooter').prop('checked',$module.data('module-show-in-footer') == '1');}
if ( moduleTypeNUM != '78' && moduleTypeNUM != '108' ) {$('<hr class="p-m-s-separator">').appendTo($popoverContent).css({display: $popoverContent.find('input').length > 0 ? 'block' : 'none'});if ( RichPage.isChild($module) && RichPage.getParent($module).data('module-hide-front-module') == '1' ) {$popoverContent.append('<div class="checkbox" data-rel="tooltip" title="'+escapeHtml(translations.richPage.hideFrontsectionDisabled)+'"><label class="block"><input id="page_HideFrontModule" type="checkbox" class="ace input-lg" disabled checked><span class="lbl fullColor">'+escapeHtml(translations.Hide_page_from_users)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.Hide_page_from_users_explain)+'"><i class="fa fa-question"></i></a></label></div>');} else {$popoverContent.append('<div class="checkbox"><label class="block"><input id="page_HideFrontModule" type="checkbox" class="ace input-lg"><span class="lbl fullColor">'+escapeHtml(translations.Hide_page_from_users)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.Hide_page_from_users_explain)+'"><i class="fa fa-question"></i></a></label></div>');$popoverContent.find('#page_HideFrontModule').prop('checked',$module.data('module-hide-front-module') == '1');}
if ( !RichPage.isRichPage(moduleTypeNUM) ) {$popoverContent.append('<div class="checkbox"><label class="block"><input id="hideFromMobile" type="checkbox" class="ace input-lg"><span class="lbl fullColor">'+escapeHtml(translations.hideFromMobile)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.hideFromMobileToolTip)+'"><i class="fa fa-question"></i></a></label></div>');$popoverContent.find('#hideFromMobile').prop('checked',$module.data('module-hide-from-mobile') == '1');disableEneableModuleSetting($popoverContent.find('#hideFromMobile'),((!IsSinglePage() && !IsLandingPage() && $module.data('module-mp-show-in-home') == '1') || RichPage.isChild($module) || IsSinglePage() || IsLandingPage()));var $hideFromMobileCheckbox = $popoverContent.find('#hideFromMobile').closest('div.checkbox')
if ( $hideFromMobileCheckbox.hasClass('disabled') ) {$hideFromMobileCheckbox.data('rel','tooltip').attr('title',escapeHtml(translations.Hide_page_from_users_disabled_tooltip))
$hideFromMobileCheckbox.tooltip();} else {$hideFromMobileCheckbox.tooltip('destroy');}}}
if ( moduleTypeNUM != '78' && moduleTypeNUM != '108' && moduleTypeNUM != '1000' && !Wizard.Ecommerce.isEcommerceHighlight(moduleTypeNUM) ) {if ( moduleTypeNUM != '112' && moduleTypeNUM != '167' && !RichPage.isRichPage(moduleTypeNUM) ) {$('<hr class="p-m-s-separator">').appendTo($popoverContent).css({visibility: $popoverContent.find('input').length > 0 ? 'visible' : 'hidden'});$popoverContent.append('<a id="page_slogan" class="btn btn-link" data-moduletypenum="'+escapeHtml(moduleTypeNUM)+'" data-moduleid="'+escapeHtml(moduleID)+'"><label class="block"><i class="ace-icon fa fa-bullhorn"></i><span class="p-m-s-link-text">'+escapeHtml(translations.slogan)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.pageSloganTool)+'"><i class="fa fa-question"></i></a></label></a>');}
if ( (!RichPage.isChild($module) || (RichPage.isChild($module) && modulesArr[moduleTypeNUM]['no_items_links'] == '0')) && !Wizard.Ecommerce.isEcommerceHighlight(moduleTypeNUM) ) {$('<hr class="p-m-s-separator">').appendTo($popoverContent).css({visibility: $popoverContent.find('input').length > 0 ? 'visible' : 'hidden'});$popoverContent.append('<a id="page_seo" class="btn btn-link" data-toggle="modal" data-target="#moduleSettingsWindow" data-moduletypenum="'+escapeHtml(moduleTypeNUM)+'" data-moduleid="'+escapeHtml(moduleID)+'" data-modal-size="m1"><label class="block"><i class="ace-icon fa fa-search"></i><span class="p-m-s-link-text">'+escapeHtml(translations.seo)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.pageSeoTool)+'"><i class="fa fa-question"></i></a></label></a>');$popoverContent.find('#page_seo').click( function( event ) {destroyPopover();});}
$popoverContent.find('#page_slogan').click( function( event ) {var moduleID = $module.data('moduleid');destroyPopover();editPageSlogan(moduleTypeNUM,moduleID);});}
if ( moduleTypeNUM != '78' && getOneTimeModule().indexOf(parseInt(moduleTypeNUM)) == -1 ) {$('<hr class="p-m-s-separator">').appendTo($popoverContent).css({visibility: $popoverContent.find('input').length > 0 ? 'visible' : 'hidden'});$popoverContent.append('<a id="duplicate_page" class="btn btn-link" data-moduletypenum="'+escapeHtml(moduleTypeNUM)+'" data-moduleid="'+escapeHtml(moduleID)+'"><label class="block"><i class="ace-icon fa fa-regular fa-files"></i><span class="p-m-s-link-text">'+escapeHtml(translations.duplicate)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.duplicatePageExplain)+'"><i class="fa fa-question"></i></a></label></a>');$popoverContent.find('#duplicate_page').click( function( event ) {var moduleID = $module.data('moduleid');var moduleTypeNUM = $module.data('moduletypenum');destroyPopover();topWindow.g_ManageAddModuleData = {action: 'after',$module: $module,};duplicateModule(moduleTypeNUM,moduleID,false,null);});}
if ( !IsSinglePage() && !IsLandingPage() && RichPage.isSupported(moduleTypeNUM) && !RichPage.isRelated($module) ) {$('<hr class="p-m-s-separator">').appendTo($popoverContent).css({visibility: $popoverContent.find('input').length > 0 ? 'visible' : 'hidden'});$popoverContent.append('<a id="convertToRichPage" class="btn btn-link" data-moduletypenum="'+escapeHtml(moduleTypeNUM)+'" data-moduleid="'+escapeHtml(moduleID)+'"><label class="block"><i class="fa fa-retweet"></i><span class="p-m-s-link-text">'+escapeHtml(translations.richPage.convertTitle)+'</span><a href="#" onclick="return false;" data-rel="tooltip" data-trigger="hover" title="'+escapeHtml(translations.richPage.convertTooltip)+'"><i class="fa fa-question"></i></a></label></a>');$popoverContent.find('#convertToRichPage').on('click', function() {var $this = $(this);destroyPopover();bootbox.confirm({title: translations.richPage.convertTitle,message: translations.richPage.convertQuestion,className: 'convert-to-rich-page',buttons: {confirm: {label: translations.yes,className: 'btn-success'},cancel: {label: translations.no,className: 'btn-default'}},callback: function( result ) {if ( result ) {Wizard.Pages.modeManager.set('richPage',$this.data('moduleid'),true);}}});});}
$('<hr class="p-m-s-separator">').appendTo($popoverContent).css({visibility: $popoverContent.find('input').length > 0 ? 'visible' : 'hidden'});$popoverContent.append('<a id="deletePage" class="btn btn-link" data-moduleid="'+escapeHtml(moduleID)+'"><label class="block"><i class="ace-icon fa fa-solid fa-trash"></i><span class="p-m-s-link-text">'+(moduleTypeNUM == '78' ? escapeHtml(translations.removeCategory) : escapeHtml(translations.removePage))+'</span></label></a>');$popoverContent.find('#deletePage').confirmation({placement: intrface_align_reverse,title: (moduleTypeNUM != '78' ? translations.areYouSure : translations.areYouSureCat),btnOkLabel: '<i class="icon-ok-sign icon-white"></i> '+translations.yes+'',btnCancelLabel: '<i class="icon-remove-sign"></i> '+translations.no+'',popout: true,singleton: true,container: 'body',btnOkClass: 'btn-danger btn-sm spacing-confirmation-btn',btnCancelClass: 'btn-default btn-sm spacing-confirmation-btn delete-page-confirmation',delay: 0,onConfirm: function() {var $module = Wizard.Pages.getPage($popoverContent.find('#deletePage').data('moduleid'));if ( $module.length > 0	) {RemoveModule($module.find('[data-toggle="confirmation-delete-module"]'));}}});$popoverContent.find('#deletePage').one('shown.bs.confirmation', function () {$('.popover.confirmation.in').off('click').click(function(event) {event.preventDefault();event.stopPropagation();});});$popoverContent.append('<a class="p-m-s-mobile-back-btn blue"><i class="fa fa-arrow-left" aria-hidden="true"></i></a>');$popoverContent.find('.p-m-s-mobile-back-btn').click( function( event ) {destroyPopover();});$popoverContent.find('input').change( function( event ) {var $input = $(event.target);var previewRefresh = true;if ( $module.data('moduletypenum') == '108' ) {if ( $popoverContent.find('input.page-navigation-checkbox:enabled').length > 1 &&$popoverContent.find('input.page-navigation-checkbox:enabled:checked').length === 0 ) {$input.prop('checked',true).trigger('change');return false;}}
switch ( $input.get(0).id ) {case 'page_showInMenu':$module.data('module-show-in-menu',($input.prop('checked') ? '1' : '0'));break;case 'page_mp_showInMenu':$module.data('module-mp-show-in-menu',($input.prop('checked') ? '1' : '0'));$popoverContent.one('pageSettingChange',function() {$module.attr('data-module-mp-show-in-menu',($input.prop('checked') ? '1' : '0'));});if ( $module.data('moduletypenum') == '167' ) {$module.data('isModuleChanged',true);}
break;case 'page_mp_showInHome':$module.data('module-mp-show-in-home',($input.prop('checked') ? '1' : '0'));$popoverContent.one('pageSettingChange',function() {$module.attr('data-module-mp-show-in-home',($input.prop('checked') ? '1' : '0'));});disableEneableModuleSetting($popoverContent.find('#hideFromMobile'),$input.prop('checked') || RichPage.isChild($module));var $hideFromMobileCheckbox = $popoverContent.find('#hideFromMobile').closest('div.checkbox')
if ( $hideFromMobileCheckbox.hasClass('disabled') ) {$hideFromMobileCheckbox.data('rel','tooltip').attr('title',escapeHtml(translations.Hide_page_from_users_disabled_tooltip))
$hideFromMobileCheckbox.tooltip();} else {$hideFromMobileCheckbox.tooltip('destroy');}
break;case 'page_showInFooter':$module.data('module-show-in-footer',($input.prop('checked') ? '1' : '0'));$popoverContent.one('pageSettingChange',function() {$module.attr('data-module-show-in-footer',($input.prop('checked') ? '1' : '0'));});break;case 'page_HideFrontModule':$module.data('module-hide-front-module',($input.prop('checked') ? '1' : '0'));$module.attr('data-module-hide-front-module',($input.prop('checked') ? '1' : '0'));break;case 'hideFromMobile':if ( $input.prop('checked') ) {if ( IsPreviewAtHomepage() || IsPreviewAtRichPage(RichPage.moduleID) ) {Wizard.Preview.$('#section-'+$module.data('moduleid')).addClass('h-s-f-hm');}
$module.data('module-hide-from-mobile','1');$module.attr('data-module-hide-from-mobile','1');} else {if ( IsPreviewAtHomepage() || IsPreviewAtRichPage(RichPage.moduleID) ) {Wizard.Preview.$('#section-'+$module.data('moduleid')).removeClass('h-s-f-hm');}
$module.data('module-hide-from-mobile','0');$module.attr('data-module-hide-from-mobile','0');}
previewRefresh = false;break;}
BuildToolJSON();if ( IsSinglePage() ) {if ( previewRefresh ) {$("#wizardForm").one( 'ajaxSuccess.module_setting_change', function( event ) {UpdatePreviewAreaByAjax(['#websiteHeader','#top-menu-mobile','footer.global_footer ul.navPages','#header #top-menu .navPages'], function() {if ( $input.get(0).id == 'page_showInFooter' ) {window.scrollPreview = 'footer.global_footer ul.navPages';scrollToPointInPreview();}},false,'');});}
AutoSaveWizard(false,true);} else {AutoSaveWizard(previewRefresh,true);}
$(document).trigger('moduleSettingsChanged',[$input.get(0).id]);});$settingButton.popover({container: 'body',content: $popoverContent,html: true,trigger: 'manual',template: '<div class="popover modules-setting" data-module-id="'+$module.data('moduleid')+'" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',placement: window['isTouchSupported'] ? 'auto' : intrface_align_reverse});$settingButton.tooltip('destroy');$settingButton.popover('show');$settingButton.on('shown.bs.popover', function () {$('.popover.modules-setting [data-rel=tooltip]').tooltip({container: 'body',placement: 'auto'});$(document).on('mousedown.pageSettingDestroyPopover LoadModulesLists.start.pageSettingDestroyPopover', function ( event ) {if ( $(event.target).closest('.popover.confirmation').length > 0 && $(event.target).hasClass('btn-danger') ) {destroyPopover();}
if ( $(event.target).closest('.popover.modules-setting').length === 0 && $(event.target).closest('.popover.confirmation').length === 0 ) {destroyPopover();}});$(window).one('blur.pageSettingDestroyPopover', function( event ) {destroyPopover();});$settingButton.closest('.tab-content').one('scroll.pageSettingDestroyPopover', function( event ) {destroyPopover();});});function destroyPopover() {$settingButton.popover('destroy');$popoverContent.trigger('pageSettingChange');$(document).off('mousedown.pageSettingDestroyPopover');$(document).off('LoadModulesLists.start.pageSettingDestroyPopover');$(window).off('blur.pageSettingDestroyPopover');$(window).off('scroll.pageSettingDestroyPopover');$('.popover.modules-setting').find('a[data-rel="tooltip"]').tooltip('destroy');$('.delete-page-confirmation').trigger('click');var activeTab = $('#pagesTab').attr('data-pages-n-i-m-o-h-tab') ? $('#pagesTab').attr('data-pages-n-i-m-o-h-tab') : 'showPagesTab';var isDisaplyOthersPagesPopover = false;if ( !IsSinglePage() && !IsLandingPage() ) {if ( $module.data('parent-id') == "" && activeTab == 'showPagesTab' && $module.data('module-mp-show-in-menu') == '0'
&& $module.data('module-show-in-footer') == '0' && $module.data('module-mp-show-in-home') == '0' ) {var tab = 'showOthersTab';var text = translations.pagesNotInMenuOrHomepageTabs.pageMovedToOthersTab;isDisaplyOthersPagesPopover = true;$('#pagesTab').attr('data-pages-n-i-m-o-h-tab','showPagesTab');} else if ( $module.data('parent-id') == "" && activeTab == 'showOthersTab' && ( $module.data('module-mp-show-in-menu') == '1'
|| $module.data('module-show-in-footer') == '1' || $module.data('module-mp-show-in-home') == '1' ) ) {var tab = 'showPagesTab';var text = translations.pagesNotInMenuOrHomepageTabs.pageMovedToPageTab;isDisaplyOthersPagesPopover = true;}}
if ( isDisaplyOthersPagesPopover ) {var $tab = $('#'+tab);var content = '<div>';content += '<div>'+text.replace('{{page_name}}',$module.find('input.module_name').val())+'</div>';content += '<div class="btn-container"><button type="button" class="btn btn-primary btn-sm ok-btn">'+translations.ok+'</button></div>';content += '<div>';var $content = $(content);$content.find('button.ok-btn').one('click',function(){$tab.popover('hide');});$module.css('pointer-events','none');$tab.popover({container: 'body',content: $content,html: true,trigger: 'manual',template: '<div class="popover modules-pages-n-i-m-o-h-tabs" data-module-id="'+$module.data('moduleid')+'" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',placement: window['isTouchSupported'] ? 'auto' : intrface_align_reverse}).popover('show');$tab.one('hidden.bs.popover',function () {$module.fadeOut(250, function() {$('.popover.modules-setting').popover('destroy');$module.attr('data-module-mp-show-in-menu',$module.data('module-mp-show-in-menu'));$module.attr('data-module-show-in-footer',$module.data('module-show-in-footer'));$module.attr('data-module-mp-show-in-home',$module.data('module-mp-show-in-home'));$module.attr('style',$module.attr('style').replace(/display:\s?none;/, ''));destroyOthersPagesPopover();$module.css('pointer-events','unset');});});$tab.on('shown.bs.popover', function () {$(document).on('mousedown.pageSettingDestroyPopover', function ( event ) {if ( $(event.target).closest('.popover.modules-pages-n-i-m-o-h-tabs').length === 0 ) {destroyOthersPagesPopover();}});$(window).one('blur.pageSettingDestroyPopover', function( event ) {destroyOthersPagesPopover();});$tab.closest('.tab-content').one('scroll.pageSettingDestroyPopover', function( event ) {destroyOthersPagesPopover();});});function destroyOthersPagesPopover() {$tab.popover('destroy');$(document).off('mousedown.pageSettingDestroyPopover');$(window).off('blur.pageSettingDestroyPopover');$(window).off('scroll.pageSettingDestroyPopover');}}}
function disableEneableModuleSetting( $setting, enable ) {if ( enable ) {$setting.prop('disabled',false);$setting.closest('.checkbox').removeClass('disabled');} else {$setting.prop('disabled',true);$setting.closest('.checkbox').addClass('disabled');}}});if ( moduleTypeNUM != '78' ) {$module.find('.modulesEditButton').on('click', function( event, target ) {var $this = $(this);if ( moduleTypeNUM == 112 ) {$this.data('active-tab','tabs/homepage/homepage.php');let eventID = topWindow.SystemModals.sm_eventReg('moduleWindow','hide', function() {$this.data('active-tab','');topWindow.SystemModals.sm_eventRemove('moduleWindow','hide',eventID);});}
$this.data('prevent-module-scroll',moduleTypeNUM != '167');Wizard.Pages.highlight.on($module);if ( !$module.hasClass('p-active') ) {ReloadPreviewAndGoToModule(moduleID,false);}});if ( (moduleTypeNUM == '1000' || moduleTypeNUM == '167' ) && $('html').data('device') !== 'mobile' ) {$module.find('.modulesEditButton[data-moduletypenum="'+moduleTypeNUM+'"]').attr('data-toggle','');$module.find('.modulesEditButton[data-moduletypenum="'+moduleTypeNUM+'"]').attr('data-target','');$module.find('.modulesEditButton[data-moduletypenum="'+moduleTypeNUM+'"]').on('click', function() {if ( !$(this).data('prevent-module-scroll') ) {Wizard.Preview.getModule(moduleID).data('section-highlight-handled',false);ReloadPreviewAndGoToModule(moduleID,false);}});}
$moduleName.on('click', function() {Wizard.Pages.highlight.on($module);if ( moduleTypeNUM != '128' ) {ReloadPreviewAndGoToModule(moduleID,false);}});$module.find('.promoModuleInput').on('click', function() {$moduleName.trigger('click');});$('.promoEditWin[data-moduleid="' + escapeHtml(moduleID) + '"]').click( function( event ) {g_ManageModuleID = moduleID;var $li = $('#card_' + escapeHtml(moduleID));var $promoButton = $(this);var parentModule = $promoButton.data('parent-module');var $container  = $('<div class="container-fluid">'+OpenFastPromoModule(moduleID,moduleTypeNUM,'')+'</div>');var $row = $('<div class="row"></div>').appendTo($container);$promoButton.popover({container: 'body',content: $container,html: true,template: '<div class="popover modules-fast-promo" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',placement: function (context, source) {if ( window['isTouchSupported'] ) return 'auto';var rtl = ($('html[dir=rtl]').length !== 0 ? true : false);var ch = 410 + 20;	// 410 = CSS, 20 = parents padding/margin
var $s = $(source);var bSpace = $(window).height() - ($s.offset().top + $s.outerHeight() + ch);return (bSpace > 0) ? 'bottom' : rtl ? 'left' : 'right';}});$promoButton.popover('show');$promoButton.on('shown.bs.popover', function () {var $promoBackdropManaul = $('<div class="promoBackdropManaul"></div>').appendTo('body');$('.tabbable.tabs-left').addClass('highOpacity');$promoBackdropManaul.on('click', function ( event ) {destroyPopover();});});function destroyPopover() {$promoButton.popover('destroy');$('.promoBackdropManaul').remove();$('.tabbable.tabs-left').removeClass('highOpacity');}});$('.customDesignModuleButton[data-module-id="' + escapeHtml(moduleID) + '"]').click( function( event ) {var $li = $('#card_' + escapeHtml(moduleID));var $cusomDesignButton = $(this);g_ManageModuleID = moduleID;Wizard.Pages.highlight.on($module);ReloadPreviewAndGoToModule(moduleID,false);OpenModuleWindow(moduleID,moduleTypeNUM,'',$(this),'itemsPage');});$('.designModuleButton[data-module-id="' + escapeHtml(moduleID) + '"]').click( function( event, target ) {if ( isInlineEditorProccesing() ) return;g_ManageModuleID = moduleID;Wizard.Pages.highlight.on($module);if( target !== 'wizard-preview' ) {ReloadPreviewAndGoToModule(moduleID,false);}
var $li = $('#card_' + escapeHtml(moduleID));var $designButton = $(this);var parentModule = $designButton.data('parent-module');var hasStylesContents = typeof modulesArr[parentModule].styleContent === 'object';var isContentPage = $designButton.data('is-content-page');if ( ['tablet','mobile'].includes($('html').data('device')) ) {isContentPage = false;} else {if ( /\bone-item-display-\d+\b/.test(Wizard.Preview.$('#section-'+moduleID).attr('class')) ) {isContentPage = true;}}
var x = '<div id="changeStyleModalAllBox">';if ( hasStylesContents ) {x += '<div class="selected-style"></div>';x += '<div class="buttonsTabs">';x += '<div class="tab">';x += '<div class="tab-button stylesButton '+(isContentPage ? '' : 'active')+'">'+escapeHtml(translations.Layout_Main)+'</div>';x += '</div>';x += '<div class="tab">';x += '<div class="tab-button stylesContentButton '+(isContentPage ? 'active' : '')+'">'+escapeHtml(translations.Layout_Content)+'</div>';x += '</div>';x += '</div>';}
x += '<div id="changeStyleModal"';x += '<div class="container-fluid">';x += '<div class="row modules-design-styles">';x += '<div class="modules-design-list fancy-scrollbar"></div>';x += '</div>';x += '<div class="row modules-design-styles-contents">';x += '<div class="modules-design-list fancy-scrollbar"></div>';x += '</div>';x += '</div>';x += '</div>';x += '</div>';var $container  = $(x);var $styles = $container.find('.modules-design-styles .modules-design-list');var $stylesContainer = $container.find('.modules-design-styles');var $stylesContents = $container.find('.modules-design-styles-contents .modules-design-list');var $stylesContentsContainer = $container.find('.modules-design-styles-contents');if ( hasStylesContents ) {$container.addClass('has-styles-contents');}
$container.find('.stylesButton').click(function() {ReloadPreviewAndGoToModule(moduleID,false);$('.buttonsTabs .tab-button').removeClass('active');$(this).addClass('active');$stylesContentsContainer.fadeOut(200, function() {$stylesContainer.fadeIn(200);});});$container.find('.stylesContentButton').click(function() {Wizard.Preview.Redirect.toItem(websiteID,moduleID,moduleTypeNUM);$('.buttonsTabs .tab-button').removeClass('active');$(this).addClass('active');$stylesContents.css('visibility','hidden');$stylesContainer.fadeOut(200, function() {$stylesContentsContainer.fadeIn(200,function(){setTimeout( function() {if ( $stylesContents.find('.modules-design-button.active').closest('.modules-design-button-container').length > 0 ) {$stylesContents.scrollTop($stylesContents.scrollTop() + $stylesContents.find('.modules-design-button.active').closest('.modules-design-button-container').position().top - $stylesContents.position().top - 55);}
$stylesContents.css('visibility','visible');}, 300);});});});if ( isContentPage ) {$container.find('.stylesButton').removeClass('active');$container.find('.stylesContentButton').addClass('active');$stylesContainer.hide();$stylesContentsContainer.show();} else {$stylesContentsContainer.hide();$styles.css('visibility','hidden');}
for ( id in modulesArr ) {var module = modulesArr[id];if ( ts_site123 == '1' || $GLOBALS['is_local_server'] ) module.beta = false;if ( module.beta ) continue;if ( module.parentModule == '1000' && module.isTemplate == '1' ) continue;if ( module.parentModule == parentModule && !module.no_design_change ) {if (module.preview_image=='') {module.preview_image 	= '/files/images/defaultStyleImage.jpg?v=' + $GLOBALS['v-cache-long'] +'';}
if (typeof module.preview_image === 'undefined') {module.preview_image = cdnInterfaceFiles+'/admin/InterfaceStatisFiles/modulesImages/modules/800_module'+module.id+'.jpg';}
var styleOrder = moduleLayoutPreviewImagesOrder(parentModule,module.style,'');var hideStyle = hideModuleLayouts(moduleTypeNUM,module.style,$li.data('module-style'));if ( hideStyle ) continue;var $style = $('<div data-style="' + module.style + '" data-modules-arr-id="' + module.id + '" data-second-side-modules-arr-id="' + (module.hasOwnProperty('secondSideLayout') ? module.secondSideLayout : '') + '" data-moduleid="'+escapeHtml(moduleID)+'" class="col-xs-12 modules-design-button-container"'+styleOrder+'>'
+ '<div class="modules-design-button">'
+ '<img class="modules-design-button-image" src="' + module.preview_image + '?v=' + $GLOBALS['v-cache-long'] +'">'
+ '<i class="ace-icon fa fa-check-circle"></i>'
+ '<span class="modules-custom-design-button"><i class="ace-icon fa fa-cog module-custom-design"></i></span>'
+ '<div class="modules-second-side-container">'
+ '<span class="modules-main-layout">'+translations.layoutCustomizer.tabs.left+'</span>'
+ '<span class="modules-second-side-layout">'+translations.layoutCustomizer.tabs.right+'</span>'
+ '</div>'
+ '</div>'
+ '</div>').appendTo($styles);var $StylesList = [];$StylesList[16] = [1,7,4,5,6,8,2,3,9,10,11,12,13,14,17,25];$StylesList[5] = [1,2,8,9,10];$StylesList[4] = [1,6,7,8,2,5,9,10,11,12];$StylesList[3] = [1,2,7,6,4,5,8,9];$StylesList[17] = [4,7,8,10,12,13,15];$StylesList[52] = [4,7,9,11,13,14,16];$StylesList[1] = [1,4,5,6,7,8,11];$StylesList[11] = [1,2,3,4];$StylesList[12] = [2,1];$StylesList[13] = [1,2,4,5];$StylesList[110] = [2];$StylesList[138] = [1,2];$StylesList[79]  = [1,2,3,4,5,6,7,8];$StylesList[106] = [4];$StylesList[167] = [1,2,3,4,5,6,7,8,9,10,12,14,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,48,49,50,51,52,53,54,55,56,57,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94],$StylesList[169] = [1,2,4,5,6,7,8,9,14,15,16,17,18,20,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94],$StylesList[9] = [1,2];$StylesList[41] = [1,2,3];$StylesList[107] = [1,2,3,4,5,6,8,9];if ( !$StylesList[moduleTypeNUM] || ($StylesList[moduleTypeNUM] && !$StylesList[moduleTypeNUM].includes(parseInt(module.style))) ) {$style.find('.modules-custom-design-button').hide();}
if ( !module.hasOwnProperty('secondSideLayout') ) {$style.find('.modules-second-side-container').hide();}
if ( module.hasOwnProperty('isSecondSideLayout') ) {$style.data('is-second-side-layout',true);$style.hide();}
if ( module.style == $li.data('module-style') ) {$style.find('.modules-design-button').addClass('module-design-active');}
$style.click( function( event, mainModulesArrID = null) {if ( $(event.target).hasClass('module-custom-design') || $(event.target).hasClass('modules-second-side-layout') ) return;var $this = $(this);$styles.find('.modules-design-button.active').removeClass('active');$styles.find('.modules-custom-design-button.active').removeClass('active');$styles.find('.modules-second-side-layout.active').removeClass('active');$styles.find('.modules-main-layout.active').removeClass('active');if ( mainModulesArrID == null ) {$this.find('.modules-design-button').addClass('active');$this.find('.modules-custom-design-button').addClass('active');$this.closest('.modules-design-button-container').find('.modules-main-layout').addClass('active');$this.closest('.modules-design-button-container').find('.modules-second-side-layout').removeClass('active');} else {var $mainModule = $this.closest('.modules-design-styles').find('.modules-design-button-container[data-second-side-modules-arr-id="'+mainModulesArrID+'"]');$styles.find('.modules-design-button.active').removeClass('active');$mainModule.find('.modules-design-button').addClass('active');$styles.find('.modules-custom-design-button.active').removeClass('active');$mainModule.find('.modules-custom-design-button').addClass('active');$mainModule.find('.modules-second-side-layout').addClass('active');$mainModule.find('.modules-main-layout').removeClass('active');}
setModuleStyle({websiteID: websiteID,moduleID: moduleID,moduleTypeNUM: moduleTypeNUM,$module: $li,newStyle: $this.data('style'),newModuleArrID: $this.data('modules-arr-id')});var isUpdateHeaderModuleVersion = false;if ( moduleTypeNUM == '167' || moduleTypeNUM == '169' ) {if ( Wizard.Preview.ready ) {var $module = Wizard.Preview.$('#section-'+moduleID);if ( $module.attr('data-version') == undefined || $module.attr('data-version') != '2' ) {isUpdateHeaderModuleVersion = true;}}}
if ( isUpdateHeaderModuleVersion ) {Wizard.UpdateModuleItemSettings(moduleID,moduleTypeNUM,{'version':'2'})
.then(function() {if ( moduleTypeNUM == '167' || moduleTypeNUM == '169' ) {Wizard.InlineModuleEditor.im_reload(moduleID,moduleTypeNUM);}
ReloadPreviewAndGoToModule(moduleID,true);});} else {g_ManageModuleID = moduleID;}});initializeCustomLayoutPopUp($style.find('.modules-custom-design-button'),$style.data('moduleid'));$style.find('.modules-second-side-layout').off('click').on('click',function() {var $this = $(this);var secondSideModuleID = $this.closest('.modules-design-button-container').data('second-side-modules-arr-id');$this.closest('.modules-design-styles').find('.modules-design-button-container[data-modules-arr-id="'+secondSideModuleID+'"]').trigger('click',[secondSideModuleID]);$this.addClass('active');$this.closest('.modules-design-button-container').find('.modules-main-layout').removeClass('active');});}}
if ( hasStylesContents ) {var allStyleContent = modulesArr[parentModule].styleContent;for (var i = 0; i < allStyleContent.length; i++) {var contentLayout = allStyleContent[i];if (contentLayout.preview_image=='') {contentLayout.preview_image 	= '/files/images/defaultStyleImage.jpg?v=' + $GLOBALS['v-cache-long'] +'';}
var styleOrder = moduleLayoutPreviewImagesOrder(parentModule,contentLayout.style,'content');var $styleContent = $('<div data-style-content="' + contentLayout.style + '" class="col-xs-12 modules-design-button-container"'+styleOrder+'>'
+ '<div class="modules-design-button">'
+ '<img class="modules-design-button-image" src="' + contentLayout.preview_image + '?v=' + $GLOBALS['v-cache-long'] +'">'
+ '<i class="ace-icon fa fa-check-circle"></i>'
+ '</div>'
+ '</div>').appendTo($stylesContents);if ( contentLayout.style == $li.data('module-style-content') ) {$styleContent.find('.modules-design-button').addClass('active');}
$styleContent.click( function( event ) {var $this = $(this);$li.data('module-style-content',$this.data('style-content'));$stylesContents.find('.modules-design-button.active').removeClass('active');$this.find('.modules-design-button').addClass('active');BuildToolJSON();AutoSaveWizard(false,true);$("#wizardForm").one('ajaxSuccess', function( event ) {Wizard.Preview.Redirect.toItem(websiteID,moduleID,moduleTypeNUM);});});}}
var $pagesTab = $('#pagesTab');var $pages = $pagesTab.find('fieldset.pages');var $pagesDesign = $pagesTab.find('fieldset.inline-module');var $designList = $pagesDesign.find('.inline-module-container');var $backBtn = $pagesTab.find('.inline-module-back-btn');$pagesTab.removeClass('pages-recycle-active');$pagesTab.find('fieldset.pages-recycle').hide();$pages.hide();$designList.html('');$designList.append($container);$pagesDesign.fadeIn(250,function() {setTimeout( function() {var $modulesDesignButtonContainer = $styles.find('.modules-design-button.module-design-active').closest('.modules-design-button-container');if ( $modulesDesignButtonContainer.data('is-second-side-layout') ) {var mainModuleArrID = $modulesDesignButtonContainer.data('modules-arr-id');var $mainModule = $('.modules-design-list [data-second-side-modules-arr-id="'+mainModuleArrID+'"]');if ( $mainModule.length > 0 ) {$styles.find('.modules-design-button.module-design-active').removeClass('module-design-active');$mainModule.find('.modules-design-button').addClass('module-design-active');$mainModule.find('.modules-second-side-layout').addClass('active');}} else {$styles.find('.modules-design-button.module-design-active .modules-main-layout').addClass('active');}
if ($styles.find('.modules-design-button.module-design-active').length > 0) { //Sometimes the active style is not in the list because we remove it
$styles.scrollTop($styles.scrollTop() + $styles.find('.modules-design-button.module-design-active').closest('.modules-design-button-container').position().top - $styles.position().top - 55);}
$styles.css('visibility','visible');$styles.find('.modules-design-button.module-design-active').removeClass('module-design-active').addClass('active');}, 300);});$pagesTab.addClass('inline-module-active');if ( $('html').data('device') === 'mobile' ) {$backBtn.hide();$('#wizardBox .wizardBackToTabs-container').data('custom-event',true);$('#wizardBox .wizardBackToTabs-container').one('click', function() {$pagesDesign.hide();$pages.fadeIn(250);$pagesTab.removeClass('inline-module-active');$(this).data('custom-event',false);});} else {$backBtn.show();}
$backBtn.addClass('is-active');$backBtn.off('click').on('click',function() {$pagesDesign.hide();$pages.fadeIn(250);$pagesTab.removeClass('inline-module-active');$backBtn.removeClass('is-active');});function moduleLayoutPreviewImagesOrder( parentModule, style, type ) {var layoutArray = '';if ( type != 'content' ) {if ( parentModule == '1000' ) {layoutArray = ['27','30','33','34','17','18','21','31','19','32','23','22','11','12','13','14','20','24','25','28','29','15','16','26'];return 'style="order:' + (layoutArray.indexOf(style) + 1) + '"';} else if ( parentModule == '169' ) {layoutArray = ['6','43','26','48','67','68','24','23','72','49','38','50','30','51','52','53','70','42','57','58','59','29','55','36','56','37','22','54','25','7','8','27','28','17','18','15','16','61','60','63','62','65','64','33','34','66','35','39','40','41','46','47','44','45','5','9','31','32','14','71','73','74','75','76','77','78','79','80','81','82','83','86','87','88','89','90','91','92','93','94','84','85','95','96'];return 'style="order:' + (layoutArray.indexOf(style) + 1) + '"';} else if ( parentModule == '167' ) {layoutArray = ['18','43','26','48','67','68','24','23','72','49','38','50','30','51','52','53','70','42','57','58','59','29','55','36','56','37','22','54','25','9','15','27','28','7','13','6','12','61','60','63','62','65','64','33','34','66','35','39','40','41','1','4','8','14','20','21','31','32','5','71','73','74','75','76','77','78','79','80','81','82','83','86','87','88','89','90','91','92','93','94','84','85','95','96'];return 'style="order:' + (layoutArray.indexOf(style) + 1) + '"';} else if ( parentModule == '1' ) {layoutArray = ['1','9','10','2','3','4','5','6','7','8','11'];return 'style="order:' + (layoutArray.indexOf(style) + 1) + '"';} else if ( parentModule == '52' ) {layoutArray = ['2','4','5','9','7','11','12','13','14','15','16','17','6','8','3','10'];return 'style="order:' + (layoutArray.indexOf(style) + 1) + '"';} else if ( parentModule == '17' ) {layoutArray = ['1','10','11','12','13','14','15','16','4','5','7','8','2','9'];return 'style="order:' + (layoutArray.indexOf(style) + 1) + '"';}} else {if ( parentModule == '17' ) {layoutArray = ['6','5','1','2','3','4'];return 'style="order:' + (layoutArray.indexOf(style) + 1) + '"';} else if ( parentModule == '52' ) {layoutArray = ['7','5','2','1','3','4','6'];return 'style="order:' + (layoutArray.indexOf(style) + 1) + '"';}}
return '';}});$module.find('.enter-rich-page').on('click', function() {Wizard.Pages.modeManager.set('richPage',$(this).data('moduleid'),true);});}
if ( firstLoad == false ) {BuildToolJSON();if ( IsSinglePage() || IsPreviewAtHomepage() && !RichPage.isRelated($module) ) {$("#wizardForm").one( 'ajaxSuccess', function( event ) {if ( !IsSinglePage() && IsNotInHomepageAndNotOnMenu() ) {ReloadPreviewAndGoToModule(moduleID,true);} else {UpdatePreviewAreaByAjax(['#s123ModulesContainer','footer.global_footer ul.navPages','#websiteHeader'], function() {window.scrollPreview = '#section-' + moduleID;scrollToPointInPreview();},false,'');}});clearTimeout(window.addNewModuleDelay);window.addNewModuleDelay = setTimeout(function() {AutoSaveWizard(false,true);},0);} else if ( RichPage.isRelated($module) ) {$('#wizardForm').off('ajaxSuccess.RichPage.duplicate').one('ajaxSuccess.RichPage.duplicate', function( event ) {if ( RichPage.goToRichPage ) {ReloadPreviewAndGoToModule(RichPage.getParent($module).data('moduleid'),true);RichPage.goToRichPage = false;} else {let selectors = ['#s123ModulesContainer'];if ( $module.data('moduleid') == Wizard.Ecommerce.moduleID ) {selectors.push('#mainNav ul.navPages');selectors.push('footer.global_footer ul.navPages');}
UpdatePreviewAreaByAjax(selectors, function() {window.scrollPreview = '#section-' + $module.data('moduleid');scrollToPointInPreview();},false,RichPage.getPageUrl($module));}});clearTimeout(window.addNewModuleDelay);window.addNewModuleDelay = setTimeout(function() {AutoSaveWizard(false,true);},500);} else {window.scrollPreview = '#section-' + moduleID;AutoSaveWizard(true,true);}
DisableAddModules(false);$('#AddModuleWin').modal('hide');$module.scrollParent().stop().animate({scrollTop: $module.position().top - $("#sortable").offset().top}, 500, function() {if ( RichPage.isActive && RichPage.isRichPage($module.data('moduletypenum')) ) return;$module.data('tmp-an-bg',$module.css('backgroundColor')).stop().animate({backgroundColor: "#f0ad4e"},1000, function() {$module.animate({backgroundColor: $module.data('tmp-an-bg')},1000, function() {$module.css({ backgroundColor: '' });});});});$(document).trigger('s123.wizardPageAdded',[$module]);}
function initializeCustomLayoutPopUp( $btn, moduleID ) {$btn.off('click').on('click',function( event ) {event.preventDefault();var $this           = $(this);var $wizardPage     = Wizard.Pages.getPage(moduleID);var modulesArrID     = $wizardPage.data('modules-arr-id');$('body').trigger('mousedown.preview.styleCustomizerPopover');if ( Wizard.Preview.ready ) {Wizard.Preview.$('body').trigger('mousedown.preview.styleCustomizerPopover');}
if ( $('body .modules-setting.layout-customizer').data('module-id') == moduleID ) return;var moduleLayoutCustomizer = new ModuleLayoutCustomizer({$container: $this.find('.module-custom-design'),defaultData: tryParseJSON(modulesArr[modulesArrID]['layout_customize']),moduleID: moduleID,style: modulesArrID,translations: translations.layoutCustomizer,popoverPlacement: $('html[dir=rtl]').length == $('html[dir=rtl]').length ? 'intrface_align_reverse' : 'intrface_align',onChange: function( newlayoutSetting ) {g_ManageModuleID = moduleID;var moduleSetting = GetModuleSetting(g_ManageModuleID,'settings');moduleSetting = tryParseJSON(moduleSetting);if ( !moduleSetting ) {moduleSetting = {layout_customize: newlayoutSetting};} else {moduleSetting.layout_customize = newlayoutSetting;}
EditModuleSetting(g_ManageModuleID,'settings',JSON.stringify(moduleSetting));BuildToolJSON();AutoSaveWizard(true,true);}});});}}
function updateModuleNameInBreadCrumbs( moduleID ) {if ( !Wizard.Preview.ready ) return;var $moduleName = Wizard.Pages.getPage(moduleID).find('.module_name');Wizard.Preview.$('#section-'+moduleID+'-title').attr('data-original-title',escapeHtml($moduleName.val()));Wizard.Preview.$('.breadcrumb-wrap [data-module-id="'+moduleID+'"]').text(escapeHtml($moduleName.val()));}
function updateModuleNameInMenu( moduleID ) {if ( !Wizard.Preview.ready ) return;var $moduleName = Wizard.Pages.getPage(moduleID).find('.module_name');if ( moduleID == 112 ) {updateModuleName(Wizard.Preview.$('li[data-menu-module-id="'+moduleID+'"]:not(.ec-collection) > a'),escapeHtml($moduleName.val()));} else {updateModuleName(Wizard.Preview.$('li[data-menu-module-id="'+moduleID+'"] > a'),escapeHtml($moduleName.val()));}}
function updateModuleName( $modules, newModuleName ) {$modules.each(function( index, module ) {var $module = $(module);var prevContent = $.parseHTML($module.html());var tmpDoc = $(new DOMParser().parseFromString($module.html(),'text/html'));var elements = tmpDoc.find('body').children();var txtContainer = elements.filter('.txt-container');var moduleName = newModuleName;var template = '{{txt}}&nbsp;{{html}}';txtContainer.html(moduleName);moduleName = template.replace('{{txt}}',txtContainer.prop('outerHTML'));if ( elements.filter(':not(.txt-container)').length > 0 ) {moduleName = moduleName.replace('{{html}}',elements.filter(':not(.txt-container)').prop('outerHTML'));} else {moduleName = moduleName.replace('{{html}}','');}
$module.html(moduleName);});clearTimeout(window.updateModuleName_Delay);window.updateModuleName_Delay = setTimeout( function() {if ( Wizard.Preview.ready ) {Wizard.Preview.window.ResetMoreButton();}},100);}
function CheckPageURLinsideJSON( m_moduleID, url ) {if ( tools_manage.length > 0 ) {var modules = jQuery.parseJSON(tools_manage);modules.forEach( function( module ) {if ( module.url == url && module.moduleID != m_moduleID ) {url = url + '-1';url = CheckPageURLinsideJSON(m_moduleID,url);}});modules.forEach( function( module ) {if ( module.moduleID == m_moduleID ) {module.url = url;return;}});tools_manage = JSON.stringify(modules);}
return url;}
function RemoveModule( $button ) {var $li = $button.closest('li');$.ajax({type: "POST",url: "/versions/2/wizard/modules/removeModule.php",data: {w: $('#id').val(),moduleID: $li.data('moduleid'),moduleTypeNUM: $li.data('moduletypenum'),},success: function(data) {Wizard.Preview.closePopups();var data = $.parseJSON(data);if ( data.status == 'success' ) {$.each(data.itemsModuleIDs, function( index, itemsModuleID ) {$('#sortable li[data-items-module-id="'+itemsModuleID.old+'"]').data('items-module-id',itemsModuleID.new).attr('data-items-module-id',itemsModuleID.new);$('#sortable li#card_'+itemsModuleID.new).data('items-module-id','').attr('data-items-module-id','');});}
if ( IsPreviewAtRichPage(RichPage.moduleID) || RichPage.isHighlighted() ) {if ( RichPage.isRichPage($li.data('moduletypenum')) ) {if ( RichPage.isActive ) Wizard.Pages.modeManager.set('pages','',false);isPreviewReload = true;RefreshPreview();} else if ( $li.data('moduletypenum') == '78' && $li.find(`[data-moduletypenum="${RichPage.moduleTypeNUM}"]`).length > 0 ) {isPreviewReload = true;RefreshPreview();}}
$li.fadeOut(250, function() {if ( Wizard.Preview.ready && (IsSinglePage() || IsPreviewAtHomepage() || IsPreviewAtRichPage(RichPage.moduleID) || RichPage.isHighlighted()) ) {if ( Wizard.Preview.ready ) {Wizard.Preview.window.DestroyParallaxImages();}
if ( $li.data('moduletypenum') == '78' ) {$li.find('ul > li').each(function( index, module ) {Wizard.Preview.getModule($(module).data('moduleid')).remove();});} else {Wizard.Preview.getModule($li.data('moduleid')).remove();}
$button.find('[data-rel=tooltip]').tooltip('destroy');$button.confirmation('destroy');$li.remove();SortPreviewModules(true);BuildToolJSON();AutoSaveWizard(false,true);} else {$button.find('[data-rel=tooltip]').tooltip('destroy');$button.confirmation('destroy');$li.remove();BuildToolJSON();AutoSaveWizard(true,true);}
if ( getOneTimeModule().indexOf(parseInt($li.data('moduletypenum'))) != -1 || $li.data('moduletypenum') == '204' ) {if ( $li.data('moduletypenum') == '204' ) {var moduleTypeNUM = $li.data('moduletypenum');} else {var moduleTypeNUM = $li.data('moduleid');}
var $limitedModule = $('#addNewModuleIframe').contents().find('div[data-module-type-num="'+moduleTypeNUM+'"]');$limitedModule.removeClass('module-limited-to-one');if ( $('#addNewModuleIframe').length > 0 ) {$('#addNewModuleIframe').get(0).contentWindow.disableEnableHighlights();}}
Wizard.refresh();$(document).trigger('removeModule.success',[$li.data('moduleid'),$li]);$(document).trigger('removeModule.optionToggle',[$li]);});$('#pagesTab').removeClass('inline-module-active');$('#pagesTab fieldset.inline-module').hide();PagesRecycle.displayPages();PagesRecycle.highlightBtn();}});}
function ShowHideModulesDiv(element) {if ($(element).is(":visible")) {$(element).hide();} else {$(element).show();}}
function GetModuleSetting(moduleID,setting) {var returnResult = '';var moduleTypeNUM = $('#card_'+moduleID+'').data('moduletypenum');if ( !moduleTypeNUM && $.isNumeric(moduleID) ) moduleTypeNUM = moduleID;if (modulesArr[Number(moduleTypeNUM)] && modulesArr[Number(moduleTypeNUM)]['module_kind']=='2') {returnResult = modulesArr[Number(moduleTypeNUM)]['name'];} else {if ( tools_manage.length === 0 || !moduleID || !setting ) return;modules = jQuery.parseJSON(tools_manage);modules.forEach( function( module ) {if ( module.moduleID == moduleID ) {if ( typeof module[setting] === "object" ) {returnResult = JSON.stringify(module[setting]);} else {returnResult = module[setting];}
return;}});}
return returnResult;}
function EditModuleSetting( moduleID, setting, value ) {if ( tools_manage.length === 0 || !moduleID || !setting ) return;var modules = tryParseJSON(tools_manage);$.each(modules, function( index, module ) {if ( module.moduleID == moduleID ) {module[setting] = value;return;}});tools_manage = JSON.stringify(modules);}
function BuildModuleSideMenu( moduleID, heighestHeightNUM, sideMenu, activeTab ) {if ( sideMenu.length === 0 || sideMenu.tabs.length === 0 ) return;tabs = sideMenu.tabs;var websiteID = $('#id').val();var parentModuleID = GetModuleSetting(moduleID,'parentId');var parentModuleTypeNUM = GetModuleSetting(parentModuleID,'moduleTypeNUM');var moduleTypeNUM = GetModuleSetting(moduleID,'moduleTypeNUM');if ( Wizard.Ecommerce.isEcommerceHighlight(moduleTypeNUM) ) {moduleID = 112;}
var html ='';html = '<div id="moduleSideMenu" class="sidebar responsive-min" style="height:'+heighestHeightNUM+'px;" data-sidebar="true" data-sidebar-hover="true">';html += '<ul class="nav nav-list fancy-scrollbar">';var i = 1;$.each( tabs, function( index, tab ) {tab.divider = (typeof tab.divider !== 'undefined') ? tab.divider : '0';tab.dash = (typeof tab.dash !== 'undefined') ? tab.dash : '0';tab.class = (typeof tab.class !== 'undefined') ? tab.class : '';if (tab.dash=='1') {return true;}
tab.href = tab.href.replace('{{moduleID}}', moduleID);tab.href = tab.href.replace('{{websiteID}}', websiteID);tab.href = tab.href.replace('{{orderID}}','');if ( tab.subTabs ) {$.each(tab.subTabs,function( index, subTab) {if ( subTab.href.indexOf(activeTab) !== -1 ) tab._is_sub_tab_active = true;});}
if (tab.divider=='1') {html += '<li class="dividerSubTitle">';html += tab.title;html += '</li>';} else {tab.active = tab.href.indexOf(activeTab) !== -1;if ( tab.active ) {tab._li_class = 'active';} else if ( tab._is_sub_tab_active ) {tab._li_class = ' open active';} else {tab._li_class = '';}
html += `<li class="${tab._li_class} ${tab.class}">`;html += '<a href="#" class="dropdown-toggle '+(tab.openNewTab == '1' ? 'open-new-tab' : '')+'" onclick="return false;" data-href="'+escapeHtml(tab.href)+'">';html += '<i class="'+escapeHtml(tab.icon)+'"></i>';html += '<span class="menu-text"> '+tab.title+' </span>';html += '</a>';html += '<b class="arrow"></b>';if ( tab.subTabs ) {html += '<ul class="submenu nav-hide" style="'+(tab._is_sub_tab_active ? 'display:block;' : 'display:none;' )+'">';$.each(tab.subTabs,function( index, subTab) {if ( !isPricingShippingTabEditable && moduleTypeNUM == 10 && subTab.id == 'shippingAndTax' ) return;subTab.dash = (typeof subTab.dash !== 'undefined') ? subTab.dash : '0';if ( subTab.dash == '1' ) return;subTab.href = subTab.href.replace('{{moduleID}}', moduleID);subTab.href = subTab.href.replace('{{websiteID}}', websiteID);html += `<li class="${subTab.class} ${subTab.href.indexOf(activeTab) !== -1 ? ' class="active"' : ''}">`;html += '<a href="#" onclick="return false;" data-href="'+escapeHtml(subTab.href)+'">';html += '<i class="'+escapeHtml(subTab.icon)+'"></i>';html += '<span class="menu-text"> '+subTab.title+' </span>'
html += '</a>';html += '<b class="arrow"></b>';html += '</li>';});html += '</ul>';}
html += '</li>';}
i++;});html += '</ul>';html += '</div>';return html;}
function getModuleSideMenuPreviewUrl( url ) {return '/'+url+'?w='+websiteID+'&disableCache='+getRandomInt(0,9999999);}
function BuildMobileModuleSideMenu( moduleID, heighestHeightNUM, sideMenu, activeTab ) {if ( sideMenu.length === 0 || sideMenu.tabs.length === 0 ) return;var moduleTypeNUM = GetModuleSetting(moduleID,'moduleTypeNUM');if ( hideSideMenuByModule(moduleTypeNUM,moduleID,false) ) return '';if ( Wizard.Ecommerce.isEcommerceHighlight(moduleTypeNUM) ) {moduleID = 112;}
tabs = sideMenu.tabs;var html ='';html = '<div id="moduleMobileBottomMenu">';var i = 1;$.each( tabs, function( index, tab ) {tab.divider = (typeof tab.divider !== 'undefined') ? tab.divider : '0';tab.dash = (typeof tab.dash !== 'undefined') ? tab.dash : '0';if (tab.dash=='1') {return true;}
if (tab.divider=='1') {return true;}
tab.href = tab.href.replace('{{moduleID}}', moduleID);tab.href = tab.href.replace('{{websiteID}}', $('#id').val());tab.href = tab.href.replace('{{orderID}}','');html += '<a href="#" class="' + (tab.href.indexOf(activeTab) !== -1 ? ' custom-active' : '' ) + ' text-center '+tab.class+'" onclick="return false;" data-href="'+escapeHtml(tab.href)+'">';html += '<i class="'+escapeHtml(tab.icon)+' bigger-200"></i><span class="menu-text-container">'+tab.title+'</span>';html += '</a>';if ( tab.subTabs ) {html += '<div class="sub-tabs">';$.each(tab.subTabs,function( index, subTab) {if ( !isPricingShippingTabEditable && moduleTypeNUM == 10 && subTab.id == 'shippingAndTax' ) return;subTab.dash = (typeof subTab.dash !== 'undefined') ? subTab.dash : '0';if ( subTab.dash == '1' ) return;subTab.href = subTab.href.replace('{{moduleID}}', moduleID);subTab.href = subTab.href.replace('{{websiteID}}', $('#id').val());html += '<a href="#" class="' + (i==1 ? ' active' : '' ) + ' text-center '+subTab.class+'" onclick="return false;" data-href="'+escapeHtml(subTab.href)+'">';html += '<li class="'+escapeHtml(subTab.icon)+' bigger-200"></li><span class="menu-text-container">'+subTab.title+'</span>';html += '</a>';});html += '</div>';}
i++;});html += '</div>';return html;}
function AddNewModuleExternalLink() {if ( PagesLimitations() ) return;if ( OpenPremiumFeatures(packageNUM) == '1' ) {topWindow.upgradeFeaturesManager.show({featureID: 'externalLink'});return;}
moduleTypeNUM = 108;AddNewModule(modulesArr[moduleTypeNUM]['parentModule'],modulesArr[moduleTypeNUM]['name'],false,modulesArr[moduleTypeNUM]['style'],modulesArr[moduleTypeNUM]['style'],1,1,0,1,0,'',moduleTypeNUM);}
function editPageSlogan( moduleTypeNUM, moduleID ) {if ( topWindow.editPageSlogan_inProgress ) return;topWindow.editPageSlogan_inProgress = true;$.ajax({type: "POST",url: "/versions/2/wizard/modules/getSettingsAjax.php",data: 'w='+$('#id').val()+'&moduleID='+moduleID+'&moduleTypeNUM='+moduleTypeNUM,success: function( data ) {var data = $.parseJSON(data);if ( data.status != 'Done' ) {topWindow.editPageSlogan_inProgress = false;return;}
bootbox.dialog({title: translations.slogan + '&nbsp;<small>(500)</small>',message: '<form id="editModuleSloganForm" class="bootbox-form"><div class="form-group"><textarea class="form-control" name="editModuleSlogan" id="editModuleSlogan" placeholder="'+escapeHtml(translations.slogan)+'" maxlength="500">'+data.slogan+'</textarea></div></form>',className: 'wizard-edit-module-slogan',closeButton: true,backdrop: true,onEscape: function() {},buttons: {cancel: {label: translations.Cancel,className: 'btn-default'},confirm: {label: translations.Save,className: 'btn-success',callback: function() {savePageSlogan(moduleTypeNUM,moduleID,this.find('#editModuleSlogan').val(),true);}}},}).on("shown.bs.modal", function() {$(this).find('#editModuleSlogan').focus();}).on("hidden.bs.modal", function() {topWindow.editPageSlogan_inProgress = false;});}});}
function savePageSlogan( moduleTypeNUM, moduleID, slogan, reloadPreview ) {g_ManageModuleID = moduleID;$.ajax({type: "POST",url: "/versions/2/wizard/modules/saveSloganAjax.php",data: 'w='+$('#id').val()+'&moduleID='+moduleID+'&moduleTypeNUM='+moduleTypeNUM+'&slogan='+encodeURIComponent(slogan),success: function(data) {if ( data == 'Done' ) {AutoSaveWizard(reloadPreview,true);EditModuleSetting(moduleID,'slogan',slogan);}}});}
function saveModuleTitle( moduleTypeNUM, moduleID, title, preventDuplicateUrl, callBack ) {$.ajax({type: "POST",url: "/versions/2/wizard/modules/saveModuleTitleAjax.php",data: 'w='+$('#id').val()+'&moduleID='+moduleID+'&moduleTypeNUM='+moduleTypeNUM+'&title='+encodeURIComponent(title)+'&preventDuplicateUrl='+preventDuplicateUrl,success: function(data) {if ( callBack ) callBack.call(this,tryParseJSON(data));}});}
var PagesRecycle = function() {var pr = {};pr.init = function() {pr.websiteID = $('#id').val();pr.$pagesTab = $('#pagesTab');pr.$pages = pr.$pagesTab.find('fieldset.pages');pr.$container = pr.$pagesTab.find('fieldset.pages-recycle');pr.$list = pr.$container.find('ul');pr.$recycleBtn = pr.$pagesTab.find('.pages-recycle-btn');pr.$recycleBackBtn = pr.$pagesTab.find('.pages-recycle-back-btn');pr.$recycleBtn.off('click').on('click',function() {pr.$list.html('<div id="pagesRecycleLoader" class="text-center"><i class="ace-icon fa fa-spinner fa-spin fa-4x"></i></div>');pr.$pages.hide();pr.$container.fadeIn(250);pr.$recycleBtn.tooltip('hide');pr.getDeletedModules();pr.$pagesTab.addClass('pages-recycle-active');if ( $('html').data('device') === 'mobile' ) {$('#wizardBox .wizardBackToTabs-container').data('custom-event',true);$('#wizardBox .wizardBackToTabs-container').one('click', function() {pr.displayPages();$(this).data('custom-event',false);});} else {pr.$recycleBackBtn.show();}});pr.$recycleBackBtn.off('click').on('click',function() {pr.displayPages();});}();pr.displayPages = function() {pr.$container.hide();pr.$pages.fadeIn(250);pr.initializeButton();pr.$recycleBackBtn.tooltip('hide').hide();pr.$pagesTab.removeClass('pages-recycle-active');}
pr.getDeletedModules = function() {$.ajax({type: "POST",url: "/versions/2/wizard/modules/getDeletedModules.php",data: {w: pr.websiteID},success: function(data) {var data = jQuery.parseJSON(data);if ( data.deletedModules.length == 0 ) {pr.$list.html('<div class="text-center empty-restore-msg">' + translations.EmptyRestoreMessage + '</div>');} else {pr.$list.html('');$.each(data.deletedModules, function( index, value ) {var $deletedModuleHTML = pr.addDeletedModuleHTML(value);$deletedModuleHTML.find('.p-r-page-restore-btn').off('click').on('click',function() {var $this = $(this);var isClicked = $this.data('is-clicked');$this.data('is-clicked',"true");$(this).attr('disabled',true);if ( !isClicked ) {pr.restoreDeletedModule($deletedModuleHTML.data('moduleid'));}});$deletedModuleHTML.appendTo(pr.$list);if ( !window['isTouchSupported'] ) {pr.$list.find('[data-rel=tooltip], [data-rel=tooltip-desk]').tooltip({container: 'body'});}});}}});}
pr.getDeletedModulesJSON = function( callback ) {$.ajax({type: "POST",url: "/versions/2/wizard/modules/getDeletedModules.php",data: {w: pr.websiteID},success: function(data) {var data = jQuery.parseJSON(data);callback(data);}});}
pr.addDeletedModuleHTML = function( module ) {var html = '';module.delete_date = module.delete_date.replace(/-/g,'/');var date = new Date(module.delete_date).toISOString().split('T')[0];const isCategory = module.moduleTypeNUM == '78';html += '<li id="card_'+module.moduleID+'" data-moduleid="'+escapeHtml(module.moduleID)+'" href="#" class="moduleSortList list-group-item" data-is-sub-module="'+(module.parentId.length > 0)+'" data-is-category="'+isCategory+'">';html += '<div class="pages_PageBox">';html += '<div class="pages_buttonsBox">';html += '<div class="p-r-page-title-container">';html += '<span class="p-r-page-title">';html += '<span>' + module.title + '</span>';if ( RichPage.isChildByModuleID(module.parentId) ) {html += '<span>(' + GetModuleSetting(module.parentId,'title') + ')</span>';} else if ( Wizard.Pages.getPage(module.parentId).data('moduletypenum') == '78' ) {html += '<span>(' + GetModuleSetting(module.parentId,'title') + ')</span>';}
html += '</span>';html += '<span class="p-r-page-delete-date">' + translations.DeleteOn + ': ' + date + '</span>';if ( isCategory && Object.keys(module.subModules).length > 0 ) {html += '<hr class="sub-modules-separator">';html += '<ul>';$.each(module.subModules, function( index, subModule ) {html += '<li>';html += '<div class="pages_PageBox">';html += '<div class="pages_buttonsBox">';html += '<div class="p-r-page-title-container">';html += '<span class="p-r-page-title">';html += subModule.title;html += '</span>';html += '</div>';html += '</div>';html += '</div>';html += '</li>';});html += '</ul>';}
html += '</div>';html += '<a class="btn btn-sm btn-primary no-radius manageWin p-r-page-restore-btn" data-moduleid="'+escapeHtml(module.moduleID)+'" data-name="'+escapeHtml(module.title)+'" data-rel="tooltip" title="'+escapeHtml(translations.PageRestore)+'" data-delay=\'{"show":"1000", "hide":"0"}\' data-is-clicked="false"><div class="p-r-txt-c"><span>'+translations.Restore+'</span></div></a>';html += '</div>';html += '</div>';html += '</li>';return $(html);}
pr.restoreDeletedModule = function( moduleID ) {$.ajax({type: "POST",url: "/versions/2/wizard/modules/restoreDeletedModule.php",data: {w: pr.websiteID,moduleID: moduleID},success: function(data) {var data = tryParseJSON(data);if ( !data ) return;pr.displayPages();AddModuleHTML(data.moduleID,data.itemsModuleID,data.moduleTypeNUM,data.name,data.firstLoad,data.style,data.modulesArrID,data.styleContent,data.showInMenu,data.showInFooter,data.hideFrontModule,data.mp_showInMenu,data.mp_showInHome,data.url,data.parentId,data.zIndex,data.hideFromMobile,data.setSettings);if ( data.isRichPage || data.isCategory ) {RichPage.goToRichPage = data.isRichPage;$.each(data.subModules, function( index, subModule ) {AddModuleHTML(subModule.moduleID,subModule.itemsModuleID,subModule.moduleTypeNUM,subModule.name,subModule.firstLoad,subModule.style,subModule.modulesArrID,subModule.styleContent,subModule.showInMenu,subModule.showInFooter,subModule.hideFrontModule,subModule.mp_showInMenu,subModule.mp_showInHome,subModule.url,subModule.parentId,subModule.zIndex,subModule.hideFromMobile,subModule.setSettings);});}
if ( getOneTimeModule().indexOf(parseInt(data.moduleTypeNUM)) != -1 ) {var $limitedModule = $('#addNewModuleIframe').contents().find('div[data-module-type-num="'+moduleID+'"]');$limitedModule.addClass('module-limited-to-one');}
$(document).trigger('PagesRecycle.restoreDeletedModule.success');}});}
pr.initializeButton = function() {$.ajax({type: "POST",url: "/versions/2/wizard/modules/getDeletedModules.php",data: {w: pr.websiteID,action: 'count'},success: function(data) {var data = jQuery.parseJSON(data);if ( data.total && data.total > 0  ) {pr.$recycleBtn.fadeIn(250);} else {pr.$recycleBtn.fadeOut(250);}}});}
pr.highlightBtn = function( moduleID ) {pr.$recycleBtn.addClass('highlight-btn');pr.$recycleBtn.on('animationend', function() {pr.$recycleBtn.removeClass('highlight-btn');});}
topWindow.Wizard.PagesRecycle = pr;return pr;}();function duplicateModule( moduleTypeNUM, moduleID, isExistingContent, newModuleStyleSettings ) {if ( topWindow.duplicateModule_inProgress ) return;var parentId = '';if ( isExistingContent && window.addNewModule_parentId ) {parentId = window.addNewModule_parentId;window.addNewModule_parentId = '';}
topWindow.duplicateModule_inProgress = true;$.ajax({type: "POST",url: "/versions/2/wizard/modules/duplicateModule.php",data: {w: $('#id').val(),moduleID: moduleID,moduleTypeNUM: moduleTypeNUM,isExistingContent: isExistingContent,parentId: parentId,newModuleStyleSettings: newModuleStyleSettings,},success: function( data ) {var data = $.parseJSON(data);if ( data.error && data.error == '10052016061967' ) {bootbox.alert({title: translations.pagesLimitHeader,message: translations.pagesLimitMessage.replace('{{limited_pages_number}}',data.limited_pages_number)});return;}
if ( data.status == 'Success' ) {AddModuleHTML(data.moduleID,data.itemsModuleID,data.moduleTypeNUM,data.name,data.firstLoad,data.style,data.modulesArrID,data.styleContent,data.showInMenu,data.showInFooter,data.hideFrontModule,data.mp_showInMenu,data.mp_showInHome,data.url,data.parentId,data.zIndex,data.hideFromMobile,false);EditModuleSetting(data.moduleID,'settings',GetModuleSetting(moduleID,'settings'));g_ManageAddModuleData = null;if ( data.isRichPage ) {RichPage.goToRichPage = true;$.each(data.subModules, function( index, subModule ) {AddModuleHTML(subModule.moduleID,subModule.itemsModuleID,subModule.moduleTypeNUM,subModule.name,subModule.firstLoad,subModule.style,subModule.modulesArrID,subModule.styleContent,subModule.showInMenu,subModule.showInFooter,subModule.hideFrontModule,subModule.mp_showInMenu,subModule.mp_showInHome,subModule.url,subModule.parentId,subModule.zIndex,subModule.hideFromMobile,false);EditModuleSetting(subModule.moduleID,'settings',GetModuleSetting(subModule.oldModuleID,'settings'));});}}
$(document).trigger('duplicateModule.success',[data]);topWindow.duplicateModule_inProgress = false;}});}
var RichPage = function() {var _ = {isActive: false,unConvertableModules: ['78','108','123','37','97','1000','153',...Wizard.Ecommerce.highLights],unAddableModules: ['123','37','97'],defaultModules: ['16','4'],moduleTypeNUM: '128',moduleID: '',pageURL: '',$module: null,$rootParent: $('#sortable'),$backButton: null,goToRichPage: false};_.init = function( settings ) {_.PromosHandler.init({$iframe: settings.$iframe,$rootParent: _.$rootParent});$(document).on('removeModule.success.RichPage', function ( event, moduleID, $module ) {if ( !Wizard.Preview.ready ) return;var $richPage = Wizard.Preview.getModulesByTypeNum(_.moduleTypeNUM);$richPage.attr('data-sections-amount',$richPage.siblings().length);showHideEmptyRichpageMessage();});};_.convert = function( dataObj ) {var $pagesTab = $('#pagesTab');_.isActive = true;_.addBackButton(dataObj);var $richPageLoader = $('<div class="text-center"><i class="ace-icon fa fa-spinner fa-spin fa-4x"></i></div>');$richPageLoader.insertBefore(_.$rootParent);$richPageLoader.show();_.goToRichPage = true;if ( dataObj.$selectedModule.data('module-mp-show-in-menu') ) {mp_showInMenu = dataObj.$selectedModule.data('module-mp-show-in-menu');} else {mp_showInMenu = dataObj.$selectedModule.attr('data-module-mp-show-in-menu');}
if ( dataObj.$selectedModule.data('module-show-in-footer') ) {showInFooter = dataObj.$selectedModule.data('module-show-in-footer');} else {showInFooter = dataObj.$selectedModule.attr('data-module-show-in-footer');}
if ( $pagesTab.attr('data-pages-n-i-m-o-h-tab') != 'showOthersTab' && showInFooter == '0' && mp_showInMenu == '0' ) {$(document).one('richPageConverted',function( event, $richpage ) {$pagesTab.attr('data-pages-n-i-m-o-h-tab','showOthersTab');$('#showPagesTab').removeClass('active');$('#showOthersTab').addClass('active');});}
AddNewModule(_.moduleTypeNUM,dataObj.$selectedModule.find('.module_name').val(),false,'1','1','1',showInFooter,'0',mp_showInMenu,'0',dataObj.$selectedModule.data('parentId'),_.moduleTypeNUM);$(document).one('s123.wizardPageAdded.RichPage', function( event, $richPage ) {setProperties($richPage);_.$addSectionButton = _.generateAddSectionButton();_.$addSectionButton.insertAfter(_.$rootParent);var $ul = $('<ul></ul>');setModulePlace(dataObj.$selectedModule,$richPage);$ul.append(dataObj.$selectedModule);$richPage.append($ul);dataObj.$selectedModule.data('parentId',_.$module.data('moduleid'));dataObj.$selectedModule.attr('data-parent-id',_.$module.data('moduleid'));dataObj.$selectedModule.data('module-mp-show-in-menu','0');dataObj.$selectedModule.attr('data-module-mp-show-in-menu','0');if ( dataObj.$selectedModule.data('moduletypenum') == '167' ) {dataObj.$selectedModule.data('isModuleChanged',true);}
$richPageLoader.remove();nestedSortableHandler();BuildToolJSON();$('#wizardForm').one('ajaxSuccess.RichPage.convert', function( event ) {if ( dataObj.callback ) dataObj.callback.call(this,$richPage);$(document).trigger('richPageConverted',[$richPage]);});AutoSaveWizard(false,true);_.PromosHandler.showHideFirstPromos(_.$module);if ( dataObj.callback ) dataObj.callback.call(this,$richPage);});$(document).on('s123.wizardPageAdded.RichPage', function ( event, $module ) {showHideEmptyRichpageMessage();});};_.show = function( dataObj ) {_.isActive = true;_.addBackButton(dataObj);setProperties(dataObj.$selectedModule);_.goToRichPage = false;_.$addSectionButton = _.generateAddSectionButton();_.$addSectionButton.insertAfter(_.$rootParent);nestedSortableHandler();showHideEmptyRichpageMessage();_.PromosHandler.showHideFirstPromos(_.$module);$(document).on('s123.wizardPageAdded.RichPage', function ( event, $module ) {showHideEmptyRichpageMessage();});if ( dataObj.callback ) dataObj.callback.call(this,dataObj.$selectedModule);};_.reset = function() {_.isActive = false;if ( _.$backButton ) {_.$backButton.remove();}
if ( _.$addSectionButton ) {_.$addSectionButton.remove();}
if ( _.$module ) {nestedSortableHandler();}
if ( _.$noSectionsMsg ) {_.$noSectionsMsg.remove();}
setProperties(null);_.goToRichPage = false;_.PromosHandler.reset();$(document).off('s123.wizardPageAdded.RichPage');};_.isChild = function( $module ) {if ( $module.data('moduletypenum') == _.moduleTypeNUM ) return false;if ( $module.closest('[data-moduletypenum="'+_.moduleTypeNUM+'"]').length > 0 ) return true;return false;};_.isChildByModuleID = function( moduleID ) {return ( Wizard.Pages.getPage(moduleID).data('moduletypenum') == _.moduleTypeNUM );};_.getModuleUrl = function( moduleID ) {return GetModuleSetting(moduleID,'url');};_.getPageUrl = function( $module ) {if ( _.pageURL.length > 0 ) return _.pageURL;return _.getModuleUrl($module.closest('li[data-moduletypenum="'+_.moduleTypeNUM+'"]').data('moduleid'));};_.addNewModule = function () {if ( PagesLimitations() ) return;window.addNewModule_parentId = '';bootbox.dialog({title: translations.richPage.addNewPage,message: '<form id="addNewRichPageForm" class="bootbox-form"><div class="form-group"><input id="addNewRichPage" autocomplete="off" type="text" class="bootbox-input bootbox-input-text form-control" required data-msg-required="'+translations.fieldRequired+'"></div></form>',className: 'wizard-add-new-rich-page',closeButton: true,backdrop: true,onEscape: function() {},buttons: {cancel: {label: translations.richPage.cancel,className: 'btn-default'},confirm: {label: translations.richPage.save,className: 'btn-primary btn-success add-new-rich-page-btn',callback: function() {var $form = this.find('.bootbox-form');var $name = $form.find('#addNewRichPage');$name.val($name.val().trim());if ( !$form.valid() || $name.val().length === 0 ) {$name.focus();return false;}
RichPage.goToRichPage = true;var moduleID = AddNewModule(_.moduleTypeNUM,$name.val(),false,'1','1','1','1','0','1','0','',_.moduleTypeNUM);for (var i = 0; i < _.defaultModules.length; i ++) {if ( _.defaultModules[i] == '16' && abTestTXT == 'siteEditor_b' ) {AddNewModule('167',modulesArr['167'].toolChild.about.name,false,'1','1','1','1','0','1','0',moduleID,'167012','about');} else {AddNewModule(_.defaultModules[i],modulesArr[_.defaultModules[i]].name,false,'1','1','1','1','0','1','0',moduleID,_.defaultModules[i]);}}}}},}).on('shown.bs.modal', function() {var $addBtn = $(this).find('.add-new-rich-page-btn');$(this).find('#addNewRichPage').focus();$(this).find('#addNewRichPage').onEnterKey(function ( event ) {event.preventDefault();$addBtn.trigger('click');});});};_.addExistingModule = function( richPageID, moduleID ) {const $richpage = Wizard.Pages.getPage(richPageID);const $module = Wizard.Pages.getPage(moduleID);if ( $richpage.find('ul').length == 0 ) {$richpage.append('<ul></ul>');}
$richpage.find('ul').append(Wizard.Pages.getPage(moduleID));$module.attr('data-parent-id',richPageID);$module.data('parent-id',richPageID);};_.isSupported = function( moduleTypeNUM ) {moduleTypeNUM = moduleTypeNUM.toString();return _.unConvertableModules.map(num => num.toString()).indexOf(moduleTypeNUM) < 0;};_.isFirstChild = function( $module ) {if ( _.isRichPage($module.data('moduletypenum')) ) return false;if ( _.PromosHandler.firstModuleID == $module.data('moduleid') ) return true;return $module.parent().children().index($module) === 0;};_.isRichPage = function( moduleTypeNUM ) {return _.moduleTypeNUM == moduleTypeNUM;}
_.isRelated = function( $module ) {if ( !$module ) return false;return _.isChild($module) || _.isRichPage($module.data('moduletypenum'));};_.isHighlighted = function() {return Wizard.Pages.highlight.$page && _.isRichPage(Wizard.Pages.highlight.$page.data('moduletypenum'));};_.getParent = function( $module ) {return $module.closest('[data-moduletypenum="'+_.moduleTypeNUM+'"]');};_.PromosHandler = function() {var _ = {moduleIDS: [],minIndex: 1, // this property is used for the nestedSortable `isAllowed` logic
firstModuleID: '',$module: null};_.init = function( settings ) {_.$iframe = settings.$iframe;_.$rootParent = settings.$rootParent;_.$iframe.on('load.RichPage.PromosHandler', function() {addPjaxListener();if ( !Wizard.Preview.ready ) return;if ( !Wizard.Preview.window.IsRichPage() ) return;_.showHideFirstPromos(Wizard.Pages.getPage(Wizard.Preview.$('.s123-module-rich-page').data('module-id')));});$(document).on('s123.pages.nestedSortable.update.PromosHandler', function( event ) {if ( !RichPage.isActive ) return;_.showHideFirstPromos(_.$module);});$(document).on('UpdatePreviewAreaByAjax.success.PromosHandler', function( event ) {if ( !Wizard.Preview.ready ) return;if ( typeof Wizard.Preview.window.IsRichPage !== "undefined" || !Wizard.Preview.window.IsRichPage() ) return;_.showHideFirstPromos(Wizard.Pages.getPage(Wizard.Preview.$('.s123-module-rich-page').data('module-id')));});$(document).on('removeModule.success.PromosHandler', function( event ) {if ( !RichPage.isActive ) return;_.showHideFirstPromos(_.$module);});$(document).on('duplicateModule.success.PromosHandler', function( event, data ) {if ( !RichPage.isActive && data.isRichPage ) {_.$module = Wizard.Pages.list.filter('[data-moduleid="'+data.moduleID+'"]');}});$(document).on('wizard_pages_highlight.on.PromosHandler', function( event, $module ) {if ( !RichPage.isActive && RichPage.isRichPage($module.data('moduletypenum')) ) {_.$module = $module;}});$(document).on('wizard.preview.device.changed.PromosHandler', function( event ) {if ( !RichPage.isActive ) return;_.showHideFirstPromos(_.$module);});$(document).on('moduleSettingsChanged.PromosHandler', function( event, inputID ) {if ( !RichPage.isActive ) return;if ( inputID != 'hideFromMobile' ) return;if ( Wizard.Preview.Scale.mode != 'mobile' ) return;_.showHideFirstPromos(_.$module);});};_.showHideFirstPromos = function( $module ) {var moduleID = $module.data('moduleid');_.$rootParent.find('li[data-parent-id="'+moduleID+'"]:is([data-moduletypenum="1000"]) .promo-module-msg').remove();_.$module = $module;_.$rootParent.find('li[data-parent-id="'+moduleID+'"]').each(function( index, module ) {var $module = $(this);if ( $module.data('moduletypenum') == '1000' ) {if ( $module.data('moduletypenum') == '1000' ) {$module.find('.pages_PageBox .pages_buttonsBox').append('<div class="promo-module-msg">'+escapeHtml(translations.richPage.promoFistChildError)+'</div>');} else {$module.find('.pages_PageBox .pages_buttonsBox').append('<div class="promo-module-msg">'+escapeHtml(translations.richPage.headersFistChildError)+'</div>');}} else if ( !(Wizard.Preview.Scale.mode == 'mobile' && $module.data('module-hide-from-mobile') == '1') ) {_.minIndex = index + 1;_.firstModuleID = $module.data('moduleid');return false;}});handlePreview(moduleID);};_.reset = function() {_.minIndex = 1;_.firstModuleID = '';};_.fixModuleColors = function( moduleID ) {_.$rootParent.find('li[data-parent-id="'+moduleID+'"]:not([data-moduletypenum="1000"])').each( function( index, module ) {var $p_module = Wizard.Preview.getModule($(this).data('moduleid'));if ( !$p_module.is(':visible') ) return;if ( index % 2 == 0 ) {$p_module.addClass('bg-primary');} else {$p_module.removeClass('bg-primary');}});};function handlePreview( moduleID ) {if ( !Wizard.Preview.ready ) return;if ( !IsPreviewAtRichPage(moduleID) ) return;_.$rootParent.find('li[data-parent-id="'+moduleID+'"]:is([data-moduletypenum="1000"])').each(function( index, module ) {var $module = $(this);var $p_module = Wizard.Preview.$('#section-'+$module.data('moduleid'));if ( $module.find('.promo-module-msg').length > 0 ) {$p_module.addClass('hidden');} else {$p_module.removeClass('hidden');}});_.fixModuleColors(moduleID);}
function addPjaxListener() {if ( !Wizard.Preview.ready ) return;Wizard.Preview.$document.on('s123.pjax.complete.RichPage.PromosHandler', function( event ) {if ( !Wizard.Preview.window.IsRichPage() ) return;_.showHideFirstPromos(Wizard.Pages.getPage(Wizard.Preview.$('.s123-module-rich-page').data('module-id')));});}
return _;}();_.getSortable = function() {return _.$module.find('ul');};function setProperties( $richPage ) {if ( $richPage ) {_.$module = $richPage;_.moduleID = _.$module.data('moduleid');_.pageURL = GetModuleSetting(RichPage.$module.data('moduleid'),'url');} else {_.$module = null;_.moduleID = '';_.pageURL = '';}}
_.addBackButton = function( dataObj ) {if ( $('html').data('device') === 'mobile' ) {$('#wizardBox .wizardBackToTabs-container').data('custom-event',true);$('#wizardBox .wizardBackToTabs-container').one('click', function() {Wizard.Pages.highlight.on(_.$module);Wizard.Pages.modeManager.set('pages','',false);$(this).data('custom-event',false);});var html = '';html += '<div class="t-h-e-header t-h-e-manual-static">';html += '<div class="rich-page-title-continer">';html += '<span class="rich-page-title">';html += '<span id="changeRichpageTitle" contenteditable="true">'+escapeHtml(dataObj.$selectedModule.children('.pages_PageBox').find('.module_name').val())+'</span>';html += '</span>';html += '<span class="rich-page-title-add-btn">';html += '<i class="fal fa-plus"></i>';html += '</span>';html += '</div>';html += '</div>';} else {var html = '';html += '<div class="t-h-e-header t-h-e-manual-static">';html += '<a class="back-btn top-nav-link exit-rich-page">';html += '<span class="back-to"></span>';html += '<span class="t-e-h-back-title">'+escapeHtml(translations.richPage.backBtn)+'</span>';html += '</a>';html += '<div class="rich-page-title-continer">';html += '<span class="rich-page-title">';html += '<span id="changeRichpageTitle" contenteditable="true">'+escapeHtml(dataObj.$selectedModule.children('.pages_PageBox').find('.module_name').val())+'</span>';html += '</span>';html += '<span class="rich-page-title-add-btn">';html += '<i class="fal fa-plus"></i>';html += '</span>';html += '</div>';html += '</div>';}
_.$backButton = $(html);_.$backButton.find('#changeRichpageTitle').off('input').on('input', function() {$this = $(this);var newRichPAgeTitle = $.trim($this.text());clearTimeout(_.$backButton.inputFinished);_.$backButton.inputFinished = setTimeout( function() {if ( newRichPAgeTitle === '' ) {$this.text(dataObj.$selectedModule.children('.pages_PageBox').find('.module_name').val());} else {dataObj.$selectedModule.children('.pages_PageBox').find('.module_name').val(newRichPAgeTitle).trigger('input');$this.text(newRichPAgeTitle);}},1000);});_.$backButton.find('.rich-page-title-add-btn').off('click').on('click', function() {$('#addSection:visible').trigger('click');});_.$backButton.insertBefore(_.$rootParent.parent());_.$backButton.find('.exit-rich-page').on('click', function( event ) {Wizard.Pages.highlight.on(_.$module);Wizard.Pages.modeManager.set('pages','',false);});}
_.generateAddSectionButton = function() {var html = '';html += '<div class="add-section-container">';html += '<button id="addSection" type="button" class="btn btn-transparent" data-moduleid="'+escapeHtml(_.moduleID)+'" data-moduletypenum="'+escapeHtml(_.moduleTypeNUM)+'">';html += '<i class="fal fa-plus"></i> ';html += '<span>' + escapeHtml(translations.richPage.addNewSection) + '</span>';html += '</button>';html += '</div>';var $html = $(html);$html.find('#addSection').on('click', function() {$('#AddModuleWin').modal('show',$(this));});return $html;}
function setModulePlace( $selectedModule, $richPage ) {var $sortable = $selectedModule.parent();var modulePlace = $sortable.children().index($selectedModule);if ( modulePlace === 0 ) {$sortable.prepend($richPage);} else if ( modulePlace < $sortable.children().length -1 ) {$richPage.insertAfter($sortable.children().eq(modulePlace));}}
function nestedSortableHandler() {if ( _.isActive ) {Wizard.Pages.sortable.destroy(_.$rootParent);var $sortable = _.getSortable();if ( $sortable.length == 0 ) {$sortable = $('<ul></ul>');_.$module.append($sortable);}
Wizard.Pages.sortable.init($sortable,1);_.$module.on('mousedown.RichPage', function( event ) {if ( $(event.target).closest('li').data('moduletypenum') == _.moduleTypeNUM ) {event.stopPropagation();event.preventDefault();}});} else {Wizard.Pages.sortable.destroy(_.getSortable());Wizard.Pages.sortable.init(_.$rootParent,3);_.$module.off('mousedown.RichPage');}}
function showHideEmptyRichpageMessage() {if ( !_.isActive ) return;var $sortable = _.getSortable();if ( $sortable.children().length == 0 ) {_.$noSectionsMsg = $('<div class="rc-empty-msg"><span>'+escapeHtml(translations.richPage.noSectionsMsg)+'</span></div>');_.$noSectionsMsg.insertBefore($sortable);} else {$sortable.siblings('.rc-empty-msg').remove();}}
return _;}();function OpenPromoInlineEdit( $module, moduleTypeNUM, iframeLoadedCallback ) {var $pagesTab = $('#pagesTab');var $pages = $pagesTab.find('fieldset.pages');var $moduleAccordion = $pagesTab.find('fieldset.inline-module');var $moduleContainer = $moduleAccordion.find('.inline-module-container');var $backBtn = $moduleAccordion.find('.inline-module-back-btn');var openTool = $module.data('open-tool') ? $module.data('open-tool') : '';var $iframe = $moduleAccordion.find('.inline-wizard-iframe');var isModuleChanged = $module.data('isModuleChanged') ? $module.data('isModuleChanged') : false;var html = '';$module.data('open-tool','');$module.data('isModuleChanged',false);$module.one('OpenPromoInlineEdit.hide', function() {$backBtn.trigger('click');SystemModals.sm_get('moduleWindow').$html.off('show.bs.modal.OpenPromoInlineEdit.backBtn');forceReloadOnNextEnery();});g_ManageModuleID = $module.data('moduleid');var moduleID = $module.data('moduleid');if ( $module.data('items-module-id') && $module.data('items-module-id').length > 0 ) {moduleID = $module.data('items-module-id');}
var src = '/versions/2/wizard/modules/'+modulesArr[moduleTypeNUM]['folder']+'/items.php?w='+$('#id').val()+'&moduleID='+moduleID+'&isInline=true&moduleTypeNUM='+moduleTypeNUM;showPromoEditor();if ( $iframe.data('is-loaded') && $iframe.length > 0 && $iframe.data('moduleid') == $module.data('moduleid') && $iframe.attr('src') == src && !isModuleChanged ) {openWidget($iframe,openTool,false);if ( iframeLoadedCallback ) iframeLoadedCallback.call(this,$iframe);} else if ( !isInlineEditorProccesing() ) {createNewIFrame();}
function openWidget( $iframe, toolID, callback ) {var frameWindow = $iframe.get(0).contentWindow;var WidgeBoxSlider = frameWindow.WidgeBoxSlider;if ( typeof WidgeBoxSlider === 'undefined' )  return;switch ( toolID ) {case 'font-themes':WidgeBoxSlider.show('fontsThemes');break;case 'form-settings':WidgeBoxSlider.show('formOptions');$iframe.get(0).contentWindow.$('#promo_goal_type_form').removeClass('showOnlyDesign');$iframe.get(0).contentWindow.$('#promo_goal_type_form').addClass('showOnlySettigns');break;case 'form-settings-styles':WidgeBoxSlider.show('formOptions');$iframe.get(0).contentWindow.$('#promo_goal_type_form').addClass('showOnlyDesign');$iframe.get(0).contentWindow.$('#promo_goal_type_form').removeClass('showOnlySettigns');break;case 'button-options':WidgeBoxSlider.show('buttonOptions');break;case 'images-options':WidgeBoxSlider.show('imagesOptions');break;case 'video-options':WidgeBoxSlider.show('videoOptions');break;case 'background-image':WidgeBoxSlider.show('backgroundOptions');var $el = WidgeBoxSlider.$widgeBoxes.filter('#backgroundOptions');$el.find('.bg-type-container').removeClass('hidden');break;case 'background-options':WidgeBoxSlider.show('backgroundOptions');var $el = WidgeBoxSlider.$widgeBoxes.filter('#backgroundOptions');$el.find('.bg-type-container').addClass('hidden');break;case 'templates-options':WidgeBoxSlider.show('templatesOptions');break;case 'log-template':WidgeBoxSlider.show('templatesOptions');$iframe.get(0).contentWindow.log_promo_styles();break;case 'text-position':WidgeBoxSlider.show('textPositionBox');break;default:if ( toolID == '' ) {WidgeBoxSlider.showAll();} else {WidgeBoxSlider.show(toolID);}
break;}
if ( callback ) callback.call(this);}
function showPromoEditor() {$pagesTab.addClass('inline-module-active');$pagesTab.removeClass('pages-recycle-active');$pagesTab.find('fieldset.pages-recycle').hide();$pages.hide();$moduleAccordion.show();$iframe.show();$pagesTab.data('active-inline-module',$module);}
function createNewIFrame() {html += '<div>';html += '<div id="moduleAccordionLoader" class="text-center" style="margin-bottom:20px;"><i class="ace-icon fa fa-spinner fa-spin fa-4x"></i></div>';html += '<iframe src="' + src + '" class="inline-wizard-iframe" data-moduleid="' + $module.data('moduleid') + '" data-moduletypenum="' + $module.data('moduletypenum') + '" style="width:100%; height: calc( 100vh - 100px); margin: 0; padding: 0; border: none;"></iframe>';html += '</div>';var $html = $(html);$moduleContainer.html($html);$iframe = $html.find('.inline-wizard-iframe');var $moduleAccordionLoader = $html.find('#moduleAccordionLoader');$iframe.hide();$iframe.off('load').on('load',function() {var $contents = $(this).contents();$contents.find('body').addClass('fancy-scrollbar');$contents.find('.widget-box').removeClass('active');openWidget($iframe,openTool,function() {$moduleAccordionLoader.hide();$iframe.fadeIn(250);});$iframe.data('is-loaded',true);if ( iframeLoadedCallback ) iframeLoadedCallback.call(this,$iframe);});$moduleAccordion.fadeIn(250);$backBtn.off('click').on('click',function() {if ( !RichPage.isChild($module) ) {Wizard.Pages.modeManager.set('pages','',false);}
$moduleAccordion.hide();$pages.fadeIn(250);$pagesTab.removeClass('inline-module-active');$pagesTab.data('active-inline-module',null);SystemModals.sm_get('moduleWindow').$html
.off('show.bs.modal.OpenPromoInlineEdit.backBtn')
.one('show.bs.modal.OpenPromoInlineEdit.backBtn', function(event) {forceReloadOnNextEnery();});$(document).off('wizard_tabs_opened.OpenPromoInlineEdit');});}
function forceReloadOnNextEnery() {$module.data('isModuleChanged',true);}}
function isInlineEditorProccesing() {var isProccesing = $('#pagesTab .inline-module-container .inline-wizard-iframe.upload-file-processing').length > 0;if ( isProccesing ) {bootbox.dialog({title: translations.uploadFileNotificationModal.title,message: `<span>${translations.uploadFileNotificationModal.message}</span>`,className: 's123-modal upload-file-notification',closeButton: true,backdrop: true,onEscape: function() {},buttons: {confirm: {label: translations.ok,className: 'btn-primary btn-success',}},});}
return isProccesing}
function setModuleStyle( settings ) {if ( settings.moduleTypeNUM == '1000' ) {$.ajax({type: "POST",url: "/versions/2/wizard/modules/updateItemMultipleSettings.php",data: {w: settings.websiteID,moduleID: settings.moduleID,moduleTypeNUM: settings.moduleTypeNUM,settingsObj: JSON.stringify(settings.settingsObj)}});}
if ( settings.moduleTypeNUM == '169' || settings.moduleTypeNUM == '167' ) {var moduleSetting = GetModuleSetting(settings.moduleID,'settings');moduleSetting = tryParseJSON(moduleSetting);if ( moduleSetting && moduleSetting.layout_customize ) {if ( moduleSetting.layout_customize.style_text_order
&& moduleSetting.layout_customize.style_text_order == '2' ) {moduleSetting.layout_customize.style_text_order = '1';}}
if ( moduleSetting && moduleSetting.mobileToolStyle ) {moduleSetting.mobileToolStyle = '';}
EditModuleSetting(settings.moduleID,'settings',JSON.stringify(moduleSetting));}
if ( settings.moduleTypeNUM == '4' ) {var moduleSetting = GetModuleSetting(settings.moduleID,'settings');moduleSetting = tryParseJSON(moduleSetting);if ( moduleSetting && moduleSetting.layout_customize ) {if ( moduleSetting.layout_customize.image_design ) {moduleSetting.layout_customize.image_design = '';}}
EditModuleSetting(settings.moduleID,'settings',JSON.stringify(moduleSetting));}
settings.$module.data('module-style',settings.newStyle);settings.$module.data('modules-arr-id',settings.newModuleArrID);if ( !IsLandingPage() && abTestTXT == 'siteEditor_b' && settings.moduleID == '169' && $('#header_opacity').val() != 'no' ) {if ( [169,169030,169025,169024,169023,169038,169042,169026,169029,169036,169037,169043,169048,169049,169050,169055,169056,169051].indexOf(settings.newModuleArrID) == -1 ) {$('#header_opacity').val('no');window.reloadPreviewCSS = ReloadPreviewCSS;}}
if ( IsLandingPage() && abTestTXT == 'siteEditor_b' && settings.moduleID == '169' ) {window.reloadPreviewCSS = ReloadPreviewCSS;}
BuildToolJSON();AutoSaveWizard(true,true);}
function hideModuleLayouts( moduleTypeNUM, style, selectedStyle ) {if ( moduleTypeNUM == 52 || moduleTypeNUM == 17 ) {if ( ['1','3','6'].indexOf(style) != -1 && style != selectedStyle ) {return true;}}
return false;}
function hideSideMenuByModule( moduleTypeNUM, moduleID, $editButton ) {if ( moduleTypeNUM == 9 ) {let menu_settings = GetModuleSetting(moduleID,'settings');menu_settings = tryParseJSON(menu_settings);if ( menu_settings['paymentButtonType'] != '1' ) {return true;}}
if ( $editButton && $editButton.data('hide-side-menu') ) {return true;}
return false;}
function PagesNotInMenuOrHomepageTabs_init() {var $pagesTab = $('#pagesTab');var $tabs = $('.pages-n-i-m-o-h');var $showPagesTab = $('#showPagesTab');$tabs.off('click').on('click',function(){var $this = $(this);var activeTab = $this.data('tab');$tabs.removeClass('active');$this.addClass('active');if ( activeTab == 'showOthersTab' ) {$pagesTab.find('#sortable,#card_homepage').fadeOut(200, function() {$pagesTab.attr('data-pages-n-i-m-o-h-tab',activeTab);$pagesTab.find('#sortable').get(0).style.setProperty('--othersTabMarginTop',35+parseInt($('.pages-not-in-menu-or-homepage').height())+'px');$pagesTab.find('#sortable').fadeIn(200);});} else {$pagesTab.find('#sortable').fadeOut(200, function() {$pagesTab.attr('data-pages-n-i-m-o-h-tab',activeTab);$pagesTab.find('#sortable, #card_homepage').fadeIn(200);});}});}
var Library = function() {var L = {};L.init = function( settings ) {Translation.init(settings.translations);L.$body = $('body');L.customClass = settings.customClass ? settings.customClass : '';SystemModals.sm_render({id: 'imageLibrary',disposable: false,$parent: L.$body,sizeClasses: `size-l3 ${L.customClass}`,headerSettings: {id: 'imageLibraryTitle',title: L.translate.imageLibrary},bodySettings: { // body settings
content: '&nbsp;'},footerSettings: { // footer settings
isActive: false,buttons: []},showCallback: function ( event, modal ) {var liveUpdate = modal.$html.data('liveUpdate');var minlibraryWidth = modal.$html.data('minlibraryWidth');var reload = true;if ( !topWindow.uploadFiles ) topWindow.uploadFiles = {};var uploadFile = topWindow.uploadFiles[modal.$html.data('uploadFileInputId')];if ( uploadFile ) {if ( !uploadFile.imagesType ) uploadFile.imagesType = 'images';if ( modal.$html.data('lastImagesType') === uploadFile.imagesType ) reload = false;if ( !modal.$html.find('#flickrLibraryModal').hasClass('imageLibrary_live_'+liveUpdate) ) reload = true;if ( modal.$html.data('lastLibraryOrientation') != uploadFile.libraryOrientation ) reload = true;if ( modal.$html.data('lastLibraryQuery') != modal.$html.data('def-query') ) reload = true;modal.$html.data('lastImagesType',uploadFile.imagesType);modal.$html.data('lastLibraryOrientation',uploadFile.libraryOrientation);modal.$html.data('lastLibraryQuery',modal.$html.data('def-query'));} else {modal.$html.data('lastImagesType',null);}
var src = '/versions/2/wizard/imagesLibrary/pixabayV_beta_V4.php?w='+websiteID+'&liveUpdate='+liveUpdate;if ( minlibraryWidth == '1200' ) {src += '&orientation=horizontal&min_width=1600&min_height=800';}
if ( reload ) {modal.updateHTML('body','<iframe id="flickrLibraryModal" class="libraryIframe imageLibrary_live_'+liveUpdate+'" src="' + src + '" style="width:100%;height:500px;margin:0;padding:0;border:none;"></iframe>');}}});};function objectAssign(target, sources) {if ( Object.assign ) {sources = Object.assign(target, sources);} else {for ( var prop in target ) if ( !sources.hasOwnProperty(prop) ) sources[prop] = target[prop];}
return sources;}
function escapeHtml( text ) {if ( !text ) return text;var map = {'&': '&amp;','<': '&lt;','>': '&gt;','"': '&quot;',"'": '&#039;'};return text.toString().replace( /[&<>"']/g, function( m ) { return map[m]; } );}
var Translation = {def : {imageLibrary: 'Image Library',close: 'Close'},init : function( translations ) {var t = translations ? objectAssign(this.def,translations) : this.def;$.each(t, function( key, value ) {t[key] = escapeHtml(value);});L.translate = t;}};return L;}();
function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.LazyLoad=e()}(this,function(){"use strict";var t="undefined"!=typeof window,e=t&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),n=t&&"IntersectionObserver"in window,o=t&&"classList"in document.createElement("p"),r={elements_selector:"img",container:e||t?document:null,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",class_loading:"loading",class_loaded:"loaded",class_error:"error",load_delay:0,auto_unobserve:!0,callback_enter:null,callback_exit:null,callback_reveal:null,callback_loaded:null,callback_error:null,callback_finish:null,use_native:!1},a=function(t,e){var n,o=new t(e);try{n=new CustomEvent("LazyLoad::Initialized",{detail:{instance:o}})}catch(t){(n=document.createEvent("CustomEvent")).initCustomEvent("LazyLoad::Initialized",!1,!1,{instance:o})}window.dispatchEvent(n)};var i=function(t,e){return t.getAttribute("data-"+e)},s=function(t,e,n){var o="data-"+e;null!==n?t.setAttribute(o,n):t.removeAttribute(o)},c=function(t){return"true"===i(t,"was-processed")},l=function(t,e){return s(t,"ll-timeout",e)},u=function(t){return i(t,"ll-timeout")},d=function(t,e){t&&t(e)},f=function(t,e){t._loadingCount+=e,0===t._elements.length&&0===t._loadingCount&&d(t._settings.callback_finish)},_=function(t){for(var e,n=[],o=0;e=t.children[o];o+=1)"SOURCE"===e.tagName&&n.push(e);return n},v=function(t,e,n){n&&t.setAttribute(e,n)},g=function(t,e){v(t,"sizes",i(t,e.data_sizes)),v(t,"srcset",i(t,e.data_srcset)),v(t,"src",i(t,e.data_src))},m={IMG:function(t,e){var n=t.parentNode;n&&"PICTURE"===n.tagName&&_(n).forEach(function(t){g(t,e)});g(t,e)},IFRAME:function(t,e){v(t,"src",i(t,e.data_src))},VIDEO:function(t,e){_(t).forEach(function(t){v(t,"src",i(t,e.data_src))}),v(t,"src",i(t,e.data_src)),t.load()}},b=function(t,e){var n,o,r=e._settings,a=t.tagName,s=m[a];if(s)return s(t,r),f(e,1),void(e._elements=(n=e._elements,o=t,n.filter(function(t){return t!==o})));!function(t,e){var n=i(t,e.data_src),o=i(t,e.data_bg);n&&(t.style.backgroundImage='url("'.concat(n,'")')),o&&(t.style.backgroundImage=o)}(t,r)},h=function(t,e){o?t.classList.add(e):t.className+=(t.className?" ":"")+e},p=function(t,e,n){t.addEventListener(e,n)},y=function(t,e,n){t.removeEventListener(e,n)},E=function(t,e,n){y(t,"load",e),y(t,"loadeddata",e),y(t,"error",n)},w=function(t,e,n){var r=n._settings,a=e?r.class_loaded:r.class_error,i=e?r.callback_loaded:r.callback_error,s=t.target;!function(t,e){o?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")}(s,r.class_loading),h(s,a),d(i,s),f(n,-1)},I=function(t,e){var n=function n(r){w(r,!0,e),E(t,n,o)},o=function o(r){w(r,!1,e),E(t,n,o)};!function(t,e,n){p(t,"load",e),p(t,"loadeddata",e),p(t,"error",n)}(t,n,o)},k=["IMG","IFRAME","VIDEO"],A=function(t,e){var n=e._observer;z(t,e),n&&e._settings.auto_unobserve&&n.unobserve(t)},L=function(t){var e=u(t);e&&(clearTimeout(e),l(t,null))},x=function(t,e){var n=e._settings.load_delay,o=u(t);o||(o=setTimeout(function(){A(t,e),L(t)},n),l(t,o))},z=function(t,e,n){var o=e._settings;!n&&c(t)||(k.indexOf(t.tagName)>-1&&(I(t,e),h(t,o.class_loading)),b(t,e),function(t){s(t,"was-processed","true")}(t),d(o.callback_reveal,t),d(o.callback_set,t))},O=function(t){return!!n&&(t._observer=new IntersectionObserver(function(e){e.forEach(function(e){return function(t){return t.isIntersecting||t.intersectionRatio>0}(e)?function(t,e){var n=e._settings;d(n.callback_enter,t),n.load_delay?x(t,e):A(t,e)}(e.target,t):function(t,e){var n=e._settings;d(n.callback_exit,t),n.load_delay&&L(t)}(e.target,t)})},{root:(e=t._settings).container===document?null:e.container,rootMargin:e.thresholds||e.threshold+"px"}),!0);var e},N=["IMG","IFRAME"],C=function(t,e){return function(t){return t.filter(function(t){return!c(t)})}((n=t||function(t){return t.container.querySelectorAll(t.elements_selector)}(e),Array.prototype.slice.call(n)));var n},M=function(t,e){this._settings=function(t){return _extends({},r,t)}(t),this._loadingCount=0,O(this),this.update(e)};return M.prototype={update:function(t){var n,o=this,r=this._settings;(this._elements=C(t,r),!e&&this._observer)?(function(t){return t.use_native&&"loading"in HTMLImageElement.prototype}(r)&&((n=this)._elements.forEach(function(t){-1!==N.indexOf(t.tagName)&&(t.setAttribute("loading","lazy"),z(t,n))}),this._elements=C(t,r)),this._elements.forEach(function(t){o._observer.observe(t)})):this.loadAll()},destroy:function(){var t=this;this._observer&&(this._elements.forEach(function(e){t._observer.unobserve(e)}),this._observer=null),this._elements=null,this._settings=null},load:function(t,e){z(t,this,e)},loadAll:function(){var t=this;this._elements.forEach(function(e){A(e,t)})}},t&&function(t,e){if(e)if(e.length)for(var n,o=0;n=e[o];o+=1)a(t,n);else a(t,e)}(M,window.lazyLoadOptions),M});
Wizard.userActions = new function() {var that = this;that.init = function( settings ) {if ( !settings ) return;that.userActions = settings.userActions;addLogListner();};that.logAction = function( filedName, flag ) {if ( !that.userActions[filedName] ) return;if ( flag == 'UndoRedoChange' ) filedName = 'flag_UseUndoRedo';if ( flag == 'ReadyTemplateChange' ) return;if ( isLogged(filedName) ) return;that.userActions[filedName] = '1';$.ajax({type: "POST",url: "/versions/2/wizard/userActions/updateUserAction.php",data: {w: $('#id').val(),userActions: JSON.stringify(that.userActions)},success: function( response ) {}});}
function addLogListner() {addWizardInputsLog();addWizardTabsLog();addWizardButtonsLog();addDocumentEventsLog();}
function addDocumentEventsLog() {$(document).on('user_action_update_flag',function( event, flag ) {that.logAction(flag.name,flag.triggerName);});}
function addWizardButtonsLog() {$('#AddModuleWin').on('add_new_page', function( event, flag ) {that.logAction('flag_AddedNewPage',flag);});$('.changePelleteColors').on('click.user_action',function( event, flag ) {that.logAction('flag_OpenThemeTool',flag);});$('#previewScaleDevices').on('click.user_action', function( event, flag ) {if ( flag === 'scale_init' ) return;that.logAction('flag_UsePreview',flag);});}
function addWizardInputsLog() {$('#home_siteSlogan, #home_siteSlogan_2, #home_SecondSiteSlogan').on('change.user_action',function( event, flag ) {that.logAction('flag_HomepageUpdateTitles',flag);});$('#font_slogan, #font_slogan_2, #font_second_slogan').on('change.user_action',function( event, flag ) {that.logAction('flag_HomepageChangeFont',flag);});$('#name').on('change.user_action',function( event, flag ) {that.logAction('flag_UpdateNameAndLogo',flag);});}
function addWizardTabsLog() {Wizard.Tabs.home.t.on('open_wizard_tabs', function( event, flag ) {that.logAction('flag_OpenHomepageTab',flag);});Wizard.Tabs.pages.t.on('open_wizard_tabs', function( event, flag ) {that.logAction('flag_OpenPagesTab',flag);});Wizard.Tabs.design.t.on('open_wizard_tabs', function( event, flag ) {that.logAction('flag_OpenDesignTab',flag);});Wizard.Tabs.settings.t.on('open_wizard_tabs', function( event, flag ) {that.logAction('flag_OpenSettingsTab',flag);});Wizard.Tabs.domain.t.on('open_wizard_tabs', function( event, flag ) {that.logAction('flag_OpenDomainTab',flag);});}
function isLogged( filedName ) {return that.userActions[filedName] == '1' ? true : false;};return that;};
var s123IconsPopup = function() {var _ = {selectedItem: false,isLoading: false,uploadFile: null,categories: [],illustrationCategories: [],defFilters: [],query: ''};_.init = function( settings ) {_.translations = settings.translations;_.$GLOBALS = settings.$GLOBALS;_.onIconChange = settings.onIconChange;loadDefData();_.$el = $(generateHtml());};_.show = function( inputID, library, filters ) {if ( !topWindow.uploadFiles[inputID] ) return;filters = filters.split(',');if ( filters.length == 1 && filters[0] == 'auto' ) {filters = _.defFilters;} else {for (var i = 0; i < filters.length; i++) {filters[i] = _.defFilters.find(defFilter => filters[i] == defFilter.value);}}
_.inputID = inputID;_.libraryType = library;_.$el.find('.modal-body').html(generateModalContent(filters));_.$el.one('show.bs.modal', function() {_.$itemsContainer = _.$el.find('.s123-icons-svg-items-container .all-items');_.$searchContainer = _.$el.find('.s123-icons-svg-search-container');_.$itemsFilterContainer = _.$el.find('.icon-filter-container');_.items = {};_.$el.find('.search')
.on('keydown', function( event ) {var $this = $(this);var eventKey = event.which;if ( _.query == $this.val() ) return;_.$itemsFilterContainer.find('.style-filter').siblings().removeClass('active');_.$itemsFilterContainer.find('.style-filter').first().addClass('active');clearTimeout(this.searchLibraryInputFinished);if ( eventKey == 13 ) {loadItems($this.val(),_.$itemsFilterContainer.find('.style-filter').first().data('filter'));} else {this.searchLibraryInputFinished = setTimeout( function() {loadItems($this.val(),_.$itemsFilterContainer.find('.style-filter').first().data('filter'));},1000);}});_.$itemsContainer.on('click.save_icon', '.s123-icons-svg-item', function( event ) {if ( !_.items[$(this).get(0).id] ) return;var url = _.items[$(this).get(0).id].icon_link;_.uploadFile = topWindow.uploadFiles[_.inputID];UpdateImagePreview(_.inputID,{ normal: url, tiny: url });if ( _.inputID != 'siteLogo' && _.libraryType != 'illustrations_library' ) {var brandFlolder = '';if ( url.indexOf('/brand-1/') != -1 ) {brandFlolder = 'brand-1';}
_.uploadFile.input.val('site123-image-icon system-svg-icons ' + brandFlolder + ' ' + url.split('/').pop().replace('.svg','')).trigger('change');} else {$('#logoIconStyle').val(_.items[$(this).get(0).id].style);_.uploadFile.input.val(url).trigger('change');}
if ( _.onIconChange ) _.onIconChange.call(this,_.inputID,url);_.hide();if ( _.libraryType == 'illustrations_library' && !_.uploadFile.input.hasClass('promo-widget') ) {$('#active_illustration').val(_.items[$(this).get(0).id].uniqueID);}
if ( _.libraryType == 'icon_library') {_.uploadFile.input.attr('data-icon-style',_.items[$(this).get(0).id].style);_.uploadFile.settings.set('icon',{style: _.items[$(this).get(0).id].style},true);}});_.$itemsContainer.on('click', '.illustrations-credits', function( event ) {event.preventDefault();event.stopPropagation();var $thisCredit = $(this);var popoverContent = '';popoverContent += '<div class="form-group" style="margin-bottom:5px">';popoverContent += '<div class="popover-custom-title">';popoverContent += '<a class="popover-close">';popoverContent += '<i class="fa fa-times" aria-hidden="true"></i>';popoverContent += '</a>';popoverContent += '</div>';popoverContent += '<div><b>' + translations.homepageRI.creditsPhotographerName + '</b> ' + $thisCredit.data('name') + '</div>';popoverContent += '<div><b>' + translations.homepageRI.creditsProvider + '</b> ' + $thisCredit.data('provider');popoverContent += '<div>';popoverContent += '<a target="_blank" href="' + $thisCredit.find('a').data('href') + '">' + translations.homepageRI.creditsSeeMoreDetails + '</a>';popoverContent += '</div>';popoverContent += '</div>';var $popoverContent = $(popoverContent);$popoverContent.find('.popover-close').on('click.close_credits', function() {destroyPopover();});$thisCredit.popover({container: '#s123IconsPopup',content: $popoverContent,html: true,trigger: 'manual',template: '<div class="popover r-i-popover-credits" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',placement: window['isTouchSupported'] ? 'auto' : intrface_align_reverse}).on('shown.bs.popover', function () {$(document).on('mousedown.credits_destroy_popover', function ( event ) {if ( $(event.target).closest('.popover.r-i-popover-credits').length === 0 ) {destroyPopover();}});$(window).one('blur.credits_destroy_popover', function( event ) {destroyPopover();});_.$itemsContainer.one('scroll.credits_destroy_popover', function( event ) {destroyPopover();});})
.popover('show');function destroyPopover() {$thisCredit.removeClass('active');$thisCredit.popover('destroy');$(document).off('mousedown.credits_destroy_popover');$(window).off('blur.credits_destroy_popover');$(window).off('scroll.credits_destroy_popover');}});_.$itemsFilterContainer.on('click','.style-filter', function( event ) {$(this).addClass('active');$(this).siblings().removeClass('active');loadItems(_.query,$(this).data('filter'));});_.$searchContainer.find('.searchStylesIconRemove').on('click', function() {loadItems('','');_.$el.find('.search').focus();});_.$el.find('.s123-icons-svg-cat-item').on('click', function() {_.$el.find('.search').val($(this).data('query'));_.$itemsFilterContainer.find('.style-filter').siblings().removeClass('active');_.$itemsFilterContainer.find('.style-filter').first().addClass('active');loadItems($(this).data('query'),_.$itemsFilterContainer.find('.style-filter').first().data('filter'));});if ( _.$itemsFilterContainer.find('.style-filter').length == 1 ) {_.$itemsFilterContainer.addClass('hidden');} else {_.$itemsFilterContainer.removeClass('hidden');}
showByLibraryType();});var $modal_title = _.$el.find('.modal-header .modal-title');var $searchInput = _.$el.find('.modal-body .search');if ( library == 'illustrations_library' ) {$modal_title.html(escapeHtml(_.translations.illustrations));$searchInput.attr('placeholder',escapeHtml(_.translations.search));} else {$modal_title.html(escapeHtml(_.translations.modalTitle));$searchInput.attr('placeholder',escapeHtml(_.translations.searchIcons));}
_.$el.modal('show');};_.hide = function() {_.$el.modal('hide');};_.reset = function() {_.$searchContainer.find('.searchStylesIconRemove').hide();_.$searchContainer.find('.search').val('');if (_.libraryType == 'illustrations_library') {loadItems('illustration_no_category','');} else {showCategories();}};function generateHtml() {var html = '';html += '<div id="s123IconsPopup" class="modal s123-modal fade bs-example-modal-lg s123-icons-svg-modal" tabindex="-1" role="dialog">';html += '<div class="modal-dialog modal-lg" role="document">';html += '<div class="modal-content">';html += '<div class="modal-header">';html += '<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>';html += '<h4 class="modal-title">' + escapeHtml(_.translations.modalTitle) + '</h4>';html += '</div>';html += '<div class="modal-body">';html += '</div>';html += '</div>';html += '</div>';html += '</div>';return html;}
function generateModalContent( filters ) {var html = '';var categoryImageType = getCategoryImagesByActiveFilter(filters);html += '<div>';html += '<div class="s123-icons-svg-search-container">';html += '<div>';html += '<input type="text" maxlength="50" class="search form-control search-query" placeholder="' + escapeHtml(_.translations.searchIcons) + '">';html += '<span class="fa fa-search form-control-feedback searchStylesIconDemo"></span>';html += '<span class="fa fa-home searchStylesIconRemove" style="display: none;"></span>';html += '</div>';html += '</div>';html += '<div class="s123-icons-svg-categories-container shown icons-categories">';for (var i = 0; i < _.categories.length; i++) {html += '<div class="s123-icons-svg-cat-item" data-query="' + escapeHtml(_.categories[i].title) + '">';html += '<div class="s123-icons-svg-cat-icon">';html += '<img src="'+escapeHtml(_.categories[i].src[categoryImageType])+'">';html += '</div>';html += '<span class="s123-icons-svg-cat-title">' + escapeHtml(_.categories[i].title) + '</span>';html += '</div>';}
html += '</div>';html += '<div class="s123-icons-svg-categories-container illustrations-categories">';for (var i = 0; i < _.illustrationCategories.length; i++) {html += '<div class="s123-icons-svg-cat-item" data-query="' + escapeHtml(_.illustrationCategories[i].title) + '">';html += '<div class="s123-icons-svg-cat-icon">';html += '<img src="'+escapeHtml(_.illustrationCategories[i].src)+'">';html += '</div>';html += '<span class="s123-icons-svg-cat-title">' + escapeHtml(_.illustrationCategories[i].title) + '</span>';html += '</div>';}
html += '</div>';html += '<div class="s123-icons-svg-items-container" style="display: none;">';html += '<div class="icon-filter-container">';html += '<div class="s123-icons-filters">';$.each(filters, function( index, filter ) {html += '<div class="style-filter" data-filter="'+filter.value+'">' + filter.title + '</div>';});html += '</div>';html += '</div>';html += '<div class="all-items fancy-scrollbar"></div>';html += '</div>';html += '<div class="s123-icons-svg-no-items-container" style="display: none;">';html += '<h1>' + _.translations.noItems  + '</h1>';html += '</div>';html += '</div>';return html;}
function getItemHtml( item ) {var html = '';var ext = item.icon_link.split('.').pop();var image = ext === 'mp4' ? item.icon_link.replace('.'+ext,'-thumbnail.jpg').replace('normal_','400_') : item.icon_link;var type = ext === 'mp4' ? 'video' : 'image';var illustration_class = _.libraryType == 'illustrations_library' ? 'illustration-img' : '';if (type == 'image' && ext != 'svg' ) {image = image.replace('normal_','400_');illustration_class+= ' not-svg-illlustration';}
html += '<div id="' + item.uniqueID + '" class="s123-icons-svg-item ' + illustration_class+ '" data-media-type="' + type + '">';html += '<img src="' + image + '">';if ( item.media_info && _.libraryType == 'illustrations_library' ) {html += generatePhotoCredits( item.media_info, item.provider );}
html += '</div>';return html;}
function generatePhotoCredits( info, provider ) {var html = '';if ( info ) {var credit = tryParseJSON(info);if ( !credit['photoInfo'] ) return '';credit = credit['photoInfo'];html += '<div class="illustrations-credits" data-name="'+credit['photographer']+'" data-provider="'+provider+'">';html += '<a data-href="' + credit['profileLink'] + '">';if ( $('html').data('device') !== 'mobile' ) {html += credit['photographer'];} else {html += '<i class="fa fa-info-circle" aria-hidden="true"></i>';}
html += '</a>';html += '</div>';}
return html;}
function loadItems( query, filter ) {if ( query.length == 0 && query != 'illustration_no_category' && filter.length == 0 ) {_.reset();return;}
if (query == 'illustration_no_category') {query = '';}
if ( _.isLoading ) return;_.isLoading = true;_.$itemsContainer.empty();_.$searchContainer.find('.searchStylesIconRemove').show();_.$el.find('.s123-icons-svg-categories-container').removeClass('shown');_.$el.find('.s123-icons-svg-items-container').show();_.$el.find('.s123-icons-svg-no-items-container').hide();_.query = query;if ( _.s123InfiniteScroll ) _.s123InfiniteScroll.destroy();var type = _.libraryType == 'illustrations_library' ? 'illustrations' : 'icons';_.s123InfiniteScroll = new s123InfiniteScroll({isMobile: false, // we don't want to add "load more button" but we have other tools that do need that feature
$container: _.$itemsContainer,ajax: {type: "POST",url: "/files/vendor/s123IconsPopup/getIcons.php",data: {w: topWindow.websiteID,q: query,limit: 50,type: type,siteLogo: _.inputID == 'siteLogo',filter: filter},buildItemCallback: function( index, item ) {var $item = $(getItemHtml(item));$item.find('img').one('load', function() {$item.addClass('loaded');});_.$itemsContainer.append($item);_.items[item.uniqueID] = item;},success: function( data ) {_.$el.find('.wizard-pagination').removeClass('full-size');_.$searchContainer.show();_.isLoading = false;if ( data.items.length == 0 && _.$itemsContainer.children('.s123-icons-svg-item').length === 0 ) {_.$el.find('.s123-icons-svg-items-container').hide();_.$el.find('.s123-icons-svg-no-items-container').show();}}}});_.$el.find('.wizard-pagination').addClass('full-size');_.$el.find('.loading-icon i').removeClass('fa-2x').addClass('blue fa-4x');}
function showCategories() {showByLibraryType();_.$el.find('.s123-icons-svg-items-container').hide();_.$el.find('.s123-icons-svg-no-items-container').hide();}
function showByLibraryType() {if (_.libraryType == 'illustrations_library') {_.$el.find('.icons-categories').removeClass('shown');_.$itemsFilterContainer.hide();_.$itemsContainer.addClass('full');loadItems('illustration_no_category','');_.$el.find('.s123-icons-svg-items-container').show();} else {_.$itemsContainer.removeClass('full');_.$itemsFilterContainer.show();_.$el.find('.icons-categories').addClass('shown');_.$el.find('.s123-icons-svg-items-container').hide();_.$searchContainer.find('.search').val('');}}
function loadDefData() {_.categories = [{title: _.translations.categories.men,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/men_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/men.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.women,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/women_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/women.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.cities,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/cities_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/cities.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.music,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/music_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/music.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.foodAndDrink,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/foodAndDrink_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/foodAndDrink.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.business,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/business_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/business.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.sports,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/sports_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/sports.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.animals,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/animals_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/animals.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.nature,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/nature_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/nature.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.architecture,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/architecture_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/architecture.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.party,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/party_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/party.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.artsAndCulture,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/artsAndCulture_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/artsAndCulture.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.building,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/building_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/building.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.health,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/health_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/health.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.people,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/people_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/people.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.shopping,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/shopping_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/shopping.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.travel,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/travel_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/travel.svg?v='+_.$GLOBALS['v-cache'],}},{title: _.translations.categories.wallpapers,src: {color: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/wallpapers_color.svg?v='+_.$GLOBALS['v-cache'],glyph: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/wallpapers.svg?v='+_.$GLOBALS['v-cache'],}}];_.illustrationCategories = [{title: _.translations.categories.men,src: _.$GLOBALS['cdn-system-files'] + '/files/vendor/s123IconsPopup/categoryIcons/men.svg?v='+_.$GLOBALS['v-cache']}];_.defFilters = [{title: _.translations.filter.all,value: ''},{title: _.translations.filter.outline,value: 'outline'},{title: _.translations.filter.colored,value: 'colored'},{title: _.translations.filter.glyph,value: 'glyph'}];}
function getCategoryImagesByActiveFilter( filters ) {if ( filters.length == 1 && filters[0].value == 'glyph' ) return 'glyph';return 'color';}
return _;}();
var ActionButtons = function() {var _ = {buttons: {}};_.init = function() {$('.action-buttons-settings').each(function( index, json ) {var $json = $(json);_.renderButton($json,false);});_.initializeDependecies();};_.getActiveButton = function() {var activeButton = null;$.each(_.buttons, function(index, button) {if ( button.$settingBox.hasClass('buttonSettingBox s-b-active') && button.$settingBox.is(':visible') ) {activeButton = button;return false;}});return activeButton;};_.renderButton = function( $json, callbacks ) {var userSettings = tryParseJSON($json.val());if ( !userSettings ) return;userSettings = addStaticData(userSettings);userSettings.callbacks = callbacks;userSettings.$json = $json;var actionButton = new Button(userSettings);actionButton.$html.insertBefore($json);_.buttons[actionButton.id] = actionButton;return _.buttons[actionButton.id];};_.initializeDependecies = function() {UploadSingleFilesInitialize('');InitializeToolTips();ColorboxInitialTopWindow('[data-rel="colorbox-t-w"]');initilizeLinksAutocomplete();SettingsBox.init();}
function addStaticData( userSettings ) {userSettings = new UserSettings(userSettings);userSettings.textInput = getTextInputData(userSettings.textInput);userSettings.settingBox = getSettingBoxData(userSettings.settingBox);userSettings.type = getTypeData(userSettings.type,userSettings.moduleID,userSettings.moduleTypeNUM,userSettings.btnType);userSettings.style = getStyleData(userSettings.style,userSettings.moduleID,userSettings.moduleTypeNUM,userSettings.btnType);userSettings.icon = getIconData(userSettings.icon);return userSettings;}
function getTextInputData( textInputObj ) {return new SettinObj(textInputObj);}
function getSettingBoxData( settingBoxObj ) {return new SettinObj({text: translations.actionButtons.settingBox.text});}
function getTypeData( typeObj, moduleID, moduleTypeNUM, btnType ) {var translation = translations.actionButtons.type;typeObj.text = translation.text;typeObj.options = getSelectInputOptions('type',moduleID,moduleTypeNUM,btnType);$.each(typeObj.options, function( index, option ) {var inputObj = typeObj.inputs[option.relatedSetting];if ( !inputObj ) return;inputObj = addTranslationsToObj(inputObj,translation[option.relatedSetting]);if ( option.relatedSetting == 'scroll' ) {inputObj.options = getSelectInputOptions('scroll',moduleID,moduleTypeNUM,btnType);}
if ( option.relatedSetting == 'videoPopup' ) {inputObj.options = getSelectInputOptions('videoPopup',moduleID,moduleTypeNUM,btnType);$.each(inputObj.options, function( index, op ) {var obj = inputObj.inputs[op.relatedSetting];if ( !obj ) return;obj = addTranslationsToObj(obj,translation[option.relatedSetting][op.relatedSetting]);inputObj.inputs[op.relatedSetting] = new SettinObj(obj);});}
typeObj.inputs[option.relatedSetting] = new SettinObj(inputObj);});return new SettinObj(typeObj);}
function getStyleData( styleObj, moduleID, moduleTypeNUM, btnType ) {styleObj.options = getSelectInputOptions('style',moduleID,moduleTypeNUM,btnType);styleObj = addTranslationsToObj(styleObj,translations.actionButtons.style);return new SettinObj(styleObj);}
function getIconData( iconObj ) {styleObj = addTranslationsToObj(iconObj,translations.actionButtons.icon);return new SettinObj(iconObj);}
function getSelectInputOptions( settingName, moduleID, moduleTypeNUM, btnType ) {switch( settingName ) {case 'scroll':var place = 1;var promoCount = 1;var modules = tryParseJSON(topWindow.tools_manage);var isSinglePage = topWindow.IsSinglePage();var modulesArray = [];var parentID = '';var parentModuleTypeNUM = '';if ( moduleID.length > 0 ) {parentID = topWindow.GetModuleSetting(moduleID,'parentId');parentModuleTypeNUM = topWindow.GetModuleSetting(parentID,'moduleTypeNUM');}
if ( !modules ) return [{text: translations.actionButtons.type.scroll.default,value: '1'}];if ( topWindow.abTestTXT != 'siteEditor_b' && btnType != 'homepage' ) {modulesArray.unshift({moduleID: 'top-section',text: topWindow.$('#homepageAlternativeName').val().length > 0 ? topWindow.$('#homepageAlternativeName').val() : translations.Homepage,value: place,isPlaceHolder: false});place ++;}
$.each(modules, function(index, module) {if ( !module.moduleTypeNUM ) module.moduleTypeNUM = module.toolID;if ( module.parentId && module.parentId.length == 0 || parentModuleTypeNUM == '78' ) {if ( !isSinglePage && module.mp_showInHome != '1' ) return;}
if ( topWindow.modulesArr[module.moduleTypeNUM].module_kind == '4' ) return;if ( topWindow.modulesArr[module.moduleTypeNUM].module_kind == '5' ) return;if ( topWindow.modulesArr[module.moduleTypeNUM].module_kind == '6' ) return;if ( module.parentId !== null && parentID != module.parentId ) return;var moduleTitle = module.title;if ( module.moduleTypeNUM == '1000' ) {moduleTitle = translations.Promo + ' ' + promoCount;promoCount++;}
modulesArray.push({moduleID: module.moduleID,text: moduleTitle,value: place,isPlaceHolder: module.moduleID === moduleID});place += 1;});return modulesArray;break;case 'style':if ( btnType == 'homepage' || btnType == 'promotionPopup' ) {return [{text: translations.actionButtons.style.mainColor,value: '1'},{text: translations.actionButtons.style.transparent,value: '2'},{text: translations.actionButtons.style.white,value: '3'},{text: translations.actionButtons.style.black,value: '4'},{text: translations.actionButtons.style.grey,value: '5'},{text: translations.actionButtons.style.mainTransparent,value: '6'},{text: translations.actionButtons.style.simpleLinkMainColor,value: '7'},{text: translations.actionButtons.style.simpleLinkTextColor,value: '8'}];} else if ( btnType == 'menu' ) {return [{text: translations.actionButtons.style.mainColor,value: '1'},{text: translations.actionButtons.style.menuTextColor,value: '2'},{text: translations.actionButtons.style.menuHoverTextColor,value: '3'},{text: translations.actionButtons.style.transparent,value: '4'},{text: translations.actionButtons.style.grey,value: '5'},{text: translations.actionButtons.style.mainTransparent,value: '6'}];} else if ( btnType == 'promo' ) {return [{text: translations.actionButtons.style.mainColor,value: ''},{text: translations.actionButtons.style.transparent,value: '1'},{text: translations.actionButtons.style.grey,value: '2'},{text: translations.actionButtons.style.mainTransparent,value: '3'},{text: translations.actionButtons.style.white,value: '4'},{text: translations.actionButtons.style.black,value: '5'},{text: translations.actionButtons.style.simpleLinkMainColor,value: '6'},{text: translations.actionButtons.style.simpleLinkTextColor,value: '7'}];} else if ( btnType == 'callToAction' ) {return [{text: translations.actionButtons.style.automaticRecommended,value: '9'},{text: translations.actionButtons.style.mainColor,value: '1'},{text: translations.actionButtons.style.transparent,value: '2'},{text: translations.actionButtons.style.white,value: '3'},{text: translations.actionButtons.style.black,value: '4'},{text: translations.actionButtons.style.grey,value: '5'},{text: translations.actionButtons.style.mainTransparent,value: '6'},{text: translations.actionButtons.style.simpleLinkMainColor,value: '7'},{text: translations.actionButtons.style.simpleLinkTextColor,value: '8'}];}
break;case 'type':if ( btnType == 'promo' ) {return [{relatedSetting: 'redirect',noInput: true,value: '',text: translations.actionButtons.type.redirectNewWindow.optionText,},{relatedSetting: 'redirect',value: '0',text: translations.actionButtons.type.redirect.optionText,},{relatedSetting: 'scroll',value: '1',text: translations.actionButtons.type.scroll.optionText,},{relatedSetting: 'phoneNumber',value: '2',text: translations.actionButtons.type.phoneNumber.optionText,},{relatedSetting: 'email',value: '3',text: translations.actionButtons.type.email.optionText,},{relatedSetting: 'downloadFile',value: '4',text: translations.actionButtons.type.downloadFile.optionText,},{relatedSetting: 'videoPopup',value: '5',text: translations.actionButtons.type.videoPopup.optionText,}];} else if ( btnType == 'promotionPopup' ) {return [{relatedSetting: 'redirect',value: '2',text: translations.actionButtons.type.redirect.optionText,},{relatedSetting: 'redirect',noInput: true,value: '3',text: translations.actionButtons.type.redirectNewWindow.optionText,},{relatedSetting: 'phoneNumber',value: '4',text: translations.actionButtons.type.phoneNumber.optionText,},{relatedSetting: 'email',value: '5',text: translations.actionButtons.type.email.optionText,}];} else if ( btnType == 'callToAction' ) {return [{relatedSetting: 'redirect',noInput: true,value: '',text: translations.actionButtons.type.redirectNewWindow.optionText,},{relatedSetting: 'redirect',value: '0',text: translations.actionButtons.type.redirect.optionText,},{relatedSetting: 'scroll',value: '1',text: translations.actionButtons.type.scroll.optionText,},{relatedSetting: 'phoneNumber',value: '2',text: translations.actionButtons.type.phoneNumber.optionText,},{relatedSetting: 'email',value: '3',text: translations.actionButtons.type.email.optionText,},{relatedSetting: 'downloadFile',value: '4',text: translations.actionButtons.type.downloadFile.optionText,},{relatedSetting: 'formPopup',value: '5',text: translations.actionButtons.type.formPopup.optionText,}];} else {return [{relatedSetting: 'scroll',value: '1',text: translations.actionButtons.type.scroll.optionText,},{relatedSetting: 'redirect',value: '2',text: translations.actionButtons.type.redirect.optionText,},{relatedSetting: 'redirect',noInput: true,value: '3',text: translations.actionButtons.type.redirectNewWindow.optionText,},{relatedSetting: 'phoneNumber',value: '4',text: translations.actionButtons.type.phoneNumber.optionText,},{relatedSetting: 'email',value: '5',text: translations.actionButtons.type.email.optionText,},{relatedSetting: 'downloadFile',value: '6',text: translations.actionButtons.type.downloadFile.optionText,},{relatedSetting: 'videoPopup',value: '7',text: translations.actionButtons.type.videoPopup.optionText,}];}
break;case 'videoPopup':return {externalVideo: {relatedSetting: 'externalVideo',value: '',text: translations.actionButtons.type.videoPopup.externalVideo.optionText,},customVideo: {relatedSetting: 'customVideo',value: '1',text: translations.actionButtons.type.videoPopup.customVideo.optionText,}};break;}}
function addTranslationsToObj( inputObj, translationObj ) {if ( translationObj.text ) {inputObj.text = translationObj.text;}
if ( translationObj.tooltip ) {inputObj.tooltip = translationObj.tooltip;}
if ( translationObj.requireMsg ) {inputObj.requireMsg = translationObj.requireMsg;}
if ( translationObj.placeholder ) {inputObj.placeholder = translationObj.placeholder;}
return inputObj;}
function UserSettings( source ) {function Def() {return {moduleID: '',moduleTypeNUM: '',btnType: '',notFormInputs: false,type: {options: []},style: {options: []},icon: {},settingBox: {}};}
return objectAssign(new Def(),source);};function SettinObj( source ) {function Def() {return {id: '',value: '',dataAttr: '',classes: '',text: '',tooltip: '',};}
return objectAssign(new Def(),source);};function Button( settings ) {var _ = {moduleID: settings.moduleID,moduleTypeNUM: settings.moduleTypeNUM,btnType: settings.btnType,textInput: settings.textInput,type: settings.type,settingBox: settings.settingBox,style: settings.style,icon: settings.icon,callbacks: settings.callbacks ? settings.callbacks : {},hasIcon: settings.icon.id != '',notFormInputs: settings.notFormInputs,$json: settings.$json};_.init = function() {_.id = uniqid('ActionButtons-');_.$html = $(generateHtml());_.$settingBox = _.$html.find('.buttonSettingBox');registerEvents();initCallbacksHandler();};_.rebuildOption = function( optionName ) {switch( optionName ) {case 'scroll':var $select = _.$settingBox.find('.scrollSectionSelect');var $typeInputField = _.$settingBox.find('#'+_.type.id);var isSinglePage = topWindow.IsSinglePage();var modules = getSelectInputOptions('scroll',_.moduleID,_.moduleTypeNUM,_.btnType);if ( modules.length === 0 ) {$typeInputField.val('2').trigger('change');$typeInputField.find('option[value="1"]').hide();return;}
var selectedValue = _.type.inputs.scroll.value ? _.type.inputs.scroll.value : '1';$typeInputField.find('option[value="1"]').show();$select.find("option").remove();let tomInstance = $select.get(0).tomselect;if ( tomInstance ) tomInstance.destroy();$.each(modules, function(index, module) {var $option = null;if ( _.btnType == 'menu' || _.btnType == 'promo' || _.btnType == 'callToAction') {$option = $('<option>', {value: module.moduleID,text: module.text});} else {$option = $('<option>', {value: module.value,text: module.text});}
$select.append($option);if ( module.isPlaceHolder == true ) {$option.addClass('hidden is-place-holder');}});if ( ['menu','promo','callToAction'].includes(_.btnType) && selectedValue == '1' ) {selectedValue = $select.find('option.is-place-holder').next().val();if ( !selectedValue ) {selectedValue = $select.find('option.is-place-holder').prev().val();}
if ( !selectedValue ) {selectedValue = $select.find('option:not(.is-place-holder)').first().val();}}
$select.val(selectedValue);let uiRichSelect = new UiRichSelect();break;}};_.save = function() {_.$json.val(JSON.stringify({moduleID: _.moduleID,moduleTypeNUM: _.moduleTypeNUM,textInput: _.textInput,btnType: _.btnType,type: _.type,style: _.style,icon: _.icon,notFormInputs: _.notFormInputs}));};function generateHtml() {var html = '';html += '<div class="form-group s-b-container">';html += getTooltipHtml(_.textInput);html += '<div class="input-group">';html += '<input type="text" class="form-control ' + _.textInput.classes + ' text-input" ' + (_.notFormInputs ? '' : 'name="' + _.textInput.id + '"') + ' id="' + _.textInput.id + '" value="' + escapeHtml(_.textInput.value) + '" placeholder="' + escapeHtml(_.textInput.placeholder) + '" maxlength="40" ' + _.textInput.dataAttr + '>';html += '<a id="' + _.textInput.id + '_settings" class="input-group-addon btn-default btnSettings" href="#" data-s-b-o-s=".popups-button">' + escapeHtml(_.settingBox.text) + '&nbsp;';html += '<i class="fa fa-chevron-down"></i>';html += '<i class="fa fa-chevron-up"></i>';html += '</a>';html += '</div>';html += '<div class="buttonSettingBox" data-type="ActionButtons">';html += '<div class="form-group no-margin">';html += getTooltipHtml(_.type);html += '<select class="form-control type-input button-action-type ' + _.type.classes + '" ' + (_.notFormInputs ? '' : 'name="' + _.type.id + '"') + ' id="' + _.type.id + '" ' + _.type.dataAttr + '>';$.each(_.type.options, function(key, option) {html += '<option data-related-setting="' + option.relatedSetting + '" value="' + option.value + '"' + (_.type.value == option.value ? ' selected' : '') + '>' + escapeHtml(option.text) + '</option>';});html += '</select>';html += '</div>';$.each(_.type.options, function(key, option) {if ( option.noInput ) return;html += getInputsByOptionType(option,_.type.inputs);});if ( _.style.options.length > 0 ) {html += '<div class="form-group no-margin">';html += getTooltipHtml(_.style);html += '<select class="button-style  form-control ' + _.style.classes + '" ' + (_.notFormInputs ? '' : 'name="' + _.style.id + '"') + ' id="' + _.style.id + '" ' + _.style.dataAttr + '>';$.each(_.style.options, function(key, option) {html += '<option value="' + option.value + '"' + (_.style.value == option.value ? ' selected' : '') + '>' + escapeHtml(option.text) + '</option>';});html += '</select>';html += '</div>';}
if ( _.hasIcon ) {html += '<div class="form-group no-margin">';html += '<label for="' + _.icon.id + '">' + escapeHtml(_.icon.text) + '</label>';html += '<div class="input-file-upload' + _.icon.classes + '" id="' + _.icon.id + '" data-file-kind="1" data-value="' + escapeHtml(_.icon.value) + '" ' + _.icon.dataAttr + ' data-icons="true" data-no-drop-down="true" data-custom-class="icon-input" ' + (_.notFormInputs ? 'data-not-form-input="true"' : '') + '></div>';html += '<textarea id="' + _.icon.settings.id + '" ' + (_.notFormInputs ? '' : 'name="' + _.icon.settings.id + '"') + ' class="hidden icon-input-settings">' + _.icon.settings.value + '</textarea>';html += '</div>';}
html += '</div>';html += '</div>';return html;}
function getInputsByOptionType( option, inputs ) {var html = '';var inputObj = inputs[option.relatedSetting] ? inputs[option.relatedSetting] : null;if ( !inputObj ) return;switch( option.relatedSetting ) {case 'scroll':html += '<div class="form-group no-margin ' + option.relatedSetting + '" style="display: none;">';html += getTooltipHtml(inputObj);html += '<select class="form-control scrollSectionSelect" ' + (_.notFormInputs ? '' : 'name="' + inputObj.id + '"') + ' id="' + inputObj.id + '" ' + inputObj.dataAttr + '>';$.each(inputObj.options, function(key, option) {html += '<option value="' + option.value + '">'+escapeHtml(option.text)+'</option>';});html += '</select>';html += '</div>';break;case 'redirect':html += '<div class="form-group no-margin ' + option.relatedSetting + '" style="display: none;">';html += getTooltipHtml(inputObj);html += '<input type="text" class="form-control redirect-input" ' + (_.notFormInputs ? '' : 'name="' + inputObj.id + '"') + ' id="' + inputObj.id + '" value="' + escapeHtml(inputObj.value) + '" placeholder="' + escapeHtml(inputObj.placeholder) + '" ' + inputObj.dataAttr + '>';html += '</div>';break;case 'phoneNumber':html += '<div class="form-group ' + option.relatedSetting + '" style="display: none;">';html += getTooltipHtml(inputObj);html += '<div>';html += '<input type="text" class="form-control ' + inputObj.classes + ' phone-number-input" ' + (_.notFormInputs ? '' : 'name="' + inputObj.id + '"') + ' id="' + inputObj.id + '" data-rule-phone-pattern="true" data-msg-phone-pattern="'+escapeHtml(translations.pleaseEnterValidPhone)+'" value="' + escapeHtml(inputObj.value) + '" placeholder="' + escapeHtml(inputObj.placeholder) + '" ' + inputObj.dataAttr + '>';html += '</div>';html += '</div>';break;case 'email':html += '<div class="form-group ' + option.relatedSetting + '" style="display: none;">';html += getTooltipHtml(inputObj);html += '<div>';html += '<input type="text" class="form-control ' + inputObj.classes + ' email-input" data-rule-email="true" data-msg-email="' + escapeHtml(inputObj.requireMsg) + '" ' + (_.notFormInputs ? '' : 'name="' + inputObj.id + '"') + ' id="' + inputObj.id + '" value="' + escapeHtml(inputObj.value) + '" placeholder="' + escapeHtml(inputObj.placeholder) + '" ' + inputObj.dataAttr + '>';html += '</div>';html += '</div>';break;case 'downloadFile':html += '<div class="form-group ' + option.relatedSetting + '" style="display: none;">';html += '<div class="input-file-upload" id="' + inputObj.id + '" data-mb="100" data-file-kind="9" data-value="' + inputObj.value + '" data-text="' + escapeHtml(inputObj.text) + '" ' + inputObj.dataAttr + ' data-custom-class="download-file-input" ' + (_.notFormInputs ? 'data-not-form-input="true"' : '') + '></div>';html += '</div>';break;case 'formPopup':html += '<div class="form-group ' + option.relatedSetting + '" style="display: none;">';html += '<div class="input-group">';html += '<button type="button" class="advancedFormSettingsBtn btn btn-sm btn-primary" data-url="/files/vendor/site123/callToAction/interface/addCustomForm.php?w='+inputObj.websiteID+'">'+translations.actionButtons.type.formPopup.buttonText+'</button>';html += '<textarea class="hidden form-popup-input" name="' + inputObj.id + '">' + inputObj.value + '</textarea>';html += '</div>';html += '</div>';break;case 'videoPopup':html += '<div class="popupVideoInputBox ' + option.relatedSetting + '">';html += '<div class="form-group">';html += getTooltipHtml(inputObj);html += '<select class="form-control type-input ' + inputObj.classes + ' video-popup-input" id="' + inputObj.id + '" ' + (_.notFormInputs ? '' : 'name="' + inputObj.id + '"') + '>';$.each(inputObj.options, function(key, option) {html += '<option value="' + option.value + '" ' + (inputObj.value == option.value ? 'selected' : '') + ' data-related-setting="' + option.relatedSetting + '">' + escapeHtml(option.text) + '</option>';});html += '</select>';html += '</div>';$.each(inputObj.options, function(key, option) {html += getInputsByOptionType(option,inputObj.inputs);});html += '</div>';break;case 'externalVideo':html += '<div class="form-group ' + option.relatedSetting + '">';html += getTooltipHtml(inputObj);html += '<input type="text" class="form-control ' + inputObj.classes + ' external-video-input" ' + (_.notFormInputs ? '' : 'name="' + inputObj.id + '"') + ' id="' + inputObj.id + '" value="' + escapeHtml(inputObj.value) + '" placeholder="' + escapeHtml(inputObj.placeholder) + '" ' + inputObj.dataAttr + ' required>';html += '</div>';break;case 'customVideo':html += '<div class="form-group ' + option.relatedSetting + '">';html += '<div class="input-file-upload" id="' + inputObj.id + '" data-mb="50" data-file-kind="2" data-value="' + escapeHtml(inputObj.value) + '" data-text="' + escapeHtml(inputObj.text) + '" data-library="video" data-hide-remove-btn="true" ' + inputObj.dataAttr + ' data-custom-class="custom-video-input" ' + (_.notFormInputs ? 'data-not-form-input="true"' : '') + '></div>';html += '</div>';break;}
return html;}
function registerEvents() {var $typeInput = _.$html.find('.type-input');$typeInput.each(function( index, el ) {var $el = $(el);showTypeInputs($el);$el.off('change.ActionButtons').on('change.ActionButtons', function( event ) {var $this = $(this);showTypeInputs($this);});});_.$html.find('#' + _.textInput.id + '_settings').on('click', function( event ) {event.preventDefault();SettingsBoxHandler($(this),_.$settingBox);_.rebuildOption('scroll');});_.$settingBox.find('.scrollSectionSelect').on('change.ActionButtons', function() {_.type.inputs.scroll.value = $(this).val();});}
function showTypeInputs( $typeInput ) {var $option = $typeInput.find('option[value="' + $typeInput.val() + '"]');$typeInput.children().each(function( index, option ) {_.$settingBox.find('.' + $(option).data('related-setting')).hide();});_.$settingBox.find('.' + $option.data('related-setting')).show();}
function getTooltipHtml( settings ) {var html = '';html += '<label for="' + settings.id + '">'
html += escapeHtml(settings.text) + ' <a href="#" onclick="return false;" data-rel="tooltip" data-html="true" data-trigger="hover" title="' + escapeHtml(settings.tooltip) + '">';html += '<i class="fa fa-question-circle"></i>';html += '</a>';html += '</label>';return html;}
function initCallbacksHandler() {_.$settingBox.find('.advancedFormSettingsBtn').on('click', function( event ) {var $this = $(this);var $formPopupInput = $this.closest('.formPopup').find('.form-popup-input');event.preventDefault();var heighestHeightNUM = $(topWindow.window).outerHeight(true) - 170;var settings = {title: translations.actionButtons.type.formPopup.modalTitle,message: '<iframe id="formSettingsIframe" src="' + $(this).data('url') + '" style="width: 100%;height: '+heighestHeightNUM+'px;margin: 0;padding: 0;border: none;"></iframe>',backdrop: true,closeButton: true,onEscape: true,show: false,className: 's123-modal formSettingsModal system-modal'};var $bootBox = null;$bootBox = topWindow.bootbox.dialog(settings);$bootBox.on('show.bs.modal', function() {var $this = $(this);$this.attr('id','formSettingsModal');if ( parseInt($(topWindow.window).outerWidth(true)) > 900 ) {$this.find('.modal-dialog').css('width','900px');}
topWindow.getParentWindowActionButtonFormSettings = function() {return {$formPopupInput: $formPopupInput,};};$this.find('#formSettingsIframe').on('load',function( event ) {$(this).get(0).contentWindow.$('#submitCustomFormBtn').one('click', function( event ) {$('#formData').trigger('change.ChangePreviewLive');});});});$bootBox.modal('show');});_.$html.on('input','.text-input',function( event ) {var $this = $(this);updateSettings($this,true);clearTimeout(this.inputChangeLive_finishedTyping);this.inputChangeLive_finishedTyping = setTimeout(function() {updateSettings($this,false);},topWindow.doneTypingInterval);});_.$settingBox.on('change','.button-action-type, .scrollSectionSelect, .redirect-input, .download-file-input, .video-popup-input, .external-video-input, .custom-video-input, .button-style, .icon-input, .form-popup-input',function( event ) {var $this = $(this);if ( $this.hasClass('redirect-input') && _.type.inputs.redirect.value == $this.val() ) return;updateSettings($this,false);});_.$settingBox.on('input','.phone-number-input, .email-input',function( event ) {var $this = $(this);updateSettings($this,true);clearTimeout(this.inputChangeLive_finishedTyping);this.inputChangeLive_finishedTyping = setTimeout(function() {updateSettings($this,false);},topWindow.doneTypingInterval);});_.$settingBox.on('input','.icon-input-settings',function( event ) {var $this = $(this);updateSettings($this,false);});function updateSettings( $input, isLive ) {if ( $input.hasClass('text-input') ) {_.textInput.value = $input.val();} else if ( $input.hasClass('button-action-type') ) {_.type.value = $input.val();} else if ( $input.hasClass('scrollSectionSelect') ) {_.type.inputs.scroll.value = $input.val();} else if ( $input.hasClass('redirect-input') ) {_.type.inputs.redirect.value = $input.val();} else if ( $input.hasClass('phone-number-input') ) {_.type.inputs.phoneNumber.value = $input.val();} else if ( $input.hasClass('email-input') ) {_.type.inputs.email.value = $input.val();} else if ( $input.hasClass('download-file-input') ) {_.type.inputs.downloadFile.value = $input.val();} else if ( $input.hasClass('form-popup-input') ) {_.type.inputs.formPopup.value = $input.html();} else if ( $input.hasClass('video-popup-input') ) {_.type.inputs.videoPopup.value = $input.val();} else if ( $input.hasClass('external-video-input') ) {_.type.inputs.videoPopup.inputs.externalVideo.value = $input.val();} else if ( $input.hasClass('custom-video-input') ) {_.type.inputs.videoPopup.inputs.customVideo.value = $input.val();} else if ( $input.hasClass('button-style') ) {_.style.value = $input.val();} else if ( $input.hasClass('icon-input') ) {_.icon.value = $input.val();} else if ( $input.hasClass('icon-input-settings') ) {var uploadFile = getUploadFileObjectByID(_.icon.id);_.icon.value = uploadFile.input.val();_.icon.settings.value = JSON.stringify(uploadFile.settings.get());}
if ( _.callbacks.buttonStateChanged ) _.callbacks.buttonStateChanged.call(this,{textInput: _.textInput,type: _.type,style: _.style,icon: _.icon},isLive,$input);_.save();}}
_.init();return _;};return _;}();
Wizard.tabEffectHandler.designTabHandler = function() {var dth = {themes: {readyThemes: {items: {},infinityScroll: null},colorThemes: {items: {},infinityScroll: null},fontThemes: {items: {},infinityScroll: null}},imageLogoInfo: null};dth.init = function( settings ) {dth.initialized = false;dth.$tab = settings.$tab;dth.$tabLinks = dth.$tab.find('.t-h-e-link a');dth.$tabContent = dth.$tab.find('.t-h-e-tab');dth.$themsContainer = $(generateThemeContainerHtml());dth.$themsContainer.insertBefore(dth.$tab.find('fieldset'));syncUserTheme();dth.innerTabsHanler = new innerTabsHanler({$container: dth.$themsContainer.find('.i-t-handler')});dth.websiteStructureTabs = new innerTabsHanler({$container: $('#websiteStructureTabs')});var $mobileOptions = $('#mobile_settings #WebsiteMobileOptionsBOX .s123-collapse-settings');$mobileOptions.removeClass('static');$mobileOptions.find('.title').addClass('s123-mobile-settings');dth.websiteStructureTabs.$tabsContent.filter('#WebsiteThemeAdvancedOptionsBOX').find('.boxes-container').append($mobileOptions);dth.websiteStructureTabs.$tabsContent.filter('#WebsiteThemeAdvancedOptionsBOX').children().find('.title').addClass('s123-custom-settings');dth.websiteStructureTabs.$linkContainer.find('[data-tab="showWebsiteStructuresTab"]').trigger('click');$(document).on('ColorPickerInitialize',function( event ) {dth.MainColorStyles.mcs_int();});addTabOpenListener();$(document).on('color_picker_change.themes', function( event, id, newColor ) {if ( id == 'global_main_color' || id == 'global_main_color_copy' ) {dth.loadThemes('colorThemes','');}});$(document).on('customFontsHandler.change.designTabHandler', function( event ) {if ( !dth.themes.singleFontThemes ) return;if ( dth.themes.singleFontThemes.fieldID.length == 0 ) return;dth.themes.singleFontThemes.loadThemes();});$(document).on('color_picker_change.newColorsDTH', function( event, id, newColor ) {if ( id != 'global_main_color' ) return;Wizard.Preview.loseMenuTransparency();});dth.initialized = true;};dth.loadThemes = function( tabID, inputID, italicInputID ) {if ( tabID == 'singleFontThemes' ) {if ( dth.themes.singleFontThemes ) dth.themes.singleFontThemes.destroy();var $input = $('#'+inputID);dth.themes.singleFontThemes = new S123SingleFontTheme({fontName: $input.val(),websiteID: $('#id').val(),website_language: $('#language').val(),$container: dth.$themsContainer.find('#singleFontThemes'),fontChangeCallback: function( newTheme ) {$input.val(newTheme.name);Wizard.render.init(inputID);if ( websiteFonts[inputID] ) {websiteFonts[inputID].isItalicSupported = newTheme.italic;if ( !websiteFonts[inputID].isItalicSupported ) {$(italicInputID).val('').trigger('change');}}
AutoSaveWizard(false,true);}});dth.themes.singleFontThemes.loadThemes();} else {addThemesToPage(tabID,dth.$themsContainer.find('.themes-container[data-type="'+tabID+'"]'),'');if ( tabID == 'fontThemes' ) {searchHandler(tabID,dth.$themsContainer.find('#'+tabID+' .search'),dth.$themsContainer.find('.themes-container[data-type="'+tabID+'"]'));}}};dth.showCustom = function( $link ) {var id = $link.get(0).id;var animationInstance = Wizard.tabEffectHandler.getAnimationInstanceByID($link.data('related-tab-id'));if ( !animationInstance ) return;animationInstance.show($link);switch( id ) {case 'showColors':animationInstance.$tabContent.filter($link.attr('href')).find('[data-design-tab-handler-category]').hide();animationInstance.$tabContent.filter($link.attr('href')).find('[data-design-tab-handler-category="colors"]').show();dth.$tab.find('.back-btn').off('click.hide_custom').on('click.hide_custom', function() {animationInstance.$tabContent.filter($link.attr('href')).find('[data-design-tab-handler-category]').hide();$(this).hide();});if ( $('#isCustomColorsBOO').val() == 1 ) {dth.$tab.find('.back-btn').hide();} else {dth.$tab.find('.back-btn').show();}
break;case 'backToColorPalettes':OpenWizardTab('designTab',true);$('#isCustomColorsBOO').val(0).trigger('change');break;case 'showFonts':animationInstance.$tabContent.filter($link.attr('href')).find('[data-design-tab-handler-category]').hide();animationInstance.$tabContent.filter($link.attr('href')).find('[data-design-tab-handler-category="fonts"]').show();dth.$tab.find('.back-btn').off('click.hide_custom').on('click.hide_custom', function() {animationInstance.$tabContent.filter($link.attr('href')).find('[data-design-tab-handler-category]').hide();$(this).hide();});dth.$tab.find('.back-btn').show();break;case 'showWebsiteBackground':var $iframe = animationInstance.$tabContent.find('.patterns iframe');if ( $iframe.data('loaded') ) return;$iframe.one('load', function() {$iframe.show();$iframe.data('loaded',true);});$iframe.attr('src',$iframe.attr('data-src'));break;}};dth.applyTheme = function( type, id, obj = null, isThemeClick, isUndoRedo ) {if ( obj !== null ) {var settings = obj;} else {var settings = dth.themes[type].items[id].settings;}
if ( type == 'colorThemes' ) $('#global_main_color').data('used-theme',settings);var uploadFile = getUploadFileObjectByID(Wizard.homePageChangingImages.fistInputID);if ( !settings ) return;if ( !isUndoRedo ) holdWizardSave = true;if ( type == 'colorThemes' && !isThemeClick ) {(function() {const bestColor = ColorsDetector.getColorBestBrightnessDiff(settings.menu_color,[{color: '#000000',priority: 1},{color: '#ffffff',priority: 1}]);settings.menu_text_color = bestColor.color;settings.menu_text_hover_color = bestColor.color;})();(function() {if ( settings.global_main_color != settings.footer_back && !isMainColorContrastValid(settings.global_main_color,settings.footer_back) ) {const bestColor = ColorsDetector.getColorBestBrightnessDiff(settings.global_main_color,[{color: '#000000',priority: 1},{color: '#ffffff',priority: 1}]);settings.footer_back = bestColor.color;}
const bestColor = ColorsDetector.getColorBestBrightnessDiff(settings.footer_back,[{color: '#000000',priority: 1},{color: '#ffffff',priority: 1}]);settings.footer_text = bestColor.color;})();(function() {const bestColor = ColorsDetector.getColorBestBrightnessDiff(settings.global_main_color,[{color: '#000000',priority: 1},{color: '#ffffff',priority: 1}]);settings.global_main_color_btn_text_color = bestColor.color;settings.modules_color_section_btn_text = bestColor.color;settings.modules_color_second_section_btn_text = bestColor.color;settings.inside_modules_color_section_btn_text = bestColor.color;})();(function() {if (!isMainColorContrastValid(settings.global_main_color,settings.modules_color) ||!isMainColorContrastValid(settings.global_main_color,settings.modules_color_box)) {const primaryGray = getModuleTheme('primaryGray');const primaryBlack = getModuleTheme('primaryBlack');if (isMainColorContrastValid(settings.global_main_color,primaryGray.modules_color) &&isMainColorContrastValid(settings.global_main_color,primaryGray.modules_color_box)) {settings = {...settings,...primaryGray};} else if (isMainColorContrastValid(settings.global_main_color,primaryBlack.modules_color) &&isMainColorContrastValid(settings.global_main_color,primaryBlack.modules_color_box)) {settings = {...settings,...primaryBlack};}}
if (!isMainColorContrastValid(settings.global_main_color,settings.modules_color_second) ||!isMainColorContrastValid(settings.global_main_color,settings.modules_color_second_box)) {const secondaryGray = getModuleTheme('secondaryGray');const secondaryBlack = getModuleTheme('secondaryBlack');if (isMainColorContrastValid(settings.global_main_color,secondaryGray.modules_color_second) &&isMainColorContrastValid(settings.global_main_color,secondaryGray.modules_color_second_box)) {settings = {...settings,...secondaryGray};} else if (isMainColorContrastValid(settings.global_main_color,secondaryBlack.modules_color_second) &&isMainColorContrastValid(settings.global_main_color,secondaryBlack.modules_color_second_box)) {settings = {...settings,...secondaryBlack};}}
if (!isMainColorContrastValid(settings.global_main_color,settings.inside_modules_color) ||!isMainColorContrastValid(settings.global_main_color,settings.inside_modules_color_box)) {const insidePageGray = getModuleTheme('insidePageGray');const insidePageBlack = getModuleTheme('insidePageBlack');if (isMainColorContrastValid(settings.global_main_color,insidePageGray.inside_modules_color) &&isMainColorContrastValid(settings.global_main_color,insidePageGray.inside_modules_color_box)) {settings = {...settings,...insidePageGray};} else if (isMainColorContrastValid(settings.global_main_color,insidePageBlack.inside_modules_color) &&isMainColorContrastValid(settings.global_main_color,insidePageBlack.inside_modules_color_box)) {settings = {...settings,...insidePageBlack};}}})();}
if ( $('#defaultWebsiteFont').val() == '2' && type == 'fontThemes' ) {settings['font_logo'] = settings['font_modules_header'];}
$.each(settings, function (key, value) {if ( key == 'home_background_color' && uploadFile.input.val().length === 0 ) return;$('#'+key).val(value);Wizard.render.init(key);});if ( !isUndoRedo ) holdWizardSave = false;AutoSaveWizard(false,true);if ( type === 'readyThemes' || type === 'colorThemes' ) {Wizard.Preview.loseMenuTransparency();}
function getModuleTheme( themeType ) {const themeSettings = {};switch( themeType ) {case 'primaryGray':themeSettings.modules_color = '#f9f9f9';themeSettings.modules_color_text = '#000000';themeSettings.modules_color_box = '#ffffff';themeSettings.modules_color_text_box = '#000000';break;case 'secondaryGray':themeSettings.modules_color_second = '#ffffff';themeSettings.modules_color_text_second = '#000000';themeSettings.modules_color_second_box = '#f9f9f9';themeSettings.modules_color_text_second_box = '#000000';break;case 'insidePageGray':themeSettings.inside_modules_color = '#ffffff';themeSettings.inside_modules_color_text = '#000000';themeSettings.inside_modules_color_box = '#f9f9f9';themeSettings.inside_modules_color_text_box = '#000000';break;case 'primaryBlack':themeSettings.modules_color = '#1B262C';themeSettings.modules_color_text = '#ffffff';themeSettings.modules_color_box = '#000000';themeSettings.modules_color_text_box = '#ffffff';break;case 'secondaryBlack':themeSettings.modules_color_second = '#000000';themeSettings.modules_color_text_second = '#ffffff';themeSettings.modules_color_second_box = '#1B262C';themeSettings.modules_color_text_second_box = '#ffffff';break;case 'insidePageBlack':themeSettings.inside_modules_color = '#000000';themeSettings.inside_modules_color_text = '#ffffff';themeSettings.inside_modules_color_box = '#1B262C';themeSettings.inside_modules_color_text_box = '#ffffff';break;}
return themeSettings;}};dth.getFieldsByType = function( type ) {var colors = ['global_main_color','menu_color','menu_text_color','menu_text_hover_color','menu_thin_border','module_separate_border_color','modules_color','modules_color_text','modules_color_box','modules_color_text_box','modules_color_second','modules_color_text_second','modules_color_second_box','modules_color_text_second_box','inside_modules_color','inside_modules_color_text','inside_modules_color_box','inside_modules_color_text_box','footer_back','footer_text','modules_color_section_main','modules_color_section_btn_text','modules_color_second_section_main','modules_color_second_section_btn_text','inside_modules_color_section_box_main','inside_modules_color_section_btn_text',];var fonts = ['all_fonts','font_menu','font_modules_header','global_font','font_logo'];var singleFontThemes = [];var readyThemes = ['global_main_color','menu_color','menu_text_color','menu_text_hover_color','menu_thin_border','module_separate_border_color','modules_color','modules_color_text','modules_color_box','modules_color_text_box','modules_color_second','modules_color_text_second','modules_color_second_box','modules_color_text_second_box','inside_modules_color','inside_modules_color_text','inside_modules_color_box','inside_modules_color_text_box','footer_back','footer_text','all_fonts','font_menu','font_modules_header','global_font','font_logo','modules_color_section_main','modules_color_section_btn_text','modules_color_second_section_main','modules_color_second_section_btn_text','inside_modules_color_section_box_main','inside_modules_color_section_btn_text',];switch ( type ) {case 'colorThemes':return colors;break;case 'fontThemes':return fonts;break;case 'singleFontThemes':return singleFontThemes;break;default:return readyThemes;break;}};function syncUserTheme() {$(document).on('color_picker_change.themes', function( event, id, newColor, isUndoRedo ) {if ( id == 'global_main_color' ) {var usedTheme = $(`#${id}`).data('used-theme');if ( !usedTheme ) return;if ( usedTheme.menu_color == usedTheme.global_main_color ) {usedTheme.menu_color = newColor;usedTheme.menu_thin_border = newColor;} else {usedTheme.menu_color = $('#menu_color').val();usedTheme.menu_thin_border = $('#menu_thin_border').val();}
if ( usedTheme.footer_back == usedTheme.global_main_color ) {usedTheme.footer_back = newColor;} else {usedTheme.footer_back = $('#footer_back').val();}
usedTheme.modules_color_section_main = newColor;usedTheme.modules_color_second_section_main = newColor;usedTheme.inside_modules_color_section_box_main = newColor;usedTheme.global_main_color = newColor;usedTheme.global_main_color_btn_text_color = $('#global_main_color_btn_text_color').val();dth.applyTheme('colorThemes','',usedTheme,false,isUndoRedo);} else if ( id == 'menu_color' ) {Wizard.render.init(id);}
var arr = dth.getFieldsByType('readyThemes');if ( arr.indexOf(id) == -1 ) return;setUserTheme('colorThemes');});$(document).on('s123.fonts.selected', function( event ) {setUserTheme('fontThemes');});}
function addThemesToPage( type, $container, search ) {if ( dth.themes[type].infinityScroll ) dth.themes[type].infinityScroll.destroy();var settings = {};var template = '';var firstRequestSettings = {pagesAmount: 1,limit: 12};var $itemsContainer = null;dth.userLastTheme = '';if ( type === 'readyThemes' ) {$itemsContainer = $container.find('.theme-items-container');$itemsContainer.empty();setUserTheme(type);template = '<div data-id="{{id}}" style="order:{{order}};" class="wizard-card wizard-theme ActiveScale design-themes" data-type="readyThemes"><div class="menuColor" style="{{bgColor}}"></div><div class="mainDesign"><div class="mainFonts"><h2 class="themes-fonts-preview-image-all" style="{{backgroundImage}}">&nbsp;</h2><h4 class="themes-fonts-preview-image-menu" style="{{backgroundImage}}">&nbsp;</h4></div><div class="allColors"><div class="mainColor" style="{{bgColor}}">&nbsp;</div><div class="otherColorsBox"><div class="otherColors" style="{{bgColor}}">&nbsp;</div><div class="otherColors" style="{{bgColor}}">&nbsp;</div></div><div class="footerColor" style="{{bgColor}}">&nbsp;</div></div></div></div>';} else if ( type === 'colorThemes' ) {settings.mainColor = $('#global_main_color').val();$itemsContainer = $container.find('.theme-items-container');$itemsContainer.empty();setUserTheme(type);template = generateThemeHtml(new getTheme({id: 'skeleton',type: 'colorThemes'}));firstRequestSettings = {pagesAmount: 1,limit: 30};} else if ( type === 'fontThemes' ) {$itemsContainer = $container.find('.theme-items-container');$itemsContainer.empty();if ( search.length == 0 ) {setUserTheme(type);}
template = generateThemeHtml(new getTheme({id: 'skeleton',type: type}));firstRequestSettings = {pagesAmount: 1,limit: 30};}
$container.scrollTop(0);dth.themes[type].infinityScroll = new s123InfiniteScroll({isMobile: false, // we don't want to add "load more button" but we have other tools that do need that feature
$container: $container,firstRequestSettings: firstRequestSettings,loader: {$container: $itemsContainer,template: template},ajax: {type: 'POST',url: '/versions/2/wizard/modules/wizardInfiniteScroll_v5.php',data: {w: $('#id').val(),website_language: $('#language').val(),type: type,limit: 30,websiteLogoPath: getWebsiteImageLogoPath(),imageLogoInfo: JSON.stringify(dth.imageLogoInfo),search: search,settings: settings},buildItemCallback: function( index, theme, $container ) {theme.settings = tryParseJSON(theme.settings);if ( !theme.settings ) return;var newTheme = new getTheme(theme);dth.themes[newTheme.type].items[newTheme.id] = newTheme;var $theme = $(generateThemeHtml(newTheme));$theme.on('click', function( event ) {event.preventDefault();singleThemeClickEvent($(this).data('type'),$(this).data('id'),null);});addThemeTooltip($theme);$itemsContainer.append($theme);},success: function( data, infiniteScroll ) {if ( data.imageLogoInfo ) {dth.imageLogoInfo = data.imageLogoInfo;infiniteScroll.ajax.data.imageLogoInfo = JSON.stringify(dth.imageLogoInfo);}
if ( data.items.length == 0 && type == 'fontThemes' ) {dth.$themsContainer.find('#'+type+' .no-result').show();} else {dth.$themsContainer.find('#'+type+' .no-result').hide();}}}});function singleThemeClickEvent( type, id, currentTheme ) {dth.applyTheme(type,id,currentTheme,true,false);setUserTheme(type);}}
function addThemeTooltip( $theme ) {$theme.find('[data-rel=tooltip]').tooltip({container: 'body',placement: 'auto',delay: {show: 1000,hide: 0}});}
function getWebsiteImageLogoPath() {if ( $('#siteLogo').val().length == 0 ) return '';if ( $('#siteLogo').val().indexOf('site123-image-icon') != -1 ) return '';if ( $('#siteLogo').val().indexOf('.svg') != -1 ) return '';return getImageWRV1(2000,$('#siteLogo').val());}
function setUserTheme( type ) {var theme = null;if ( type == 'colorThemes' ) {theme = new getTheme({id: 'theme-current',type: type,order: 0,settings: {},isUserTheme: true});} else {theme = new getTheme({id: 'theme-current',type: type,order: 0,settings: {font_modules_header: $('#font_modules_header').val(),global_font: $('#global_font').val(),},isUserTheme: true});}
if ( dth.initialized && dth.userLastTheme === JSON.stringify(theme) ) return;dth.userLastTheme = JSON.stringify(theme);if ( type == 'colorThemes' ) {setColorThemes(theme);$('#global_main_color').data('used-theme',theme.settings);}
if ( type == 'fontThemes' ) {setfontThemes(theme);}
addThemeTooltip(dth.$userTheme);dth.innerTabsHanler.$tabsContent.find('.custom-option-controller a, #showColors, #showFonts')
.off('click.setUserTheme')
.on('click.setUserTheme', function( event ) {event.preventDefault();dth.showCustom($(this));});$('#backToColorPalettes')
.off('click')
.on('click', function( event ) {event.preventDefault();dth.showCustom($(this));});function setColorThemes( theme ) {theme.type = 'colorThemes';dth.$userTheme = $(generateThemeHtml(theme));dth.$themsContainer.find('#colorThemes .change-main-color-container .theme-current-box [data-id="theme-current"]').remove();dth.$themsContainer.find('#colorThemes .change-main-color-container .theme-current-box').prepend(dth.$userTheme);}
function setfontThemes( theme ) {theme.type = 'fontThemes';dth.$userTheme = $(generateThemeHtml(theme));dth.$userTheme.removeClass('ActiveScale');dth.$themsContainer.find('#fontThemes .theme-defult-item-container [data-id="theme-current"]').remove();dth.$themsContainer.find('#fontThemes .theme-defult-item-container').prepend(dth.$userTheme);}}
function getTheme( data ) {function Def() {return {id: 'static',settings: {},isUserTheme: false,type: 'readyThemes'};}
var def = new Def();var arr = dth.getFieldsByType(data.type);for (var i = 0; i < arr.length; i++) {def.settings[arr[i]] = $('#'+arr[i]).val();}
data.settings = objectAssign(def.settings,data.settings);data = objectAssign(def,data);return data;}
function objectAssign(target, sources) {if (Object.assign) {sources = Object.assign(target, sources);} else {for (var prop in target)
if (!sources.hasOwnProperty(prop)) sources[prop] = target[prop];}
return sources;}
function generateThemeContainerHtml() {var html = '';html += '<div class="themes-main-container">';html += '<div class="t-h-e-header t-h-e-manual-static t-h-e-tab-title hidden" data-visible="true">';html += '<span class="text-container">Colors</span>';html += '</div>';html += '<div class="i-t-handler">';html += '<div class="i-t-header ' + ($('html').data('device') !== 'mobile' ? 'hidden' : '') + '">';html += '<div data-tab="readyThemes" class="hidden">'+translations.tabEffectHandler.moreThemes+'</div>';html += '<div data-tab="colorThemes">'+translations.tabEffectHandler.colors+'</div>';html += '<div data-tab="fontThemes">'+translations.tabEffectHandler.fonts+'</div>';html += '<div data-tab="singleFontThemes" class="hidden">'+translations.tabEffectHandler.fonts+'</div>';html += '<div data-tab="more">';html += '<a href="#" data-toggle="dropdown">';html += translations.tabEffectHandler.moreTab;html += ' <span class="ace-icon fal fa-caret-down icon-on-right">';html += '</a>';html += '<ul class="dropdown-menu">';html += '<li>';html += '<a id="showMenuOptions" href="#collapseHeaderOptions" data-related-tab-id="designTab">';html += '<i class="fal fa-arrow-up"></i>&nbsp;'+translations.tabEffectHandler.headerMenuOptions;html += '</a>';html += '</li>';html += '<li>';html += '<a id="showFooterOptions" href="#collapseFooterLayout" data-related-tab-id="designTab">';html += '<i class="fal fa-arrow-down"></i>&nbsp;'+translations.tabEffectHandler.footerOptions;html += '</a>';html += '</li>';html += '<li>';html += '<a id="showWebsiteBackground" href="#websiteBackground" data-related-tab-id="designTab">';html += '<i class="fal fa-file-image-o" aria-hidden="true"></i>&nbsp;'+translations.tabEffectHandler.websiteBackground;html += '</a>';html += '</li>';html += '<li>';html += '<a id="showAdvancedStructure" href="#moreDesignOptions2" data-related-tab-id="designTab">';html += '<i class="fal fa-cog" aria-hidden="true"></i>&nbsp;'+translations.tabEffectHandler.websiteStructure;html += '</a>';html += '</li>';html += '</ul>';html += '</div>';html += '</div>';html += '<div id="readyThemes" class="tabContent">';html += '<div class="themes-container fancy-scrollbar" data-type="readyThemes">';html += '<div class="theme-items-container"></div>';html += '</div>';html += '</div>';html += '<div id="colorThemes" class="tabContent">';html += '<div class="checkboxSingleSetting">';html += '<div class="change-main-color-container">';html += '<div class="change-main-color-box">';html += '<div class="colorPalette" id="global_main_color" data-required="true" data-text="'+escapeHtml(translations.mainColor)+'" data-value="'+global_main_color+'" data-tooltip="'+escapeHtml(translations.mainColorTooltip)+'">';html += '</div>';html += '<div class="inline-colorlist"></div>';html += '</div>';html += '<div class="theme-current-box"></div>';html += '</div>';html += '</div>';html += '<div class="themes-container fancy-scrollbar" data-type="colorThemes">';html += '<div class="theme-items-container"></div>';html += '</div>';html += '<div class="custom-option-controller">';html += '<a id="showColors" href="#collapseTwo1" data-related-tab-id="designTab" class="btn btn btn-transparent btn-sm" data-back-btn="true">';html += '<i class="fal fa-tint"></i>&nbsp;'+translations.tabEffectHandler.customColors;html += '</a>';html += '</div>';html += '</div>';html += '<div id="fontThemes" class="tabContent">';html += '<div class="theme-defult-item-container">';html += '<a id="showFonts" href="#collapseTwo1" data-related-tab-id="designTab" class="btn btn btn-transparent btn-sm" data-back-btn="true">'+translations.tabEffectHandler.custom+'</a>';html += '</div>';html += '<div class="searchInput_design_container">';html += '<input type="text" maxlength="50" class="search form-control search-query input-transparent" placeholder="'+translations.fontsSearchPlaceHolder+'">';html += '<span class="fal fa-search form-control-feedback searchInput_designIcon"></span>';html += '<span class="btn btn-link clearInput_designIcon">';html += '<i class="fal fa-solid fa-xmark-large form-control-feedback"></i>';html += '</span>';html += '</div>';html += '<div class="font-theme-msg">';html += '<div class="alert alert-warning">';html += '<p>';html += translations.tabEffectHandler.fontsThemesExplanation;html += '</p>';html += '</div>';html += '</div>';html += '<div class="themes-container fancy-scrollbar" data-type="fontThemes">';html += '<div class="theme-items-container"></div>';html += '<div class="no-result">'+translations.fontsSearchNoResult+'</div>';html += '</div>';html += '</div>';html += '<div id="singleFontThemes" class="tabContent" data-static-tab-title-text="'+translations.tabEffectHandler.fonts+'"></div>';html += '</div>';html += '</div>';return html;}
function generateThemeHtml( theme ) {switch ( theme.type ) {case 'readyThemes':return getReadyThemeHtml(theme);break;case 'colorThemes':return getColorThemeHtml(theme);break;case 'fontThemes':return getFontThemeHtml(theme);break;}}
function getReadyThemeHtml( theme ) {var fontModulesHeaderImage = $GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/fontsImages/v5/normal_'+encodeURIComponent(theme.settings.font_modules_header.replace(/ /ig,"_"))+'_f_white.png?v=3';var globalFontImage = $GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/fontsImages/v5/normal_'+encodeURIComponent(theme.settings.global_font.replace(/ /ig,"_"))+'_f_white.png?v=3';var html = '';html += '<div data-id="' + theme.id + '" style="order:' + theme.order + ';" class="wizard-card wizard-theme ActiveScale design-themes" data-type="'+theme.type+'">';html += '<div class="mainDesign">';html += '<div class="mainFonts">';html += '<h2 class="themes-fonts-preview-image-all" style="background-image:url('+fontModulesHeaderImage+');">&nbsp;</h2>';html += '<h4 class="themes-fonts-preview-image-menu" style="background-image:url('+globalFontImage+');">&nbsp;</h4>';html += '</div>';html += '<div class="allColors">';html += '<div class="menuColor" style="background-color:'+theme.settings.menu_color+';">';html += '</div>';html += '<div class="mainColor" style="background-color:'+theme.settings.global_main_color+';background: linear-gradient(to right, '+theme.settings.global_main_color+', '+hexToRGB(theme.settings.global_main_color, 0.85)+');">&nbsp;</div>';html += '<div class="otherColorsBox">';html += '<div class="otherColors" style="background-color:'+theme.settings.modules_color+';background: linear-gradient(to right, '+theme.settings.modules_color+', '+hexToRGB(theme.settings.modules_color, 0.85)+');">&nbsp;</div>';html += '<div class="otherColors" style="background-color:'+theme.settings.modules_color_second+';background: linear-gradient(to right, '+theme.settings.modules_color_second+', '+hexToRGB(theme.settings.modules_color_second, 0.85)+');">&nbsp;</div>';html += '</div>';html += '<div class="footerColor" style="background-color:'+theme.settings.footer_back+';background: linear-gradient(to right, '+theme.settings.footer_back+', '+hexToRGB(theme.settings.footer_back, 0.85)+');">&nbsp;</div>';html += '</div>';html += '</div>';html += '</div>';return html;}
function getColorThemeHtml( theme ) {var html = '';html += '<div data-id="{{id}}" style="order:{{order}};" class="wizard-card wizard-theme ActiveScale design-themes" data-type="colorThemes">';html += '<div class="mainDesignV1">';html += '<div class="allColorsV1">';html += '<div class="menuColor" style="{{menuColor}}"></div>';html += '<div class="mainColor" style="{{mainColor}}">&nbsp;</div>';html += '<div class="otherColorsBox">';html += '<div class="otherColors" style="{{otherColors1}}">&nbsp;</div>';html += '<div class="otherColors" style="{{otherColors2}}">&nbsp;</div>';html += '</div>';html += '<div class="footerColor" style="{{footerColor}}">&nbsp;</div>';html += '</div>';html += '</div>';html += '</div>';if ( theme.id != 'skeleton' ) {html = html.replace('{{id}}',theme.id);html = html.replace('{{order}}',theme.order);html = html.replace('{{menuColor}}','background-color:'+theme.settings.menu_color+';background: linear-gradient(to right, '+theme.settings.menu_color+', '+hexToRGB(theme.settings.menu_color, 0.85)+');');html = html.replace('{{mainColor}}','background-color:'+theme.settings.global_main_color+';background: linear-gradient(to right, '+theme.settings.global_main_color+', '+hexToRGB(theme.settings.global_main_color, 0.85)+');');html = html.replace('{{otherColors1}}','background-color:'+theme.settings.modules_color+';background: linear-gradient(to right, '+theme.settings.modules_color+', '+hexToRGB(theme.settings.modules_color, 0.85)+');');html = html.replace('{{otherColors2}}','background-color:'+theme.settings.modules_color_second+';background: linear-gradient(to right, '+theme.settings.modules_color_second+', '+hexToRGB(theme.settings.modules_color_second, 0.85)+');');html = html.replace('{{footerColor}}','background-color:'+theme.settings.footer_back+';background: linear-gradient(to right, '+theme.settings.footer_back+', '+hexToRGB(theme.settings.footer_back, 0.85)+');');}
return html;}
function getFontThemeHtml( theme ) {var isSameFonts = theme.settings.font_modules_header == theme.settings.global_font;var html = '<div data-id="{{id}}" style="order:{{order}};" class="wizard-card wizard-theme ActiveScale design-themes" data-type="fontThemes">';html += '<div class="mainDesign">';html += '<div class="mainFonts'+(isSameFonts ? ' same-fonts' : '')+'">';if ( theme.id == 'skeleton' ) {html += '<h2 class="themes-fonts-preview-image-all" style="{{fontModulesHeaderImage}} {{border}}">{{fontModulesHeaderName}}</h2>';html += '<h4 class="themes-fonts-preview-image-menu" style="{{globalFontImage}}; {{border}}">{{globalFontName}}</h4>';} else {html += '<img class="themes-fonts-preview-image-all" src="{{fontModulesHeaderImage}}" title="'+translations.tabEffectHandler.Font_Headers+'">';html += '<img class="themes-fonts-preview-image-menu" src="{{globalFontImage}}" title="'+translations.tabEffectHandler.Font_Content+'">';}
html += '</div>';html += '<div class="allColors"></div>';html += '</div>';html += '</div>';html = html.replace('{{id}}',theme.id);html = html.replace('{{order}}',theme.order);if ( theme.id == 'skeleton' ) {html = html.replace('{{globalFontTitle}}','');html = html.replace('{{globalFontImage}}','');html = html.replace('{{fontModulesHeaderImage}}','');html = html.replace('{{globalFontName}}','');html = html.replace('{{fontModulesHeaderTitle}}','');html = html.replace('{{fontModulesHeaderImage}}','');html = html.replace('{{fontModulesHeaderName}}','');html = html.replace(/{{border}}/g,'');} else {html = html.replace(/{{border}}/g,'');html = html.replace('{{fontModulesHeaderTitle}}',theme.settings.font_modules_header);html = html.replace('{{globalFontTitle}}',theme.settings.global_font);if ( customFontsHandler.isCustomFont(theme.settings.font_modules_header) ) {html = html.replace('{fontModulesHeaderImage}}','');html = html.replace('{{fontModulesHeaderName}}',theme.settings.font_modules_header);} else {html = html.replace('{{fontModulesHeaderName}}','&nbsp;');html = html.replace('{{fontModulesHeaderImage}}',''+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/fontsImages/v5/normal_'+encodeURIComponent(theme.settings.font_modules_header.replace(/ /ig,"_"))+'_f_white.png?v=3'+'');html = html.replace('{{globalFontTitle}}',escapeHtml(theme.settings.font_modules_header));}
if ( customFontsHandler.isCustomFont(theme.settings.global_font) ) {html = html.replace('{{globalFontImage}}','');html = html.replace('{{globalFontName}}',theme.settings.global_font);} else {html = html.replace('{{globalFontName}}','&nbsp;');html = html.replace('{{globalFontImage}}',''+$GLOBALS['cdn-interface-files']+'/admin/InterfaceStatisFiles/fontsImages/v5/normal_'+encodeURIComponent(theme.settings.global_font.replace(/ /ig,"_"))+'_f_white.png?v=3'+'');html = html.replace('{{fontModulesHeaderTitle}}',escapeHtml(theme.settings.global_font));}}
return html;}
function innerTabsHanler( settings ) {var that = {};that.$container = settings.$container;that.$linkContainer = that.$container.find('.i-t-header');that.$tabsContent = that.$container.find('.tabContent');that.$linkContainer.find('[data-tab-related="moduleHeaderStyles"]').hide();that.$linkContainer.find('[data-tab]:not([data-tab="more"])').on('click.inner_tabs_hanler', function() {if ( $(this).data('tab') == 'showWebsiteStructuresTab' ) {if ( $('#websitePreviewIframe').attr('data-design-mobile-preview') == 'true' ) {Wizard.Preview.Scale.deviceButtonsClick($('#previewScaleDevices').find('li[data-device-type="computer"]'));$('#websitePreviewIframe').attr('data-design-mobile-preview',false);}}
that.showTab($(this).data('tab'));});that.$linkContainer.find('[data-tab="more"] [data-related-tab-id]').on('click.inner_tabs_hanler', function( event ) {event.preventDefault();dth.showCustom($(this));});that.showTab = function( tabID ) {that.$linkContainer.children().removeClass('active');that.$linkContainer.children('[data-tab="' + tabID + '"]').addClass('active');that.$tabsContent.removeClass('active');that.$tabsContent.filter('#'+tabID).addClass('active');};return that;}
function addTabOpenListener() {$(document).off('wizard_tabs_opened.design_tab_handler').one('wizard_tabs_opened.design_tab_handler', function( event, tabID ) {if ( tabID != 'designTab' ) {addTabOpenListener();return;}
dth.innerTabsHanler.$linkContainer.find('[data-tab="readyThemes"],[data-tab="colorThemes"],[data-tab="fontThemes"]').off('click.design_tab_handler').one('click.design_tab_handler', function( event, fieldID ) {dth.loadThemes($(this).data('tab'),'');})
.filter(':not(.hidden)')
.first().trigger('click');});}
function searchHandler( type, $searchInput, $container ) {var $noResult = $container.find('.no-result');$searchInput.closest('.searchInput_design_container').find('.clearInput_designIcon').off('click').on('click', function() {$searchInput.val('').trigger('input');});$noResult.hide();$searchInput.on('input', function( event ) {if ( $(this).val().length === 0 ) {$searchInput.closest('.searchInput_design_container').find('.clearInput_designIcon').hide();$searchInput.closest('.searchInput_design_container').find('.searchInput_designIcon').show();} else {$searchInput.closest('.searchInput_design_container').find('.searchInput_designIcon').hide();$searchInput.closest('.searchInput_design_container').find('.clearInput_designIcon').show();}
resetOrSearch(this,doneTypingInterval_Short,type,$container);});function resetOrSearch( input, interval, type, $container ) {clearTimeout(input.finishedTyping);input.finishedTyping = setTimeout( function() {if ( $searchInput.val().length === 0 ) {search('',type,$container);} else {search($searchInput.val(),type,$container);}},interval);}
function search( fontName, type, $container ) {addThemesToPage(type,$container,fontName);}}
function isMainColorContrastValid( mainColor, secondColor ) {const sensitivity = ['#000000','#ffffff'].includes(mainColor) ? 125 : 50;return ColorsDetector.getColorBestBrightnessDiff(mainColor,[{color: secondColor,priority: 0}]).score >= sensitivity;}
dth.MainColorStyles = function() {var _ = {$container: null,$input: null,limit: 12,def_quick_palette_colors: ['#814256','#eccc6e','#3d3d3d','#f46530','#345c72','#4a0638','#7b3911','#b12b24','#001f3d','#045174','#f8dcbf','#34568B','#FF0018','#39FF14','#FFD300','#673AB7','#40E0D0','#FFC0CB','#FF7F50','#708090','#98FF98','#FF8C00','#87CEEB','#FFF44F','#333333','#FFFFF0','#BF00FF','#FF00FF','#008080','#FFFDD0','#191970','#D32F2F','#C2185B','#7B1FA2','#512DA8','#303F9F','#1976D2','#0288D1','#0097A7','#00796B','#388E3C','#AFB42B','#FBC02D','#FFA000','#F57C00','#E64A19','#5D4037','#616161','#455A64','#263238'],quick_palette_colors: [],isLoaded: false};_.mcs_int = function( settings ) {_.$container = dth.innerTabsHanler.$tabsContent.filter('#colorThemes');_.$input = _.$container.find('#global_main_color');if ( $('.site-editor-b').length > 0 ) {$(document).off('wizardNavbar.mouseenter.newColorsDTH.loadDominanColors').on('wizardNavbar.mouseenter.newColorsDTH.loadDominanColors', function( event, id ) {if ( id != 'designTab' ) return;if ( $('#wizardBox .tab-content[data-active-tab="designTab"]').length > 0 ) return;_.mcs_load();});$(document).off('wizard_tabs_opened.newColorsDTH.loadDominanColors').on('wizard_tabs_opened.newColorsDTH.loadDominanColors', function( event, id ) {if ( id != 'designTab' ) {_.isLoaded = false;return;}
_.mcs_load();});$(document).off('homepage_image_change.refreshColors').on('homepage_image_change.refreshColors', function( event ) {if ( $('#wizardBox .tab-content:not([data-active-tab="designTab"])').length > 0 ) return;_.isLoaded = false;_.mcs_load();});var siteLogo = getUploadFileObjectByID('siteLogo');siteLogo.input.off('change.refreshColors').on('change.refreshColors', function( event, s3Obj, flagStatus ) {if ( $('#wizardBox .tab-content:not([data-active-tab="designTab"])').length > 0 ) return;_.isLoaded = false;_.mcs_load();});} else {_.mcs_load();}};_.mcs_load = function() {if ( _.isLoaded ) return;_.quick_palette_colors = [_.def_quick_palette_colors];_.limit = 48;var isHomepageHasNoImage = [33,34,52,53,57,59].includes(Wizard.Pages.homepage.$card.find('#card_169').data('module-style'));if ( isHomepageHasNoImage ) {_.quick_palette_colors = [['#c24e60','#8a028f','#954e25','#baf961','#9a88f6','#dba2aa','#305117','#327c91','#39e366','#f8c106','#f76f27','#c1ad7d'],_.def_quick_palette_colors];}
_.$container.find('.inline-colorlist').removeClass('show-extra-colors');_.$container.find('.extra-colors-controller').remove();if ( $('.site-editor-b').length == 0 || isHomepageHasNoImage ) {render();return;}
if ( _.dominantColorsLoading ) return;_.dominantColorsLoading = true;_.$container.find('.inline-colorlist').html('<div class="loading-container"><i class="ace-icon fal fa-spinner fa-solid fa-spin fa-3x"></i></div>');$.ajax({type: `POST`,url: `/versions/2/wizard/modules/headersModule/getHomepageDominantColors.php`,data: {w: $('#id').val(),websiteLogoPath: getWebsiteImageLogoPath()},success: function( data ) {_.dominantColorsLoading = false;data = tryParseJSON(data);if ( !data || !data.success) {render();return;}
data.colors.sort(function(a, b) { return b.percentage - a.percentage; });data.colors.sort(function(a, b) { return b.priority - a.priority; });_.quick_palette_colors = [[...data.colors.map(function( colorObj ) {return colorObj.hex;})],_.def_quick_palette_colors];render();}});};function render() {_.$container.find('.inline-colorlist').empty();let colorI = 1;let maxVisibleColors = 24;_.$input.spectrum('option','palette',[]);$.each(_.quick_palette_colors, function( colorsArrayIndex , colorArr ) {$.each(colorArr, function( index , color ) {let recColor =
`<div class="item ${_.$input.val() == color ? 'active' : ''}" data-select-color="${color}" data-is-extra-color="${(colorI > maxVisibleColors)}" data-is-recomended="${colorsArrayIndex == 0}">
<div class="colorCircle" style="background-color: ${color};"></div>
</div>`;$recColor = $(recColor);_.$container.find('.inline-colorlist').append($recColor);$recColor.on('click', function() {const $this = $(this);handleActiveClass();holdWizardSave = true;_.$input.val($this.data('select-color')).trigger('change');holdWizardSave = false;});if ( $.isNumeric(_.limit) && colorI >= _.limit ) {return false;}
colorI ++;});});if ( _.$container.find('.inline-colorlist [data-is-extra-color="true"]').length > 0  ) {let $extraColorsController = $(`<a href="#" class="extra-colors-controller"><i class="fa fa-chevron-down"></i></a>`);$extraColorsController.on('click', function( event	) {event.preventDefault();_.$container.find('.inline-colorlist').toggleClass('show-extra-colors');if ( _.$container.find('.inline-colorlist').hasClass('show-extra-colors') ) {$(this).html(' <i class="fa fa-chevron-up"></i>');} else {$(this).html('<i class="fa fa-chevron-down"></i>');}});_.$container.find('.inline-colorlist').parent().append($extraColorsController);}
$(document).off('color_picker_change.themes.MainColorStyles').on('color_picker_change.themes.MainColorStyles', function( event, id, newColor ) {if ( id != 'global_main_color' ) return;handleActiveClass();});_.isLoaded = true;}
function handleActiveClass() {_.$container.find(`.inline-colorlist .item`).removeClass('active');_.$container.find(`.inline-colorlist .item[data-select-color="${_.$input.val()}"]`).addClass('active');}
return _;}();return dth;}();
// TinyColor v1.4.2
// https://github.com/bgrins/TinyColor
// 2020-09-25, Brian Grinstead, MIT License
!function(a){function b(a,d){if(a=a?a:"",d=d||{},a instanceof b)return a;if(!(this instanceof b))return new b(a,d);var e=c(a);this._originalInput=a,this._r=e.r,this._g=e.g,this._b=e.b,this._a=e.a,this._roundA=P(100*this._a)/100,this._format=d.format||e.format,this._gradientType=d.gradientType,this._r<1&&(this._r=P(this._r)),this._g<1&&(this._g=P(this._g)),this._b<1&&(this._b=P(this._b)),this._ok=e.ok,this._tc_id=O++}function c(a){var b={r:0,g:0,b:0},c=1,e=null,g=null,i=null,j=!1,k=!1;return"string"==typeof a&&(a=K(a)),"object"==typeof a&&(J(a.r)&&J(a.g)&&J(a.b)?(b=d(a.r,a.g,a.b),j=!0,k="%"===String(a.r).substr(-1)?"prgb":"rgb"):J(a.h)&&J(a.s)&&J(a.v)?(e=G(a.s),g=G(a.v),b=h(a.h,e,g),j=!0,k="hsv"):J(a.h)&&J(a.s)&&J(a.l)&&(e=G(a.s),i=G(a.l),b=f(a.h,e,i),j=!0,k="hsl"),a.hasOwnProperty("a")&&(c=a.a)),c=z(c),{ok:j,format:a.format||k,r:Q(255,R(b.r,0)),g:Q(255,R(b.g,0)),b:Q(255,R(b.b,0)),a:c}}function d(a,b,c){return{r:255*A(a,255),g:255*A(b,255),b:255*A(c,255)}}function e(a,b,c){a=A(a,255),b=A(b,255),c=A(c,255);var d,e,f=R(a,b,c),g=Q(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}}function f(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(a=A(a,360),b=A(b,100),c=A(c,100),0===b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:255*e,g:255*f,b:255*g}}function g(a,b,c){a=A(a,255),b=A(b,255),c=A(c,255);var d,e,f=R(a,b,c),g=Q(a,b,c),h=f,i=f-g;if(e=0===f?0:i/f,f==g)d=0;else{switch(f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,v:h}}function h(b,c,d){b=6*A(b,360),c=A(c,100),d=A(d,100);var e=a.floor(b),f=b-e,g=d*(1-c),h=d*(1-f*c),i=d*(1-(1-f)*c),j=e%6,k=[d,h,g,g,i,d][j],l=[i,d,d,h,g,g][j],m=[g,g,i,d,d,h][j];return{r:255*k,g:255*l,b:255*m}}function i(a,b,c,d){var e=[F(P(a).toString(16)),F(P(b).toString(16)),F(P(c).toString(16))];return d&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function j(a,b,c,d,e){var f=[F(P(a).toString(16)),F(P(b).toString(16)),F(P(c).toString(16)),F(H(d))];return e&&f[0].charAt(0)==f[0].charAt(1)&&f[1].charAt(0)==f[1].charAt(1)&&f[2].charAt(0)==f[2].charAt(1)&&f[3].charAt(0)==f[3].charAt(1)?f[0].charAt(0)+f[1].charAt(0)+f[2].charAt(0)+f[3].charAt(0):f.join("")}function k(a,b,c,d){var e=[F(H(d)),F(P(a).toString(16)),F(P(b).toString(16)),F(P(c).toString(16))];return e.join("")}function l(a,c){c=0===c?0:c||10;var d=b(a).toHsl();return d.s-=c/100,d.s=B(d.s),b(d)}function m(a,c){c=0===c?0:c||10;var d=b(a).toHsl();return d.s+=c/100,d.s=B(d.s),b(d)}function n(a){return b(a).desaturate(100)}function o(a,c){c=0===c?0:c||10;var d=b(a).toHsl();return d.l+=c/100,d.l=B(d.l),b(d)}function p(a,c){c=0===c?0:c||10;var d=b(a).toRgb();return d.r=R(0,Q(255,d.r-P(255*-(c/100)))),d.g=R(0,Q(255,d.g-P(255*-(c/100)))),d.b=R(0,Q(255,d.b-P(255*-(c/100)))),b(d)}function q(a,c){c=0===c?0:c||10;var d=b(a).toHsl();return d.l-=c/100,d.l=B(d.l),b(d)}function r(a,c){var d=b(a).toHsl(),e=(d.h+c)%360;return d.h=0>e?360+e:e,b(d)}function s(a){var c=b(a).toHsl();return c.h=(c.h+180)%360,b(c)}function t(a){var c=b(a).toHsl(),d=c.h;return[b(a),b({h:(d+120)%360,s:c.s,l:c.l}),b({h:(d+240)%360,s:c.s,l:c.l})]}function u(a){var c=b(a).toHsl(),d=c.h;return[b(a),b({h:(d+90)%360,s:c.s,l:c.l}),b({h:(d+180)%360,s:c.s,l:c.l}),b({h:(d+270)%360,s:c.s,l:c.l})]}function v(a){var c=b(a).toHsl(),d=c.h;return[b(a),b({h:(d+72)%360,s:c.s,l:c.l}),b({h:(d+216)%360,s:c.s,l:c.l})]}function w(a,c,d){c=c||6,d=d||30;var e=b(a).toHsl(),f=360/d,g=[b(a)];for(e.h=(e.h-(f*c>>1)+720)%360;--c;)e.h=(e.h+f)%360,g.push(b(e));return g}function x(a,c){c=c||6;for(var d=b(a).toHsv(),e=d.h,f=d.s,g=d.v,h=[],i=1/c;c--;)h.push(b({h:e,s:f,v:g})),g=(g+i)%1;return h}function y(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function z(a){return a=parseFloat(a),(isNaN(a)||0>a||a>1)&&(a=1),a}function A(b,c){D(b)&&(b="100%");var d=E(b);return b=Q(c,R(0,parseFloat(b))),d&&(b=parseInt(b*c,10)/100),a.abs(b-c)<1e-6?1:b%c/parseFloat(c)}function B(a){return Q(1,R(0,a))}function C(a){return parseInt(a,16)}function D(a){return"string"==typeof a&&-1!=a.indexOf(".")&&1===parseFloat(a)}function E(a){return"string"==typeof a&&-1!=a.indexOf("%")}function F(a){return 1==a.length?"0"+a:""+a}function G(a){return 1>=a&&(a=100*a+"%"),a}function H(b){return a.round(255*parseFloat(b)).toString(16)}function I(a){return C(a)/255}function J(a){return!!V.CSS_UNIT.exec(a)}function K(a){a=a.replace(M,"").replace(N,"").toLowerCase();var b=!1;if(T[a])a=T[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0,format:"name"};var c;return(c=V.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:(c=V.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=V.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=V.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=V.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=V.hsva.exec(a))?{h:c[1],s:c[2],v:c[3],a:c[4]}:(c=V.hex8.exec(a))?{r:C(c[1]),g:C(c[2]),b:C(c[3]),a:I(c[4]),format:b?"name":"hex8"}:(c=V.hex6.exec(a))?{r:C(c[1]),g:C(c[2]),b:C(c[3]),format:b?"name":"hex"}:(c=V.hex4.exec(a))?{r:C(c[1]+""+c[1]),g:C(c[2]+""+c[2]),b:C(c[3]+""+c[3]),a:I(c[4]+""+c[4]),format:b?"name":"hex8"}:(c=V.hex3.exec(a))?{r:C(c[1]+""+c[1]),g:C(c[2]+""+c[2]),b:C(c[3]+""+c[3]),format:b?"name":"hex"}:!1}function L(a){var b,c;return a=a||{level:"AA",size:"small"},b=(a.level||"AA").toUpperCase(),c=(a.size||"small").toLowerCase(),"AA"!==b&&"AAA"!==b&&(b="AA"),"small"!==c&&"large"!==c&&(c="small"),{level:b,size:c}}var M=/^\s+/,N=/\s+$/,O=0,P=a.round,Q=a.min,R=a.max,S=a.random;b.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1e3},getLuminance:function(){var b,c,d,e,f,g,h=this.toRgb();return b=h.r/255,c=h.g/255,d=h.b/255,e=.03928>=b?b/12.92:a.pow((b+.055)/1.055,2.4),f=.03928>=c?c/12.92:a.pow((c+.055)/1.055,2.4),g=.03928>=d?d/12.92:a.pow((d+.055)/1.055,2.4),.2126*e+.7152*f+.0722*g},setAlpha:function(a){return this._a=z(a),this._roundA=P(100*this._a)/100,this},toHsv:function(){var a=g(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=g(this._r,this._g,this._b),b=P(360*a.h),c=P(100*a.s),d=P(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHsl:function(){var a=e(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=e(this._r,this._g,this._b),b=P(360*a.h),c=P(100*a.s),d=P(100*a.l);return 1==this._a?"hsl("+b+", "+c+"%, "+d+"%)":"hsla("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHex:function(a){return i(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(a){return j(this._r,this._g,this._b,this._a,a)},toHex8String:function(a){return"#"+this.toHex8(a)},toRgb:function(){return{r:P(this._r),g:P(this._g),b:P(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+P(this._r)+", "+P(this._g)+", "+P(this._b)+")":"rgba("+P(this._r)+", "+P(this._g)+", "+P(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:P(100*A(this._r,255))+"%",g:P(100*A(this._g,255))+"%",b:P(100*A(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+P(100*A(this._r,255))+"%, "+P(100*A(this._g,255))+"%, "+P(100*A(this._b,255))+"%)":"rgba("+P(100*A(this._r,255))+"%, "+P(100*A(this._g,255))+"%, "+P(100*A(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:U[i(this._r,this._g,this._b,!0)]||!1},toFilter:function(a){var c="#"+k(this._r,this._g,this._b,this._a),d=c,e=this._gradientType?"GradientType = 1, ":"";if(a){var f=b(a);d="#"+k(f._r,f._g,f._b,f._a)}return"progid:DXImageTransform.Microsoft.gradient("+e+"startColorstr="+c+",endColorstr="+d+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=this._a<1&&this._a>=0,e=!b&&d&&("hex"===a||"hex6"===a||"hex3"===a||"hex4"===a||"hex8"===a||"name"===a);return e?"name"===a&&0===this._a?this.toName():this.toRgbString():("rgb"===a&&(c=this.toRgbString()),"prgb"===a&&(c=this.toPercentageRgbString()),("hex"===a||"hex6"===a)&&(c=this.toHexString()),"hex3"===a&&(c=this.toHexString(!0)),"hex4"===a&&(c=this.toHex8String(!0)),"hex8"===a&&(c=this.toHex8String()),"name"===a&&(c=this.toName()),"hsl"===a&&(c=this.toHslString()),"hsv"===a&&(c=this.toHsvString()),c||this.toHexString())},clone:function(){return b(this.toString())},_applyModification:function(a,b){var c=a.apply(null,[this].concat([].slice.call(b)));return this._r=c._r,this._g=c._g,this._b=c._b,this.setAlpha(c._a),this},lighten:function(){return this._applyModification(o,arguments)},brighten:function(){return this._applyModification(p,arguments)},darken:function(){return this._applyModification(q,arguments)},desaturate:function(){return this._applyModification(l,arguments)},saturate:function(){return this._applyModification(m,arguments)},greyscale:function(){return this._applyModification(n,arguments)},spin:function(){return this._applyModification(r,arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(w,arguments)},complement:function(){return this._applyCombination(s,arguments)},monochromatic:function(){return this._applyCombination(x,arguments)},splitcomplement:function(){return this._applyCombination(v,arguments)},triad:function(){return this._applyCombination(t,arguments)},tetrad:function(){return this._applyCombination(u,arguments)}},b.fromRatio=function(a,c){if("object"==typeof a){var d={};for(var e in a)a.hasOwnProperty(e)&&("a"===e?d[e]=a[e]:d[e]=G(a[e]));a=d}return b(a,c)},b.equals=function(a,c){return a&&c?b(a).toRgbString()==b(c).toRgbString():!1},b.random=function(){return b.fromRatio({r:S(),g:S(),b:S()})},b.mix=function(a,c,d){d=0===d?0:d||50;var e=b(a).toRgb(),f=b(c).toRgb(),g=d/100,h={r:(f.r-e.r)*g+e.r,g:(f.g-e.g)*g+e.g,b:(f.b-e.b)*g+e.b,a:(f.a-e.a)*g+e.a};return b(h)},b.readability=function(c,d){var e=b(c),f=b(d);return(a.max(e.getLuminance(),f.getLuminance())+.05)/(a.min(e.getLuminance(),f.getLuminance())+.05)},b.isReadable=function(a,c,d){var e,f,g=b.readability(a,c);switch(f=!1,e=L(d),e.level+e.size){case"AAsmall":case"AAAlarge":f=g>=4.5;break;case"AAlarge":f=g>=3;break;case"AAAsmall":f=g>=7}return f},b.mostReadable=function(a,c,d){var e,f,g,h,i=null,j=0;d=d||{},f=d.includeFallbackColors,g=d.level,h=d.size;for(var k=0;k<c.length;k++)e=b.readability(a,c[k]),e>j&&(j=e,i=b(c[k]));return b.isReadable(a,i,{level:g,size:h})||!f?i:(d.includeFallbackColors=!1,b.mostReadable(a,["#fff","#000"],d))};var T=b.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},U=b.hexNames=y(T),V=function(){var a="[-\\+]?\\d+%?",b="[-\\+]?\\d*\\.\\d+%?",c="(?:"+b+")|(?:"+a+")",d="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?",e="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?";return{CSS_UNIT:new RegExp(c),rgb:new RegExp("rgb"+d),rgba:new RegExp("rgba"+e),hsl:new RegExp("hsl"+d),hsla:new RegExp("hsla"+e),hsv:new RegExp("hsv"+d),hsva:new RegExp("hsva"+e),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();"undefined"!=typeof module&&module.exports?module.exports=b:"function"==typeof define&&define.amd?define(function(){return b}):window.tinycolor=b}(Math);
const ColorsDetector = function() {const _ = {};_.isLightDarkColor = function ( c ) {var c = c.substring(1);      // strip #
var rgb = parseInt(c, 16);   // convert rrggbb to decimal
var r = (rgb >> 16) & 0xff;  // extract red
var g = (rgb >>  8) & 0xff;  // extract green
var b = (rgb >>  0) & 0xff;  // extract blue
var luma = 0.2126 * r + 0.7152 * g + 0.0722 * b; // per ITU-R BT.709
return luma > 200 ? 'light' : 'dark';};_.getLighterColor = function( color ) {var lightColor = tinycolor(color).toRgb();lightColor = tinycolor(lightColor).toHsl();lightColor.l = 0.9;lightColor = tinycolor(lightColor).toRgb();lightColor = tinycolor(lightColor).toHexString();return lightColor;};_.getDrakerColor = function( color ) {var darkColor = tinycolor(color).toRgb();darkColor = tinycolor(darkColor).toHsl();darkColor.l = 0.2;darkColor = tinycolor(darkColor).toRgb();darkColor = tinycolor(darkColor).toHexString();return darkColor;};_.hexColorDelta = function(hex1, hex2) {var hex1 = hex1.substring(1); // strip #
var hex2 = hex2.substring(1); // strip #
var r1 = parseInt(hex1.substring(0, 2), 16);var g1 = parseInt(hex1.substring(2, 4), 16);var b1 = parseInt(hex1.substring(4, 6), 16);var r2 = parseInt(hex2.substring(0, 2), 16);var g2 = parseInt(hex2.substring(2, 4), 16);var b2 = parseInt(hex2.substring(4, 6), 16);var r = 255 - Math.abs(r1 - r2);var g = 255 - Math.abs(g1 - g2);var b = 255 - Math.abs(b1 - b2);r /= 255;g /= 255;b /= 255;return (r + g + b) / 3;}
_.getBrightnessDiff = function(hex1, hex2) {const R1 = parseInt(hex1.substr(1, 2), 16);const G1 = parseInt(hex1.substr(3, 2), 16);const B1 = parseInt(hex1.substr(5, 2), 16);const R2 = parseInt(hex2.substr(1, 2), 16);const G2 = parseInt(hex2.substr(3, 2), 16);const B2 = parseInt(hex2.substr(5, 2), 16);const BR1 = (299 * R1 + 587 * G1 + 114 * B1) / 1000;const BR2 = (299 * R2 + 587 * G2 + 114 * B2) / 1000;return Math.abs(BR1 - BR2);}
_.getColorBestBrightnessDiff = function( mainColor, colorsToCompare ) {const sensitivity = ['#000000','#ffffff'].includes(mainColor) ? 125 : 50;colorsToCompare = colorsToCompare.map(function( colorObj,index ) {colorObj.score = _.getBrightnessDiff(mainColor,colorObj.color);if ( colorObj.score < sensitivity ) colorObj.score = -1;return colorObj;});colorsToCompare.sort(function(a, b) {if (b.score !== a.score) {return b.score - a.score;}
return a.priority - b.priority;});return {score: colorsToCompare[0].score,color: colorsToCompare[0].color,colorsToCompare: colorsToCompare,isLight: !tinycolor(colorsToCompare[0].color).isDark(),colorBrightnessValue: _.getColorBrightness(colorsToCompare[0].color)};}
_.getColorBrightness = function ( color ) {const r = parseInt(color.substr(1, 2), 16);const g = parseInt(color.substr(3, 2), 16);const b = parseInt(color.substr(5, 2), 16);const luminance = 0.2126 * r + 0.7152 * g + 0.0722 * b;return luminance;}
return _;}();
var upgradeFeaturesManager = new function() {var that = this;that.proFeatures = {};that.init = function( settings ) {if ( !settings ) return;that.websiteID = settings.websiteID;that.packageNUM = settings.packageNUM;that.website_uniqueID = settings.website_uniqueID;renderNewUpgradeModal();};that.show = function( featureData ) {const featureID = featureData.featureID;const limitedToPackageNUM = featureData.limitedToPackageNUM ? featureData.limitedToPackageNUM : 1;const modal = SystemModals.sm_get('upgradePackage');modal.$html.data('upgrade-reason',featureID);getProFeatures((data)=>{modal.updateHTML('body',generateFeatureContentHtml(data));updateUpgradeButtonReason(featureID,modal,limitedToPackageNUM);modal.show();},featureID,limitedToPackageNUM);};function updateUpgradeReason( featureID, isUpdateUpgradeReason ) {if ( !featureID || featureID.length === 0 ) return;updateUpgradeButtonReason(featureID);if ( isUpdateUpgradeReason ) {$.ajax({type: "POST",url: "/manager/upgrade/updateUpgradeReason.php",data: 'w='+that.websiteID+'&ur='+featureID,success: function(data) { }});}}
function updateUpgradeButtonReason( featureID, modal, limitedToPackageNUM ) {if ( !featureID || featureID.length === 0 ) return;var href = modal.$html.find('.upgrade-btn').attr('href');if ( href.indexOf('ur=') != -1 ) {href = replaceQueryParam('ur',featureID,href);} else {href += '&ur='+featureID;}
if ( href.indexOf('minPackage=') != -1 ) {href = replaceQueryParam('minPackage',limitedToPackageNUM,href);} else {href += `&minPackage=${limitedToPackageNUM}`;}
modal.$html.find('.upgrade-btn').attr('href',href);}
function generateFeatureContentHtml( data ) {let texts = data.text;texts = texts.replaceAll('{{','');texts = texts.replace(/(}})[^}]*$/, '');texts = texts.split('}}');let title = texts[0].split(':')[1];let otherTexts = texts[1].split('##bullet_list##');let subtitle = otherTexts[0].split(':')[1];let bullets = otherTexts[1] ? otherTexts[1].split('***') : [];var html = '';html += '<div class="w-u-h-c">';html += '<div class="content">';html += '<div class="content-top">';html += '<div class="title-container">';html += '<h3 class="title">'+title+'</h3>';html += '<p class="sub-title">'+subtitle+'</p>';html += '</div>';html += '</div>';html += '<div class="content-middle">';if ( bullets.length > 0 ) {html += '<ul class="list-unstyled" style="grid-template-columns: repeat('+ Math.ceil(bullets.length / 3)+',1fr);">';$.each(bullets, function( index, value ) {html += '<li><i class="ace-icon fa fa-check blue"></i> ' + value + '</li>';});html += '</ul>';}
if ( data.mediaType == 'image' && data.media!='' ) {html += '<img src="'+data.media+'"/>';} else if ( data.mediaType == 'video' && data.media!='' ) {html += '<video controls="" poster=""><source src="'+data.media+'" type="video/mp4"></video>';}
html += '</div>';html += '</div>';html += '</div>';const $html = $(html);ProFeature_addLabel({'websiteID': that.websiteID,'packageNUM': that.packageNUM,'limitedToPackageNUM': '1','toolType': data.featureType,'$element': $html.find('.title-container .title'),'upgradeReason': data.featureType,'text': `${data.packageName} +`});return $html;}
function renderNewUpgradeModal() {let upgrade_url = `/manager/upgrade/index.php?wu=${that.website_uniqueID}&ur=`;if ( parseInt(OpenPremiumFeatures(that.packageNUM)) > 1 ) {upgrade_url += '&upgrade=1';}
SystemModals.sm_render({id: 'upgradePackage',disposable: false,$parent: $('body'),sizeClasses: 'size-l1',headerSettings: {id: 'upgradePackageTitle',title: `<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="crown" class="svg-inline--fa fa-crown fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" style="color: #fee188"><path fill="currentColor" d="M528 448H112c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h416c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm64-320c-26.5 0-48 21.5-48 48 0 7.1 1.6 13.7 4.4 19.8L476 239.2c-15.4 9.2-35.3 4-44.2-11.6L350.3 85C361 76.2 368 63 368 48c0-26.5-21.5-48-48-48s-48 21.5-48 48c0 15 7 28.2 17.7 37l-81.5 142.6c-8.9 15.6-28.9 20.8-44.2 11.6l-72.3-43.4c2.7-6 4.4-12.7 4.4-19.8 0-26.5-21.5-48-48-48S0 149.5 0 176s21.5 48 48 48c2.6 0 5.2-.4 7.7-.8L128 416h384l72.3-192.8c2.5.4 5.1.8 7.7.8 26.5 0 48-21.5 48-48s-21.5-48-48-48z"></path></svg> ${translations.upgradeFeaturesManager.title}`
},bodySettings: { // body settings
content: '&nbsp;'},footerSettings: { // footer settings
isActive: true,buttons: [{class: 'btn btn-lg btn-success upgrade-btn',dataAttr: 'target="_blank"',href: upgrade_url,text: translations.upgradeFeaturesManager.upgradeBtn},{class: 'btn btn-link',dataAttr: 'data-dismiss="modal"',text: translations.upgradeFeaturesManager.maybeLater}]},showCallback: function ( event, modal ) {var button = $(event.relatedTarget);var moduleID = button.data('moduleid');var moduleTypeNUM = button.data('moduletypenum');var modalSize = button.data('modal-size');if (modalSize) modal.setWidth(modalSize);},shownCallback: () => {$('body.modal-open .main-container').addClass('modal-backdrop-blur');},hideCallback: () => {$('body.modal-open .main-container').removeClass('modal-backdrop-blur');}});}
function getProFeatures( callback, upgradeReason, limitedToPackageNUM ) {$.ajax({type: "POST",url: "/versions/2/wizard/upgradeFeaturesManager/upgradeFeatureAjax.php",data: {w: that.websiteID,websiteID: that.websiteID,featureID: upgradeReason},success: ( result ) => {result = JSON.parse(result);const disable = result.data ? result.data.disable : true;if ( result.success && !disable ) {callback(result.data);} else {let upgrade_url = `/manager/upgrade/index.php?wu=${that.website_uniqueID}&ur=${encodeURIComponent(upgradeReason)}&minPackage=${limitedToPackageNUM}`;if ( parseInt(OpenPremiumFeatures(that.packageNUM)) > 1 ) {upgrade_url += '&upgrade=1';}
window.open(upgrade_url,'_blank');return false;}}});}
return that;}();
